(self.webpackChunktest_orgnew_1=self.webpackChunktest_orgnew_1||[]).push([[196],{"./node_modules/@babel/runtime/helpers/esm/slicedToArray.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return _slicedToArray}});var unsupportedIterableToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js");function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_x,_r,_arr=[],_n=!0,_d=!1;try{if(_x=(_i=_i.call(arr)).next,0===i){if(Object(_i)!==_i)return;_n=!1}else for(;!(_n=(_s=_x.call(_i)).done)&&(_arr.push(_s.value),_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i.return&&(_r=_i.return(),Object(_r)!==_r))return}finally{if(_d)throw _e}}return _arr}}(arr,i)||(0,unsupportedIterableToArray.Z)(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"./node_modules/basicprimitives/src/enums.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{$I:function(){return ConnectorPlacementType},DL:function(){return NeighboursSelectionMode},DY:function(){return ShapeType},EE:function(){return Visibility},En:function(){return SideFlag},F7:function(){return OrientationType},GE:function(){return TextOrientationType},GV:function(){return ConnectorShapeType},JG:function(){return LabelType},JJ:function(){return AnnotationType},ML:function(){return ConnectorStyleType},S9:function(){return Layers},SP:function(){return LineType},TK:function(){return PlacementType},Vn:function(){return VerticalAlignmentType},X9:function(){return ChildrenPlacementType},ZU:function(){return VectorRelationType},a3:function(){return HorizontalAlignmentType},ex:function(){return ElbowType},hZ:function(){return AdviserPlacementType},k0:function(){return ZOrderType},lO:function(){return UpdateMode},lz:function(){return SelectionPathMode},qG:function(){return ItemType},r7:function(){return ConnectorType},sO:function(){return RenderingMode},sj:function(){return PageFitMode},vZ:function(){return SegmentType},vt:function(){return NavigationMode},wL:function(){return Colors},xB:function(){return Enabled},xj:function(){return ConnectorLabelPlacementType},zX:function(){return GroupByType}});const AdviserPlacementType={Auto:0,Left:2,Right:3},AnnotationType={Connector:0,Shape:1,HighlightPath:2,Label:3,Background:4,Level:5},ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3},Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"},ConnectorLabelPlacementType={From:0,Between:1,To:2},ConnectorPlacementType={Offbeat:0,Straight:1},ConnectorShapeType={OneWay:0,TwoWay:1,BothWay:2},ConnectorStyleType={Extra:0,Regular:1,Highlight:2},ConnectorType={Squared:0,Angular:1,Curved:2},ElbowType={None:0,Dot:1,Bevel:2,Round:3},Enabled={Auto:0,True:1,False:2},GroupByType={None:0,Parents:1,Children:2},HorizontalAlignmentType={Center:0,Left:1,Right:2},ItemType={Regular:0,Assistant:1,SubAssistant:4,Adviser:2,SubAdviser:5,GeneralPartner:6,LimitedPartner:7,AdviserPartner:8},LabelType={Regular:0,Dummy:1,Fixed:2,None:3},Layers={LevelAnnotation:1,BackgroundAnnotation:2,BackgroundAnnotations:3,BackgroundConnectorAnnotation:4,BackgroundHighlightPathAnnotations:5,Connector:6,ForegroundHighlightPathAnnotations:7,Highlight:8,Marker:9,Label:10,Cursor:11,Item:12,ForegroundAnnotations:13,ForegroundConnectorAnnotation:14,Annotation:15,Controls:16},LineType={Solid:0,Dotted:1,Dashed:2},NavigationMode={Default:0,CursorOnly:1,HighlightOnly:3,Inactive:2},NeighboursSelectionMode={ParentsAndChildren:0,ParentsChildrenSiblingsAndSpouses:1},OrientationType={Top:0,Bottom:1,Left:2,Right:3,None:4},PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3,AutoSize:5,SelectionOnly:6},PlacementType={Auto:0,TopLeft:8,Top:1,TopRight:2,RightTop:11,Right:3,RightBottom:12,BottomRight:4,Bottom:5,BottomLeft:6,LeftBottom:10,Left:7,LeftTop:9},RenderingMode={Create:0,Update:1},SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4},SelectionPathMode={None:0,FullStack:1},ShapeType={Rectangle:0,Oval:1,Triangle:2,CrossOut:3,Circle:4,Rhombus:5,Wedge:7,FramedOval:8,FramedTriangle:9,FramedWedge:10,FramedRhombus:11,None:6},SideFlag={Top:1,Right:2,Bottom:4,Left:8},TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3},UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2},VectorRelationType={None:0,Null:1,Collinear:2,Opposite:3},VerticalAlignmentType={Top:0,Middle:1,Bottom:2},Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4},ZOrderType={Auto:0,Background:1,Foreground:2}},"./node_modules/basicprimitives/src/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AdviserPlacementType:function(){return enums.hZ},AnnotationType:function(){return enums.JJ},BackgroundAnnotationConfig:function(){return BackgroundAnnotationConfig},ChildrenPlacementType:function(){return enums.X9},Colors:function(){return enums.wL},ConnectorAnnotationConfig:function(){return ConnectorAnnotationConfig},ConnectorLabelPlacementType:function(){return enums.xj},ConnectorPlacementType:function(){return enums.$I},ConnectorShapeType:function(){return enums.GV},ConnectorStyleType:function(){return enums.ML},ConnectorType:function(){return enums.r7},ElbowType:function(){return enums.ex},Enabled:function(){return enums.xB},FamConfig:function(){return FamConfig},FamDiagram:function(){return FamDiagram},FamDiagramPdfkit:function(){return FamDiagramPdfkit},FamEventArgs:function(){return FamEventArgs},FamItemConfig:function(){return FamItemConfig},FamTaskManagerFactory:function(){return FamTaskManagerFactory},Family:function(){return Family},FamilyAlignment:function(){return FamilyAlignment},FamilyMargins:function(){return FamilyMargins},FibonacciHeap:function(){return FibonacciHeap},Graph:function(){return Graph},GroupByType:function(){return enums.zX},HeapResult:function(){return HeapResult},HighlightPathAnnotationConfig:function(){return HighlightPathAnnotationConfig},HorizontalAlignmentType:function(){return enums.a3},Interval:function(){return Interval},ItemType:function(){return enums.qG},JsonML:function(){return jsonml_html},LCA:function(){return LCA},LabelAnnotationConfig:function(){return LabelAnnotationConfig},LabelType:function(){return enums.JG},Layers:function(){return enums.S9},LevelAnnotationConfig:function(){return LevelAnnotationConfig},LineType:function(){return enums.SP},LinkedHashItems:function(){return LinkedHashItems},Matrix:function(){return Matrix},NavigationMode:function(){return enums.vt},NeighboursSelectionMode:function(){return enums.DL},OrgConfig:function(){return OrgConfig},OrgDiagram:function(){return OrgDiagram},OrgDiagramPdfkit:function(){return OrgDiagramPdfkit},OrgEventArgs:function(){return OrgEventArgs},OrgItemConfig:function(){return OrgItemConfig},OrgTaskManagerFactory:function(){return TaskManagerFactory},OrientationType:function(){return enums.F7},PageFitMode:function(){return enums.sj},PaletteItemConfig:function(){return PaletteItemConfig},Pile:function(){return Pile},PlacementType:function(){return enums.TK},Point:function(){return Point},QuadTree:function(){return QuadTree},RMQ:function(){return RMQ},Rect:function(){return Rect},RenderingMode:function(){return enums.sO},SegmentType:function(){return enums.vZ},SelectionPathMode:function(){return enums.lz},ShapeAnnotationConfig:function(){return ShapeAnnotationConfig},ShapeType:function(){return enums.DY},SideFlag:function(){return enums.En},Size:function(){return Size},SortedList:function(){return SortedList},SpatialIndex:function(){return SpatialIndex},TemplateConfig:function(){return TemplateConfig},TextOrientationType:function(){return enums.GE},Thickness:function(){return Thickness},Tree:function(){return Tree},TreeLevels:function(){return TreeLevels},UpdateMode:function(){return enums.lO},Vector:function(){return Vector},VectorRelationType:function(){return enums.ZU},VerticalAlignmentType:function(){return enums.Vn},Visibility:function(){return enums.EE},ZOrderType:function(){return enums.k0},beforeOpacity:function(){return beforeOpacity},binarySearch:function(){return binarySearch_binarySearch},cloneObject:function(){return cloneObject},compareArrays:function(){return compareArrays},getBlue:function(){return getBlue},getColorHexValue:function(){return getColorHexValue},getColorName:function(){return getColorName},getCrossingRectangles:function(){return getCrossingRectangles},getElementOffset:function(){return getElementOffset},getElementsByName:function(){return getElementsByName},getFamilyLoops:function(){return getFamilyLoops},getFamilyUnits:function(){return getFamilyUnits},getFixOfPixelAlignment:function(){return getFixOfPixelAlignment},getGreen:function(){return getGreen},getHashCode:function(){return common_getHashCode},getInnerSize:function(){return getInnerSize},getLiniarBreaks:function(){return getLiniarBreaks},getMergedIntervals:function(){return getMergedIntervals},getMergedRectangles:function(){return getMergedRectangles},getMinimumCrossingRows:function(){return getMinimumCrossingRows},getRed:function(){return getRed},hasClass:function(){return hasClass},highestContrast:function(){return highestContrast},isEmptyObject:function(){return isEmptyObject},isEven:function(){return isEven},isNullOrEmpty:function(){return isNullOrEmpty},isObject:function(){return isObject},loop:function(){return loop},luminosity:function(){return luminosity},mergeObjects:function(){return mergeObjects},mergeSort:function(){return mergeSort},splitCamelCaseName:function(){return splitCamelCaseName},stopPropagation:function(){return stopPropagation}});var enums=__webpack_require__("./node_modules/basicprimitives/src/enums.js");function isEven(value){return value%2==0}function isNullOrEmpty(value){var result=!0;return null!=value&&value.toString().length>0&&(result=!1),result}function loop(thisArg,items,onItem){var key,index,len;if(null!=onItem)if(Array.isArray(items))for(index=0,len=items.length;index<len&&!onItem.call(thisArg,index,items[index]);index+=1);else for(key in items)if(items.hasOwnProperty(key)&&onItem.call(thisArg,key,items[key]))break}function splitCamelCaseName(name){for(var result=[],word="",i=0;i<name.length;i+=1){var c=name[i];c>="A"&&c<="Z"?(""!==word&&result.push(word),word=c):word+=c}return""!==word&&result.push(word),result}function isObject(item){return null!==item&&"object"==typeof item}function isEmptyObject(item){var key;for(key in item)if(item.hasOwnProperty(key))return!1;return!0}function cloneObject(source,isShallow){var result;if(null===source)result=null;else if(Array.isArray(source))if(isShallow)result=source.slice(0);else{result=[];for(var index=0,len=source.length;index<len;index+=1)result.push(cloneObject(source[index],isShallow))}else if("object"==typeof source)for(var property in result={},source)source.hasOwnProperty(property)&&(result[property]=isShallow?source[property]:cloneObject(source[property],isShallow));else result=source;return result}function mergeObjects(destination,source){for(var index=1;index<arguments.length;index+=1){var src=arguments[index];if(void 0!==src)for(var key in src)src.hasOwnProperty(key)&&(destination[key]=src[key])}return destination}function common_getHashCode(value){var i,hash=0;if(value.length>0)for(i=0;i<value.length;i+=1)hash=(hash<<5)-hash+value.charCodeAt(i),hash&=hash;return hash}function compareArrays(array1,array2,getKeyFunc){var index,len,value,hashArray1,result=!0;if(array1.length!=array2.length)result=!1;else{for(hashArray1={},index=0,len=array1.length;index<len;index+=1)value=null!=getKeyFunc?getKeyFunc(array1[index]):array1[index],hashArray1.hasOwnProperty(value)?hashArray1[value]+=1:hashArray1[value]=1;for(index=0,len=array2.length;index<len;index+=1){if(value=null!=getKeyFunc?getKeyFunc(array2[index]):array2[index],!hashArray1.hasOwnProperty(value)){result=!1;break}if(hashArray1[value]-=1,hashArray1[value]<0){result=!1;break}}}return result}let ColorHexs,ColorNames;function getColorHexValue(color){var digits,rgb,colorKey;if("#"===color.substr(0,1))return color;if(null!==(digits=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(color))&&digits.length>0)return rgb=(parseInt(digits[2],10)<<16|parseInt(digits[3],10)<<8|parseInt(digits[4],10)).toString(16),digits[1]+"000000".substr(0,6-rgb.length)+rgb;if(void 0===ColorHexs)for(colorKey in ColorHexs={},0,enums.wL)enums.wL.hasOwnProperty(colorKey)&&(ColorHexs[colorKey.toUpperCase()]=enums.wL[colorKey],1);return ColorHexs[color.toUpperCase()]}function getColorName(color){var colorKey;if(color=getColorHexValue(color),void 0===ColorNames)for(colorKey in ColorNames={},0,enums.wL)enums.wL.hasOwnProperty(colorKey)&&(ColorNames[enums.wL[colorKey]]=colorKey,1);return ColorNames[color]}function getRed(color){return"#"===color.substr(0,1)&&7===color.length?parseInt(color.substr(1,2),16):null}function getGreen(color){return"#"===color.substr(0,1)&&7===color.length?parseInt(color.substr(3,2),16):null}function getBlue(color){return"#"===color.substr(0,1)&&7===color.length?parseInt(color.substr(5,2),16):null}function beforeOpacity(color,opacity){var rgb;return color=getColorHexValue(color),rgb=(Math.ceil((getRed(color)-255*(1-opacity))/opacity)<<16|Math.ceil((getGreen(color)-255*(1-opacity))/opacity)<<8|Math.ceil((getBlue(color)-255*(1-opacity))/opacity)).toString(16),"#"+"000000".substr(0,6-rgb.length)+rgb}const highestContrasts={};function highestContrast(baseColor,firstColor,secondColor){var result=firstColor,key=baseColor+","+firstColor+","+secondColor;return highestContrasts.hasOwnProperty(key)?result=highestContrasts[key]:(luminosity(firstColor,baseColor)<luminosity(secondColor,baseColor)&&(result=secondColor),highestContrasts[key]=result),result}function luminosity(firstColor,secondColor){var first=getColorHexValue(firstColor),second=getColorHexValue(secondColor),firstLuminosity=.2126*Math.pow(getRed(first)/255,2.2)+.7152*Math.pow(getRed(first)/255,2.2)+.0722*Math.pow(getRed(first)/255,2.2),secondLuminosity=.2126*Math.pow(getRed(second)/255,2.2)+.7152*Math.pow(getRed(second)/255,2.2)+.0722*Math.pow(getRed(second)/255,2.2);return firstLuminosity>secondLuminosity?(firstLuminosity+.05)/(secondLuminosity+.05):(secondLuminosity+.05)/(firstLuminosity+.05)}function Size(arg0,arg1){switch(this.width=0,this.height=0,arguments.length){case 1:this.width=arg0.width,this.height=arg0.height;break;case 2:this.width=arg0,this.height=arg1}}function getElementsByName(thisArg,parent,name,onNode){for(var nodes=parent.getElementsByTagName("*"),index=0;index<nodes.length;index+=1){var node=nodes[index];node.name==name&&onNode.call(thisArg,node)}}function getFixOfPixelAlignment(element){var elementClientRectangle=element.getBoundingClientRect(),top=elementClientRectangle.top+document.body.scrollTop,left=elementClientRectangle.left+document.body.scrollLeft;return new Size(-left+Math.floor(left),-top+Math.floor(top))}function getElementOffset(element){var rect=element.getBoundingClientRect(),documentElement=element.ownerDocument.documentElement;return{top:rect.top+window.pageYOffset-documentElement.clientTop,left:rect.left+window.pageXOffset-documentElement.clientLeft}}function hasClass(element,className){var classNames=element.className;if(null!=classNames&&"string"==typeof classNames)for(var list=classNames.split(" "),index=0;index<list.length;index+=1)if(list[index]==className)return!0;return!1}function stopPropagation(event){void 0!==event.stopPropagation?event.stopPropagation():void 0!==event.cancelBubble?event.cancelBubble=!0:void 0!==event.preventDefault&&event.preventDefault()}function getInnerSize(element){var size=window.getComputedStyle(element);return new Size(parseInt(size.width,10),parseInt(size.height,10))}Size.prototype.isEmpty=function(){return null===this.width||null===this.height||this.width<0||this.height<0},Size.prototype.invert=function(){var width=this.width;return this.width=this.height,this.height=width,this},Size.prototype.scale=function(scale){return this.width=this.width*scale,this.height=this.height*scale,this},Size.prototype.space=function(){return this.width*this.height},Size.prototype.getCSS=function(units){return units=void 0!==units?units:"px",{width:this.width+units,height:this.height+units}},Size.prototype.cropBySize=function(size){return this.width=Math.min(this.width,size.width),this.height=Math.min(this.height,size.height),this},Size.prototype.maxSize=function(size){return this.width=Math.max(this.width,size.width),this.height=Math.max(this.height,size.height),this},Size.prototype.addThickness=function(thickness){return this.width=Math.max(0,this.width+thickness.left+thickness.right),this.height=Math.max(0,this.height+thickness.top+thickness.bottom),this},Size.prototype.removeThickness=function(thickness){return this.width=Math.max(0,this.width-thickness.left-thickness.right),this.height=Math.max(0,this.height-thickness.top-thickness.bottom),this},Size.prototype.validate=function(){if(isNaN(this.width)||isNaN(this.height))throw"Invalid size."};const JsonML={};"undefined"!=typeof document&&function(JsonML,document){var ATTR_MAP={accesskey:"accessKey",bgcolor:"bgColor",cellpadding:"cellPadding",cellspacing:"cellSpacing",checked:"defaultChecked",class:"className",colspan:"colSpan",contenteditable:"contentEditable",defaultchecked:"defaultChecked",for:"htmlFor",formnovalidate:"formNoValidate",hidefocus:"hideFocus",ismap:"isMap",maxlength:"maxLength",novalidate:"noValidate",readonly:"readOnly",rowspan:"rowSpan",spellcheck:"spellCheck",tabindex:"tabIndex",usemap:"useMap",willvalidate:"willValidate"},ATTR_DUP={enctype:"encoding",onscroll:"DOMMouseScroll"},ATTR_DOM={autocapitalize:1,autocomplete:1,autocorrect:1},ATTR_BOOL={async:1,autofocus:1,checked:1,defaultchecked:1,defer:1,disabled:1,formnovalidate:1,hidden:1,indeterminate:1,ismap:1,multiple:1,novalidate:1,readonly:1,required:1,spellcheck:1,willvalidate:1},LEADING=/^[\r\n]+/,TRAILING=/[\r\n]+$/,NUL=0,VAL=4;function Markup(value){this.value=value}Markup.prototype.toString=function(){return this.value},JsonML.raw=function(value){return new Markup(value)};var isMarkup=JsonML.isRaw=function(value){return value instanceof Markup},isArray=Array.isArray||function(val){return val instanceof Array};function isFunction(val){return"function"==typeof val}function getType(val){switch(typeof val){case"object":return val?isArray(val)?2:isMarkup(val)?5:val instanceof Date?VAL:3:NUL;case"function":return 1;case"undefined":return NUL;default:return VAL}}var createElement=function(tag){if(tag){if("!"===tag.charAt(0))return document.createComment("!"===tag?"":tag.substr(1)+" ")}else{if(document.createDocumentFragment)return document.createDocumentFragment();tag=""}return"style"===tag.toLowerCase()&&document.createStyleSheet?document.createStyleSheet():document.createElement(tag)},addHandler=function(elem,name,handler){switch("on"===name.substr(0,2)&&(name=name.substr(2)),typeof handler){case"function":if(elem.addEventListener)elem.addEventListener(name,handler,!1);else if(elem.attachEvent&&getType(elem[name])!==NUL)elem.attachEvent("on"+name,handler);else{var old=elem["on"+name]||elem[name];elem["on"+name]=elem[name]=isFunction(old)?function(e){return!1!==old.call(this,e)&&!1!==handler.call(this,e)}:handler}break;case"string":elem["on"+name]=new Function("event",handler)}},applyStyles=JsonML.applyStyles=function(elem,css){for(var key in css)css.hasOwnProperty(key)&&(elem.style[key]=css[key]);return elem},addAttributes=function(elem,attr){if(attr.name&&document.attachEvent&&!elem.parentNode)try{var alt=createElement("<"+elem.tagName+' name="'+attr.name+'">');elem.tagName===alt.tagName&&(elem=alt)}catch(ex){}for(var name in attr)if(attr.hasOwnProperty(name)){var value=attr[name],type=getType(value);if(name)if(type===NUL&&(value="",type=VAL),"$"===(name=ATTR_MAP[name.toLowerCase()]||name))value(elem);else if("className"==name)if(isArray(value))for(var index=0;index<value.length;index+=1)elem.className+=" "+value[index];else elem.className+=" "+value;else"style"===name?getType(elem.style.cssText)!==NUL?"string"==typeof value?elem.style.cssText=value:applyStyles(elem,value):elem.style=value:"on"===name.substr(0,2)?(addHandler(elem,name,value),(name=ATTR_DUP[name])&&addHandler(elem,name,value)):ATTR_DOM[name.toLowerCase()]||type===VAL&&"$"!==name.charAt(0)&&getType(elem[name])===NUL&&getType(elem[ATTR_DUP[name]])===NUL?ATTR_BOOL[name.toLowerCase()]?value&&(elem.setAttribute(name,name),(name=ATTR_DUP[name])&&elem.setAttribute(name,name)):(elem.setAttribute(name,value),(name=ATTR_DUP[name])&&elem.setAttribute(name,value)):(elem[name]=value,(name=ATTR_DUP[name])&&(elem[name]=value))}return elem},appendDOM=JsonML.appendDOM=function(elem,child){if(child){var tag=(elem.tagName||"").toLowerCase();if(8===elem.nodeType)3===child.nodeType&&(elem.nodeValue+=child.nodeValue);else if("table"===tag&&elem.tBodies){if(!child.tagName){if(11===child.nodeType)for(;child.firstChild;)appendDOM(elem,child.removeChild(child.firstChild));return}var childTag=child.tagName.toLowerCase();if(childTag&&"tbody"!==childTag&&"thead"!==childTag){var tBody=elem.tBodies.length>0?elem.tBodies[elem.tBodies.length-1]:null;tBody||(tBody=createElement("th"===childTag?"thead":"tbody"),elem.appendChild(tBody)),tBody.appendChild(child)}else!1!==elem.canHaveChildren&&elem.appendChild(child)}else if("style"===tag&&document.createStyleSheet)elem.cssText=child;else if(!1!==elem.canHaveChildren)elem.appendChild(child);else if("object"===tag&&child.tagName&&"param"===child.tagName.toLowerCase()){try{elem.appendChild(child)}catch(ex1){}try{elem.object&&(elem.object[child.name]=child.value)}catch(ex2){}}}},isWhitespace=function(node){return!(!node||3!==node.nodeType||node.nodeValue&&/\S/.exec(node.nodeValue))},trimPattern=function(node,pattern){node&&3===node.nodeType&&pattern.exec(node.nodeValue)&&(node.nodeValue=node.nodeValue.replace(pattern,""))},trimWhitespace=function(elem){if(elem){for(;isWhitespace(elem.firstChild);)elem.removeChild(elem.firstChild);for(trimPattern(elem.firstChild,LEADING);isWhitespace(elem.lastChild);)elem.removeChild(elem.lastChild);trimPattern(elem.lastChild,TRAILING)}},toDOM=function(value){var wrapper=createElement("div");if(wrapper.innerHTML=""+value,trimWhitespace(wrapper),1===wrapper.childNodes.length)return wrapper.firstChild;for(var frag=createElement("");wrapper.firstChild;)frag.appendChild(wrapper.firstChild);return frag},onError=function(ex){return document.createTextNode("["+ex+"]")};JsonML.onerror=null;var patch=JsonML.patch=function(elem,jml,filter){for(var i=1;i<jml.length;i+=1)isArray(jml[i])||"string"==typeof jml[i]?appendDOM(elem,toHTML(jml[i],filter)):isMarkup(jml[i])?appendDOM(elem,toDOM(jml[i].value)):"object"==typeof jml[i]&&null!==jml[i]&&1===elem.nodeType&&(elem=addAttributes(elem,jml[i]));return elem},toHTML=JsonML.toHTML=function(jml,filter){try{if(!jml)return null;if("string"==typeof jml)return document.createTextNode(jml);if(isMarkup(jml))return toDOM(jml.value);if(!isArray(jml)||"string"!=typeof jml[0])throw new SyntaxError("invalid JsonML");var tagName=jml[0];if(!tagName){for(var frag=createElement(""),i=1;i<jml.length;i+=1)appendDOM(frag,toHTML(jml[i],filter));return trimWhitespace(frag),1===frag.childNodes.length?frag.firstChild:frag}if("style"===tagName.toLowerCase()&&document.createStyleSheet)return patch(document.createStyleSheet(),jml,filter),null;var elem=patch(createElement(tagName),jml,filter);return trimWhitespace(elem),elem&&isFunction(filter)?filter(elem):elem}catch(ex){try{return(isFunction(JsonML.onerror)?JsonML.onerror:onError)(ex,jml,filter)}catch(ex2){return document.createTextNode("["+ex2+"]")}}};JsonML.toHTMLText=function(jml,filter){var elem=toHTML(jml,filter);if(elem.outerHTML)return elem.outerHTML;var parent=createElement("div");parent.appendChild(elem);var html=parent.innerHTML;return parent.removeChild(elem),html}}(JsonML,document);var jsonml_html=JsonML;function Point(arg0,arg1){switch(this.x=null,this.y=null,this.context=null,arguments.length){case 1:this.x=arg0.x,this.y=arg0.y,this.context=arg0.context;break;case 2:this.x=arg0,this.y=arg1}}function Matrix(arg0,arg1,arg2,arg3){switch(this.a1=null,this.b1=null,this.a2=null,this.b2=null,arguments.length){case 1:this.a1=arg0.a1,this.b1=arg0.b1,this.a2=arg0.a2,this.b2=arg0.b2;break;case 4:this.a1=arg0,this.b1=arg1,this.a2=arg2,this.b2=arg3}}function Vector(arg0,arg1){switch(this.from=null,this.to=null,this.context=null,arguments.length){case 1:this.from=arg0.from,this.to=arg0.to;break;case 2:this.from=arg0,this.to=arg1}}function Interval(arg0,arg1,arg2){switch(this.from=null,this.to=null,this.context=null,arguments.length){case 1:this.from=arg0.from,this.to=arg0.to,this.context=arg0.context;break;case 2:this.from=arg0,this.to=arg1;break;case 3:this.from=arg0,this.to=arg1,this.context=arg2}}function Rect(arg0,arg1,arg2,arg3){switch(this.x=null,this.y=null,this.width=null,this.height=null,this.context=null,arguments.length){case 1:this.x=arg0.x,this.y=arg0.y,this.width=arg0.width,this.height=arg0.height;break;case 2:this.x=Math.min(arg0.x,arg1.x),this.y=Math.min(arg0.y,arg1.y),this.width=Math.abs(arg1.x-arg0.x),this.height=Math.abs(arg1.y-arg0.y);break;case 4:this.x=arg0,this.y=arg1,this.width=arg2,this.height=arg3}}function Thickness(arg0,arg1,arg2,arg3){switch(this.left=0,this.top=0,this.right=0,this.bottom=0,arguments.length){case 1:null!==arg0&&"object"==typeof arg0?(this.left=arg0.left,this.top=arg0.top,this.right=arg0.right,this.bottom=arg0.bottom):(this.left=arg0,this.top=arg0,this.right=arg0,this.bottom=arg0);break;case 4:this.left=arg0,this.top=arg1,this.right=arg2,this.bottom=arg3}return this}function binarySearch_binarySearch(items,callback,startMinimum,startMaximum){var distance,bestDistance,middle,item,result=null,minimum=startMinimum||0,maximum=startMaximum||items.length-1;if(items.length>0&&(result={index:minimum,item:item=items[minimum]},(distance=callback(item,minimum))>0))if(bestDistance=Math.abs(distance),(distance=callback(item=items[maximum],maximum))>=0)result={index:maximum,item:item};else for(bestDistance>(distance=Math.abs(distance))&&(bestDistance=distance,result={index:maximum,item:item});minimum+1<maximum;){if(0===(distance=callback(item=items[middle=Math.round((minimum+maximum)/2)],middle))){result={index:middle,item:item};break}distance>0?minimum=middle:maximum=middle,bestDistance>(distance=Math.abs(distance))&&(bestDistance=distance,result={index:middle,item:item})}return result}function SortedList(){var _rootNode=null;function Node(value,context){this.value=value,this.context=context,this.left=null,this.right=null,this.balance=0}function _rebalance(node){var balance;if(2==node.balance){var right=node.right;(balance=right.balance)>=0?function _rotateSmallLeft(node,parent){_rotateLeft(node,parent),1==node.balance?(parent.balance=0,node.balance=0):(parent.balance=-1,node.balance=1)}(right,node):function _rotateBigLeft(node,parent){var bottom=node.left;switch(_rotateRight(bottom,node),_rotateLeft(node,parent),parent.balance=0,bottom.balance){case 1:node.balance=-1,bottom.balance=0;break;case 0:bottom.balance=0,node.balance=0;break;default:bottom.balance=1,node.balance=0}}(right,node)}else if(-2==node.balance){(balance=node.left.balance)<=0?function _rotateSmallRight(node,parent){_rotateRight(node,parent),-1==node.balance?(parent.balance=0,node.balance=0):(parent.balance=1,node.balance=-1)}(node.left,node):function _rotateBigRight(node,parent){var bottom=node.right;switch(_rotateLeft(bottom,node),_rotateRight(node,parent),parent.balance=0,bottom.balance){case-1:bottom.balance=0,node.balance=1;break;case 0:bottom.balance=0,node.balance=0;break;default:bottom.balance=-1,node.balance=0}}(node.left,node)}return balance}function _rotateLeft(node,parent){_swap(node,parent),parent.right=node.right,node.right=node.left,node.left=parent.left,parent.left=node}function _rotateRight(node,parent){_swap(node,parent),parent.left=node.left,node.left=node.right,node.right=parent.right,parent.right=node}function _delete(node,parent){var child=null!=node.right?node.right:node.left;null!=parent?parent.value>node.value?parent.left=child:parent.right=child:_rootNode=child}function _swap(node1,node2){var value=node1.value;node1.value=node2.value,node2.value=value;var context=node1.context;node1.context=node2.context,node2.context=context}function loopForward(thisArg,fromValue,onItem){if(null!=onItem){for(var trace=[],node=null,next=_rootNode;null!=next;)(node=next).value>=fromValue||null==fromValue?(trace.push(node),next=node.left):next=node.right;for(;null!=(node=trace.pop());){if(onItem.call(thisArg,node.value,node.context))return;for(next=node.right;null!=next;)if(null!=(node=next).left)trace.push(node),next=node.left;else{if(onItem.call(thisArg,node.value,node.context))return;next=node.right}}}}function loopBackward(thisArg,fromValue,onItem){if(null!=onItem){for(var trace=[],node=null,next=_rootNode;null!=next;)(node=next).value<=fromValue||null==fromValue?(trace.push(node),next=node.right):next=node.left;for(;null!=(node=trace.pop());){if(onItem.call(thisArg,node.value,node.context))return;for(next=node.left;null!=next;)if(null!=(node=next).right)trace.push(node),next=node.right;else{if(onItem.call(thisArg,node.value,node.context))return;next=node.left}}}}function _getValidationDepth(node){var level=[],result=0;if(null!=node)for(level.push(node);level.length>0;){for(var newLevel=[],index=0;index<level.length;index+=1)null!=(node=level[index]).left&&newLevel.push(node.left),null!=node.right&&newLevel.push(node.right);level=newLevel,result+=1}return result}return{add:function add(value,context,thisArg,onDuplicate){if(null==_rootNode)_rootNode=new Node(value,context);else{for(var trace=[],node=null,next=_rootNode;null!=next;)if(null!=node&&trace.push(node),(node=next).value==value){if(null==onDuplicate)throw"Structure does not support duplicates.";onDuplicate.call(thisArg,node.context)}else next=node.value>value?node.left:node.right;trace.push(node);var newNode=new Node(value,context);for(node.value>value?node.left=newNode:node.right=newNode,node=newNode;null!=(next=trace.pop());){if(node.value<next.value){if(next.balance<0){next.balance-=1,_rebalance(next);break}if(next.balance>0){next.balance-=1;break}next.balance-=1}else{if(next.balance>0){next.balance+=1,_rebalance(next);break}if(next.balance<0){next.balance+=1;break}next.balance+=1}node=next}}},remove:function remove(value){for(var fromNode,toNode,trace=[],node=_rootNode;null!=node;){if(node.value==value){if(null!=node.right&&null!=node.left){trace.push(node);for(var next=node.right;null!=next.left;)trace.push(next),next=next.left;fromNode=next,(toNode=node).value=fromNode.value,toNode.context=fromNode.context,_delete(next,trace[trace.length-1]),trace.push(next)}else _delete(node,trace[trace.length-1]),trace.push(node);for(var index=trace.length-2;index>=0;index-=1){var parent=trace[index];if(node=trace[index+1],parent.value>node.value)if(parent.balance>0){if(parent.balance+=1,0===_rebalance(parent))break}else{if(0===parent.balance){parent.balance+=1;break}parent.balance+=1}else if(parent.balance<0){if(parent.balance-=1,0===_rebalance(parent))break}else{if(0===parent.balance){parent.balance-=1;break}parent.balance-=1}}break}trace.push(node),node=node.value>value?node.left:node.right}},loopForward:loopForward,loopBackward:loopBackward,nextContext:function nextContext(fromValue){var result=null;return loopForward(this,fromValue,(function(value,context){return result=context,!0})),result},previousContext:function previousContext(fromValue){var result=null;return loopBackward(this,fromValue,(function(nextValue,context){return result=context,!0})),result},validate:function validate(){if(null!=_rootNode)for(var level=[_rootNode];level.length>0;){for(var newLevel=[],index=0;index<level.length;index+=1){var node=level[index];if(null==node.value)return!1;if(null!=node.left&&(newLevel.push(node.left),node.left.value>=node.value))return!1;if(null!=node.right&&(newLevel.push(node.right),node.right.value<=node.value))return!1;if(node.balance!=_getValidationDepth(node.right)-_getValidationDepth(node.left))return console.log("Disbalanced node: "+node.value+" - "+JSON.stringify(_rootNode)),!1}level=newLevel}return!0}}}function getCrossingRectangles(thisArg,rectangles,onCrossing){function Action(isStart,index,x,rect){this.isStart=isStart,this.index=index,this.x=x,this.rect=rect}function Level(){this.count=0,this.rectangles={},this.add=function(index){this.count+=1,this.rectangles[index]=!0},this.remove=function(index){return this.count-=1,delete this.rectangles[index],0==this.count}}function _findCrossedRectangles(buffer,from,to,rectIndex,rect){buffer.loopForward(this,from,(function(value,level){if(value>to)return!0;for(var index in level.rectangles)if(level.rectangles.hasOwnProperty(index)){var key=rectIndex>index?rectIndex+"-"+index:index+"-"+rectIndex;processed.hasOwnProperty(key)||(processed[key]=!0,onCrossing.call(thisArg,rect,rectangles[index]))}}))}if(null!=onCrossing){for(var actions=[],index=0;index<rectangles.length;index+=1){var rect=rectangles[index];actions.push(new Action(1,index,rect.x,rect)),actions.push(new Action(0,index,rect.right(),rect))}actions.sort((function(a,b){return a.x==b.x?b.isStart-a.isStart:a.x-b.x}));var buffer=SortedList(),levels={},processed={};for(index=0;index<actions.length;index+=1){var action=actions[index],actionLevels=[action.rect.y,action.rect.bottom()];if(1==action.isStart){_findCrossedRectangles(buffer,actionLevels[0],actionLevels[1],action.index,action.rect);for(var index2=0,len2=actionLevels.length;index2<len2;index2+=1){var value=actionLevels[index2],level=levels[value];null==level&&(level=new Level,levels[value]=level,buffer.add(value,level)),level.add(action.index)}}else{for(index2=0,len2=actionLevels.length;index2<len2;index2+=1)(level=levels[value=actionLevels[index2]]).remove(action.index)&&(delete levels[value],buffer.remove(value));_findCrossedRectangles(buffer,actionLevels[0],actionLevels[1],action.index,action.rect)}}}}function Edge(from,to){this.from=from,this.to=to}function getFamilyLoops(family,debug){var loop,index,len,index2,len2,fromNode,toNode,edge,loops=[],tempFamily=family.clone();family.loopTopo(this,(function(itemid){tempFamily.removeNode(itemid)})),family.loopTopoReversed(this,(function(itemid){tempFamily.removeNode(itemid)}));var cleanFamily=tempFamily.clone();for(cleanFamily.loop(this,(function(itemid){if(null!=tempFamily.node(itemid)){tempFamily.loopParents(this,itemid,(function(parentid){return loops.push(new Edge(parentid,itemid)),tempFamily.removeChildRelation(parentid,itemid),tempFamily.SKIP}));var itemsToRemove=[];tempFamily.loopTopo(this,(function(itemid){itemsToRemove.push(itemid)})),tempFamily.loopTopoReversed(this,(function(itemid){itemsToRemove.push(itemid)}));for(var index=0;index<itemsToRemove.length;index+=1)tempFamily.removeNode(itemsToRemove[index])}})),index=0,len=loops.length;index<len;index+=1)if(loop=loops[index],!cleanFamily.removeChildRelation(loop.from,loop.to))throw"Relation does not exists";if(debug&&cleanFamily.hasLoops())throw"Failed to clean loops in family";var graph=cleanFamily.getGraph(this,(function(from,to){return{from:from,to:to,capacity:1,flow:0}})),from="__1000__",to="__2000__",defaultMinimalFlow=loops.length;for(index=0,len=loops.length;index<len;index+=1)loop=loops[index],null==(edge=graph.edge(loop.from,to))?graph.addEdge(loop.from,to,{from:loop.from,to:to,capacity:1,flow:0,tos:[loop.to]}):(edge.capacity+=1,edge.tos.push(loop.to)),null==(edge=graph.edge(from,loop.to))?graph.addEdge(from,loop.to,{from:from,to:loop.to,capacity:1,flow:0,froms:[loop.from]}):(edge.capacity+=1,edge.froms.push(loop.from));for(var totalFlow=0,levelGraph=null;levelGraph=graph.getLevelGraph(this,from,(function(fromNode,toNode,edge){return fromNode==edge.from?edge.capacity>edge.flow:edge.flow>0})),levelGraph.hasNode(to);)for(;;){var connectionPath=graph.dfsPath(this,from,to,(function(fromNode,toNode,edge){return fromNode==edge.from?edge.capacity>edge.flow:edge.flow>0}));if(0==connectionPath.length)break;var flow=1/0;for(index=0,len=connectionPath.length;index<len-1;index+=1){fromNode=connectionPath[index],toNode=connectionPath[index+1];var edgeFlow=0;if(0==(edgeFlow=(edge=graph.edge(fromNode,toNode)).from==fromNode?edge.capacity-edge.flow:edge.flow))throw"Broken flow path";flow=Math.min(flow,edgeFlow)}for(index=0,len=connectionPath.length;index<len-1;index+=1)fromNode=connectionPath[index],toNode=connectionPath[index+1],(edge=graph.edge(fromNode,toNode)).from==fromNode?edge.flow+=flow:edge.flow-=flow;totalFlow+=flow}if(totalFlow<defaultMinimalFlow){var residueGraph=graph.getLevelGraph(this,from,(function(fromNode,toNode,edge){return fromNode==edge.from&&edge.capacity>edge.flow})),edgesToBreak=[];residueGraph.loopNodes(this,from,(function(nodeid){graph.loopNodeEdges(this,nodeid,(function(toNode,edge){if(edge.to==toNode&&!residueGraph.hasNode(toNode)){var isIsolated=!1;graph.dfsLoop(this,toNode,(function(fromNode,toNode2,edge){return edge.from==fromNode&&!residueGraph.hasNode(fromNode)}),(function(foundid){return foundid==to&&(isIsolated=!0,!0)})),isIsolated&&edgesToBreak.push(new Edge(nodeid,toNode))}}))}));var optimizedLoops=[],validatedFlow=0;for(index=0,len=edgesToBreak.length;index<len;index+=1){var edgeToBreak=edgesToBreak[index];if(edgeToBreak.from==from)for(index2=0,len2=(edge=graph.edge(edgeToBreak.from,edgeToBreak.to)).froms.length;index2<len2;index2+=1)optimizedLoops.push(new Edge(edge.froms[index2],edgeToBreak.to)),validatedFlow+=1;else if(edgeToBreak.to==to)for(index2=0,len2=(edge=graph.edge(edgeToBreak.from,edgeToBreak.to)).tos.length;index2<len2;index2+=1)optimizedLoops.push(new Edge(edgeToBreak.from,edge.tos[index2])),validatedFlow+=1;else optimizedLoops.push(edgeToBreak),validatedFlow+=1}validatedFlow==totalFlow&&(loops=optimizedLoops)}return loops}function getFamilyUnits(family){var index,len,familyUnits=[],familyUnitByParent={};function FamilySiblings(){this.fromIndex=0,this.toIndex=0,this.items=[],this.hash={}}function FamilyUnit(id){this.id=id,this.parents=new FamilySiblings,this.children=new FamilySiblings,this.loopSiblings=function(thisArg,itemid,onItem){this._loop(thisArg,this.parents.hash.hasOwnProperty(itemid)?this.parents.items:this.children.items,onItem)},this.loopNonSiblings=function(thisArg,itemid,onItem){this._loop(thisArg,this.parents.hash.hasOwnProperty(itemid)?this.children.items:this.parents.items,onItem)},this.loop=function(thisArg,onItem){this._loop(thisArg,this.parents.items,onItem),this._loop(thisArg,this.children.items,onItem)},this._loop=function(thisArg,items,onItem){if(null!=onItem)for(var index=0,len=items.length;index<len;index+=1){var sibling=items[index];onItem.call(thisArg,sibling)}},this.addParent=function(itemid){this._add(itemid,this.parents)},this.addChild=function(itemid){this._add(itemid,this.children)},this._add=function(itemid,siblings){siblings.hash.hasOwnProperty(itemid)||(siblings.items.push(itemid),siblings.hash[itemid]=!0)}}index=0,family.loop(this,(function(itemid,item){var childrenCount=family.countChildren(itemid);if(childrenCount>0&&!familyUnitByParent.hasOwnProperty(itemid)){var familyUnit=new FamilyUnit(index);index+=1,familyUnit.addParent(itemid),family.loopChildren(this,itemid,(function(childid,child){return familyUnit.addChild(childid),1==childrenCount&&family.loopParents(this,childid,(function(parentid){return familyUnit.addParent(parentid),familyUnitByParent[parentid]=familyUnit,family.SKIP})),family.SKIP})),familyUnits.push(familyUnit),familyUnitByParent[itemid]=familyUnit}}));var familyUnitByItemId={};for(index=0,len=familyUnits.length;index<len;index+=1){var familyUnit=familyUnits[index];familyUnit.loop(this,(function(itemid){familyUnitByItemId.hasOwnProperty(itemid)?familyUnitByItemId[itemid].push(familyUnit):familyUnitByItemId[itemid]=[familyUnit]}))}return familyUnitByItemId}function getLiniarBreaks(values){for(var _leftTotal=[],_len=values.length,total=0,index=0;index<_len;index+=1)total+=values[index],_leftTotal[index]=total;function getLinearDeviation(leftIndex,rightIndex){var result=0,avg=(_leftTotal[rightIndex]-_leftTotal[leftIndex]+values[leftIndex])/(rightIndex-leftIndex+1),median=binarySearch_binarySearch(values,(function(item){return avg-item}),leftIndex,rightIndex);return median.item<=avg?(result+=avg*(median.index+1-leftIndex)-(_leftTotal[median.index]-_leftTotal[leftIndex]+values[leftIndex]),result+=_leftTotal[rightIndex]-_leftTotal[median.index]-avg*(rightIndex-median.index)):(result+=avg*(median.index-leftIndex)-(_leftTotal[median.index]-_leftTotal[leftIndex]-values[median.index]+values[leftIndex]),result+=_leftTotal[rightIndex]-_leftTotal[median.index]+values[median.index]-avg*(rightIndex-median.index+1)),result}function getScore(leftIndex,rightIndex){var score=0;return score+=getLinearDeviation(0,leftIndex),rightIndex>leftIndex+1&&(score+=getLinearDeviation(leftIndex+1,rightIndex-1)),score+=getLinearDeviation(rightIndex,_len-1)}for(var leftIndex=0,rightIndex=_len-1,score=getScore(leftIndex,rightIndex);leftIndex<rightIndex+1;){var leftScore=getScore(leftIndex+1,rightIndex),rightScore=getScore(leftIndex,rightIndex-1);if(leftScore<rightScore){if(leftScore>=score)break;leftIndex+=1,score=leftScore}else{if(rightScore>=score)break;rightIndex-=1,score=rightScore}}return[leftIndex,rightIndex-1,_len-1]}function LinkedHashItems(){var segmentsHash={},nextKeys={},prevKeys={},startSegmentKey=null,endSegmentKey=null;function add(key,item){if(segmentsHash.hasOwnProperty(key))throw"Duplicate segments are not supported!";segmentsHash[key]=item,nextKeys[key]=null,null==endSegmentKey?(startSegmentKey=key,prevKeys[key]=null):(nextKeys[endSegmentKey]=key,prevKeys[key]=endSegmentKey),endSegmentKey=key}function unshift(key,item){if(segmentsHash.hasOwnProperty(key))throw"Duplicate segments are not supported!";segmentsHash[key]=item,prevKeys[key]=null,null==startSegmentKey?(endSegmentKey=key,nextKeys[key]=null):(prevKeys[startSegmentKey]=key,nextKeys[key]=startSegmentKey),startSegmentKey=key}function insertAfter(afterKey,key,item){if(segmentsHash.hasOwnProperty(key))throw"Duplicate segments are not supported!";if(null==afterKey)unshift(key,item);else{var nextKey=nextKeys[afterKey];null==nextKey?add(key,item):(segmentsHash[key]=item,nextKeys[afterKey]=key,nextKeys[key]=nextKey,prevKeys[nextKey]=key,prevKeys[key]=afterKey)}}function _iterate(forward,onItem,startKey,endKey){var segment,key=startKey;if(null==key&&(key=forward?startSegmentKey:endSegmentKey),null!=onItem)for(;null!=key;){if(null!=(segment=segmentsHash[key])&&onItem(segment,key))return;key=key==endKey?null:forward?nextKeys[key]:prevKeys[key]}}function iterate(onItem,startKey,endKey){_iterate(!0,onItem,startKey,endKey)}return{add:add,item:function item(key){return segmentsHash[key]},nextKey:function nextKey(key){return nextKeys[key]},prevKey:function prevKey(key){return prevKeys[key]},startKey:function startKey(){return startSegmentKey},endKey:function endKey(){return endSegmentKey},unshift:unshift,insertAfter:insertAfter,insertBefore:function insertBefore(beforeKey,key,item){if(segmentsHash.hasOwnProperty(key))throw"Duplicate segments are not supported!";if(null==beforeKey||!segmentsHash.hasOwnProperty(beforeKey))throw"Before key should be defined!";var prevKey=prevKeys[beforeKey];null==prevKey?unshift(key,item):insertAfter(prevKey,key,item)},remove:function remove(key){var prevKey=prevKeys[key],nextKey=nextKeys[key];null!=prevKey?nextKeys[prevKey]=nextKey:startSegmentKey=nextKey,null!=nextKey?prevKeys[nextKey]=prevKey:endSegmentKey=prevKey,delete segmentsHash[key],delete nextKeys[key],delete prevKeys[key]},isEmpty:function isEmpty(){return null==startSegmentKey},attach:function attach(list){list.iterate((function(segment,key){add(key,segment)}))},iterate:iterate,iterateBack:function iterateBack(onItem,startKey,endKey){_iterate(!1,onItem,startKey,endKey)},empty:function empty(){segmentsHash={},nextKeys={},prevKeys={},startSegmentKey=null,endSegmentKey=null},toArray:function toArray(){var result=[];return iterate((function(item){result.push(item)})),result},validate:function validate(info){var key,prevKey,nextKey;for(key in segmentsHash)if(segmentsHash.hasOwnProperty(key)&&(!nextKeys.hasOwnProperty(key)||!prevKeys.hasOwnProperty(key)))return null!=info&&(info.message="Orphant key found!"),!1;if(!segmentsHash.hasOwnProperty(startSegmentKey)||!segmentsHash.hasOwnProperty(endSegmentKey))return null!=info&&(info.message="Start or end values are missing!"),!1;for(key in nextKeys)if(nextKeys.hasOwnProperty(key)){if(!segmentsHash.hasOwnProperty(key)||!prevKeys.hasOwnProperty(key))return null!=info&&(info.message="Orphant key found!"),!1;if((nextKey=nextKeys[key])&&!nextKeys.hasOwnProperty(nextKey))return null!=info&&(info.message="Next key not found!"),!1}for(key in prevKeys)if(prevKeys.hasOwnProperty(key)){if(!segmentsHash.hasOwnProperty(key)||!nextKeys.hasOwnProperty(key))return null!=info&&(info.message="Orphant key found!"),!1;if((prevKey=prevKeys[key])&&!prevKeys.hasOwnProperty(prevKey))return null!=info&&(info.message="Prev key not found!"),!1}return!0}}}function getMergedRectangles(thisArg,items,onItem){var index,len,index2,len2,point;items.sort((function(a,b){return a.x==b.x?a.y-b.y:a.x-b.x}));var points=[],pointsHash={};for(index=0,len=items.length;index<len;index+=1)for(var item=items[index],xs=[item.x,item.right()],k=0;k<xs.length;k+=1){var x=xs[k];null==(point=pointsHash[x])&&(point={x:x,add:[],remove:[]},pointsHash[x]=point,points.push(point)),x==item.x?point.add.push(index):point.remove.push(index)}function Range(start,end){this.start=start,this.startHead=null,this.end=end,this.endHead=null,this.overlap=function(range){return!(this.end<range.start||this.start>range.end)}}function Stripe(x,ranges){this.x=x,this.ranges=ranges}points.sort((function(a,b){return a.x-b.x}));var active={},stripes=[];for(stripes.push(new Stripe(null,[])),index=0,len=points.length;index<len;index+=1){for(index2=0,len2=(point=points[index]).add.length;index2<len2;index2+=1)active[point.add[index2]]=!0;for(index2=0,len2=point.remove.length;index2<len2;index2+=1)delete active[point.remove[index2]];var activeRects=[];for(var key in active)active.hasOwnProperty(key)&&activeRects.push(items[key]);activeRects.sort((function(a,b){return a.y-b.y}));var ranges=[],start=null,end=null;for(index2=0,len2=activeRects.length;index2<len2;index2+=1){var activeRect=activeRects[index2];null==start?(start=activeRect.y,end=activeRect.bottom()):end<activeRect.y?(ranges.push(new Range(start,end)),start=activeRect.y,end=activeRect.bottom()):end=Math.max(end,activeRect.bottom())}null!=start&&ranges.push(new Range(start,end)),stripes.push(new Stripe(point.x,ranges))}var lists=[],heads={},counter=1;function Head(isHead,list){this.isHead=isHead,this.list=list,heads.hasOwnProperty(list)||(heads[list]=[]),heads[list].push(this),this.add=function(segment){segment.from.equalTo(segment.to)||(this.isHead?(lists[this.list].add(counter,segment),counter+=1):(lists[this.list].unshift(counter,segment),counter+=1))},this.getTail=function(){return new Head(!this.isHead,this.list)},this.attach=function(head){if(this.list!=head.list){lists[this.list].attach(lists[head.list]);var refs=heads[head.list];if(delete heads[head.list],null!=refs)for(var index=0,len=refs.length;index<len;index+=1){var ref=refs[index];ref!=head&&(ref.list=this.list,heads[this.list].push(ref))}}}}function createHead(isHead){return lists.push(new LinkedHashItems),new Head(isHead,lists.length-1)}for(index=1,len=stripes.length;index<len;index+=1)for(var prev=stripes[index-1],curr=stripes[index],pi=0,ci=0;pi<prev.ranges.length||ci<curr.ranges.length;){var pr=pi<prev.ranges.length?prev.ranges[pi]:null,cr=ci<curr.ranges.length?curr.ranges[ci]:null;if(null!=cr)if(null!=pr)if(cr.overlap(pr)){for(points=[new Point(prev.x,pr.start),new Point(curr.x,pr.start),new Point(curr.x,cr.start)],pindex=1;pindex<points.length;pindex+=1)pr.startHead.add(new Vector(points[pindex],points[pindex-1]));cr.startHead=pr.startHead;for(var loop=!0;loop;)if(loop=!1,pr.end>cr.end){var nextcr=ci+1<curr.ranges.length?curr.ranges[ci+1]:null;if(null!=nextcr&&nextcr.overlap(pr)){var p1=new Point(curr.x,nextcr.start),p2=new Point(curr.x,cr.end);cr.endHead=createHead(!0),cr.endHead.add(new Vector(p1,p2)),nextcr.startHead=cr.endHead.getTail(),ci+=1,cr=nextcr,loop=!0}}else{var nextpr=pi+1<prev.ranges.length?prev.ranges[pi+1]:null;if(null!=nextpr&&nextpr.overlap(cr)){for(points=[new Point(prev.x,pr.end),new Point(curr.x,pr.end),new Point(curr.x,nextpr.start),new Point(prev.x,nextpr.start)],pindex=1;pindex<points.length;pindex+=1)pr.endHead.add(new Vector(points[pindex-1],points[pindex]));pr.endHead.attach(nextpr.startHead),pi+=1,pr=nextpr,loop=!0}}for(points=[new Point(prev.x,pr.end),new Point(curr.x,pr.end),new Point(curr.x,cr.end)],pindex=1;pindex<points.length;pindex+=1)pr.endHead.add(new Vector(points[pindex-1],points[pindex]));cr.endHead=pr.endHead,pi+=1,ci+=1}else{if(pr.start<cr.start){for(points=[new Point(prev.x,pr.end),new Point(curr.x,pr.end),new Point(curr.x,pr.start),new Point(prev.x,pr.start)],pindex=1;pindex<points.length;pindex+=1)pr.endHead.add(new Vector(points[pindex-1],points[pindex]));pr.endHead.attach(pr.startHead),pi+=1;continue}cr.endHead=createHead(!0),cr.endHead.add(new Vector(new Point(curr.x,cr.start),new Point(curr.x,cr.end))),cr.startHead=cr.endHead.getTail(),ci+=1}else cr.endHead=createHead(!0),cr.endHead.add(new Vector(new Point(curr.x,cr.start),new Point(curr.x,cr.end))),cr.startHead=cr.endHead.getTail(),ci+=1;else{points=[new Point(prev.x,pr.end),new Point(curr.x,pr.end),new Point(curr.x,pr.start),new Point(prev.x,pr.start)];for(var pindex=1;pindex<points.length;pindex+=1)pr.endHead.add(new Vector(points[pindex-1],points[pindex]));pr.endHead.attach(pr.startHead),pi+=1}}if(null!=onItem)for(index=0;index<lists.length;index+=1)if(heads.hasOwnProperty(index)){var list=lists[index];points=[],list.iterate((function(segment,key){0==points.length?(points.push(segment.from),points.push(segment.to)):points.push(segment.to)})),onItem.call(thisArg,points)}}function getMinimumCrossingRows(thisArg,rectangles,onItem){var from=null,to=null;if(null!=onItem){rectangles.sort((function(a,b){return a.y-b.y}));for(var index=0;index<rectangles.length;index+=1){var rect=rectangles[index],bottom=rect.bottom();null===from?(from=rect.y,to=bottom):rect.y>=to?(onItem.call(thisArg,from),from=rect.y,to=bottom):(rect.y>from&&(from=rect.y),bottom<to&&(to=bottom))}null!==from&&onItem.call(thisArg,from)}}function mergeSort(arrays,getItemWeight,ignoreDuplicates){var firstArray,secondArray,mergedArray,arrayIndex,firstIndex,secondIndex,firstLen,secondLen,firstItem,secondItem,firstItemWeight,secondItemWeight,currentValue,result=null;if(0===arrays.length)result=[];else{for(firstArray=[],arrayIndex=0;arrayIndex<arrays.length;arrayIndex+=1){for(secondArray=arrays[arrayIndex],mergedArray=[],firstLen=firstArray.length,secondLen=secondArray.length,firstIndex=0,secondIndex=0,firstItem=null,firstItemWeight=null,secondItem=null,secondItemWeight=null,firstLen>0&&(firstItem=firstArray[firstIndex],firstItemWeight=getItemWeight?getItemWeight(firstItem):firstItem),secondLen>0&&(secondItem=secondArray[secondIndex],secondItemWeight=getItemWeight?getItemWeight(secondItem):secondItem),currentValue=null;firstIndex<firstLen||secondIndex<secondLen;)firstIndex>=firstLen?(ignoreDuplicates&&currentValue==secondItem||(mergedArray.push(secondItem),currentValue=secondItem),(secondIndex+=1)<secondLen&&(secondItem=secondArray[secondIndex],secondItemWeight=getItemWeight?getItemWeight(secondItem):secondItem)):secondIndex>=secondLen||firstItemWeight<secondItemWeight?(ignoreDuplicates&&currentValue==firstItem||(mergedArray.push(firstItem),currentValue=firstItem),(firstIndex+=1)<firstLen&&(firstItem=firstArray[firstIndex],firstItemWeight=getItemWeight?getItemWeight(firstItem):firstItem)):(ignoreDuplicates&&currentValue==secondItem||(mergedArray.push(secondItem),currentValue=secondItem),(secondIndex+=1)<secondLen&&(secondItem=secondArray[secondIndex],secondItemWeight=getItemWeight?getItemWeight(secondItem):secondItem));firstArray=mergedArray}result=firstArray}return result}function IntervalPoint(value,index,isStart){this.value=value,this.index=index,this.isStart=isStart}function getMergedIntervals(thisArg,items,onItem){for(var points=[],index=0;index<items.length;index+=1){var item=items[index];points.push(new IntervalPoint(item.from,index,!0)),points.push(new IntervalPoint(item.to,index,!1))}points.sort((function(a,b){return a.value===b.value?b.isStart-a.isStart:a.value-b.value}));for(var counter=0,interval=null,logicalIndex=null,len=(index=0,points.length);index<len;index+=1){var point=points[index];null==interval&&(interval=new Interval(items[point.index])),interval.to=point.value,point.isStart?(counter++,(null===logicalIndex||logicalIndex>point.index)&&(logicalIndex=point.index,interval.context=items[point.index].context)):counter--,counter||(null!=onItem&&onItem.call(thisArg,interval),interval=null,logicalIndex=null)}}function Tree(source){var _nodes={},_parents={},_children={},_roots={},_rootChildren={},BREAK=1,SKIP=2;function loopChildren(thisArg,nodeid,onItem){var items,itemid,index,len;if(null!=_nodes[nodeid]&&null!=(items=_children[nodeid]))for(index=0,len=items.length;index<len&&(itemid=items[index],!onItem.call(thisArg,itemid,_nodes[itemid],index,len-1));index+=1);}function parentid(nodeid){var result=null;return null!=_parents[nodeid]&&(result=_parents[nodeid]),result}function _splice(collection,nodeid){var index,len=collection.length;for(index=0;index<len;index+=1)if(collection[index]==nodeid)return collection.splice(index,1),len-1;return len}function node(nodeid){return _nodes[nodeid]}function _loopNeighbours(thisArg,itemid,onItem){if(null!=onItem&&_nodes.hasOwnProperty(itemid)){var parentItemId=parentid(itemid);if(null!=parentItemId&&onItem.call(thisArg,parentItemId,_nodes[parentItemId]))return;loopChildren(thisArg,parentItemId,(function(childItemId,childItem){childItemId==itemid||onItem.call(thisArg,childItemId,childItem)})),loopChildren(thisArg,itemid,(function(childItemId,childItem){onItem.call(thisArg,childItemId,childItem)}))}}return function _init(source){isObject(source)&&(_nodes=cloneObject(source.nodes,!0),_parents=cloneObject(source.parents,!0),_children=cloneObject(source.children,!1),_roots=cloneObject(source.roots,!1),_rootChildren=cloneObject(source.rootChildren,!0))}(source),{loop:function loop(thisArg,onItem){var item;if(null!=onItem)for(item in _nodes)if(_nodes.hasOwnProperty(item)&&onItem.call(thisArg,item,_nodes[item]))break},loopLevels:function loopLevels(thisArg,arg0,arg1){var itemid,onItem,newItems,key,index,len,levelIndex=0,items=[];switch(arguments.length){case 2:onItem=arg0;break;case 3:itemid=arg0,onItem=arg1}if(null!=onItem){if(null==itemid)for(key in _rootChildren)_rootChildren.hasOwnProperty(key)&&(items=items.concat(_rootChildren[key]));else null!=_children[itemid]&&(items=items.concat(_children[itemid]));for(;items.length>0;){for(newItems=[],index=0,len=items.length;index<len;index+=1)switch(itemid=items[index],onItem.call(thisArg,itemid,_nodes[itemid],levelIndex)){case BREAK:newItems=[];break;case SKIP:break;default:null!=_children[itemid]&&(newItems=newItems.concat(_children[itemid]))}items=newItems,levelIndex+=1}}},loopParents:function loopParents(thisArg,nodeid,onItem,includingStartItem){var parentid=nodeid;if(null!=_nodes[parentid]&&null!=onItem){if(!0===includingStartItem&&onItem.call(thisArg,parentid,_nodes[parentid]))return;for(;null!=(parentid=_parents[parentid])&&!onItem.call(thisArg,parentid,_nodes[parentid]););}},loopChildren:loopChildren,loopChildrenRange:function loopChildrenRange(thisArg,nodeid,fromIndex,toIndex,onItem){var items,itemid,index;if(null!=_nodes[nodeid]&&null!=(items=_children[nodeid]))if(fromIndex<toIndex)for(fromIndex=Math.max(fromIndex,0),toIndex=Math.min(toIndex,items.length-1),index=fromIndex;index<=toIndex&&(itemid=items[index],!onItem.call(thisArg,itemid,_nodes[itemid],index,NaN));index+=1);else for(fromIndex=Math.min(fromIndex,items.length-1),toIndex=Math.max(0,toIndex),index=fromIndex;index>=toIndex&&(itemid=items[index],!onItem.call(thisArg,itemid,_nodes[itemid],index,NaN));index-=1);},loopChildrenReversed:function loopChildrenReversed(thisArg,nodeid,onItem){var items,itemid,index,lastIndex;if(null!=_nodes[nodeid]&&(lastIndex=(items=_children[nodeid]).length-1,null!=items))for(index=lastIndex;index>=0&&(itemid=items[index],!onItem.call(thisArg,itemid,_nodes[itemid],index,lastIndex));index-=1);},loopPostOrder:function loopPostOrder(thisArg,onItem){var nodeid,key,index,prevParent,children,stack=[];if(null!=onItem){for(key in _rootChildren)_rootChildren.hasOwnProperty(key)&&(stack=stack.concat(_rootChildren[key]));for(;stack.length>0;)if((nodeid=stack[stack.length-1])!=prevParent&&null!=(children=_children[nodeid]))for(index=children.length-1;index>=0;index-=1)stack.push(children[index]);else if(stack.pop(),prevParent=_parents[nodeid],onItem.call(thisArg,nodeid,_nodes[nodeid],prevParent,_nodes[prevParent]))break}},loopPreOrder:function loopPreOrder(thisArg,arg0,arg1){var nodeid,key,index,parentid,prevParent,children,startNodeId,onItem,stack=[];switch(arguments.length){case 2:onItem=arg0;break;case 3:startNodeId=arg0,onItem=arg1}if(null!=onItem){if(node(startNodeId))stack.push(startNodeId);else for(key in _rootChildren)_rootChildren.hasOwnProperty(key)&&(stack=stack.concat(_rootChildren[key]));for(;stack.length>0&&((nodeid=stack[stack.length-1])==prevParent||(parentid=_parents[nodeid],!onItem.call(thisArg,nodeid,_nodes[nodeid],parentid,_nodes[parentid])));)if(nodeid!=prevParent&&null!=(children=_children[nodeid]))for(index=children.length-1;index>=0;index-=1)stack.push(children[index]);else stack.pop(),prevParent=_parents[nodeid]}},loopEulerWalk:function loopEulerWalk(thisArg,onItem){var nodeid,key,index,len,prevParent,children,stack=[],levels=[],level=0;if(null!=onItem){for(key in _rootChildren)if(_rootChildren.hasOwnProperty(key))for(index=0,len=(children=_rootChildren[key]).length;index<len;index+=1)stack.push(children[index]),levels.push(0);for(;stack.length>0&&(nodeid=stack[index=stack.length-1],level=levels[index],!onItem.call(thisArg,nodeid,_nodes[nodeid],level));)if(nodeid!=prevParent&&null!=(children=_children[nodeid]))for(index=children.length-1;index>=0;index-=1)stack.push(children[index]),levels.push(level+1),index>0&&(stack.push(nodeid),levels.push(level));else stack.pop(),levels.pop(),prevParent=_parents[nodeid]}},loopNeighbours:function loopNeighbours(thisArg,itemid,distance,onItem){var newMargin,processed={},margin=[itemid],currentDistance=0;if(null!=onItem&&_nodes.hasOwnProperty(itemid))for(processed[itemid]=!0;margin.length>0;){newMargin=[];for(var index=0,len=margin.length;index<len;index+=1){var marginid=margin[index];if(currentDistance>0&&onItem.call(thisArg,marginid,_nodes[marginid],currentDistance))return;currentDistance<distance&&_loopNeighbours(this,marginid,(function(neighbourid,neighbour){processed.hasOwnProperty(neighbourid)||(newMargin.push(neighbourid),processed[neighbourid]=!0)}))}margin=newMargin,currentDistance+=1}},zipUp:function zipUp(thisArg,firstNodeId,secondNodeid,onZip){var firstParentId,secondParentId;if(null!=onZip)for(;null!=firstNodeId&&null!=secondNodeid&&firstNodeId!=secondNodeid&&(firstParentId=_parents[firstNodeId],secondParentId=_parents[secondNodeid],!onZip.call(thisArg,firstNodeId,firstParentId,secondNodeid,secondParentId));)firstNodeId=firstParentId,secondNodeid=secondParentId},parentid:parentid,parent:function parent(nodeid){var result=null;return null!=_parents[nodeid]&&(result=_nodes[_parents[nodeid]]),result},adopt:function adopt(parentid,nodeid){if(null==_nodes[parentid]||null==_nodes[nodeid])throw"Both parent and child should be in hierarchy!";if(parentid==nodeid)throw"Item cannot be parent of itself!";_roots.hasOwnProperty(nodeid)&&(_splice(_rootChildren[_roots[nodeid]],nodeid)||delete _rootChildren[_roots[nodeid]],delete _roots[nodeid]),_parents.hasOwnProperty(nodeid)&&(_splice(_children[_parents[nodeid]],nodeid)||delete _children[_parents[nodeid]]),_parents[nodeid]=parentid,null!=_children[parentid]?_children[parentid].push(nodeid):_children[parentid]=[nodeid]},moveChildren:function moveChildren(fromNodeid,toNodeId){null!=_nodes[fromNodeid]&&null!=_nodes[toNodeId]&&fromNodeid!=toNodeId&&null!=_children[fromNodeid]&&(loopChildren(this,fromNodeid,(function(childid,node,index){_parents[childid]=toNodeId})),null!=_children[toNodeId]?_children[toNodeId]=_children[toNodeId].concat(_children[fromNodeid]):_children[toNodeId]=_children[fromNodeid],delete _children[fromNodeid])},node:node,add:function add(parentid,nodeid,node,position){var index,len,children,childid;if(null!=_nodes[nodeid])throw"Node already exists";if(null!=nodeid&&null!=node&&null==_nodes[nodeid]&&(null!=_nodes[parentid]?(_parents[nodeid]=parentid,null!=_children[parentid]?null==position?_children[parentid].push(nodeid):_children[parentid].splice(position,0,nodeid):_children[parentid]=[nodeid]):(_roots[nodeid]=parentid,null!=_rootChildren[parentid]?null==position?_rootChildren[parentid].push(nodeid):_rootChildren[parentid].splice(position,0,nodeid):_rootChildren[parentid]=[nodeid]),_nodes[nodeid]=node,null!=_rootChildren[nodeid]))for(_children[nodeid]=_rootChildren[nodeid],delete _rootChildren[nodeid],index=0,len=(children=_children[nodeid]).length;index<len;index+=1)childid=children[index],delete _roots[childid],_parents[childid]=nodeid},insert:function insert(nodeid,bundleid,bundle){null!=_nodes[nodeid]&&null!=bundleid&&null==_nodes[bundleid]&&null!=bundle&&(_nodes[bundleid]=bundle,null!=_children[nodeid]&&(_children[bundleid]=_children[nodeid]),_children[nodeid]=[bundleid],loopChildren(this,bundleid,(function(childid,node,index){_parents[childid]=bundleid})),_parents[bundleid]=nodeid)},hasNodes:function hasNodes(){return!isEmptyObject(_rootChildren)},hasChildren:function hasChildren(nodeid){return null!=_children[nodeid]},countChildren:function countChildren(nodeid){return null!=_children[nodeid]?_children[nodeid].length:0},countSiblings:function countSiblings(nodeid){var parent=parentid(nodeid);return null!=parent?_children[parent].length:0},indexOf:function indexOf(nodeid){var parent=parentid(nodeid);return null!=parent?_children[parent].findIndex((itemid=>itemid===nodeid)):null},getChild:function getChild(parentid,index){var children,result=null;return null!=(children=_children[parentid])&&(result=_nodes[children[index]]),result},arrangeChildren:function arrangeChildren(nodeid,children){var childid,index,len;if(children=children.slice(0),null!=_nodes[nodeid])if(null!=_children[nodeid]){if(_children[nodeid].length!=children.length)throw"Collections of children don't match each other!";for(index=0,len=children.length;index<len;index+=1)if(childid=children[index],_parents[childid]!=nodeid)throw"Child "+childid+" does not belong to given node!";_children[nodeid]=children}else if(children.length>0)throw"Collections of children don't match each other!"},validate:function validate(){var key,result=!0;for(key in _roots)if(_roots.hasOwnProperty(key)&&null!=_roots[key]){result=!1;break}return result},clone:function clone(){return Tree({nodes:_nodes,parents:_parents,children:_children,roots:_roots,rootChildren:_rootChildren})},BREAK:BREAK,SKIP:SKIP}}function HeapResult(node){this.key=node.key,this.priority=node.priority,this.item=node.item}function FibonacciHeap(isMaximum){var root=null,nodes={};function Node(key,priority,item){this.key=key,this.priority=priority,this.item=item,this.degree=0,this.marked=!1,this.parent=null,this.child=null,this.left=null,this.right=null}function _insert(node,newNode){var rightNode=nodes[node.right];newNode.right=node.right,newNode.left=node.key,node.right=newNode.key,rightNode.left=newNode.key}function _exclude(node){var prevNode=nodes[node.left],nextNode=nodes[node.right];prevNode.right=nextNode.key,nextNode.left=prevNode.key,node.right=node.key,node.left=node.key}function heapRoot(){var result=null;return null!=root&&(result=new HeapResult(nodes[root])),result}function extractRoot(){var result=heapRoot();if(null!=result){var rootNode=nodes[root],nextNode=nodes[rootNode.right];if(null!=rootNode.child){var childNode=nodes[rootNode.child],childNodeLeft=nodes[childNode.left];rootNode.right=childNode.key,nextNode.left=childNodeLeft.key,childNode.left=rootNode.key,childNodeLeft.right=nextNode.key,_exclude(rootNode),delete nodes[rootNode.key],root=null,_consolidate(childNode.key)}else _exclude(rootNode),delete nodes[rootNode.key],root=null,nextNode.key!=rootNode.key&&_consolidate(nextNode.key);1}return result}function _consolidate(startKey){for(var pairedNode,pairs=[],processed={},key=startKey;!processed.hasOwnProperty(key);){var node=nodes[key],nextKey=node.right;for(processed[key]=!0,node.parent=null;null!=(pairedNode=pairs[node.degree]);)(isMaximum?node.priority>pairedNode.priority:node.priority<pairedNode.priority)?_union(node,pairedNode):(_union(pairedNode,node),node=pairedNode),pairs[node.degree-1]=null;pairs[node.degree]=node,(null==root||null==nodes[root]||(isMaximum?nodes[root].priority<=node.priority:nodes[root].priority>=node.priority))&&(root=node.key),key=nextKey}}function _union(node1,node2){node1.degree+=1,_exclude(node2);var child=nodes[node1.child];null!=child?(_insert(child,node2),(isMaximum?child.priority<node2.priority:child.priority>node2.priority)&&(node1.child=node2.key)):node1.child=node2.key,node2.parent=node1.key}function setPriority(key,priority){var node=nodes[key];if(isMaximum?node.priority>priority:node.priority<priority)throw"Priority increase is not supported";if(node.priority=priority,null!=node.parent){var parentNode=nodes[node.parent];(isMaximum?parentNode.priority<node.priority:parentNode.priority>node.priority)&&(_cut(parentNode,node),_cascadeCut(parentNode))}(isMaximum?nodes[root].priority<node.priority:nodes[root].priority>node.priority)&&(root=node.key)}function _cut(parentNode,node){node.marked=!1,node.parent=null,node.right==node.key?parentNode.child=null:(parentNode.child=node.right,_exclude(node)),parentNode.degree-=1,_insert(nodes[root],node)}function _cascadeCut(node){if(null!=node.parent)if(node.marked){var parentNode=nodes[node.parent];_cut(parentNode,node),_cascadeCut(parentNode)}else node.marked=!0}return{add:function add(key,priority,item){if(nodes.hasOwnProperty(key))throw"Duplicate keys are not supported!";var newNode=new Node(key,priority,item);if(nodes[key]=newNode,null==root)newNode.left=key,newNode.right=key,root=key;else{var rootNode=nodes[root];_insert(rootNode,newNode),(isMaximum?rootNode.priority<newNode.priority:rootNode.priority>newNode.priority)&&(root=key)}1},getPriority:function getPriority(key){var result=null;return nodes.hasOwnProperty(key)&&(result=nodes[key].priority),result},setPriority:setPriority,heapRoot:heapRoot,extractRoot:extractRoot,deleteKey:function deleteKey(key){setPriority(key,isMaximum?1/0:-1),extractRoot()},validate:function validate(){var totalNodes=0;for(var key in nodes)if(nodes.hasOwnProperty(key)){var node=nodes[key];if(totalNodes+=1,null!=node.child){if(!nodes.hasOwnProperty(node.child))throw"Child does not exists";var ref=nodes[node.child];if(ref.parent!=node.key)throw"Child references wrong parent"}if(null!=node.parent&&!nodes.hasOwnProperty(node.parent))throw"Parent does not exists";if(null!=node.left){if(!nodes.hasOwnProperty(node.left))throw"Left does not exists";if((ref=nodes[node.left]).right!=node.key)throw"Left references wrong right"}if(null!=node.right){if(!nodes.hasOwnProperty(node.right))throw"Right does not exists";if((ref=nodes[node.right]).left!=node.key)throw"Right references wrong left"}}if(null==root&&totalNodes>0)throw"Orphans";if(null!=root){if(!nodes.hasOwnProperty(root))throw"Root node does not exists";if(null!=(node=nodes[root]).parent)throw"Root node has parent reference";for(var children=[root],processed={},totalChildren=0;children.length>0;){for(var newChildren=[],index=0,len=children.length;index<len;index+=1)for(var child=nodes[children[index]];!processed.hasOwnProperty(child.key);)processed[child.key]=!0,totalChildren+=1,null!=child.child&&newChildren.push(child.child),child=nodes[child.right];children=newChildren}if(totalNodes!=totalChildren)throw"Tree has loops or orpants"}}}}function Graph(){var _edges={},MAXIMUMTOTALWEIGHT=1,MINIMUMWEIGHT=2;function _loopNodes(thisArg,startNode,processed,onItem){var marginKey,newMargin,index,len,neighbours,neighbourKey,margin=[];if(margin.push(startNode),processed[startNode]=!0,null!=onItem)for(;margin.length>0;){for(newMargin=[],index=0,len=margin.length;index<len;index+=1){if(marginKey=margin[index],onItem.call(thisArg,marginKey))return;for(neighbourKey in neighbours=_edges[marginKey])neighbours.hasOwnProperty(neighbourKey)&&!processed.hasOwnProperty(neighbourKey)&&(processed[neighbourKey]=!0,newMargin.push(neighbourKey))}margin=newMargin}}function _findStartNode(thisArg,onEdgeWeight){var fromItem,toItems,toItem,result=null,weight=0,maxWeight=null;for(fromItem in _edges)if(_edges.hasOwnProperty(fromItem)){for(toItem in weight=0,toItems=_edges[fromItem])toItems.hasOwnProperty(toItem)&&(weight+=onEdgeWeight.call(thisArg,toItems[toItem],fromItem,toItem));(weight>maxWeight||null==maxWeight)&&(result=fromItem,maxWeight=weight)}return result}function _getGrowthSequence(thisArg,startNode,onEdgeWeight,onItem,growsMode){var marginKey,hasNeighbours,nextMarginKey,nextMarginWeight,bestWeight,neighbours,neighbourKey,neighbourWeight,index,len,margin={},itemsToRemove=[],processed={},marginLength=0;if(null!=onEdgeWeight&&null!=onItem&&(null==startNode&&(startNode=_findStartNode(thisArg,onEdgeWeight)),null!=startNode))for(onItem.call(thisArg,startNode),margin[startNode]=!0,marginLength+=1,processed[startNode]=null;marginLength>0;){for(marginKey in itemsToRemove=[],nextMarginKey=null,nextMarginWeight=null,bestWeight={},margin)if(margin.hasOwnProperty(marginKey)){for(neighbourKey in hasNeighbours=!1,neighbours=_edges[marginKey])if(neighbours.hasOwnProperty(neighbourKey)&&!processed.hasOwnProperty(neighbourKey))switch(neighbourWeight=onEdgeWeight.call(thisArg,neighbours[neighbourKey],marginKey,neighbourKey),hasNeighbours=!0,growsMode){case MAXIMUMTOTALWEIGHT:null==bestWeight[neighbourKey]&&(bestWeight[neighbourKey]=0),bestWeight[neighbourKey]+=neighbourWeight,(!nextMarginWeight||bestWeight[neighbourKey]>nextMarginWeight)&&(nextMarginKey=neighbourKey,nextMarginWeight=bestWeight[neighbourKey]);break;case MINIMUMWEIGHT:null==bestWeight[neighbourKey]?bestWeight[neighbourKey]=neighbourWeight:bestWeight[neighbourKey]=Math.min(bestWeight[neighbourKey],neighbourWeight),(!nextMarginWeight||bestWeight[neighbourKey]<nextMarginWeight)&&(nextMarginKey=neighbourKey,nextMarginWeight=bestWeight[neighbourKey])}hasNeighbours||itemsToRemove.push(marginKey)}if(null==nextMarginKey)break;for(margin[nextMarginKey]=!0,marginLength+=1,processed[nextMarginKey]=!0,onItem.call(thisArg,nextMarginKey),index=0,len=itemsToRemove.length;index<len;index+=1)delete margin[itemsToRemove[index]],marginLength-=1}}return{addEdge:function addEdge(from,to,edge){null!=_edges[from]&&null!=_edges[from][to]||null==edge||(null==_edges[from]&&(_edges[from]={}),_edges[from][to]=edge,null==_edges[to]&&(_edges[to]={}),_edges[to][from]=edge)},edge:function edge(from,to){var result=null;return null!=_edges[from]&&_edges[from][to]&&(result=_edges[from][to]),result},hasNode:function hasNode(from){return _edges.hasOwnProperty(from)},loopNodes:function loopNodes(thisArg,startNode,onItem){var processed={};if(null==startNode)for(startNode in _edges)_edges.hasOwnProperty(startNode)&&(processed.hasOwnProperty[startNode]||_loopNodes(thisArg,startNode,processed,onItem));else _loopNodes(thisArg,startNode,processed,onItem)},loopNodeEdges:function loopNodeEdges(thisArg,itemid,onEdge){var neighbours,neighbourKey;if(null!=onEdge&&null!=(neighbours=_edges[itemid]))for(neighbourKey in neighbours)neighbours.hasOwnProperty(neighbourKey)&&onEdge.call(thisArg,neighbourKey,neighbours[neighbourKey])},getSpanningTree:function getSpanningTree(startNode,getWeightFunc){var marginNode,neighbours,neighbourKey,neighbourWeight,currentWeight,result=Tree(),margin=FibonacciHeap(!0),parents={};for(margin.add(startNode,0,null),parents[startNode]=null;null!=(marginNode=margin.extractRoot());){for(neighbourKey in neighbours=_edges[marginNode.key])neighbours.hasOwnProperty(neighbourKey)&&!result.node(neighbourKey)&&(neighbourWeight=null!=getWeightFunc?getWeightFunc(neighbours[neighbourKey]):neighbours[neighbourKey],null==(currentWeight=margin.getPriority(neighbourKey))?(margin.add(neighbourKey,neighbourWeight,null),parents[neighbourKey]=marginNode.key.toString()):currentWeight<=neighbourWeight&&(margin.setPriority(neighbourKey,neighbourWeight),parents[neighbourKey]=marginNode.key.toString()));result.add(parents[marginNode.key],marginNode.key.toString(),{})}return result},getTotalWeightGrowthSequence:function getTotalWeightGrowthSequence(thisArg,onEdgeWeight,onItem){_getGrowthSequence(thisArg,_findStartNode(thisArg,onEdgeWeight),onEdgeWeight,onItem,MAXIMUMTOTALWEIGHT)},getMinimumWeightGrowthSequence:function getMinimumWeightGrowthSequence(thisArg,startNode,onEdgeWeight,onItem){_getGrowthSequence(thisArg,startNode,onEdgeWeight,onItem,MINIMUMWEIGHT)},getShortestPath:function getShortestPath(thisArg,startNode,endNodes,getWeightFunc,onPathFound){var bestNodeOnMargin,key,children,newDistance,weight,path,currentNode,index,len,margin=FibonacciHeap(!1),distance={},breadcramps={},endNodesHash={},endsCount=0,endsFound=0;for(index=0,len=endNodes.length;index<len;index+=1)key=endNodes[index],endNodesHash.hasOwnProperty(key)||(endsCount+=1,endNodesHash[key]=!0);for(margin.add(startNode,0,null),breadcramps[startNode]=null;null!=(bestNodeOnMargin=margin.extractRoot());){for(key in children=_edges[bestNodeOnMargin.key])children.hasOwnProperty(key)&&(weight=1,null!=getWeightFunc?(weight=getWeightFunc.call(thisArg,children[key],bestNodeOnMargin,key),newDistance=bestNodeOnMargin.priority+weight):newDistance=bestNodeOnMargin.priority+1,weight>=0&&(null!=(distance=margin.getPriority(key))?distance>newDistance&&(margin.setPriority(key,newDistance),breadcramps[key]=bestNodeOnMargin.key):breadcramps.hasOwnProperty(key)||(margin.add(key,newDistance,null),breadcramps[key]=bestNodeOnMargin.key)));if(endNodesHash.hasOwnProperty(bestNodeOnMargin.key)){for(path=[],currentNode=bestNodeOnMargin.key;null!=currentNode;)path.push(currentNode),currentNode=breadcramps[currentNode];if(onPathFound.call(thisArg,path,bestNodeOnMargin.key),(endsFound+=1)>=endsCount)break}}},dfsPath:function dfsPath(thisArg,startNode,endNode,onEdge){var margin=[],backtrace={};if(margin.push(startNode),backtrace[startNode]=null,startNode!=endNode)for(;margin.length>0&&!backtrace.hasOwnProperty(endNode);){var currentNode=margin[margin.length-1];margin.length-=1;var neighbours=_edges[currentNode];for(var neighbour in neighbours)if(neighbours.hasOwnProperty(neighbour)&&!backtrace.hasOwnProperty(neighbour)&&onEdge.call(thisArg,currentNode,neighbour,neighbours[neighbour])&&(margin.push(neighbour),backtrace[neighbour]=currentNode,neighbour==endNode))break}currentNode=endNode;for(var path=[];backtrace.hasOwnProperty(currentNode);)path.push(currentNode),currentNode=backtrace[currentNode];var result=[];if(path.length>0)for(var index=path.length-1;index>=0;index-=1)result.push(path[index]);return result},getLevelGraph:function getLevelGraph(thisArg,startNode,onEdge){var currentNode,currentLevel,neighbours,level={},margin=[];for(margin.push(startNode),level[startNode]=1;margin.length>0;){for(var newMargin=[],index=0,len=margin.length;index<len;index+=1)for(var neighbour in currentLevel=level[currentNode=margin[index]],neighbours=_edges[currentNode])neighbours.hasOwnProperty(neighbour)&&(level.hasOwnProperty(neighbour)||onEdge.call(thisArg,currentNode,neighbour,neighbours[neighbour])&&(newMargin.push(neighbour),level[neighbour]=currentLevel+1));margin=newMargin}var levelGraph=Graph();for(currentNode in _edges)if(level.hasOwnProperty(currentNode))for(neighbour in currentLevel=level[currentNode],neighbours=_edges[currentNode]){if(level.hasOwnProperty(neighbour))currentLevel+1==level[neighbour]&&levelGraph.addEdge(currentNode,neighbour,neighbours[neighbour])}return levelGraph},dfsLoop:function dfsLoop(thisArg,startNode,onEdge,onNode){var currentNode,margin=[],visited={};for(margin.push(startNode),visited[startNode]=!0;margin.length>0;){currentNode=margin[margin.length-1],margin.length-=1;var neighbours=_edges[currentNode];for(var neighbour in neighbours)if(neighbours.hasOwnProperty(neighbour)&&!visited.hasOwnProperty(neighbour)&&onEdge.call(thisArg,currentNode,neighbour,neighbours[neighbour])&&(margin.push(neighbour),visited[neighbour]=!0,onNode.call(thisArg,neighbour)))return}}}}function FamilyNode(id,node){this.id=id,this.node=node}function Family(source){var _roots={},_rootsCount={},_children={},_childrenCount={},_parents={},_parentsCount={},_nodes={},BREAK=1,SKIP=2;function _loop(thisArg,collection,itemid,onItem){var item,items;if(null!=onItem&&null!=(items=collection[itemid]))for(item in items)if(items.hasOwnProperty(item)&&onItem.call(thisArg,item,items[item]))break}function _removeChildReference(parentid,childid){var result=!1;return null!=_children[parentid]&&null!=_children[parentid][childid]&&(delete _children[parentid][childid],_childrenCount[parentid]-=1,delete _parents[childid][parentid],_parentsCount[childid]-=1,_childrenCount[parentid]||(delete _children[parentid],delete _childrenCount[parentid]),_parents[childid]||(delete _parents[childid],delete _parentsCount[childid],null==_roots.null&&(_roots.null={},_rootsCount.null=0),_roots.null[childid]=!0,_rootsCount.null+=1),result=!0),result}function loop(thisArg,onItem){var item;if(null!=onItem)for(item in _nodes)if(_nodes.hasOwnProperty(item)&&onItem.call(thisArg,item,_nodes[item]))break}function _loopItems(thisArg,collection,items,onItem){for(var newItems,itemid,processed={},levelIndex=0,hasItems=!0;hasItems;){for(itemid in newItems={},hasItems=!1,items)if(items.hasOwnProperty(itemid)&&!processed[itemid])switch(processed[itemid]=!0,onItem.call(thisArg,itemid,_nodes[itemid],levelIndex)){case 1:newItems={},hasItems=!1;break;case 2:break;default:_loop(this,collection,itemid,(function(newItemId){processed[newItemId]||(newItems[newItemId]=!0,hasItems=!0)}))}items=newItems,levelIndex+=1}}function loopChildren(thisArg,nodeid,onItem){null!=onItem&&null!=nodeid&&null!=_nodes[nodeid]&&null!=_children[nodeid]&&_loopItems(thisArg,_children,_children[nodeid],onItem)}function loopParents(thisArg,nodeid,onItem){null!=onItem&&null!=nodeid&&null!=_nodes[nodeid]&&null!=_parents[nodeid]&&_loopItems(thisArg,_parents,_parents[nodeid],onItem)}function _loopTopo(thisArg,backwardCol,backwardCount,forwardCol,forwardCount,onItem){var index,len,nodeid,references,queue,newQueue,position;if(null!=onItem){for(nodeid in queue=[],references={},_nodes)_nodes.hasOwnProperty(nodeid)&&(references[nodeid]=backwardCount[nodeid]||0,references[nodeid]||queue.push(nodeid));for(position=0;queue.length>0;){for(newQueue=[],index=0,len=queue.length;index<len;index+=1){if(nodeid=queue[index],onItem.call(thisArg,nodeid,_nodes[nodeid],position)){newQueue=[];break}position+=1,_loop(this,forwardCol,nodeid,(function(itemid){references[itemid]-=1,0===references[itemid]&&newQueue.push(itemid)}))}queue=newQueue}}}function loopTopo(thisArg,onItem){_loopTopo(thisArg,0,_parentsCount,_children,0,onItem)}function loopTopoReversed(thisArg,onItem){_loopTopo(thisArg,0,_childrenCount,_parents,0,onItem)}function _bundleNodes(fromItem,items,bundleItemId,bundleItem,backwardCol,backwardCount,forwardCol,forwardCount,checkChildren){var index,len,child,isValid=!1;if(null!=_nodes[fromItem]&&null!=forwardCol[fromItem]){if(isValid=!0,checkChildren)for(index=0,len=items.length;index<len;index+=1)child=items[index],null!=_nodes[child]&&null!=forwardCol[fromItem][child]||(isValid=!1);if(isValid&&(null!=bundleItem&&(_nodes[bundleItemId]=bundleItem),null!=_nodes[bundleItemId]))for(backwardCol[bundleItemId]||(backwardCol[bundleItemId]={},backwardCount[bundleItemId]=0),forwardCol[bundleItemId]||(forwardCol[bundleItemId]={},forwardCount[bundleItemId]=0),backwardCol[bundleItemId][fromItem]||(backwardCol[bundleItemId][fromItem]=!0,backwardCount[bundleItemId]+=1),forwardCol[fromItem][bundleItemId]||(forwardCol[fromItem][bundleItemId]=!0,forwardCount[fromItem]+=1),index=0,len=items.length;index<len;index+=1)bundleItemId!=(child=items[index])&&(null!=forwardCol[fromItem][child]&&(delete forwardCol[fromItem][child],forwardCount[fromItem]-=1),null!=backwardCol[child][fromItem]&&(delete backwardCol[child][fromItem],backwardCount[child]-=1),backwardCol[child][bundleItemId]||(backwardCol[child][bundleItemId]=!0,backwardCount[child]+=1),forwardCol[bundleItemId][child]||(forwardCol[bundleItemId][child]=!0,forwardCount[bundleItemId]+=1))}return isValid}function bundleChildren(parent,children,bundleItemId,bundleItem){return _bundleNodes(parent,children,bundleItemId,bundleItem,_parents,_parentsCount,_children,_childrenCount,!0)}function ReferenceItem(){this.id="",this.key="",this.children=[],this.childrenHash={},this.processed=!1}function ReferencesEdge(arg0){this.items=[],this.weight=0,this.difference=0,arguments.length>0&&(this.difference=arg0)}function _getReferencesGraph(currentItems){var item,parents,index1,index2,len,from,to,difference,result=Graph(),processed={};for(item in currentItems)currentItems.hasOwnProperty(item)&&_loop(this,_children,item,(function(child){if(!processed.hasOwnProperty(child))for(processed[child]=!0,parents=[],_loop(this,_parents,child,(function(parent){parents.push(parent)})),index1=0,len=parents.length;index1<len-1;index1+=1)if(from=parents[index1],currentItems.hasOwnProperty(from))for(index2=index1+1;index2<len;index2+=1)if(to=parents[index2],currentItems.hasOwnProperty(to)){difference=Math.abs(currentItems[from].children.length-currentItems[to].children.length);var edge=result.edge(from,to);null==edge&&(edge=new ReferencesEdge(difference),result.addEdge(from,to,edge)),edge.items.push(child),edge.weight+=1}}));return result}function FamilyEdge(parentid,childid){this.parentid=parentid,this.childid=childid,this.key=parentid+","+childid}function Link(from,to,distance){this.from=from,this.to=to,this.distance=0}function countChildren(parent){return _childrenCount[parent]||0}function countParents(child){return _parentsCount[child]||0}function firstChild(parent){var result=null,children=_children[parent]||{};for(result in children)if(children.hasOwnProperty(result))return result;return null}function firstParent(child){var result=null,parents=_parents[child]||{};for(result in parents)if(parents.hasOwnProperty(result))return result;return null}function GroupBy(parents,children){this.parents=parents,this.children=children,this.nodes=[]}function loopChainParents(thisArg,nodeid,onItem){for(;1===_parentsCount[nodeid];){var parentId=firstParent(nodeid);if(1!==_childrenCount[parentId])break;onItem.call(thisArg,parentId),nodeid=parentId}}function loopChainChildren(thisArg,nodeid,onItem){for(;1===_childrenCount[nodeid];){var childId=firstChild(nodeid);if(1!==_parentsCount[childId])break;onItem.call(thisArg,childId),nodeid=childId}}function clone(){return Family({roots:_roots,rootsCount:_rootsCount,children:_children,childrenCount:_childrenCount,parents:_parents,parentsCount:_parentsCount,nodes:_nodes})}return function _init(source){isObject(source)&&(_roots=cloneObject(source.roots,!1),_rootsCount=cloneObject(source.rootsCount,!0),_children=cloneObject(source.children,!1),_childrenCount=cloneObject(source.childrenCount,!0),_parents=cloneObject(source.parents,!1),_parentsCount=cloneObject(source.parentsCount,!0),_nodes=cloneObject(source.nodes,!0))}(source),{add:function add(parents,nodeid,node){var index,len,parentid,processed={};if(parents&&0!==parents.length||(parents=[null]),null==_nodes[nodeid]&&null!=node){for(_nodes[nodeid]=node,index=0,len=parents.length;index<len;index+=1)null==processed[parentid=parents[index]]&&parentid!=nodeid&&(processed[parentid]=!0,null!=_nodes[parentid]?(null==_parents[nodeid]&&(_parents[nodeid]={},_parentsCount[nodeid]=0),_parents[nodeid][parentid]||(_parents[nodeid][parentid]=!0,_parentsCount[nodeid]+=1),null==_children[parentid]&&(_children[parentid]={},_childrenCount[parentid]=0),_children[parentid][nodeid]||(_children[parentid][nodeid]=!0,_childrenCount[parentid]+=1)):(null==_roots[parentid]&&(_roots[parentid]={},_rootsCount[parentid]=0),_roots[parentid][nodeid]||(_roots[parentid][nodeid]=!0,_rootsCount[parentid]+=1)));null!=_roots[nodeid]&&(_children[nodeid]=_roots[nodeid],_childrenCount[nodeid]=_rootsCount[nodeid],delete _roots[nodeid],delete _rootsCount[nodeid],_loop(this,_children,nodeid,(function(itemid){null==_parents[itemid]&&(_parents[itemid]={},_parentsCount[itemid]=0),_parents[itemid][nodeid]||(_parents[itemid][nodeid]=!0,_parentsCount[itemid]+=1)})))}},adopt:function adopt(parents,nodeid){var index,len,parentid;if(null==_nodes[nodeid])throw"Child should be in hierarchy!";for(index=0,len=parents.length;index<len;index+=1){if(parentid=parents[index],null==_parents[nodeid]&&(_parents[nodeid]={},_parentsCount[nodeid]=0),parentid==nodeid||null==_nodes[parentid])throw"Item cannot be parent of itself and parent should exist in the structure!";_parents[nodeid][parentid]||(_parents[nodeid][parentid]=!0,_parentsCount[nodeid]+=1),null==_children[parentid]&&(_children[parentid]={},_childrenCount[parentid]=0),_children[parentid][nodeid]||(_children[parentid][nodeid]=!0,_childrenCount[parentid]+=1)}},bundleChildren:bundleChildren,bundleParents:function bundleParents(child,parents,bundleItemId,bundleItem){return _bundleNodes(child,parents,bundleItemId,bundleItem,_children,_childrenCount,_parents,_parentsCount,!0)},optimizeReferences:function optimizeReferences(onNewBundleItem){var nodeid,newReferenceItem,nextItems,graph,maximumTree,processed,sharedItemsByKey={},sharedItemsById={},currentItems={},counter=0,power=10;if(null!=onNewBundleItem){for(nodeid in _nodes)counter+=1,_nodes.hasOwnProperty(nodeid)&&(newReferenceItem=new ReferenceItem,_loop(this,_children,nodeid,(function(child){newReferenceItem.children.push(child),newReferenceItem.childrenHash[child]=!0})),newReferenceItem.children.sort(),newReferenceItem.id=nodeid,newReferenceItem.key=newReferenceItem.children.join(","),currentItems[newReferenceItem.id]=newReferenceItem);for(power=Math.pow(10,counter.toString().length);!isEmptyObject(currentItems);){for(nodeid in nextItems={},processed={},graph=_getReferencesGraph(currentItems),currentItems)currentItems.hasOwnProperty(nodeid)&&(currentItems[nodeid].processed||(maximumTree=graph.getSpanningTree(nodeid,(function(edge){return edge.weight*power+power-edge.difference}))).loopLevels(this,(function(treeKey,treeKeyNode,levelid){currentItems[treeKey].processed=!0,maximumTree.loopChildren(this,treeKey,(function(child,childNode){var newItem,key,index,len,childrenToBind,isSharedItem,relationItem,relation=graph.edge(treeKey,child),nextBundleItem=null;if(currentItems[child].processed=!0,relation.weight>1){if(relation.items.sort(),key=relation.items.join(","),sharedItemsByKey.hasOwnProperty(key))nextBundleItem=sharedItemsByKey[key];else{for(newItem=onNewBundleItem(),_nodes[newItem.id]=newItem,(nextBundleItem=new ReferenceItem).id=newItem.id,nextBundleItem.key=key,index=0,len=relation.items.length;index<len;index+=1)relationItem=relation.items[index],nextBundleItem.children.push(relationItem),nextBundleItem.childrenHash[relationItem]=!0,processed[relationItem]=!0;nextBundleItem.children.sort(),sharedItemsByKey[nextBundleItem.key]=nextBundleItem,sharedItemsById[nextBundleItem.id]=nextBundleItem,nextItems[nextBundleItem.id]=nextBundleItem,processed[nextBundleItem.id]=nextBundleItem,childrenToBind=nextBundleItem.children.slice(0),loopChildren(this,treeKeyNode.replacementItem||treeKey,(function(childid,child,level){return nextBundleItem.childrenHash[childid]||null==sharedItemsById[childid]||(isSharedItem=!0,loopChildren(this,childid,(function(childid,child,level){return nextBundleItem.childrenHash[childid]?processed.hasOwnProperty(childid)?void 0:SKIP:(isSharedItem=!1,1)})),isSharedItem&&childrenToBind.push(childid)),2})),_bundleNodes(treeKeyNode.replacementItem||treeKey,childrenToBind,nextBundleItem.id,newItem,_parents,_parentsCount,_children,_childrenCount,!1),(_childrenCount[treeKey]||0)<=1&&null==treeKeyNode.replacementItem&&(treeKeyNode.replacementItem=nextBundleItem.id)}nextBundleItem.id!=child&&(childrenToBind=nextBundleItem.children.slice(0),loopChildren(this,childNode.replacementItem||child,(function(childid,child,level){return null==sharedItemsById[childid]||nextBundleItem.childrenHash[childid]||(isSharedItem=!0,loopChildren(this,childid,(function(childid,child,level){return nextBundleItem.childrenHash[childid]?processed.hasOwnProperty(childid)?SKIP:2:(isSharedItem=!1,1)})),isSharedItem&&childrenToBind.push(childid)),2})),_bundleNodes(childNode.replacementItem||child,childrenToBind,nextBundleItem.id,null,_parents,_parentsCount,_children,_childrenCount,!1),(_childrenCount[child]||0)<=1&&null==childNode.replacementItem&&(childNode.replacementItem=nextBundleItem.id))}}))})));currentItems=nextItems}}},eliminateManyToMany:function eliminateManyToMany(onNewBundleItem){var parent,bundleNode;for(parent in _children)_children.hasOwnProperty(parent)&&(_childrenCount[parent]||0)>1&&_loop(this,_children,parent,(function(child){(_parentsCount[child]||0)>1&&(bundleNode=onNewBundleItem(),bundleChildren(parent,[child],bundleNode.id,bundleNode))}))},groupBy:function groupBy(thisArg,size,onGroup,onGroupId){if(null!=onGroup){var groups={},processed={};for(var nodeid in _nodes)if(!processed.hasOwnProperty(nodeid)&&(processed[nodeid]=!0,(_parentsCount[nodeid]||0)<=1&&(_childrenCount[nodeid]||0)<=1)){var nodes=[new FamilyNode(nodeid,_nodes[nodeid])];loopChainParents(this,nodeid,(parentId=>{processed[parentId]=!0,nodes.unshift({id:parentId,node:_nodes[parentId]})})),loopChainChildren(this,nodeid,(childId=>{processed[childId]=!0,nodes.push(new FamilyNode(childId,_nodes[childId]))}));var groupId=null;if(null!=onGroupId&&(groupId=onGroupId.call(thisArg,nodes)),-1!==groupId){var parents=[];loopParents(this,nodes[0].id,(function(parentId,parent,levelIndex){if(0!=levelIndex)return BREAK;parents.push(parentId)})),parents.sort();var children=[];loopChildren(this,nodes[nodes.length-1].id,(function(childId,child,levelIndex){if(0!=levelIndex)return BREAK;children.push(childId)})),children.sort();var key=parents.join(",")+" * "+children.join(",");null!==groupId&&(key+=" * "+groupId),groups.hasOwnProperty(key)||(groups[key]=new GroupBy(parents,children)),groups[key].nodes.push(nodes)}}for(key in groups)if(groups.hasOwnProperty(key)){var group=groups[key];if(group.nodes.length>=size&&onGroup.call(thisArg,group.parents,group.children,group.nodes))break}}},getPlanarFamily:function getPlanarFamily(treeLevels){var familyEdgeIndex,familyEdgeLen,result=new Family;return treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var sequence=new LinkedHashItems,crossings={},familyEdges={},firstBucket=[];treeLevels.loopLevelItems(this,levelIndex,(function(parentid,parentItem,position){if(loopChildren(this,parentid,(function(childid,childItem){var childPosition=treeLevels.getItemPosition(childid),familyEdge=new FamilyEdge(parentid,childid);familyEdges[familyEdge.key]=familyEdge;var crossEdges=[];sequence.isEmpty()?sequence.add(childPosition,[familyEdge]):(sequence.iterateBack((function(sequenceItem,itemPosition){if(itemPosition<childPosition)return sequence.insertAfter(itemPosition,childPosition,[familyEdge]),!0;if(itemPosition==childPosition)return sequenceItem.push(familyEdge),!0;for(var crossEdgesIndex=0,crossEdgesLen=sequenceItem.length;crossEdgesIndex<crossEdgesLen;crossEdgesIndex+=1){var crossEdge=sequenceItem[crossEdgesIndex];crossEdge.parentid!=parentid&&crossEdges.push(crossEdge)}})),sequence.startKey()>childPosition&&sequence.unshift(childPosition,[familyEdge])),crossings[familyEdge.key]=crossEdges;for(var crossEdgesIndex=0,crossEdgesLen=crossEdges.length;crossEdgesIndex<crossEdgesLen;crossEdgesIndex+=1)crossings[crossEdges[crossEdgesIndex].key].push(familyEdge);return SKIP})),1==countChildren(parentid)){var childid=firstChild(parentid);if(1==countParents(childid)){var familyEdge=new FamilyEdge(parentid,childid);firstBucket.push(familyEdge.key)}}}));var crossEdges,buckets=[];for(var familyEdgeKey in crossings){var len=(crossEdges=crossings[familyEdgeKey]).length;null!=buckets[len]?buckets[len].push(familyEdgeKey):buckets[len]=[familyEdgeKey]}var processed={};buckets.unshift(firstBucket);for(var bucketIndex=0,bucketsLen=buckets.length;bucketIndex<bucketsLen;bucketIndex+=1){var bucket=buckets[bucketIndex];if(null!=bucket)for(familyEdgeIndex=0,familyEdgeLen=bucket.length;familyEdgeIndex<familyEdgeLen;familyEdgeIndex+=1)if(familyEdgeKey=bucket[familyEdgeIndex],!processed.hasOwnProperty(familyEdgeKey)){processed[familyEdgeKey]=!0;var familyEdge=familyEdges[familyEdgeKey];null==result.node(familyEdge.parentid)&&result.add(null,familyEdge.parentid,{}),null==result.node(familyEdge.childid)?result.add([familyEdge.parentid],familyEdge.childid,{}):result.adopt([familyEdge.parentid],familyEdge.childid);for(var crossEdgesIndex=0,crossEdgesLen=(crossEdges=crossings[familyEdgeKey]).length;crossEdgesIndex<crossEdgesLen;crossEdgesIndex+=1)processed[crossEdges[crossEdgesIndex].key]=!0}}})),result},getFamilyWithoutGrandParentsRelations:function getFamilyWithoutGrandParentsRelations(){var result=new Family,hash={},links=[],level=0;for(var from in _parents)_parents.hasOwnProperty(from)&&_loop(this,_parents,from,(function(to){var fromHash=hash[from];if(null==fromHash&&(fromHash={},hash[from]=fromHash),!fromHash.hasOwnProperty(to)){var link=new Link(from,to,level);links.push(link),hash[from][to]=link}}));for(;links.length>0;){var newLinks=[];level+=1;for(var index=0,len=links.length;index<len;index+=1){var link=links[index];from=link.to,_parents.hasOwnProperty(from)&&_loop(this,_parents,from,(function(to){var fromHash=hash[link.from];if(null==fromHash&&(fromHash={},hash[link.from]=fromHash),fromHash.hasOwnProperty(to))fromHash[to].distance=level;else{var newLink=new Link(from,to,level);newLinks.push(newLink),fromHash[to]=newLink}}))}links=newLinks}return loop(this,(function(nodeid,node){var parents=[];_loop(this,_parents,nodeid,(function(to){0===hash[nodeid][to].distance&&parents.push(to)})),result.add(parents,nodeid,node)})),result},getGraph:function getGraph(thisArg,onEdge){var from,result=Graph();for(from in _children)_children.hasOwnProperty(from)&&_loop(this,_children,from,(function(to){var edge=result.edge(from,to);null==edge&&(edge=null==onEdge?new ReferencesEdge({}):onEdge.call(thisArg,from,to),result.addEdge(from,to,edge))}));return result},removeNode:function removeNode(nodeid){null!=_nodes[nodeid]&&(_loop(this,_children,nodeid,(function(itemid){delete _parents[itemid][nodeid],_parentsCount[itemid]-=1,_parentsCount[itemid]||(delete _parents[itemid],delete _parentsCount[itemid],null==_roots.null&&(_roots.null={},_rootsCount.null=0),_roots.null[itemid]||(_roots.null[itemid]=!0,_rootsCount.null+=1))})),_loop(this,_parents,nodeid,(function(itemid){delete _children[itemid][nodeid],_childrenCount[itemid]-=1,_childrenCount[itemid]||(delete _children[itemid],delete _childrenCount[itemid])})),null!=_roots.null&&null!=_roots.null[nodeid]&&(delete _roots.null[nodeid],_rootsCount.null-=1,_rootsCount.null||(delete _roots.null,delete _rootsCount.null)),delete _children[nodeid],delete _childrenCount[nodeid],delete _parents[nodeid],delete _parentsCount[nodeid],delete _nodes[nodeid])},removeRelation:function removeRelation(fromid,toid){var result=!1;return null!=_nodes[fromid]&&null!=_nodes[toid]&&(result=_removeChildReference(fromid,toid)||_removeChildReference(toid,fromid)),result},removeChildRelation:function removeChildRelation(parentid,childid){var result=!1;return null!=_nodes[parentid]&&null!=_nodes[childid]&&(result=_removeChildReference(parentid,childid)),result},node:function node(nodeid){return _nodes[nodeid]},loop:loop,loopLevels:function loopLevels(thisArg,parentAligned,onItem){var levelIndex,hasGroups,newGroups,groupIndex,group,itemsAtLevel,itemid,index,len,mIndex,mLen,mItem,mLevel,topoSortedItem,bestPosition,bestItem,bestLevel,bestIsParent,newMargin,hasNeighbours,topoSorted=[],topoSortedPositions={},processed={},margin=[],levels={},groups={},minimumLevel=null,loopFunc=parentAligned?loopTopo:loopTopoReversed;function Group(){this.items={},this.minimumLevel=null}function addItemToLevel(itemid,index,level){var group=groups[index];group||(group=new Group,groups[index]=group),group.addItemToLevel(itemid,level),minimumLevel=null==minimumLevel?level:Math.min(minimumLevel,level),levels[itemid]=level,processed[itemid]=!0}if(Group.prototype.addItemToLevel=function(itemid,level){var items=this.items[level];items?items.push(itemid):(items=[itemid],this.items[level]=items),this.minimumLevel=null==this.minimumLevel?level:Math.min(this.minimumLevel,level)},null!=onItem){for(loopFunc(this,(function(itemid,item,position){topoSorted.push(itemid),topoSortedPositions[itemid]=position})),index=0,len=topoSorted.length;index<len;index+=1)if(topoSortedItem=topoSorted[index],null==processed[topoSortedItem])for(margin.push(topoSortedItem),addItemToLevel(topoSortedItem,index,0);margin.length>0;){for(bestPosition=null,bestItem=null,bestLevel=null,bestIsParent=!parentAligned,newMargin=[],mIndex=0,mLen=margin.length;mIndex<mLen;mIndex+=1)mItem=margin[mIndex],mLevel=levels[mItem],hasNeighbours=!1,parentAligned?(_loop(this,_parents,mItem,(function(parentid){var topoSortedPosition;processed[parentid]||(hasNeighbours=!0,topoSortedPosition=topoSortedPositions[parentid],(null==bestPosition||!bestIsParent||bestPosition<topoSortedPosition||bestPosition==topoSortedPosition&&bestLevel>mLevel-1)&&(bestPosition=topoSortedPosition,bestItem=parentid,bestLevel=mLevel-1,bestIsParent=!0))})),_loop(this,_children,mItem,(function(childid){var topoSortedPosition;processed[childid]||(hasNeighbours=!0,topoSortedPosition=topoSortedPositions[childid],(null==bestPosition||!bestIsParent&&(bestPosition>topoSortedPosition||bestPosition==topoSortedPosition&&bestLevel<mLevel+1))&&(bestPosition=topoSortedPosition,bestItem=childid,bestLevel=mLevel+1,bestIsParent=!1))}))):(_loop(this,_children,mItem,(function(childid){var topoSortedPosition;processed[childid]||(hasNeighbours=!0,topoSortedPosition=topoSortedPositions[childid],(null==bestPosition||bestIsParent||bestPosition<topoSortedPosition||bestPosition==topoSortedPosition&&bestLevel<mLevel+1)&&(bestPosition=topoSortedPosition,bestItem=childid,bestLevel=mLevel+1,bestIsParent=!1))})),_loop(this,_parents,mItem,(function(parentid){var topoSortedPosition;processed[parentid]||(hasNeighbours=!0,topoSortedPosition=topoSortedPositions[parentid],(null==bestPosition||bestIsParent&&(bestPosition>topoSortedPosition||bestPosition==topoSortedPosition&&bestLevel>mLevel-1))&&(bestPosition=topoSortedPosition,bestItem=parentid,bestLevel=mLevel-1,bestIsParent=!0))}))),hasNeighbours&&newMargin.push(mItem);null!=bestItem&&(newMargin.push(bestItem),addItemToLevel(bestItem,index,bestLevel)),margin=newMargin}for(hasGroups=!0,levelIndex=minimumLevel;hasGroups;){for(groupIndex in newGroups={},hasGroups=!1,groups)if(groups.hasOwnProperty(groupIndex)&&null!=(itemsAtLevel=(group=groups[groupIndex]).items[group.minimumLevel-minimumLevel+levelIndex]))for(newGroups[groupIndex]=group,hasGroups=!0,index=0,len=itemsAtLevel.length;index<len;index+=1)if(itemid=itemsAtLevel[index],onItem.call(thisArg,itemid,_nodes[itemid],levelIndex-minimumLevel))return hasGroups=!1,!0;groups=newGroups,levelIndex+=1}}},loopTopo:loopTopo,loopTopoReversed:loopTopoReversed,loopChildren:loopChildren,loopParents:loopParents,findLargestRoot:function findLargestRoot(){var maximum,isRoot,result=null,famMembers={},famCount={};return maximum=null,loopTopoReversed(this,(function(famItemId,famItem,position){famMembers.hasOwnProperty(famItemId)||(famMembers[famItemId]={},famCount[famItemId]=0),famMembers[famItemId][famItemId]=!0,famCount[famItemId]+=1,isRoot=!0,loopParents(this,famItem.id,(function(parentid,parent,levelIndex){var items,itemid;if(isRoot=!1,famMembers.hasOwnProperty(parentid)||(famMembers[parentid]={},famCount[parentid]=0),famCount[parentid]||1!=_parentsCount[famItemId])for(itemid in items=famMembers[famItemId])items.hasOwnProperty(itemid)&&(famMembers[parentid][itemid]=!0,famCount[parentid]+=1);else famMembers[parentid]=famMembers[famItemId],famCount[parentid]=famCount[famItemId];return SKIP})),isRoot&&(!maximum||famCount[famItemId]>maximum)&&(maximum=famCount[famItemId],result=famItemId)})),result},loopRoots:function loopRoots(thisArg,onItem){var minimum,isRoot,famItemId,member,members,rootid,membersRoots,memberRoots,memberRoot,index,len,result=null,counter=0,famMembers={},famCount={},roots={},processed={};for(rootid in loopTopoReversed(this,(function(famItemId,famItem,position){famMembers.hasOwnProperty(famItemId)||(famMembers[famItemId]={},famCount[famItemId]=0),famMembers[famItemId][famItemId]=!0,famCount[famItemId]+=1,isRoot=!0,loopParents(this,famItem.id,(function(parentid,parent,levelIndex){var items,itemid;if(isRoot=!1,famMembers.hasOwnProperty(parentid)||(famMembers[parentid]={},famCount[parentid]=0),famCount[parentid]||1!=_parentsCount[famItemId])for(itemid in items=famMembers[famItemId])items.hasOwnProperty(itemid)&&(famMembers[parentid][itemid]||(famMembers[parentid][itemid]=!0,famCount[parentid]+=1));else famMembers[parentid]=famMembers[famItemId],famCount[parentid]=famCount[famItemId];return SKIP})),isRoot&&(roots[famItemId]=!0,counter+=1)})),membersRoots={},roots)if(roots.hasOwnProperty(rootid))for(member in members=famMembers[rootid])members.hasOwnProperty(member)&&(membersRoots[member]||(membersRoots[member]=[]),membersRoots[member].push(rootid.toString()));for(;counter>0;){for(famItemId in minimum=null,roots)roots.hasOwnProperty(famItemId)&&(!minimum||famCount[famItemId]<minimum)&&(minimum=famCount[famItemId],result=famItemId);if(null!=result){for(member in null!=onItem&&onItem.call(thisArg,result,_nodes[result]),members=famMembers[result])if(members.hasOwnProperty(member)&&!processed[member]){for(index=0,len=(memberRoots=membersRoots[member]).length;index<len;index+=1)memberRoot=memberRoots[index],famCount[memberRoot]-=1;processed[member]=!0}delete roots[result],counter-=1}}},hasNodes:function hasNodes(){return!isEmptyObject(_nodes)},hasCommonChild:function hasCommonChild(parents){var parentsHash,childrenHash,parentsCount,pIndex,pLen,parent,child,result=!1;for(parentsHash={},parentsCount=0,pIndex=0,pLen=parents.length;pIndex<pLen;pIndex+=1)parent=parents[pIndex],null==_nodes[parent]||parentsHash[parent]||(parentsHash[parent]=!0,parentsCount+=1);for(parent in childrenHash={},parentsHash)parentsHash.hasOwnProperty(parent)&&_loop(this,_children,parent,(function(child){childrenHash[child]?childrenHash[child]+=1:childrenHash[child]=1}));for(child in childrenHash)if(childrenHash.hasOwnProperty(child)&&null!=_parents[child]&&(_parentsCount[child]||0)==childrenHash[child]&&childrenHash[child]==parentsCount){result=!0;break}return result},loopNeighbours:function loopNeighbours(thisArg,itemid,onItem){var processed={};null!=onItem&&(loopChildren(this,itemid,(function(childid,child,childLevel){return processed.hasOwnProperty(childid)||(processed[childid]=null,onItem.call(thisArg,childid,child,1)&&(processed[childid]=SKIP),loopParents(this,childid,(function(parentid,parent,parentLevel){return processed.hasOwnProperty(parentid)||(processed[parentid]=null,onItem.call(thisArg,parentid,parent,2)&&(processed[parentid]=SKIP)),processed[parentid]}))),processed[childid]})),loopParents(this,itemid,(function(parentid,parent,parentLevel){return processed.hasOwnProperty(parentid)||(processed[parentid]=null,onItem.call(thisArg,parentid,parent,1)&&(processed[parentid]=SKIP),loopChildren(this,parentid,(function(childid,child,childLevel){return processed.hasOwnProperty(childid)||(processed[childid]=!0,onItem.call(thisArg,childid,child,2)&&(processed[childid]=SKIP)),processed[childid]}))),processed[parentid]})))},countChildren:countChildren,countParents:countParents,firstParent:firstParent,firstChild:firstChild,validate:function validate(info){var parent,child;function _count(items){var key,result=0;if(null!=items)for(key in items)items.hasOwnProperty(key)&&(result+=1);return result}for(parent in loop(this,(function(nodeId,node){_loop(this,_children,nodeId,(function(child){if(!_parents.hasOwnProperty(child)||!_parents[child].hasOwnProperty(nodeId))return null!=info&&(info.message="Child #"+child+" does not reference parent #"+nodeId),!1})),_loop(this,_parents,nodeId,(function(parent){if(!_children.hasOwnProperty(parent)||!_children[parent].hasOwnProperty(nodeId))return null!=info&&(info.message="Parent #"+parent+" does not reference child #"+nodeId),!1}))})),_parents)if(_parents.hasOwnProperty(parent)){if((_parentsCount[parent]||0)!=_count(_parents[parent]))return null!=info&&(info.message="Parents count for item #"+parent+" missmatch."),!1;if(_parents.hasOwnProperty(parent)&&!_nodes.hasOwnProperty(parent))return null!=info&&(info.message="Orphant parents for item #"+parent),!1}for(child in _children)if(_children.hasOwnProperty(child)){if((_childrenCount[child]||0)!=_count(_children[child]))return null!=info&&(info.message="Children count for item "+child+" missmatch."),!1;if(_children.hasOwnProperty(child)&&!_nodes.hasOwnProperty(child))return null!=info&&(info.message="Orphant children of item "+child),!1}for(child in _roots)if(_roots.hasOwnProperty(child)){if((_rootsCount[child]||0)!=_count(_roots[child]))return null!=info&&(info.message="Root children count for item @"+child+" missmatch."),!1;_loop(this,_roots,child,(function(nodeid){if(!_nodes.hasOwnProperty(nodeid))return null!=info&&(info.message="Child #"+nodeid+"of root #"+child+" does not exists."),!1}))}return!0},hasLoops:function hasLoops(){var tempFamily=clone();return loopTopo(this,(function(itemid,item,levelIndex){tempFamily.removeNode(itemid)})),tempFamily.hasNodes()},clone:clone,BREAK:BREAK,SKIP:SKIP}}function FamilyMargins(){function Margin(left,right,leftIndex,rightIndex){this.left=left,this.right=right,this.leftIndex=leftIndex,this.rightIndex=rightIndex}this.items=[],this.add=function(arg0,arg1,arg2,arg3){switch(arguments.length){case 2:this.items.push(new Margin(-arg0/2,arg0/2,arg1,arg1));break;case 4:this.items.push(new Margin(arg0,arg1,arg2,arg3))}},this.merge=function(from,interval){for(var distance=this.getDistanceTo(from),leftOffset=0,rightOffset=0,len1=this.items.length,len2=from.items.length,min=Math.min(len1,len2),max=Math.max(len1,len2),index=0;index<min;index+=1){var leftMargin=this.items[len1-1-index],rightMargin=from.items[len2-1-index];if(0===index){var width=leftMargin.right-leftMargin.left+(distance||0)+(interval||0)+rightMargin.right-rightMargin.left;leftOffset=width/2+leftMargin.left,rightOffset=width/2-rightMargin.right}leftMargin.left-=leftOffset,leftMargin.right=rightMargin.right+rightOffset,leftMargin.rightIndex=rightMargin.rightIndex,this.items[max-1-index]=leftMargin}for(index=min;index<max;index+=1)leftMargin=this.items[len1-1-index],rightMargin=from.items[len2-1-index],null==leftMargin?this.items[max-1-index]=new Margin(rightMargin.left+rightOffset,rightMargin.right+rightOffset,rightMargin.leftIndex,rightMargin.rightIndex):(leftMargin.left-=leftOffset,leftMargin.right-=leftOffset);return distance},this.attach=function(from,interval){for(var distance=this.getDistanceTo(from),rightOffset=interval||0,len1=this.items.length,len2=from.items.length,min=Math.min(len1,len2),max=Math.max(len1,len2),index=0;index<min;index+=1){var leftMargin=this.items[len1-1-index],rightMargin=from.items[len2-1-index];0===index&&(rightOffset=leftMargin.right+(distance||0)+(interval||0)-rightMargin.left),leftMargin.right=rightMargin.right+rightOffset,leftMargin.rightIndex=rightMargin.rightIndex,this.items[max-1-index]=leftMargin}for(index=min;index<max;index+=1)null==(leftMargin=this.items[len1-1-index])&&(rightMargin=from.items[len2-1-index],this.items[max-1-index]=new Margin(rightMargin.left+rightOffset,rightMargin.right+rightOffset,rightMargin.leftIndex,rightMargin.rightIndex));return distance},this.getDistanceTo=function(to){var distance=null,baseDistance=0,len1=this.items.length,len2=to.items.length,len=Math.min(len1,len2);if(len>0){for(var index=0;index<len;index+=1){var leftMargins=this.items[len1-1-index],rightMargins=to.items[len2-1-index];0===index?distance=baseDistance=leftMargins.right-rightMargins.left:leftMargins.rightIndex<rightMargins.leftIndex&&(distance=Math.max(distance,leftMargins.right-rightMargins.left))}distance-=baseDistance}return distance},this.loop=function(thisArg,onItem){if(null!=onItem)for(var index=0,len=this.items.length;index<len;index+=1){var margin=this.items[len-1-index];if(onItem.call(thisArg,index,margin.left,margin.right,margin.leftIndex,margin.rightIndex))break}},this.getLeft=function(level){var maximum=this.items.length-1;if(maximum>=level)return this.items[maximum-level].left}}function FamilyAlignment(thisArg,family,treeLevels,onItemSize){var offsets,childrenDistances,sizes={};function _getNodeMargins(margins,nodeid){var nodeMargins=margins[nodeid];return null==nodeMargins&&(nodeMargins=new FamilyMargins,margins[nodeid]=nodeMargins),nodeMargins}function setFamilyOffsets(offsets,itemid,familyUnit,fromLevel,toLevel,itemIndex,treeLevels,childrenDistances){var fromIndex=itemIndex,toIndex=itemIndex;familyUnit.loopSiblings(this,itemid,(function(siblingid){var position=treeLevels.getItemPosition(siblingid);fromIndex=Math.min(fromIndex,position),toIndex=Math.max(toIndex,position)}));for(var index=itemIndex-1;index>=fromIndex;index-=1){var siblingid=treeLevels.getItemAtPosition(fromLevel,index);if(!offsets.hasOwnProperty(siblingid)){var nodeid=treeLevels.getItemAtPosition(fromLevel,index+1);offsets[siblingid]=offsets[nodeid]-(sizes[siblingid]/2+(childrenDistances[nodeid]||0)+sizes[nodeid]/2)}}for(index=itemIndex+1;index<=toIndex;index+=1)siblingid=treeLevels.getItemAtPosition(fromLevel,index),offsets.hasOwnProperty(siblingid)||(nodeid=treeLevels.getItemAtPosition(fromLevel,index-1),offsets[siblingid]=offsets[nodeid]+(sizes[nodeid]/2+(childrenDistances[siblingid]||0)+sizes[siblingid]/2));var siblingsMedian=offsets[siblingid=treeLevels.getItemAtPosition(fromLevel,fromIndex)]-sizes[siblingid]/2;siblingsMedian+=offsets[siblingid=treeLevels.getItemAtPosition(fromLevel,toIndex)]+sizes[siblingid]/2,siblingsMedian/=2,fromIndex=null,toIndex=null,familyUnit.loopNonSiblings(this,itemid,(function(siblingid){var position=treeLevels.getItemPosition(siblingid);fromIndex=null!=fromIndex?Math.min(fromIndex,position):position,toIndex=null!=toIndex?Math.max(toIndex,position):position}));var nonSiblingsWidth=0;for(index=fromIndex;index<=toIndex;index+=1){var relatedItemId=treeLevels.getItemAtPosition(toLevel,index);nonSiblingsWidth+=sizes[relatedItemId],index>fromIndex&&(nonSiblingsWidth+=childrenDistances[relatedItemId]||0)}var offset=siblingsMedian-nonSiblingsWidth/2;for(relatedItemId=treeLevels.getItemAtPosition(toLevel,fromIndex),offsets.hasOwnProperty(relatedItemId)||(offsets[relatedItemId]=offset+sizes[relatedItemId]/2),index=fromIndex+1;index<=toIndex;index+=1)relatedItemId=treeLevels.getItemAtPosition(toLevel,index),offsets.hasOwnProperty(relatedItemId)||(nodeid=treeLevels.getItemAtPosition(toLevel,index-1),offsets[relatedItemId]=offsets[nodeid]+(sizes[nodeid]/2+(childrenDistances[relatedItemId]||0)+sizes[relatedItemId]/2))}return null!=onItemSize&&treeLevels.loopItems(this,(function(itemid,item,position,levelIndex,level){sizes[itemid]=onItemSize.call(thisArg,itemid,item)})),childrenDistances=function getDistancesBetweenChildren(family,treeLevels){var distances={},margins={},levelMargins=null;return treeLevels.loopLevelsReversed(this,(function(levelIndex,level){var newMargins=new FamilyMargins;null!=levelMargins&&(levelMargins.add(0,Number.MAX_VALUE),newMargins.merge(levelMargins,0));var previousParentMargins=levelMargins=newMargins;treeLevels.loopLevelItems(this,levelIndex,(function(nodeid,node,position){var nodeMargins=_getNodeMargins(margins,nodeid);switch(nodeMargins.add(sizes[nodeid],position),family.countParents(nodeid)){case 0:null!=previousParentMargins&&(distances[nodeid]=previousParentMargins.attach(nodeMargins));break;case 1:family.loopParents(this,nodeid,(function(parentid,parent,levelIndex){var parentMargins=_getNodeMargins(margins,parentid);return distances[nodeid]=parentMargins.merge(nodeMargins),previousParentMargins=parentMargins,family.BREAK}));break;default:var totalSize=0,fromIndex=null,toIndex=null,hash={};family.loopParents(this,nodeid,(function(parentid,parent,levelIndex){if(levelIndex>0)return family.BREAK;totalSize+=sizes[parentid];var position=treeLevels.getItemPosition(parentid);fromIndex=null==fromIndex?position:Math.min(fromIndex,position),toIndex=null==toIndex?position:Math.max(toIndex,position),hash[position]=parentid}));for(var offset=-totalSize/2,index=fromIndex;index<=toIndex;index+=1){var parentid=hash[index];offset+=sizes[parentid]/2;var parentMargins=_getNodeMargins(margins,parentid);parentMargins.attach(nodeMargins,-offset),previousParentMargins=parentMargins,offset+=sizes[parentid]/2}}}))})),distances}(family,treeLevels),offsets=function getTreeLevelsOffsets(family,treeLevels,childrenDistances){var offsets={},familyUnitsById=getFamilyUnits(family),processedFamilyUnits={};return treeLevels.loopLevels(this,(function(levelIndex,level){treeLevels.loopLevelItems(this,levelIndex,(function(nodeid,node,position){if(!offsets.hasOwnProperty(nodeid)){var offset=0;if(0===position)null!=childrenDistances[nodeid]&&(offset+=childrenDistances[nodeid]+sizes[nodeid]/2);else{var prevNodeId=treeLevels.getItemAtPosition(levelIndex,position-1);offset+=offsets[prevNodeId]+sizes[prevNodeId]/2+(childrenDistances[nodeid]||0)+sizes[nodeid]/2}offsets[nodeid]=offset}var familyUnits=familyUnitsById[nodeid];if(null!=familyUnits)for(var index=0;index<familyUnits.length;index+=1){var familyUnit=familyUnits[index];processedFamilyUnits.hasOwnProperty(familyUnit.id)||(processedFamilyUnits[familyUnit.id]=!0,setFamilyOffsets(offsets,nodeid,familyUnit,levelIndex,levelIndex+1,position,treeLevels,childrenDistances))}}))})),offsets}(family,treeLevels,childrenDistances),{getOffset:function getOffset(nodeid){return offsets[nodeid]}}}function RMQ(items){var _lookup=[],_log2=Math.log(2);function getRangeMinimumIndex(from,to){var power=Math.floor(Math.log(to-from+1)/_log2);return items[_lookup[from][power]]<=items[_lookup[to-(1<<power)+1][power]]?_lookup[from][power]:_lookup[to-(1<<power)+1][power]}return function preprocess(){for(var power,index=0,len=items.length;index<len;index+=1)_lookup[index]=[index];for(power=1,len=items.length;1<<power<len;power+=1)for(index=0;index+(1<<power)-1<len;index+=1)items[_lookup[index][power-1]]<items[_lookup[index+(1<<power-1)][power-1]]?_lookup[index][power]=_lookup[index][power-1]:_lookup[index][power]=_lookup[index+(1<<power-1)][power-1]}(),{getRangeMinimumIndex:getRangeMinimumIndex,getRangeMinimum:function getRangeMinimum(from,to){return items[getRangeMinimumIndex(from,to)]}}}function LCA(tree){var _rmq,_eulerSequence=[],_levels=[],_fai={};return function preprocess(){var counter=0;tree.loopEulerWalk(this,(function(nodeid,node,level){_eulerSequence.push(nodeid),_levels.push(level),_fai.hasOwnProperty(nodeid)||(_fai[nodeid]=counter),counter+=1})),_rmq=RMQ(_levels)}(),{getLowestCommonAncestor:function getLowestCommonAncestor(from,to){var index,fromIndex=_fai[from],toIndex=_fai[to];return index=fromIndex<toIndex?_rmq.getRangeMinimumIndex(fromIndex,toIndex):_rmq.getRangeMinimumIndex(toIndex,fromIndex),_eulerSequence[index]}}}function Pile(){var _items=[];function Segment(from,to,context,direction){this.context=context,this.from=from,this.to=to,this.offset=null,this.direction=direction}function getMax(index,items,hash,backtraceNext,backtraceTaken){if(index>=items.length)return 0;if(hash.hasOwnProperty(index))return hash[index];for(var item=items[index],withoutItem=getMax(index+1,items,hash,backtraceNext,backtraceTaken),nextIndex=index+1;nextIndex<items.length;){if(items[nextIndex].from>=item.to)break;nextIndex+=1}var withItem=1+getMax(nextIndex,items,hash,backtraceNext,backtraceTaken);return withItem>withoutItem?(hash[index]=withItem,backtraceNext[index]=nextIndex,backtraceTaken[index]=!0):(hash[index]=withoutItem,backtraceNext[index]=index+1,backtraceTaken[index]=!1),hash[index]}return{add:function add(from,to,context){from<to?_items.push(new Segment(from,to,context,1)):_items.push(new Segment(to,from,context,-1))},resolve:function resolve(thisArg,onItem){var backtraceNext,backtraceTaken,items,item,rowItems,rows,rowIndex,index,offset=0;if(null!=onItem){for((items=_items.slice(0)).sort((function(a,b){return a.from-b.from})),rows=[];items.length>0;){for(getMax(0,items,{},backtraceNext={},backtraceTaken={}),rowItems=[],rows[offset]=[],index=0;backtraceNext.hasOwnProperty(index);)backtraceTaken[index]&&(rowItems.push(index),rows[offset].push(items[index])),index=backtraceNext[index];for(index=rowItems.length-1;index>=0;index-=1)items.splice(rowItems[index],1);offset+=1}for(rowIndex=0;rowIndex<offset;rowIndex+=1)for(rowItems=rows[rowIndex],index=0;index<rowItems.length;index+=1)if(item=rowItems[index],onItem.call(thisArg,item.from,item.to,item.context,rowIndex,offset,item.direction))return offset}return offset}}}function QuadTree(minimalSize){var _minimalScale=Math.max(1,function scale(value){return Math.floor(Math.log(value)/Math.log(2))}(minimalSize)),_rootScale=8,_rootSize=256,_rootCell=null;function Cell(x,y,scale,size){this.x=x,this.y=y,this.scale=scale,this.size=size,this.quadrants=[],this.points=[]}function _splitCell(parent){var size=parent.size/2;parent.quadrants=[new Cell(parent.x,parent.y,parent.scale-1,size),new Cell(parent.x+size,parent.y,parent.scale-1,size),new Cell(parent.x,parent.y+size,parent.scale-1,size),new Cell(parent.x+size,parent.y+size,parent.scale-1,size)];for(var index=0,len=parent.points.length;index<len;index+=1){var point=parent.points[index],x=Math.floor(point.x),y=Math.floor(point.y);parent.quadrants[parent.getQuadrantIndex(x,y)].points.push(point)}parent.points=null}return _rootCell=new Cell(0,0,_rootScale,_rootSize),Cell.prototype.notEnclosed=function(rect){return this.x<rect.x||this.x+this.size>rect.x+rect.width||this.y<rect.y||this.y+this.size>rect.y+rect.height},Cell.prototype.overlaps=function(rect){return!(this.x+this.size<rect.x||rect.x+rect.width<this.x||this.y+this.size<rect.y||rect.y+rect.height<this.y)},Cell.prototype.getQuadrantIndex=function(x,y){var shift=this.scale-1;return x>>shift&1|(y>>shift&1)<<1},{addPoint:function addPoint(point){for(var x=Math.floor(point.x),y=Math.floor(point.y),size=Math.max(x,y);_rootSize<=size;){var parent=new Cell(0,0,_rootScale+=1,_rootSize*=2);_splitCell(parent),parent.quadrants[0]=_rootCell,_rootCell=parent}!function _addPoint(point){var x=Math.floor(point.x),y=Math.floor(point.y),cell=_rootCell;if(x<0||y<0)throw"Negative values are not supported in the quad tree.";for(;(null==cell.points||cell.points.length>0)&&(cell.scale!=_minimalScale||null==cell.points);)null!=cell.points&&cell.points.length>0&&_splitCell(cell),cell=cell.quadrants[cell.getQuadrantIndex(x,y)];cell.points.push(point)}(point)},loopArea:function loopArea(thisArg,rect,onItem){var cell,index,len;if(null!=onItem)for(var check=[_rootCell],nocheck=[];check.length>0||nocheck.length>0;){var newCheck=[],newNocheck=[];for(index=0,len=check.length;index<len;index+=1)if((cell=check[index]).overlaps(rect))if(cell.notEnclosed(rect))if(null==cell.points)for(var quadrantIndex=0;quadrantIndex<4;quadrantIndex+=1)newCheck.push(cell.quadrants[quadrantIndex]);else for(var pointIndex=0,pointsLen=cell.points.length;pointIndex<pointsLen;pointIndex+=1){var point=cell.points[pointIndex];if(rect.contains(point)&&onItem.call(thisArg,point))return}else nocheck.push(cell);for(index=0,len=nocheck.length;index<len;index+=1)if(null==(cell=nocheck[index]).points)for(quadrantIndex=0;quadrantIndex<4;quadrantIndex+=1)newNocheck.push(cell.quadrants[quadrantIndex]);else for(pointIndex=0,pointsLen=cell.points.length;pointIndex<pointsLen;pointIndex+=1)if(onItem.call(thisArg,cell.points[pointIndex]))return;check=newCheck,nocheck=newNocheck}},validate:function validate(){for(var level=[_rootCell];level.length>0;){for(var newLevel=[],index=0,len=level.length;index<len;index+=1){var cell=level[index],rect=new Rect(cell.x,cell.y,cell.size,cell.size);if(null!=cell.points&&cell.quadrants.length>0)return!1;if(null==cell.points)for(var quadrantIndex=0;quadrantIndex<4;quadrantIndex+=1)newLevel.push(cell.quadrants[quadrantIndex]);else for(var pointIndex=0,pointsLen=cell.points.length;pointIndex<pointsLen;pointIndex+=1){var point=cell.points[pointIndex];if(!rect.contains(point))return!1}}level=newLevel}return!0},getPositions:function getPositions(selection){for(var result=[],level=[_rootCell];level.length>0;){for(var newLevel=[],index=0,len=level.length;index<len;index+=1){var cell=level[index],rect=new Rect(cell.x,cell.y,cell.size,cell.size);rect.context={isHighlighted:!1},1,null!=selection&&selection.overlaps(rect)&&null!=cell.points&&cell.points.length>0&&(rect.context.isHighlighted=!0),result.push(rect);for(var quadrantIndex=0;quadrantIndex<4;quadrantIndex+=1){var quadrant=cell.quadrants[quadrantIndex];null!=quadrant&&newLevel.push(quadrant)}}level=newLevel}return result}}}function SpatialIndex(sizes){var _buckets=[];switch(sizes.sort((function(a,b){return a-b})),sizes.length){case 0:_buckets.push(new Bucket(0,1e6));break;case 1:var size1=sizes[0];_buckets.push(new Bucket(0,size1));break;case 2:size1=sizes[0];var size2=sizes[1];size2>2*size1?(_buckets.push(new Bucket(0,size1)),_buckets.push(new Bucket(size1,size2))):_buckets.push(new Bucket(0,size2));break;default:for(var breaks=getLiniarBreaks(sizes),minimum=0,index=0;index<breaks.length;index+=1){var maximum=sizes[breaks[index]];_buckets.push(new Bucket(minimum,maximum)),minimum=maximum}}function Bucket(minimum,maximum){this.minimum=minimum,this.maximum=maximum,this.quadTree=QuadTree(2*maximum)}return{addRect:function addRect(rect){for(var size=Math.max(rect.width,rect.height),point=rect.centerPoint(),index=0,len=_buckets.length;index<len;index+=1){var bucket=_buckets[index];if(size<=bucket.maximum||index==len-1){point.context=rect,bucket.quadTree.addPoint(point);break}}},loopArea:function loopArea(thisArg,rect,onItem){if(null!=onItem)for(var index=0,len=_buckets.length;index<len;index+=1){var bucket=_buckets[index],bucketRect=new Rect(rect);bucketRect.offset(bucket.maximum/2),bucket.quadTree.loopArea(this,bucketRect,(function(point){var pointRect=point.context;if(rect.overlaps(pointRect))return onItem.call(thisArg,pointRect)}))}},validate:function validate(){for(var result=!0,index=0,len=_buckets.length;index<len;index+=1){var bucket=_buckets[index];result=result&&bucket.quadTree.validate()}return result},getPositions:function getPositions(selection){for(var result=[],index=0,len=_buckets.length;index<len;index+=1){var bucket=_buckets[index];result=result.concat(bucket.quadTree.getPositions(selection))}return result}}}function TreeLevels(source){var _levels=[],_items={},_minimum=null,_maximum=null;function LevelContext(context){this.context=context,this.items=[]}function ItemContext(context,position,level){this.context=context,this.positions={},this.positions[level]=position,this.startLevel=level,this.endLevel=level}function createLevel(index){return null==_levels[index]&&(_levels[index]=new LevelContext(null),_minimum=null===_minimum?index:Math.min(_minimum,index),_maximum=null===_maximum?index:Math.max(_maximum,index)),_levels[index]}return function _init(source){isObject(source)&&(_levels=cloneObject(source.levels,!0),_items=cloneObject(source.items,!0),_minimum=cloneObject(source.minimum,!0),_maximum=cloneObject(source.maximum,!0))}(source),{addlevel:function addLevel(level,context){createLevel(level).context=context},hasLevel:function hasLevel(levelIndex){return null!=_levels[levelIndex]},hasItem:function hasItem(itemid){return _items.hasOwnProperty(itemid)},addItem:function addItem(levelIndex,itemid,context){var level,itemContext;_items.hasOwnProperty(itemid)?((level=createLevel(levelIndex)).items.push(itemid),(itemContext=_items[itemid]).positions[levelIndex]=level.items.length-1,itemContext.startLevel=Math.min(itemContext.startLevel,levelIndex),itemContext.endLevel=Math.max(itemContext.endLevel,levelIndex)):((level=createLevel(levelIndex)).items.push(itemid),_items[itemid]=new ItemContext(context,level.items.length-1,levelIndex))},getItemContext:function getItemContext(itemid){var result=null;return _items.hasOwnProperty(itemid)&&(result=_items[itemid].context),result},getLevelIndex:function getStartLevelIndex(itemid){return _items.hasOwnProperty(itemid)?_items[itemid].startLevel:null},getEndLevelIndex:function getEndLevelIndex(itemid){return _items.hasOwnProperty(itemid)?_items[itemid].endLevel:null},getItemPosition:function getItemPosition(itemid,level){var context=_items[itemid];return null!=context?null!=level?context.positions[level]:context.positions[context.startLevel]:null},getItemAtPosition:function getItemAtPosition(levelIndex,position){var level=_levels[levelIndex],itemid=null;return null!=level&&(itemid=level.items[position]),itemid},loopLevels:function loopLevels(thisArg,onItem){var index,level;if(null!=onItem)for(index=_minimum;index<=_maximum&&(null==(level=_levels[index])||!onItem.call(thisArg,index,level.context));index+=1);},loopLevelsReversed:function loopLevelsReversed(thisArg,onItem){var index,level;if(null!=onItem)for(index=_maximum;index>=_minimum&&(null==(level=_levels[index])||!onItem.call(thisArg,index,level.context));index-=1);},loopLevelItems:function loopLevelItems(thisArg,levelIndex,onItem){var index,len,level,itemid;if(null!=onItem&&null!=(level=_levels[levelIndex]))for(index=0,len=level.items.length;index<len&&(itemid=level.items[index],!onItem.call(thisArg,itemid,_items[itemid].context,index));index+=1);},getLevelLength:function getLevelLength(levelIndex){var result=0,level=_levels[levelIndex];return null!=level&&(result=level.items.length),result},loopItems:function loopItems(thisArg,onItem){var index,len,level,levelIndex,items,itemid,processed={};if(null!=onItem)for(levelIndex=_minimum;levelIndex<=_maximum;levelIndex+=1)if(null!=(level=_levels[levelIndex]))for(index=0,len=(items=level.items).length;index<len;index+=1)if(itemid=items[index],!processed.hasOwnProperty(itemid)&&(processed[itemid]=!0,onItem.call(thisArg,itemid,_items[itemid].context,index,levelIndex,level.context)))return},binarySearch:function binarySearch(thisArg,levelIndex,onGetDistance){var level,result=null;return null!=onGetDistance&&null!=(level=_levels[levelIndex])&&(result=binarySearch_binarySearch(level.items,(function(itemid){return onGetDistance.call(thisArg,itemid,_items[itemid].context)}))),result.item},loopMerged:function loopMerged(thisArg,getItemWeight,onItem){var index,len,level,itemid,sortedItems,levelsItems=[];for(index=0,len=_levels.length;index<len;index+=1)null!=(level=_levels[index])&&levelsItems.push(level.items);if(sortedItems=mergeSort(levelsItems,getItemWeight,!0),null!=onItem)for(index=0,len=sortedItems.length;index<len&&(itemid=sortedItems[index],!onItem.call(thisArg,itemid,_items[itemid].context));index+=1);},loopFromItem:function loopFromItem(thisArg,itemid,isLeft,onItem,level){var context,index,len,items,nextItemId,itemLevel,position;if(_items.hasOwnProperty(itemid)&&(context=_items[itemid],itemLevel=level||context.startLevel,items=_levels[itemLevel].items,position=context.positions[itemLevel],null!=onItem))if(isLeft)for(index=position-1;index>=0&&(nextItemId=items[index],!onItem.call(thisArg,nextItemId,_items[nextItemId].context));index-=1);else for(index=position+1,len=items.length;index<len&&(nextItemId=items[index],!onItem.call(thisArg,nextItemId,_items[nextItemId].context));index+=1);},loopLevelsFromItem:function loopLevelsFromItem(thisArg,itemid,isBelow,onItem){var context,index,level;if(_items.hasOwnProperty(itemid)&&(context=_items[itemid],null!=onItem))if(isBelow)for(index=context.endLevel+1;index<=_maximum&&(level=_levels[index],!onItem.call(thisArg,index,null!=level?level.context:null));index+=1);else for(index=context.startLevel-1;index>=_minimum&&(level=_levels[index],!onItem.call(thisArg,index,null!=level?level.context:null));index-=1);},getPrevItem:function getPrevItem(itemid,itemLevel){var result=null;if(_items.hasOwnProperty(itemid)){var item=_items[itemid];itemLevel=itemLevel||item.startLevel,result=_levels[itemLevel].items[item.positions[itemLevel]-1]}return result},getNextItem:function getNextItem(itemid,itemLevel){var result=null;if(_items.hasOwnProperty(itemid)){var item=_items[itemid];itemLevel=itemLevel||item.startLevel,result=_levels[itemLevel].items[item.positions[itemLevel]+1]}return result},length:function length(){return _levels.length},isEmpty:function isEmpty(){return!_levels.length},clone:function clone(){return TreeLevels({levels:_levels,items:_items,minimum:_minimum,maximum:_maximum})}}}function OrgConfig(name){this.name=void 0!==name?name:"OrgDiagram",this.classPrefix="orgdiagram",this.navigationMode=enums.vt.Default,this.pageFitMode=enums.sj.FitToPage,this.minimalVisibility=enums.EE.Dot,this.minimumVisibleLevels=1,this.orientationType=enums.F7.Top,this.horizontalAlignment=enums.a3.Center,this.verticalAlignment=enums.Vn.Middle,this.arrowsDirection=enums.zX.None,this.showExtraArrows=!1,this.extraArrowsMinimumSpace=30,this.connectorType=enums.r7.Squared,this.bevelSize=4,this.elbowType=enums.ex.None,this.elbowDotSize=4,this.emptyDiagramMessage="Diagram is empty.",this.items=[],this.annotations=[],this.cursorItem=null,this.highlightItem=null,this.highlightGravityRadius=40,this.selectedItems=[],this.hasSelectorCheckbox=enums.xB.Auto,this.selectCheckBoxLabel="Selected",this.selectionPathMode=enums.lz.FullStack,this.showFrame=!1,this.frameInnerPadding=new Thickness(2,2,2,2),this.frameOuterPadding=new Thickness(2,2,2,2),this.padding=new Thickness(10,10,10,10),this.templates=[],this.defaultTemplateName=null,this.hasButtons=enums.xB.Auto,this.onButtonsRender=null,this.onHighlightChanging=null,this.onHighlightChanged=null,this.onCursorChanging=null,this.onCursorChanged=null,this.onSelectionChanging=null,this.onSelectionChanged=null,this.onButtonClick=null,this.onMouseClick=null,this.onMouseDblClick=null,this.onItemRender=null,this.onHighlightRender=null,this.onCursorRender=null,this.normalLevelShift=20,this.dotLevelShift=20,this.lineLevelShift=10,this.normalItemsInterval=10,this.dotItemsInterval=1,this.lineItemsInterval=2,this.cousinsIntervalMultiplier=5,this.itemTitleFirstFontColor=enums.wL.White,this.itemTitleSecondFontColor=enums.wL.Navy,this.minimizedItemShapeType=enums.DY.None,this.linesColor=enums.wL.Silver,this.linesWidth=1,this.linesType=enums.SP.Solid,this.highlightLinesColor=enums.wL.Red,this.highlightLinesWidth=1,this.highlightLinesType=enums.SP.Solid,this.showCallout=!0,this.calloutMaximumVisibility=enums.EE.Dot,this.calloutPlacementOffset=100,this.defaultCalloutTemplateName=null,this.calloutfillColor="#000000",this.calloutBorderColor=null,this.calloutOffset=4,this.calloutCornerRadius=4,this.calloutPointerWidth="10%",this.calloutLineWidth=1,this.calloutOpacity=.2,this.alignBranches=!1,this.childrenPlacementType=enums.X9.Horizontal,this.leavesPlacementType=enums.X9.Horizontal,this.placeAssistantsAboveChildren=!0,this.placeAdvisersAboveChildren=!0,this.maximumColumnsInMatrix=6,this.buttonsPanelSize=28,this.groupTitlePanelSize=24,this.checkBoxPanelSize=24,this.groupTitlePlacementType=enums.hZ.Left,this.groupTitleOrientation=enums.GE.RotateRight,this.groupTitleVerticalAlignment=enums.Vn.Middle,this.groupTitleHorizontalAlignment=enums.a3.Center,this.groupTitleFontSize="12px",this.groupTitleFontFamily="Arial",this.groupTitleColor=enums.wL.RoyalBlue,this.groupTitleFontWeight="normal",this.groupTitleFontStyle="normal",this.onGroupTitleRender=null,this.levelTitlePanelSize=24,this.levelTitlePlacementType=enums.hZ.Left,this.levelTitlePlaceInside=!1,this.levelTitleOrientation=enums.GE.Auto,this.levelTitleVerticalAlignment=enums.Vn.Middle,this.levelTitleHorizontalAlignment=enums.a3.Center,this.levelTitleFontSize="12px",this.levelTitleFontFamily="Arial",this.levelTitleFontColor=enums.wL.White,this.levelTitleColor=enums.wL.RoyalBlue,this.levelTitleFontWeight="normal",this.levelTitleFontStyle="normal",this.onLevelTitleRender=null,this.onLevelBackgroundRender=null,this.distance=3,this.scale=1,this.minimumScale=.5,this.maximumScale=2,this.showLabels=enums.xB.Auto,this.labelSize=new Size(80,24),this.labelOffset=1,this.labelOrientation=enums.GE.Horizontal,this.labelPlacement=enums.TK.Top,this.labelFontSize="10px",this.labelFontFamily="Arial",this.labelColor=enums.wL.Black,this.labelFontWeight="normal",this.labelFontStyle="normal",this.enablePanning=!0,this.autoSizeMinimum=new Size(800,600),this.autoSizeMaximum=new Size(1024,768)}function OrgItemConfig(arg0,arg1,arg2,arg3,arg4){var property;switch(this.id=null,this.parent=null,this.title=null,this.description=null,this.image=null,this.context=null,this.itemTitleColor=enums.wL.RoyalBlue,this.minimizedItemShapeType=null,this.groupTitle=null,this.groupTitleColor=enums.wL.RoyalBlue,this.isVisible=!0,this.isActive=!0,this.hasSelectorCheckbox=enums.xB.Auto,this.hasButtons=enums.xB.Auto,this.itemType=enums.qG.Regular,this.levelOffset=null,this.adviserPlacementType=enums.hZ.Auto,this.childrenPlacementType=enums.X9.Auto,this.placeAssistantsAboveChildren=enums.xB.Auto,this.placeAdvisersAboveChildren=enums.xB.Auto,this.templateName=null,this.showCallout=enums.xB.Auto,this.calloutTemplateName=null,this.label=null,this.showLabel=enums.xB.Auto,this.labelSize=null,this.labelOrientation=enums.GE.Auto,this.labelPlacement=enums.TK.Auto,arguments.length){case 1:for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property]);break;case 5:this.id=arg0,this.parent=arg1,this.title=arg2,this.description=arg3,this.image=arg4}}function OrgEventArgs(){this.oldContext=null,this.context=null,this.parentItem=null,this.position=null,this.name=null,this.cancel=!1}function FamConfig(name){this.name=void 0!==name?name:"FamDiagram",this.classPrefix="famdiagram",this.navigationMode=enums.vt.Default,this.pageFitMode=enums.sj.FitToPage,this.minimalVisibility=enums.EE.Dot,this.minimumVisibleLevels=0,this.orientationType=enums.F7.Top,this.verticalAlignment=enums.Vn.Middle,this.arrowsDirection=enums.zX.None,this.showExtraArrows=!0,this.extraArrowsMinimumSpace=30,this.groupByType=enums.zX.Children,this.alignBylevels=!0,this.enableMatrixLayout=!1,this.minimumMatrixSize=4,this.maximumColumnsInMatrix=6,this.hideGrandParentsConnectors=!1,this.elbowType=enums.ex.Round,this.bevelSize=4,this.elbowDotSize=4,this.emptyDiagramMessage="Diagram is empty.",this.items=[],this.annotations=[],this.cursorItem=null,this.highlightItem=null,this.highlightGravityRadius=40,this.selectedItems=[],this.hasSelectorCheckbox=enums.xB.Auto,this.selectCheckBoxLabel="Selected",this.selectionPathMode=enums.lz.None,this.neighboursSelectionMode=enums.DL.ParentsAndChildren,this.showFrame=!1,this.frameInnerPadding=new Thickness(2,2,2,2),this.frameOuterPadding=new Thickness(2,2,2,2),this.padding=new Thickness(10,10,10,10),this.templates=[],this.defaultTemplateName=null,this.defaultLabelAnnotationTemplate=null,this.hasButtons=enums.xB.Auto,this.onButtonsRender=null,this.onHighlightChanging=null,this.onHighlightChanged=null,this.onCursorChanging=null,this.onCursorChanged=null,this.onSelectionChanging=null,this.onSelectionChanged=null,this.onButtonClick=null,this.onMouseClick=null,this.onMouseDblClick=null,this.onItemRender=null,this.onHighlightRender=null,this.onCursorRender=null,this.normalLevelShift=20,this.dotLevelShift=20,this.lineLevelShift=10,this.normalItemsInterval=10,this.dotItemsInterval=1,this.lineItemsInterval=2,this.cousinsIntervalMultiplier=5,this.itemTitleFirstFontColor=enums.wL.White,this.itemTitleSecondFontColor=enums.wL.Navy,this.minimizedItemShapeType=enums.DY.None,this.linesColor=enums.wL.Silver,this.linesWidth=1,this.linesType=enums.SP.Solid,this.showNeigboursConnectorsHighlighted=!1,this.highlightLinesColor=enums.wL.Red,this.highlightLinesWidth=1,this.highlightLinesType=enums.SP.Solid,this.linesPalette=[],this.showCallout=!0,this.calloutMaximumVisibility=enums.EE.Dot,this.calloutPlacementOffset=100,this.defaultCalloutTemplateName=null,this.calloutfillColor="#000000",this.calloutBorderColor=null,this.calloutOffset=4,this.calloutCornerRadius=4,this.calloutPointerWidth="10%",this.calloutLineWidth=1,this.calloutOpacity=.2,this.buttonsPanelSize=28,this.groupTitlePanelSize=24,this.checkBoxPanelSize=24,this.groupTitlePlacementType=enums.hZ.Left,this.groupTitleOrientation=enums.GE.RotateRight,this.groupTitleVerticalAlignment=enums.Vn.Middle,this.groupTitleHorizontalAlignment=enums.a3.Center,this.groupTitleFontSize="12px",this.groupTitleFontFamily="Arial",this.groupTitleColor=enums.wL.RoyalBlue,this.groupTitleFontWeight="normal",this.groupTitleFontStyle="normal",this.onGroupTitleRender=null,this.levelTitlePanelSize=24,this.levelTitlePlacementType=enums.hZ.Left,this.levelTitlePlaceInside=!1,this.levelTitleOrientation=enums.GE.Auto,this.levelTitleVerticalAlignment=enums.Vn.Middle,this.levelTitleHorizontalAlignment=enums.a3.Center,this.levelTitleFontSize="12px",this.levelTitleFontFamily="Arial",this.levelTitleFontColor=enums.wL.White,this.levelTitleColor=enums.wL.RoyalBlue,this.levelTitleFontWeight="normal",this.levelTitleFontStyle="normal",this.onLevelTitleRender=null,this.onLevelBackgroundRender=null,this.distance=3,this.scale=1,this.minimumScale=.5,this.maximumScale=1,this.showLabels=enums.xB.Auto,this.labelSize=new Size(80,24),this.labelOffset=1,this.labelOrientation=enums.GE.Horizontal,this.labelPlacement=enums.TK.Top,this.labelFontSize="10px",this.labelFontFamily="Arial",this.labelColor=enums.wL.Black,this.labelFontWeight="normal",this.labelFontStyle="normal",this.enablePanning=!0,this.autoSizeMinimum=new Size(800,600),this.autoSizeMaximum=new Size(1024,768)}function FamItemConfig(arg0,arg1,arg2,arg3,arg4){var property;switch(this.id=null,this.parents=[],this.relativeItem=null,this.placementType=enums.hZ.Right,this.position=null,this.primaryParent=null,this.title=null,this.description=null,this.image=null,this.context=null,this.itemTitleColor=enums.wL.RoyalBlue,this.minimizedItemShapeType=null,this.groupTitle=null,this.groupTitleColor=enums.wL.RoyalBlue,this.matrixId=null,this.addToMatrix=!0,this.isActive=!0,this.hasSelectorCheckbox=enums.xB.Auto,this.hasButtons=enums.xB.Auto,this.templateName=null,this.showCallout=enums.xB.Auto,this.calloutTemplateName=null,this.label=null,this.showLabel=enums.xB.Auto,this.labelSize=null,this.labelOrientation=enums.GE.Auto,this.labelPlacement=enums.TK.Auto,arguments.length){case 1:for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property]);break;case 5:this.id=arg0,this.parents=arg1,this.title=arg2,this.description=arg3,this.image=arg4}}function FamEventArgs(){this.oldContext=null,this.context=null,this.parentItems=[],this.childrenItems=[],this.position=null,this.name=null,this.cancel=!1}function BackgroundAnnotationConfig(arg0){var property;if(this.annotationType=enums.JJ.Background,this.items=[],this.includeChildren=!1,this.zOrderType=enums.k0.Auto,this.offset=new Thickness(18,18,18,18),this.lineWidth=2,this.opacity=1,this.borderColor=null,this.fillColor=null,this.lineType=enums.SP.Solid,this.selectItems=!1,1===arguments.length)if(null!==arg0)if(arg0 instanceof Array)this.items=arg0;else if("object"==typeof arg0)for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property])}function ConnectorAnnotationConfig(arg0,arg1){var property;switch(this.annotationType=enums.JJ.Connector,this.zOrderType=enums.k0.Foreground,this.fromItem=null,this.toItem=null,this.connectorShapeType=enums.GV.OneWay,this.connectorPlacementType=enums.$I.Offbeat,this.labelPlacementType=enums.xj.Between,this.offset=new Thickness(0,0,0,0),this.lineWidth=2,this.color=enums.wL.Black,this.lineType=enums.SP.Solid,this.selectItems=!0,this.label=null,this.labelSize=new Size(60,30),arguments.length){case 1:for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property]);break;case 2:this.fromItem=arg0,this.toItem=arg1}}function HighlightPathAnnotationConfig(arg0){var property;if(this.annotationType=enums.JJ.HighlightPath,this.zOrderType=enums.k0.Foreground,this.items=[],this.lineWidth=2,this.color=enums.wL.Red,this.lineType=enums.SP.Solid,this.opacity=1,this.showArrows=!0,this.selectItems=!1,1===arguments.length)if(null!==arg0)if(arg0 instanceof Array)this.items=arg0;else if("object"==typeof arg0)for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property])}function LabelAnnotationConfig(arg0,arg1){var property;switch(this.annotationType=enums.JJ.Label,this.fromItem=null,this.toItems=[],this.title=null,this.itemTitleColor=enums.wL.RoyalBlue,this.templateName=null,arguments.length){case 1:for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property]);break;case 2:this.fromItem=arg0,this.toItem=arg1}}function PaletteItemConfig(arg0,arg1,arg2){var property;switch(this.lineColor=enums.wL.Silver,this.lineWidth=1,this.lineType=enums.SP.Solid,arguments.length){case 1:for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property]);break;case 3:this.lineColor=arg0,this.lineWidth=arg1,this.lineType=arg2}}function ShapeAnnotationConfig(arg0){var property;if(this.annotationType=enums.JJ.Shape,this.zOrderType=enums.k0.Auto,this.items=[],this.shapeType=enums.DY.Rectangle,this.offset=new Thickness(0,0,0,0),this.lineWidth=2,this.cornerRadius="10%",this.opacity=1,this.borderColor=null,this.fillColor=null,this.lineType=enums.SP.Solid,this.selectItems=!1,this.label=null,this.labelSize=new Size(60,30),this.labelPlacement=enums.TK.Auto,this.labelOffset=4,1===arguments.length)if(null!==arg0)if(arg0 instanceof Array)this.items=arg0;else if("object"==typeof arg0)for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property])}function LevelAnnotationConfig(arg0){var property;if(this.annotationType=enums.JJ.Level,this.levels=[],this.title=null,this.titleFontColor=null,this.titleColor=null,this.offset=new Thickness(0,0,0,0),this.lineWidth=new Thickness(0,0,0,0),this.opacity=1,this.borderColor=null,this.fillColor="#D4D4D4",this.lineType=enums.SP.Solid,1===arguments.length)if(null!==arg0)if(arg0 instanceof Array)this.items=arg0;else if("object"==typeof arg0)for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property])}function TemplateConfig(){this.name=null,this.isActive=!0,this.itemSize=new Size(120,100),this.itemBorderWidth=1,this.itemTemplate=null,this.minimizedItemShapeType=null,this.minimizedItemSize=new Size(4,4),this.minimizedItemCornerRadius=null,this.minimizedItemLineWidth=1,this.minimizedItemBorderColor=null,this.minimizedItemLineType=enums.SP.Solid,this.minimizedItemFillColor=null,this.minimizedItemOpacity=1,this.highlightPadding=new Thickness(2,2,2,2),this.highlightBorderWidth=1,this.highlightTemplate=null,this.cursorPadding=new Thickness(3,3,3,3),this.cursorBorderWidth=2,this.cursorTemplate=null,this.hasButtons=enums.xB.Auto,this.onButtonsRender=null}function AnnotationLabelTemplate(){var _template=["div",{type:"checkbox",name:"checkbox",class:["bp-item","bp-corner-all","bp-connector-label"]}];return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultAnnotationLabelTemplate"},render:function render(event,data){var annotationConfig=data.context;Array.isArray(annotationConfig.label)?(data.element.innerHTML="",data.element.appendChild(jsonml_html.toHTML(annotationConfig.label))):data.element.innerHTML=annotationConfig.label}}}function ButtonsTemplate(options){var _template=["div",{style:{position:"absolute"}}];return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultButtonsTemplate"},render:function render(event,data){var onButtonsRender=data.onButtonsRender;null!=onButtonsRender&&onButtonsRender(data)}}}function CustomRenderTemplate(options,onRender){var _template=["div",{style:{position:"absolute"}}];return{template:function template(){return _template},getHashCode:function getHashCode(){return"customRenderTemplate"},render:function render(event,data){null!=onRender&&onRender(data)}}}function CheckBoxTemplate(selectCheckBoxLabel){var _template=["div",["label",["nobr",["input",{type:"checkbox",name:"checkbox",class:"bp-selectioncheckbox"}]," ",["span",{name:"selectiontext",class:"bp-selectiontext"},selectCheckBoxLabel]]]];return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultCheckBoxTemplate"},render:function render(event,data){var checkBox=data.element.firstChild.firstChild.firstChild;checkBox.checked=data.isSelected,checkBox.setAttribute("data-id",data.id),data.element.firstChild.firstChild.childNodes[2].setAttribute("data-id",data.id)}}}function CursorTemplate(options,itemTemplateConfig){var _template=function create(config){return["div",{style:{width:config.itemSize.width+config.cursorPadding.left+config.cursorPadding.right+"px",height:config.itemSize.height+config.cursorPadding.top+config.cursorPadding.bottom+"px",borderWidth:config.cursorBorderWidth+"px"},class:["bp-item","bp-corner-all","bp-cursor-frame"]}]}(itemTemplateConfig);return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultCursorTemplate"},render:function render(event,data){}}}function DotHighlightTemplate(options,itemTemplateConfig){var _template=function create(config){var radius=config.minimizedItemCornerRadius;null==radius&&(radius=Math.max(config.highlightPadding.left+config.minimizedItemSize.width+config.highlightPadding.right,config.highlightPadding.top+config.minimizedItemSize.height+config.highlightPadding.bottom)+config.highlightBorderWidth);return["div",{style:{borderWidth:config.highlightBorderWidth+"px",MozBorderRadius:radius+"px",WebkitBorderRadius:radius+"px","-khtml-border-radius":radius+"px",borderRadius:radius+"px"},class:["bp-item","bp-highlight-dot-frame"]}]}(itemTemplateConfig);return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultDotHighlightTemplate"},render:function render(event,data){}}}function getTextAlign(alignment){var result=null;switch(alignment){case enums.a3.Center:result="center";break;case enums.a3.Left:result="left";break;case enums.a3.Right:result="right"}return result}function getVerticalAlignment(alignment){var result=null;switch(alignment){case enums.Vn.Middle:result="middle";break;case enums.Vn.Top:result="top";break;case enums.Vn.Bottom:result="bottom"}return result}function getBorderStyle(lineType){var result=null;switch(lineType){case enums.SP.Solid:result="solid";break;case enums.SP.Dotted:result="dotted";break;case enums.SP.Dashed:result="dashed"}return result}function getRotatedText({orientation:orientation,textOrientation:textOrientation,horizontalAlignment:horizontalAlignment,verticalAlignment:verticalAlignment,fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle,label:label}){var element,rotation="";switch(textOrientation){case enums.GE.Horizontal:break;case enums.GE.RotateLeft:rotation="rotate(-90deg)";break;case enums.GE.RotateRight:rotation="rotate(90deg)";break;case enums.GE.Auto:switch(orientation){case enums.F7.Top:case enums.F7.Bottom:rotation="rotate(90deg)";case enums.F7.Left:case enums.F7.Right:}}var style={fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle,position:"absolute",padding:0,margin:0,textAlign:getTextAlign(horizontalAlignment),lineHeight:1,"-webkit-transform-origin":"center center","-moz-transform-origin":"center center","-o-transform-origin":"center center","-ms-transform-origin":"center center","-webkit-transform":rotation,"-moz-transform":rotation,"-o-transform":rotation,"-ms-transform":rotation,transform:rotation,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",tableLayout:"fixed"};if(verticalAlignment===enums.Vn.Top)element=["div",{style:style},label];else style.borderCollapse="collapse",element=["table",{style:style},["tbody",["tr",["td",{style:{verticalAlign:getVerticalAlignment(verticalAlignment),padding:0,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}},label]]]];return element}function updateRotatedText({element:element,orientation:orientation,textOrientation:textOrientation,verticalAlignment:verticalAlignment,width:width,height:height,label:label,fontColor:fontColor}){var style={},isVertical=!1;switch(textOrientation){case enums.GE.RotateLeft:case enums.GE.RotateRight:isVertical=!0;break;case enums.GE.Auto:switch(orientation){case enums.F7.Top:case enums.F7.Bottom:isVertical=!0}}(style=(isVertical?new Rect(Math.round(width/2-height/2),Math.round(height/2-width/2),height,width):new Rect(0,0,width,height)).getCSS()).maxWidth=style.width,style.maxHeight=style.height;var title,container=element.firstChild;if(jsonml_html.applyStyles(container,style),verticalAlignment===enums.Vn.Top)title=element.firstChild;else(title=element.firstChild.firstChild.firstChild.firstChild).style.borderCollapse="collapse";title.style.color=fontColor,title.textContent=label||""}function GroupTitleTemplate(options){var{groupTitleFontSize:fontSize,groupTitleFontFamily:fontFamily,groupTitleFontWeight:fontWeight,groupTitleFontStyle:fontStyle,groupTitleColor:groupTitleColor,itemTitleFirstFontColor:itemTitleFirstFontColor,itemTitleSecondFontColor:itemTitleSecondFontColor,groupTitleOrientation:textOrientation,groupTitleHorizontalAlignment:horizontalAlignment,groupTitleVerticalAlignment:verticalAlignment}=options,_template=function create(){return["div",{style:{fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle},class:["bp-item","bp-corner-all","bp-grouptitle-frame"]},getRotatedText({orientation:enums.F7.Horizontal,textOrientation:textOrientation,horizontalAlignment:horizontalAlignment,verticalAlignment:verticalAlignment,fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle})]}();return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultGroupTitleTemplate"},render:function render(event,data){var{element:element,context:itemConfig,width:width,height:height}=data,label=itemConfig.groupTitle,backgroundColor=itemConfig.groupTitleColor||groupTitleColor,fontColor=highestContrast(backgroundColor,itemTitleSecondFontColor,itemTitleFirstFontColor);updateRotatedText({element:element,orientation:enums.F7.Horizontal,textOrientation:textOrientation,verticalAlignment:verticalAlignment,width:width,height:height,label:label,fontColor:fontColor}),jsonml_html.applyStyles(data.element,{backgroundColor:backgroundColor})}}}function HighlightTemplate(options,itemTemplateConfig){var _template=function create(config){return["div",{style:{borderWidth:config.highlightBorderWidth+"px"},class:["bp-item","bp-corner-all","bp-highlight-frame"]}]}(itemTemplateConfig);return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultHighlightTemplate"},render:function render(event,data){}}}function ItemTemplate(options,itemTemplateConfig){var _template=function create(config){var contentSize=new Size(config.itemSize);return contentSize.width-=2*config.itemBorderWidth,contentSize.height-=2*config.itemBorderWidth,["div",{style:{borderWidth:config.itemBorderWidth+"px"},class:["bp-item","bp-corner-all","bt-item-frame"]},["div",{name:"titleBackground",style:{top:"2px",left:"2px",width:contentSize.width-4+"px",height:"18px"},class:["bp-item","bp-corner-all","bp-title-frame"]},["div",{name:"title",style:{top:"1px",left:"4px",width:contentSize.width-4-8+"px",height:"16px"},class:["bp-item","bp-title"]}]],["div",{name:"photoBorder",style:{top:"24px",left:"2px",width:"50px",height:"60px"},class:["bp-item","bp-photo-frame"]},["img",{name:"photo",alt:"",style:{width:"50px",height:"60px"}}]],["div",{name:"description",style:{top:"24px",left:"56px",width:contentSize.width-4-56+"px",height:"74px"},class:["bp-item","bp-description"]}]]}(itemTemplateConfig);return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultItemTemplate"},render:function render(event,data){var itemConfig=data.context,itemTitleColor=null!=itemConfig.itemTitleColor?itemConfig.itemTitleColor:enums.wL.RoyalBlue,color=highestContrast(itemTitleColor,options.itemTitleSecondFontColor,options.itemTitleFirstFontColor),element=data.element,titleBackground=element.firstChild,photo=element.childNodes[1].firstChild,title=titleBackground.firstChild,description=element.childNodes[2];jsonml_html.applyStyles(titleBackground,{backgroundColor:itemTitleColor}),photo.src=itemConfig.image,photo.alt=itemConfig.title,jsonml_html.applyStyles(title,{color:color}),title.textContent=itemConfig.title,description.textContent=itemConfig.description}}}function UserTemplate(options,content,onRender){var _hashCode=common_getHashCode(JSON.stringify(content));return{template:function template(){return content},getHashCode:function getHashCode(){return _hashCode},render:function render(event,data){if(null!=onRender)onRender(event,data);else{var itemConfig=data.context,itemTitleColor=null!=itemConfig.itemTitleColor?itemConfig.itemTitleColor:enums.wL.RoyalBlue,color=highestContrast(itemTitleColor,options.itemTitleSecondFontColor,options.itemTitleFirstFontColor);getElementsByName(this,data.element,"photo",(function(node){node.src=itemConfig.image,node.alt=itemConfig.title})),getElementsByName(this,data.element,"titleBackground",(function(node){jsonml_html.applyStyles(node,{background:itemTitleColor})})),getElementsByName(this,data.element,"title",(function(node){jsonml_html.applyStyles(node,{color:color}),node.textContent=itemConfig.title})),getElementsByName(this,data.element,"description",(function(node){node.textContent=itemConfig.description}))}}}}function LabelAnnotationTemplate(){var _template=["div",{class:["bp-item","bp-label-annotation"]}];return{template:function template(){return _template},getHashCode:function getHashCode(){return"defaultLabelAnnotationTemplate"},render:function render(event,data){var itemConfig=data.context;data.element.innerHTML=itemConfig.title}}}function LevelTitleTemplate(options,orientation){var{levelTitleFontSize:fontSize,levelTitleFontFamily:fontFamily,levelTitleFontWeight:fontWeight,levelTitleFontStyle:fontStyle,levelTitleFontColor:levelTitleFontColor,levelTitleOrientation:textOrientation,levelTitleHorizontalAlignment:horizontalAlignment,levelTitleVerticalAlignment:verticalAlignment,levelTitleColor:levelTitleColor}=options,_template=function create(){return["div",{style:{fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle},class:["bp-item","bp-corner-all"]},getRotatedText({orientation:orientation,textOrientation:textOrientation,horizontalAlignment:horizontalAlignment,verticalAlignment:verticalAlignment,fontSize:fontSize,fontFamily:fontFamily,fontWeight:fontWeight,fontStyle:fontStyle})]}(),_hashCode=common_getHashCode(JSON.stringify(_template));return{template:function template(){return _template},getHashCode:function getHashCode(){return _hashCode},render:function render(event,data){var config=data.context,{element:element,width:width,height:height}=data,titleColor=config.titleColor||levelTitleColor,label=config.title,fontColor=config.titleFontColor||levelTitleFontColor;updateRotatedText({element:element,orientation:orientation,textOrientation:textOrientation,width:width,height:height,label:label,fontColor:fontColor}),jsonml_html.applyStyles(data.element,{backgroundColor:titleColor})}}}function LevelBackgroundTemplate(options,levelAnnotationConfig){var _template=["div"];return{template:function template(){return _template},getHashCode:function getHashCode(){return"levelAnnotationBackgroundTemplate"},render:function render(event,data){var annotationConfig=data.context,style={opacity:annotationConfig.opacity,borderColor:annotationConfig.borderColor,backgroundColor:annotationConfig.fillColor,borderWidth:annotationConfig.lineWidth.toString(),borderStyle:getBorderStyle(annotationConfig.lineType)},container=data.element;jsonml_html.applyStyles(container,style)}}}function DependencyManager(){var hash={};return{register:function register(key,value){return hash[key]=value,value},resolve:function resolve(){var args=[],deps=arguments[0],func=arguments[1],scope=arguments[2]||{};return function(){for(var a=Array.prototype.slice.call(arguments,0),i=0;i<deps.length;i+=1){var d=deps[i];args.push(hash.hasOwnProperty(d)&&""!==d?hash[d]:a.shift())}return args=args.concat(a),func.apply(scope||{},args)}}}}function TaskManager(){var _taskFamily=new Family,_dependencies=new DependencyManager,_tasks=[];function TaskInfo(name,dependencies,factory,color){this.name=name,this.dependencies=dependencies,this.factory=factory,this.task=null,this.color=color}return{addTask:function addTask(taskName,taskDependencies,factory,color){if(_tasks.length>0)throw"Task Manager is already initialized";_taskFamily.add(taskDependencies,taskName,new TaskInfo(taskName,taskDependencies,factory,color))},addDependency:function addDependency(name,dependency){if(_tasks.length>0)throw"Task Manager is already initialized";_dependencies.register(name,dependency)},getTask:function getTask(taskName){var taskInfo=_taskFamily.node(taskName);return taskInfo&&taskInfo.task},process:function process(startTask,stopTask,debug){var hasChanges=!1,logtime=debug;0===_tasks.length&&_taskFamily.loopTopo(this,(function(taskName,taskInfo){taskInfo.task=_dependencies.register(taskName,_dependencies.resolve(taskInfo.dependencies,taskInfo.factory)()),_tasks.push(taskInfo)})),debug&&console.log("-- process --");for(var isRequired={},index=0,len=_tasks.length;index<len;index+=1){var taskInfo=_tasks[index],dependents=[];if(taskInfo.name==startTask||isRequired.hasOwnProperty(taskInfo.name)){if(logtime)var startAt=performance.now();if((hasChanges=taskInfo.task.process(debug))&&_taskFamily.loopChildren(this,taskInfo.name,(function(childTaskName,childTaskInfo){return isRequired[childTaskName]=!0,debug&&dependents.push(childTaskName),_taskFamily.SKIP})),logtime)var endAt=performance.now();if(debug){var spentTime=Math.round(endAt-startAt,2);console.log(index+". "+taskInfo.name+", "+spentTime+" ms. "+(hasChanges?" - forces: "+dependents.toString():""))}}if(taskInfo.name==stopTask)return}},getProcessDiagramConfig:function getProcessDiagramConfig(){var result=[];0===_tasks.length&&_taskFamily.loopTopo(this,(function(taskName,taskInfo){taskInfo.task=_dependencies.register(taskName,_dependencies.resolve(taskInfo.dependencies,taskInfo.factory)()),_tasks.push(taskInfo)}));for(var index=0,len=_tasks.length;index<len;index+=1){var taskInfo=_tasks[index],itemConfig={id:taskInfo.name,title:splitCamelCaseName(taskInfo.name).join(" "),description:taskInfo.task.description||"",itemTitleColor:taskInfo.color,parents:[]};_taskFamily.loopParents(this,taskInfo.name,(function(parentTaskName,parentTaskInfo){return itemConfig.parents.push(parentTaskName),_taskFamily.SKIP})),result.push(itemConfig)}return result}}}function OptionsTask(getOptions){return{process:function process(){return!0},getOptions:getOptions,description:"Raw options."}}function ArrayReader(itemTemplate,containsUniqueItems,uniquePropertyKey,createSourceHash,isOrdered){this.itemTemplate=itemTemplate,this.containsUniqueItems=containsUniqueItems,this.uniquePropertyKey=uniquePropertyKey,this.containsPrimitiveValues=isNullOrEmpty(uniquePropertyKey),this.createSourceHash=createSourceHash,this.isOrdered=isOrdered}function ValueReader(acceptedTypes,isNullable,defaultValue){this.acceptedTypes=acceptedTypes,this.isNullable=isNullable,this.defaultValue=defaultValue,this.hash={};for(var index=0;index<acceptedTypes.length;index+=1){var acceptedType=acceptedTypes[index];this.hash[acceptedType]=!0}}function ObjectReader(dataTemplate,isNullable,defaultValue){this.dataTemplate=dataTemplate,this.isNullable=isNullable,this.defaultValue=defaultValue}function EnumerationReader(enumeration,isNullable,defaultValue){for(var key in this.enumeration=enumeration,this.isNullable=isNullable,this.defaultValue=defaultValue,this.hash={},enumeration)this.hash[enumeration[key]]=key}function CalloutOptionTask(optionsTask,defaultConfig,defaultItemConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({calloutMaximumVisibility:new EnumerationReader(enums.EE,!1,defaultConfig.calloutMaximumVisibility),showCallout:new ValueReader(["boolean"],!1,defaultConfig.showCallout),calloutPlacementOffset:new ValueReader(["number"],!1,defaultConfig.calloutPlacementOffset),orientationType:new EnumerationReader(enums.F7,!1,defaultConfig.orientationType),defaultTemplateName:new ValueReader(["string"],!0),defaultCalloutTemplateName:new ValueReader(["string"],!0),calloutfillColor:new ValueReader(["string"],!1,defaultConfig.calloutfillColor),calloutBorderColor:new ValueReader(["string"],!0),calloutOffset:new ValueReader(["number"],!1,defaultConfig.calloutOffset),calloutCornerRadius:new ValueReader(["string"],!1,defaultConfig.calloutCornerRadius),calloutPointerWidth:new ValueReader(["string"],!1,defaultConfig.calloutPointerWidth),calloutLineWidth:new ValueReader(["number"],!1,defaultConfig.calloutLineWidth),calloutOpacity:new ValueReader(["number"],!1,defaultConfig.calloutOpacity),items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),showCallout:new EnumerationReader(enums.xB,!1,defaultConfig.showCallout),calloutTemplateName:new ValueReader(["string"],!0),templateName:new ValueReader(["string"],!0)}),!0,"id")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},getItemOptions:function getItemOptions(itemid){return _hash["options-items"][itemid]},description:"Checks item callout options."}}function ConnectorsOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({arrowsDirection:new EnumerationReader(enums.zX,!1,defaultConfig.arrowsDirection),showExtraArrows:new ValueReader(["boolean"],!1,defaultConfig.showExtraArrows),extraArrowsMinimumSpace:new ValueReader(["number"],!1,defaultConfig.extraArrowsMinimumSpace),connectorType:new EnumerationReader(enums.r7,!1,defaultConfig.hasOwnProperty("connectorType")?defaultConfig.connectorType:enums.r7.Squared),showNeigboursConnectorsHighlighted:new EnumerationReader(enums.r7,!1,!!defaultConfig.hasOwnProperty("showNeigboursConnectorsHighlighted")&&defaultConfig.showNeigboursConnectorsHighlighted),elbowType:new EnumerationReader(enums.ex,!1,defaultConfig.elbowType),bevelSize:new ValueReader(["number"],!1,defaultConfig.bevelSize),elbowDotSize:new ValueReader(["number"],!1,defaultConfig.elbowDotSize),linesColor:new ValueReader(["string"],!1,defaultConfig.linesColor),linesWidth:new ValueReader(["number"],!1,defaultConfig.linesWidth),linesType:new EnumerationReader(enums.SP,!1,defaultConfig.linesType),highlightLinesColor:new ValueReader(["string"],!1,defaultConfig.highlightLinesColor),highlightLinesWidth:new ValueReader(["number"],!1,defaultConfig.highlightLinesWidth),highlightLinesType:new EnumerationReader(enums.SP,!1,defaultConfig.highlightLinesType)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks connector lines drawing options."}}function OrgItemsOptionTask(optionsTask,defaultItemConfig){var _data={},_hash={},_sourceHash={},_dataTemplate=new ObjectReader({items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),parent:new ValueReader(["string","number"],!0),itemType:new EnumerationReader(enums.qG,!1,defaultItemConfig.itemType),adviserPlacementType:new EnumerationReader(enums.hZ,!1,defaultItemConfig.adviserPlacementType),childrenPlacementType:new EnumerationReader(enums.X9,!1,defaultItemConfig.childrenPlacementType),placeAdvisersAboveChildren:new EnumerationReader(enums.xB,!1,defaultItemConfig.placeAdvisersAboveChildren),placeAssistantsAboveChildren:new EnumerationReader(enums.xB,!1,defaultItemConfig.placeAssistantsAboveChildren),isVisible:new ValueReader(["boolean"],!1,defaultItemConfig.isVisible),isActive:new ValueReader(["boolean"],!1,defaultItemConfig.isActive),levelOffset:new ValueReader(["number"],!1,null)}),!0,"id",!0,!0)});return{process:function process(){var context={isChanged:!1,hash:_hash,sourceHash:_sourceHash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getItems:function getItems(){return _data.items},getConfig:function getConfig(itemId){return _sourceHash["options-items"][itemId]},description:"Checks items configuration options effecting their placement in layout."}}function ItemsContentOptionTask(optionsTask,defaultItemConfig){var _data={},_hash={},_sourceHash={},_dataTemplate=new ObjectReader({items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),title:new ValueReader(["string"],!0),description:new ValueReader(["string"],!0),image:new ValueReader(["string"],!0),context:new ValueReader(["string","number","object"],!0),itemTitleColor:new ValueReader(["string"],!1,defaultItemConfig.itemTitleColor),groupTitle:new ValueReader(["string"],!1,defaultItemConfig.groupTitle),groupTitleColor:new ValueReader(["string"],!1,defaultItemConfig.groupTitleColor)}),!0,"id",!0,!0)});return{process:function process(){var context={isChanged:!1,hash:_hash,sourceHash:_sourceHash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getItems:function getItems(){return _data.items},getConfig:function getConfig(itemId){return _sourceHash["options-items"][itemId]},description:"Checks items configuration options effecting their placement in layout."}}function FunctionReader(){}function ItemsSizesOptionTask(optionsTask,defaultConfig,defaultItemConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({defaultTemplateName:new ValueReader(["string"],!0),defaultLabelAnnotationTemplate:new ValueReader(["string"],!0),hasSelectorCheckbox:new EnumerationReader(enums.xB,!1,defaultConfig.hasSelectorCheckbox),hasButtons:new EnumerationReader(enums.xB,!1,defaultConfig.hasButtons),buttonsPanelSize:new ValueReader(["number"],!1,defaultConfig.buttonsPanelSize),groupTitlePanelSize:new ValueReader(["number"],!1,defaultConfig.groupTitlePanelSize),groupTitlePlacementType:new EnumerationReader(enums.hZ,!1,defaultConfig.groupTitlePlacementType),checkBoxPanelSize:new ValueReader(["number"],!1,defaultConfig.checkBoxPanelSize),selectCheckBoxLabel:new ValueReader(["string"],!1,defaultConfig.selectCheckBoxLabel),onButtonsRender:new FunctionReader,pageFitMode:new EnumerationReader(enums.sj,!1,defaultConfig.pageFitMode),padding:new ObjectReader({left:new ValueReader(["number"],!1,defaultConfig.padding.left),top:new ValueReader(["number"],!1,defaultConfig.padding.top),right:new ValueReader(["number"],!1,defaultConfig.padding.right),bottom:new ValueReader(["number"],!1,defaultConfig.padding.bottom)},!1,defaultConfig.padding),minimalVisibility:new EnumerationReader(enums.EE,!1,defaultConfig.minimalVisibility),selectionPathMode:new EnumerationReader(enums.lz,!1,defaultConfig.selectionPathMode),autoSizeMinimum:new ObjectReader({width:new ValueReader(["number"],!1,defaultConfig.autoSizeMinimum.width),height:new ValueReader(["number"],!1,defaultConfig.autoSizeMinimum.height)},!1,defaultConfig.autoSizeMinimum),autoSizeMaximum:new ObjectReader({width:new ValueReader(["number"],!1,defaultConfig.autoSizeMaximum.width),height:new ValueReader(["number"],!1,defaultConfig.autoSizeMaximum.height)},!1,defaultConfig.autoSizeMaximum),scale:new ValueReader(["number"],!1,defaultConfig.scale),maximumScale:new ValueReader(["number"],!1,defaultConfig.maximumScale),minimumScale:new ValueReader(["number"],!1,defaultConfig.minimumScale),normalLevelShift:new ValueReader(["number"],!1,defaultConfig.normalLevelShift),dotLevelShift:new ValueReader(["number"],!1,defaultConfig.dotLevelShift),lineLevelShift:new ValueReader(["number"],!1,defaultConfig.lineLevelShift),normalItemsInterval:new ValueReader(["number"],!1,defaultConfig.normalItemsInterval),dotItemsInterval:new ValueReader(["number"],!1,defaultConfig.dotItemsInterval),lineItemsInterval:new ValueReader(["number"],!1,defaultConfig.lineItemsInterval),cousinsIntervalMultiplier:new ValueReader(["number"],!1,defaultConfig.cousinsIntervalMultiplier),verticalAlignment:new EnumerationReader(enums.Vn,!1,defaultConfig.verticalAlignment),items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),groupTitle:new ValueReader(["string","number"],!0),isVisible:new ValueReader(["boolean","number"],!1,defaultItemConfig.isVisible),isActive:new ValueReader(["boolean","number"],!1,defaultItemConfig.isActive),hasSelectorCheckbox:new EnumerationReader(enums.xB,!1,defaultItemConfig.hasSelectorCheckbox),hasButtons:new EnumerationReader(enums.xB,!1,defaultItemConfig.hasButtons),templateName:new ValueReader(["string"],!0)}),!0,"id")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getItemOptions:function getItemOptions(itemid){return _hash["options-items"][itemid]},getOptions:function getOptions(){return _data},description:"Checks items size options."}}function MinimumVisibleLevelsOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({pageFitMode:new EnumerationReader(enums.sj,!1,defaultConfig.pageFitMode),minimalVisibility:new EnumerationReader(enums.EE,!1,defaultConfig.minimalVisibility),minimumVisibleLevels:new ValueReader(["number"],!1,defaultConfig.minimumVisibleLevels)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks minimum visible levels options."}}function LabelsOptionTask(optionsTask,defaultConfig,defaultItemConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({showLabels:new EnumerationReader(enums.xB,!1,defaultConfig.showLabels),labelOffset:new ValueReader(["number"],!1,defaultConfig.labelOffset),labelFontSize:new ValueReader(["string"],!1,defaultConfig.labelFontSize),labelFontFamily:new ValueReader(["string"],!1,defaultConfig.labelFontFamily),labelFontStyle:new ValueReader(["string"],!1,defaultConfig.labelFontStyle),labelFontWeight:new ValueReader(["string"],!1,defaultConfig.labelFontWeight),labelColor:new ValueReader(["string"],!1,defaultConfig.labelColor),labelSize:new ObjectReader({width:new ValueReader(["number"],!1,defaultConfig.labelSize.width),height:new ValueReader(["number"],!1,defaultConfig.labelSize.height)},!1,defaultConfig.labelSize),labelOrientation:new EnumerationReader(enums.GE,!1,defaultConfig.labelOrientation),labelPlacement:new EnumerationReader(enums.TK,!1,defaultConfig.labelPlacement),arrowsDirection:new EnumerationReader(enums.zX,!1,defaultConfig.arrowsDirection),items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),label:new ValueReader(["string","number","object"],!0),showLabel:new EnumerationReader(enums.xB,!1,defaultItemConfig.showLabel),labelSize:new ObjectReader({width:new ValueReader(["number"],!1,0),height:new ValueReader(["number"],!1,0)},!0),labelOrientation:new EnumerationReader(enums.GE,!1,defaultItemConfig.labelOrientation),labelPlacement:new EnumerationReader(enums.TK,!1,defaultItemConfig.labelPlacement)}),!0,"id")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getItemOptions:function getItemOptions(itemid){return _hash["options-items"][itemid]},getItemsOptions:function getItemsOptions(){return _hash["options-items"]},getOptions:function getOptions(){return _data},description:"Checks items labels options."}}function TemplatesOptionTask(optionsTask,defaultConfig,defaultTemplateConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({groupTitleVerticalAlignment:new EnumerationReader(enums.Vn,!1,defaultConfig.groupTitleVerticalAlignment),groupTitleHorizontalAlignment:new EnumerationReader(enums.a3,!1,defaultConfig.groupTitleHorizontalAlignment),groupTitleOrientation:new EnumerationReader(enums.GE,!1,defaultConfig.groupTitleOrientation),groupTitleFontSize:new ValueReader(["string"],!1,defaultConfig.groupTitleFontSize),groupTitleFontFamily:new ValueReader(["string"],!1,defaultConfig.groupTitleFontFamily),groupTitleColor:new ValueReader(["string"],!1,defaultConfig.groupTitleColor),groupTitleFontWeight:new ValueReader(["string"],!1,defaultConfig.groupTitleFontWeight),groupTitleFontStyle:new ValueReader(["string"],!1,defaultConfig.groupTitleFontStyle),itemTitleFirstFontColor:new ValueReader(["string"],!1,defaultConfig.itemTitleFirstFontColor),itemTitleSecondFontColor:new ValueReader(["string"],!1,defaultConfig.itemTitleSecondFontColor),selectCheckBoxLabel:new ValueReader(["string"],!1,defaultConfig.selectCheckBoxLabel),onItemRender:new FunctionReader,onCursorRender:new FunctionReader,onHighlightRender:new FunctionReader,onGroupTitleRender:new FunctionReader,templates:new ArrayReader(new ObjectReader({name:new ValueReader(["string"],!0),isActive:new ValueReader(["boolean"],!1,defaultTemplateConfig.isActive),itemSize:new ObjectReader({width:new ValueReader(["number"],!1,defaultTemplateConfig.itemSize.width),height:new ValueReader(["number"],!1,defaultTemplateConfig.itemSize.height)},!1,defaultTemplateConfig.itemSize),itemBorderWidth:new ValueReader(["number"],!1,defaultTemplateConfig.itemBorderWidth),itemTemplate:new ValueReader(["string","object"],!0),minimizedItemShapeType:new EnumerationReader(enums.DY,!0),minimizedItemSize:new ObjectReader({width:new ValueReader(["number"],!1,defaultTemplateConfig.minimizedItemSize.width),height:new ValueReader(["number"],!1,defaultTemplateConfig.minimizedItemSize.height)},!1,defaultTemplateConfig.minimizedItemSize),minimizedItemCornerRadius:new ValueReader(["number"],!0),minimizedItemLineWidth:new ValueReader(["number"],!1,defaultTemplateConfig.minimizedItemLineWidth),minimizedItemBorderColor:new ValueReader(["string"],!0),minimizedItemLineType:new EnumerationReader(enums.SP,!1,defaultTemplateConfig.minimizedItemLineType),minimizedItemFillColor:new ValueReader(["string"],!0),minimizedItemOpacity:new ValueReader(["number"],!1,defaultTemplateConfig.minimizedItemOpacity),highlightPadding:new ObjectReader({left:new ValueReader(["number"],!1,defaultTemplateConfig.highlightPadding.left),top:new ValueReader(["number"],!1,defaultTemplateConfig.highlightPadding.top),right:new ValueReader(["number"],!1,defaultTemplateConfig.highlightPadding.right),bottom:new ValueReader(["number"],!1,defaultTemplateConfig.highlightPadding.bottom)},!1,defaultTemplateConfig.highlightPadding),highlightBorderWidth:new ValueReader(["number"],!1,defaultTemplateConfig.highlightBorderWidth),highlightTemplate:new ValueReader(["string","object"],!0),cursorPadding:new ObjectReader({left:new ValueReader(["number"],!1,defaultTemplateConfig.cursorPadding.left),top:new ValueReader(["number"],!1,defaultTemplateConfig.cursorPadding.top),right:new ValueReader(["number"],!1,defaultTemplateConfig.cursorPadding.right),bottom:new ValueReader(["number"],!1,defaultTemplateConfig.cursorPadding.bottom)},!1,defaultTemplateConfig.cursorPadding),cursorBorderWidth:new ValueReader(["number"],!1,defaultTemplateConfig.cursorBorderWidth),cursorTemplate:new ValueReader(["string","object"],!0),hasButtons:new EnumerationReader(enums.xB,!1,defaultTemplateConfig.hasButtons),onButtonsRender:new FunctionReader}),!0,"name")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks items template options."}}function OrientationOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({orientationType:new EnumerationReader(enums.F7,!1,defaultConfig.orientationType)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks diagram orientation options."}}function OrgVisualTreeOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({alignBranches:new ValueReader(["boolean"],!1,defaultConfig.alignBranches),leavesPlacementType:new EnumerationReader(enums.X9,!1,defaultConfig.leavesPlacementType),childrenPlacementType:new EnumerationReader(enums.X9,!1,defaultConfig.childrenPlacementType),placeAdvisersAboveChildren:new ValueReader(["boolean"],!1,defaultConfig.placeAdvisersAboveChildren),placeAssistantsAboveChildren:new ValueReader(["boolean"],!1,defaultConfig.placeAssistantsAboveChildren),maximumColumnsInMatrix:new ValueReader(["number"],!1,defaultConfig.maximumColumnsInMatrix),horizontalAlignment:new EnumerationReader(enums.a3,!1,defaultConfig.horizontalAlignment)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks items layout options."}}function MinimizedItemsOptionTask(optionsTask){var _data={},_hash={},_dataTemplate=new ObjectReader({minimizedItemShapeType:new EnumerationReader(enums.DY,!0),items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),minimizedItemShapeType:new EnumerationReader(enums.DY,!0),itemTitleColor:new ValueReader(["string"],!0)}),!0,"id")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getItemOptions:function getItemOptions(itemid){return _hash["options-items"][itemid]},getOptions:function getOptions(){return _data},description:"Checks minimized items drawing options."}}function CursorItemOptionTask(optionsTask,defaultConfig){var _data={},_dataTemplate=new ObjectReader({cursorItem:new ValueReader(["string","number"],!0),navigationMode:new EnumerationReader(enums.vt,!1,defaultConfig.navigationMode)});return{process:function process(){var context={isChanged:!1};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getCursorItem:function getCursorItem(){return _data.cursorItem},hasCursorEnabled:function hasCursorEnabled(){switch(_data.navigationMode){case enums.vt.Default:case enums.vt.CursorOnly:return!0}return!1},description:"Checks currenct cursor item option."}}function HighlightItemOptionTask(optionsTask,defaultConfig){var _data={},_dataTemplate=new ObjectReader({highlightItem:new ValueReader(["string","number"],!0),navigationMode:new EnumerationReader(enums.vt,!1,defaultConfig.navigationMode),highlightGravityRadius:new ValueReader(["number"],!1,defaultConfig.highlightGravityRadius)});return{process:function process(){var context={isChanged:!1};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getHighlightItem:function getHighlightItem(){return _data.highlightItem},hasHighlightEnabled:function hasHighlightEnabled(){switch(_data.navigationMode){case enums.vt.Default:case enums.vt.HighlightOnly:return!0}return!1},getGravityRadius:function getGravityRadius(){return _data.highlightGravityRadius},description:"Checks highlight item option."}}function SelectedItemsOptionTask(optionsTask){var _data={},_hash={},_dataTemplate=new ObjectReader({selectedItems:new ArrayReader(new ValueReader(["string","number"],!0),!0)});return{process:function process(){var context={isChanged:!1,hash:_hash},options=optionsTask.getOptions();return _data=_dataTemplate.read(_data,options,"options",context),context.isChanged},getSelectedItems:function getSelectedItems(){return _data.selectedItems},description:"Checks user selected items option."}}function CursorSelectionPathModeOptionTask(optionsTask,defaultConfig){var _data={},_dataTemplate=new ObjectReader({selectionPathMode:new EnumerationReader(enums.lz,!1,defaultConfig.selectionPathMode)});return{process:function process(){var context={isChanged:!1};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getSelectionPathMode:function getSelectionPathMode(){return _data.selectionPathMode},description:"Checks cursor selection path option."}}function SplitAnnotationsOptionTask(optionsTask){var _data={annotations:{}};return{process:function process(){var index,len,annotationConfig,annotationType,zOrderType,key,annotations=optionsTask.getOptions().annotations,hash={};if(Array.isArray(annotations))for(index=0,len=annotations.length;index<len;index+=1){switch(annotationType=(annotationConfig=annotations[index]).annotationType){case enums.JJ.Shape:case enums.JJ.Connector:case enums.JJ.HighlightPath:switch(annotationConfig.zOrderType){case enums.k0.Background:zOrderType=enums.k0.Background;break;case enums.k0.Foreground:case enums.k0.Auto:default:zOrderType=enums.k0.Foreground}break;case enums.JJ.Background:case enums.JJ.Label:default:zOrderType=null}null!=annotationType&&(key=1e3*annotationType+(zOrderType||0),hash.hasOwnProperty(key)||(hash[key]=[]),hash[key].push(annotationConfig))}return _data.annotations=hash,!0},getAnnotations:function getAnnotations(annotationType,zOrderType){var key=1e3*annotationType+(zOrderType||0);return _data.annotations[key]}}}function ShapeAnnotationOptionTask(splitAnnotationsOptionTask,defaultShapeAnnotationConfig,zOrderType){var _annotations=[],_hash={},_dataTemplate=new ArrayReader(new ObjectReader({zOrderType:new EnumerationReader(enums.k0,!1,defaultShapeAnnotationConfig.zOrderType),items:new ArrayReader(new ValueReader(["string","number"],!0),!0),shapeType:new EnumerationReader(enums.DY,!1,defaultShapeAnnotationConfig.shapeType),offset:new ObjectReader({left:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.offset.left),top:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.offset.top),right:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.offset.right),bottom:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.offset.bottom)},!1,defaultShapeAnnotationConfig.offset),lineWidth:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.lineWidth),cornerRadius:new ValueReader(["string"],!1,defaultShapeAnnotationConfig.cornerRadius),opacity:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.opacity),borderColor:new ValueReader(["string"],!1,defaultShapeAnnotationConfig.borderColor),fillColor:new ValueReader(["string"],!1,defaultShapeAnnotationConfig.fillColor),lineType:new EnumerationReader(enums.SP,!1,defaultShapeAnnotationConfig.lineType),selectItems:new ValueReader(["boolean"],!1,defaultShapeAnnotationConfig.selectItems),label:new ValueReader(["string","object"],!1,defaultShapeAnnotationConfig.label),labelSize:new ObjectReader({width:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.labelSize.width),height:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.labelSize.height)},!1,defaultShapeAnnotationConfig.labelSize),labelPlacement:new EnumerationReader(enums.TK,!1,defaultShapeAnnotationConfig.labelPlacement),labelOffset:new ValueReader(["number"],!1,defaultShapeAnnotationConfig.labelOffset)},!1));return{process:function process(){var context={isChanged:!1,hash:_hash};return _annotations=_dataTemplate.read(_annotations,splitAnnotationsOptionTask.getAnnotations(enums.JJ.Shape,zOrderType),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _annotations}}}function HighlightPathAnnotationOptionTask(splitAnnotationsOptionTask,defaultHighlightPathAnnotationConfig,zOrderType){var _annotations=[],_hash={},_dataAnnotationsTemplate=new ArrayReader(new ObjectReader({zOrderType:new EnumerationReader(enums.k0,!1,defaultHighlightPathAnnotationConfig.zOrderType),lineWidth:new ValueReader(["number"],!1,defaultHighlightPathAnnotationConfig.lineWidth),opacity:new ValueReader(["number"],!1,defaultHighlightPathAnnotationConfig.opacity),color:new ValueReader(["string"],!1,defaultHighlightPathAnnotationConfig.color),lineType:new EnumerationReader(enums.SP,!1,defaultHighlightPathAnnotationConfig.lineType),items:new ArrayReader(new ValueReader(["string","number"],!0),!1),selectItems:new ValueReader(["boolean"],!1,defaultHighlightPathAnnotationConfig.selectItems),showArrows:new ValueReader(["boolean"],!1,defaultHighlightPathAnnotationConfig.showArrows)},!1));return{process:function process(){var context={isChanged:!1,hash:_hash};return _annotations=_dataAnnotationsTemplate.read(_annotations,splitAnnotationsOptionTask.getAnnotations(enums.JJ.HighlightPath,zOrderType),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _annotations}}}function ConnectorAnnotationOptionTask(splitAnnotationsOptionTask,defaultConnectorAnnotationConfig,zOrderType){var _annotations=[],_hash={},_dataTemplate=new ArrayReader(new ObjectReader({zOrderType:new EnumerationReader(enums.k0,!1,defaultConnectorAnnotationConfig.zOrderType),fromItem:new ValueReader(["string","number"],!0),toItem:new ValueReader(["string","number"],!0),connectorShapeType:new EnumerationReader(enums.DY,!1,defaultConnectorAnnotationConfig.connectorShapeType),connectorPlacementType:new EnumerationReader(enums.$I,!1,defaultConnectorAnnotationConfig.connectorPlacementType),labelPlacementType:new EnumerationReader(enums.xj,!1,defaultConnectorAnnotationConfig.labelPlacementType),offset:new ObjectReader({left:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.offset.left),top:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.offset.top),right:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.offset.right),bottom:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.offset.bottom)},!1,defaultConnectorAnnotationConfig.offset),lineWidth:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.lineWidth),color:new ValueReader(["string"],!1,defaultConnectorAnnotationConfig.color),lineType:new EnumerationReader(enums.SP,!1,defaultConnectorAnnotationConfig.lineType),selectItems:new ValueReader(["boolean"],!1,defaultConnectorAnnotationConfig.selectItems),label:new ValueReader(["string","object"],!1,defaultConnectorAnnotationConfig.label),labelSize:new ObjectReader({width:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.labelSize.width),height:new ValueReader(["number"],!1,defaultConnectorAnnotationConfig.labelSize.height)},!1,defaultConnectorAnnotationConfig.labelSize)}),!1);return{process:function process(){var context={isChanged:!1,hash:_hash};return _annotations=_dataTemplate.read(_annotations,splitAnnotationsOptionTask.getAnnotations(enums.JJ.Connector,zOrderType),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _annotations}}}function BackgroundAnnotationOptionTask(splitAnnotationsOptionTask,defaultBackgroundAnnotationConfig){var _annotations=[],_hash={},_dataTemplate=new ArrayReader(new ObjectReader({items:new ArrayReader(new ValueReader(["string","number"],!0),!0),includeChildren:new ValueReader(["boolean"],!1,defaultBackgroundAnnotationConfig.includeChildren),zOrderType:new EnumerationReader(enums.k0,!1,defaultBackgroundAnnotationConfig.zOrderType),offset:new ObjectReader({left:new ValueReader(["number"],!1,defaultBackgroundAnnotationConfig.offset.left),top:new ValueReader(["number"],!1,defaultBackgroundAnnotationConfig.offset.top),right:new ValueReader(["number"],!1,defaultBackgroundAnnotationConfig.offset.right),bottom:new ValueReader(["number"],!1,defaultBackgroundAnnotationConfig.offset.bottom)},!1,defaultBackgroundAnnotationConfig.offset),lineWidth:new ValueReader(["number"],!1,defaultBackgroundAnnotationConfig.lineWidth),opacity:new ValueReader(["number"],!1,defaultBackgroundAnnotationConfig.opacity),borderColor:new ValueReader(["string"],!1,defaultBackgroundAnnotationConfig.borderColor),fillColor:new ValueReader(["string"],!1,defaultBackgroundAnnotationConfig.fillColor),lineType:new EnumerationReader(enums.SP,!1,defaultBackgroundAnnotationConfig.lineType),selectItems:new ValueReader(["boolean"],!1,defaultBackgroundAnnotationConfig.selectItems)}),!1);return{process:function process(){var context={isChanged:!1,hash:_hash};return _annotations=_dataTemplate.read(_annotations,splitAnnotationsOptionTask.getAnnotations(enums.JJ.Background,null),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _annotations}}}function LevelAnnotationOptionTask(splitAnnotationsOptionTask,defaultLevelAnnotationConfig){var _annotations=[],_hash={},_dataTemplate=new ArrayReader(new ObjectReader({levels:new ArrayReader(new ValueReader(["string","number"],!0),!0),title:new ValueReader(["string"],!0),titleFontColor:new ValueReader(["string"],!0),titleColor:new ValueReader(["string"],!0),offset:new ObjectReader({left:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.offset.left),top:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.offset.top),right:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.offset.right),bottom:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.offset.bottom)},!1,defaultLevelAnnotationConfig.offset),lineWidth:new ObjectReader({left:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.lineWidth.left),top:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.lineWidth.top),right:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.lineWidth.right),bottom:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.lineWidth.bottom)},!1,defaultLevelAnnotationConfig.lineWidth),opacity:new ValueReader(["number"],!1,defaultLevelAnnotationConfig.opacity),borderColor:new ValueReader(["string"],!0),fillColor:new ValueReader(["string"],!1,defaultLevelAnnotationConfig.fillColor),lineType:new EnumerationReader(enums.SP,!1,defaultLevelAnnotationConfig.lineType)}),!1);return{process:function process(){var context={isChanged:!1,hash:_hash};return _annotations=_dataTemplate.read(_annotations,splitAnnotationsOptionTask.getAnnotations(enums.JJ.Level,null),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _annotations},description:"Collects Level Annotations"}}function ScaleOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({scale:new ValueReader(["number"],!1,defaultConfig.scale),minimumScale:new ValueReader(["number"],!1,defaultConfig.minimumScale),maximumScale:new ValueReader(["number"],!1,defaultConfig.maximumScale)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks control scale options."}}function FrameOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({showFrame:new ValueReader(["boolean"],!1,defaultConfig.showFrame),frameInnerPadding:new ObjectReader({left:new ValueReader(["number"],!1,defaultConfig.frameInnerPadding.left),top:new ValueReader(["number"],!1,defaultConfig.frameInnerPadding.top),right:new ValueReader(["number"],!1,defaultConfig.frameInnerPadding.right),bottom:new ValueReader(["number"],!1,defaultConfig.frameInnerPadding.bottom)},!1,defaultConfig.frameInnerPadding),frameOuterPadding:new ObjectReader({left:new ValueReader(["number"],!1,defaultConfig.frameOuterPadding.left),top:new ValueReader(["number"],!1,defaultConfig.frameOuterPadding.top),right:new ValueReader(["number"],!1,defaultConfig.frameOuterPadding.right),bottom:new ValueReader(["number"],!1,defaultConfig.frameOuterPadding.bottom)},!1,defaultConfig.frameOuterPadding)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Checks frame options."}}function LevelTitlePlacementOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({levelTitlePlaceInside:new ValueReader(["boolean"],!1,defaultConfig.levelTitlePlaceInside),levelTitlePanelSize:new ValueReader(["number"],!1,defaultConfig.levelTitlePanelSize),levelTitlePlacementType:new EnumerationReader(enums.hZ,!1,defaultConfig.levelTitlePlacementType)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Level annotation title placement options."}}function LevelTitleTemplateOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({levelTitleOrientation:new EnumerationReader(enums.GE,!1,defaultConfig.levelTitleOrientation),levelTitleVerticalAlignment:new EnumerationReader(enums.Vn,!1,defaultConfig.levelTitleVerticalAlignment),levelTitleHorizontalAlignment:new EnumerationReader(enums.a3,!1,defaultConfig.levelTitleHorizontalAlignment),levelTitleFontSize:new ValueReader(["string"],!1,defaultConfig.levelTitleFontSize),levelTitleFontFamily:new ValueReader(["string"],!1,defaultConfig.levelTitleFontFamily),levelTitleFontColor:new ValueReader(["string"],!1,defaultConfig.levelTitleFontColor),levelTitleColor:new ValueReader(["string"],!1,defaultConfig.levelTitleColor),levelTitleFontWeight:new ValueReader(["string"],!1,defaultConfig.levelTitleFontWeight),levelTitleFontStyle:new ValueReader(["string"],!1,defaultConfig.levelTitleFontStyle),onLevelTitleRender:new FunctionReader,onLevelBackgroundRender:new FunctionReader});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},description:"Level annotation title template options."}}function CombinedContextsTask(task1,task2){return{process:function process(){return!0},getConfig:function getConfig(itemId){return task1.getConfig(itemId)||null!=task2&&task2.getConfig(itemId)}}}function OrgItem(options){var index,len,property;this.id=null,this.isVisible=!0,this.isActive=!0,this.itemType=enums.qG.Regular,this.adviserPlacementType=enums.hZ.Auto,this.childrenPlacementType=enums.X9.Auto,this.placeAdvisersAboveChildren=enums.xB.Auto,this.placeAssistantsAboveChildren=enums.xB.Auto,this.levelOffset=null,this.level=null,this.hideParentConnection=!1,this.hideChildrenConnection=!1,this.childIndex=null;var properties=["id","parent","isVisible","isActive","itemType","adviserPlacementType","childrenPlacementType","placeAdvisersAboveChildren","placeAssistantsAboveChildren","levelOffset"];for(index=0,len=properties.length;index<len;index+=1)property=properties[index],options.hasOwnProperty(property)&&(this[property]=options[property])}function OrgTreeTask(itemsOptionTask){var _data={orgTree:null,maximumId:null};return{process:function process(){return function createOrgTree(items){var orgItem,orgItemRoot,userItem,index,len,parsedId,rootItemConfig,maximumId=0,orgTree=Tree();for(index=0,len=items.length;index<len;index+=1)null!=(userItem=items[index]).id&&(orgItem=new OrgItem(userItem),parsedId=parseInt(userItem.id,10),maximumId=Math.max(isNaN(parsedId)?0:parsedId,maximumId),orgTree.add(userItem.parent,orgItem.id,orgItem));return maximumId+=1,(rootItemConfig=new OrgItemConfig).id=maximumId,rootItemConfig.title="internal root",rootItemConfig.isVisible=!1,rootItemConfig.isActive=!1,(orgItemRoot=new OrgItem(rootItemConfig)).hideParentConnection=!0,orgItemRoot.hideChildrenConnection=!0,orgItemRoot.childrenPlacementType=enums.X9.Horizontal,orgTree.add(null,orgItemRoot.id,orgItemRoot),orgTree.loopLevels(this,(function(nodeid,node,levelid){if(levelid>0)return orgTree.BREAK;orgItemRoot.id!=nodeid&&(orgTree.adopt(orgItemRoot.id,nodeid),node.itemType=enums.qG.Regular)})),function hideRootConnectors(orgTree){orgTree.loopLevels(this,(function(nodeid,node,levelid){var allRegular=!0;return node.isVisible?orgTree.SKIP:(orgTree.loopChildren(this,nodeid,(function(childid,child,index){if(child.itemType!=enums.qG.Regular)return allRegular=!1,!0})),allRegular?(node.hideChildrenConnection=!0,void orgTree.loopChildren(this,nodeid,(function(childid,child,index){child.hideParentConnection=!0}))):orgTree.SKIP)}))}(orgTree),_data.orgTree=orgTree,_data.maximumId=maximumId,!0}(itemsOptionTask.getItems()),!0},getOrgTree:function getOrgTree(){return _data.orgTree},getMaximumId:function getMaximumId(){return _data.maximumId}}}function Template(templateConfig,itemTemplate,highlightTemplate,dotHighlightTemplate,cursorTemplate){this.templateConfig=templateConfig,this.itemTemplate=itemTemplate,this.highlightTemplate=highlightTemplate,this.dotHighlightTemplate=dotHighlightTemplate,this.cursorTemplate=cursorTemplate}function ReadTemplatesTask(templatesOptionTask,defaultTemplates){var _data={templates:{},itemTemplates:[]},_defaultWidgetTemplateName="DefaultWidgetTemplate",_defaultWidgetLabelAnnotationTemplateName="DefaultWidgetLabelAnnotationTemplate";return{process:function process(){var index,len,templateConfig,options=templatesOptionTask.getOptions(),templates=options.templates;for(_data.templates={},_data.itemTemplates=[],templateConfig=new TemplateConfig,_data.templates[_defaultWidgetTemplateName]=new Template(templateConfig,new defaultTemplates.ItemTemplate(options,templateConfig),new defaultTemplates.HighlightTemplate(options,templateConfig),new defaultTemplates.DotHighlightTemplate(options,templateConfig),new defaultTemplates.CursorTemplate(options,templateConfig)),_data.itemTemplates.push(_data.templates[_defaultWidgetTemplateName]),templateConfig=function getLabelAnnotationTemplateConfig(name){var config=new TemplateConfig;return config.name=name,config.isActive=!1,config.itemSize=new Size(100,20),config.minimizedItemSize=new Size(0,0),config.minimizedItemCornerRadius=config.minimizedItemSize.width/2,config}(_defaultWidgetLabelAnnotationTemplateName),_data.templates[_defaultWidgetLabelAnnotationTemplateName]=new Template(templateConfig,new defaultTemplates.LabelAnnotationTemplate,null,new defaultTemplates.DotHighlightTemplate(options,templateConfig),null),index=0,len=templates.length;index<len;index+=1)templateConfig=templates[index],_data.templates[templateConfig.name]=new Template(templateConfig,isNullOrEmpty(templateConfig.itemTemplate)?new defaultTemplates.ItemTemplate(options,templateConfig):new defaultTemplates.UserTemplate(options,templateConfig.itemTemplate,options.onItemRender),isNullOrEmpty(templateConfig.highlightTemplate)?new defaultTemplates.HighlightTemplate(options,templateConfig):new defaultTemplates.UserTemplate(options,templateConfig.highlightTemplate,options.onHighlightRender),new defaultTemplates.DotHighlightTemplate(options,templateConfig),isNullOrEmpty(templateConfig.cursorTemplate)?new defaultTemplates.CursorTemplate(options,templateConfig):new defaultTemplates.UserTemplate(options,templateConfig.cursorTemplate,options.onCursorRender)),_data.itemTemplates.push(_data.templates[templateConfig.name]);return!0},getTemplate:function getTemplate(templateName1,templateName2,templateName3){return _data.templates[templateName1]||_data.templates[templateName2]||_data.templates[templateName3]},getItemTemplates:function getItemTemplates(){return _data.itemTemplates},DefaultWidgetTemplateName:_defaultWidgetTemplateName,DefaultWidgetLabelAnnotationTemplateName:_defaultWidgetLabelAnnotationTemplateName}}function ActiveItemsTask(itemsSizesOptionTask,readTemplatesTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},itemsSizesOptions=itemsSizesOptionTask.getOptions(),items=itemsSizesOptions.items;return _data.items=_dataTemplate.read(_data.items,function collectActiveItems(itemsSizesOptions,items){var index,len,result=[];for(index=0,len=items.length;index<len;index+=1){var itemConfig=items[index],templateConfig=readTemplatesTask.getTemplate(itemConfig.templateName,itemsSizesOptions.defaultTemplateName,readTemplatesTask.DefaultWidgetTemplateName).templateConfig;itemConfig.isActive&&templateConfig.isActive&&result.push(itemConfig.id)}return result}(itemsSizesOptions,items),"items",context),context.isChanged},getActiveItems:function getActiveItems(){return _hash.items}}}function TemplateParams(){this.template=null,this.isActive=!1,this.hasSelectorCheckbox=!1,this.hasButtons=!1,this.hasGroupTitle=!1,this.onButtonsRender=null}function ItemTemplateParamsTask(itemsSizesOptionTask,cursorItemOptionTask,readTemplatesTask){var _data={items:{}};function getSelectionVisibility(isCursor,itemState,widgetState){var result=!1;switch(itemState){case enums.xB.Auto:switch(widgetState){case enums.xB.Auto:result=isCursor;break;case enums.xB.True:result=!0;break;case enums.xB.False:result=!1}break;case enums.xB.True:result=!0;break;case enums.xB.False:result=!1}return result}return{process:function process(){var index,len,itemsSizesOptions=itemsSizesOptionTask.getOptions(),cursorItem=cursorItemOptionTask.getCursorItem(),items=itemsSizesOptions.items;for(_data.items={},index=0,len=items.length;index<len;index+=1){var itemConfig=items[index],templateParams=new TemplateParams,isCursor=cursorItem==itemConfig.id,template=readTemplatesTask.getTemplate(itemConfig.templateName,itemsSizesOptions.defaultTemplateName,readTemplatesTask.DefaultWidgetTemplateName),templateConfig=template.templateConfig,hasButtonsRender=null!=itemsSizesOptions.onButtonsRender||null!=templateConfig.onButtonsRender;templateParams.template=template,templateParams.isActive=itemConfig.isActive&&templateConfig.isActive,templateParams.isActive&&(templateParams.hasSelectorCheckbox=getSelectionVisibility(isCursor,itemConfig.hasSelectorCheckbox,itemsSizesOptions.hasSelectorCheckbox),templateParams.hasButtons=templateConfig.hasButtons!==enums.xB.Auto?templateConfig.hasButtons==enums.xB.True:hasButtonsRender&&getSelectionVisibility(isCursor,itemConfig.hasButtons,itemsSizesOptions.hasButtons),templateParams.hasButtons&&(templateParams.onButtonsRender=templateConfig.onButtonsRender||itemsSizesOptions.onButtonsRender)),templateParams.hasGroupTitle=!isNullOrEmpty(itemConfig.groupTitle),_data.items[itemConfig.id]=templateParams}return!0},getTemplateParams:function getTemplateParams(orgItemId){return _data.items[orgItemId]}}}function GroupTitleTemplateTask(templatesOptionTask,templates){var _data={template:null};return{process:function process(){return _data.template=null,!0},getTemplate:function getTemplate(){var options;if(null==_data.template){options=templatesOptionTask.getOptions();var{onGroupTitleRender:onGroupTitleRender}=options;_data.template=null!=onGroupTitleRender?new templates.CustomRenderTemplate(options,onGroupTitleRender):new templates.GroupTitleTemplate(options)}return _data.template}}}function CheckBoxTemplateTask(itemsSizesOptionTask,templates){var _data={template:null};return{process:function process(){return _data.template=null,!0},getTemplate:function getTemplate(){var options;return null==_data.template&&(options=itemsSizesOptionTask.getOptions(),_data.template=new templates.CheckBoxTemplate(options.selectCheckBoxLabel)),_data.template}}}function ButtonsTemplateTask(itemsSizesOptionTask,templates){var _data={template:null};return{process:function process(){return!1},getTemplate:function getTemplate(){return null==_data.template&&(_data.template=new templates.ButtonsTemplate),_data.template}}}function AnnotationLabelTemplateTask(itemsSizesOptionTask,templates){var _data={template:null};return{process:function process(){return!1},getTemplate:function getTemplate(){return null==_data.template&&(_data.template=new templates.AnnotationLabelTemplate),_data.template}}}function LevelAnnotationTemplateTask(orientationOptionTask,levelTitleTemplateOptionTask,templates){var _data={backgroundTemplate:null,titleTemplate:null};return{process:function process(){return _data.backgroundTemplate=null,_data.titleTemplate=null,!0},getBackgroundTemplate:function getBackgroundTemplate(){var options;if(null==_data.backgroundTemplate){options=levelTitleTemplateOptionTask.getOptions();var{onLevelBackgroundRender:onLevelBackgroundRender}=options;_data.backgroundTemplate=null!=onLevelBackgroundRender?new templates.CustomRenderTemplate(options,onLevelBackgroundRender):new templates.LevelBackgroundTemplate(options)}return _data.backgroundTemplate},getTitleTemplate:function getTitleTemplate(){var options;if(null==_data.titleTemplate){var{orientationType:orientation}=orientationOptionTask.getOptions();options=levelTitleTemplateOptionTask.getOptions();var{onLevelTitleRender:onLevelTitleRender}=options;_data.titleTemplate=null!=onLevelTitleRender?new templates.CustomRenderTemplate(options,onLevelTitleRender):new templates.LevelTitleTemplate(options,orientation)}return _data.titleTemplate}}}Point.prototype.scale=function(scale){return this.x=this.x*scale,this.y=this.y*scale,this},Point.prototype.distanceTo=function(arg0,arg1){var a,b,x2=0,y2=0;switch(arguments.length){case 1:x2=arg0.x,y2=arg0.y;break;case 2:x2=arg0,y2=arg1}return a=this.x-x2,b=this.y-y2,Math.sqrt(a*a+b*b)},Point.prototype.equalTo=function(point){return this.x==point.x&&this.y==point.y},Point.prototype.swap=function(point){var x=point.x,y=point.y;point.x=this.x,point.y=this.y,this.x=x,this.y=y},Point.prototype.clone=function(){return new Point(this)},Point.prototype.toString=function(units){var result="";return units=void 0!==units?units:"px",result+="left:"+this.x+units+";",result+="top:"+this.y+units+";"},Point.prototype.getCSS=function(units){return units=void 0!==units?units:"px",{left:this.x+units,top:this.y+units}},Matrix.prototype.determinant=function(){return this.a1*this.b2-this.b1*this.a2},Vector.prototype.isNull=function(){return this.from.x==this.to&&this.from.y==this.to.y},Vector.prototype.length=function(){return this.from.distanceTo(this.to)},Vector.prototype.equalTo=function(vector){return this.from.equalTo(vector.from)&&this.to.equalTo(vector.to)},Vector.prototype.getMiddlePoint=function(){return new Point((this.from.x+this.to.x)/2,(this.from.y+this.to.y)/2)},Vector.prototype.relateTo=function(vector){var result=enums.ZU.None,x1=this.to.x-this.from.x,y1=this.to.y-this.from.y,x2=vector.to.x-vector.from.x,y2=vector.to.y-vector.from.y;switch((x1?8:0)+(y1?4:0)+(x2?2:0)+(y2?1:0)){case 0:case 1:case 2:case 3:case 4:case 8:case 12:result=enums.ZU.Null;break;case 5:result=y1*y2>0?enums.ZU.Collinear:enums.ZU.Opposite;break;case 10:result=x1*x2>0?enums.ZU.Collinear:enums.ZU.Opposite;break;case 15:x1/x2==y1/y2&&(result=x1/x2>0?enums.ZU.Collinear:enums.ZU.Opposite)}return result},Vector.prototype.offset=function(offset){var length=this.length(),x=(this.to.y-this.from.y)*offset/length,y=-(this.to.x-this.from.x)*offset/length;this.from.x+=x,this.from.y+=y,this.to.x+=x,this.to.y+=y},Vector.prototype.getLine=function(){var x1=this.from.x,y1=this.from.y,x2=this.to.x,y2=this.to.y;return[y2-y1,x1-x2,x1*(y1-y2)+y1*(x2-x1)]},Vector.prototype.getLineKey=function(){var line=this.getLine(),a=line[0],b=line[1],c=line[2],r=1e4;return(line=0!==b?[Math.floor(a/b*r),1,Math.floor(c/b*r)]:[1,0,Math.floor(c/a*r)]).toString()},Vector.prototype.intersect=function(vector){var x,y,v1=this.getLine(),v2=vector.getLine(),d=new Matrix(v1[0],v1[1],v2[0],v2[1]).determinant(),result=!1;return 0!==d&&(x=new Matrix(-v1[2],v1[1],-v2[2],v2[1]).determinant()/d,y=new Matrix(v1[0],-v1[2],v2[0],-v2[2]).determinant()/d,vector.to.x=x,vector.to.y=y,this.from.x=x,this.from.y=y,result=!0),result},Vector.prototype.getIntersectionPoint=function(vector,strict,rounding){var x,y,v1=this.getLine(),v2=vector.getLine(),d=new Matrix(v1[0],v1[1],v2[0],v2[1]).determinant(),result=null;return 0!==d&&(x=new Matrix(-v1[2],v1[1],-v2[2],v2[1]).determinant()/d,y=new Matrix(v1[0],-v1[2],v2[0],-v2[2]).determinant()/d,strict?vector._contains(x,y,rounding)&&this._contains(x,y,rounding)&&(result=new Point(x,y)):result=new Point(x,y)),result},Vector.prototype._contains=function(x,y,rounding){var x1=Math.min(this.from.x,this.to.x),y1=Math.min(this.from.y,this.to.y),x2=Math.max(this.from.x,this.to.x),y2=Math.max(this.from.y,this.to.y);return x1-rounding<=x&&x<=x2+rounding&&y1-rounding<=y&&y<=y2+rounding},Interval.prototype.width=function(){return this.to-this.from},Interval.prototype.equalTo=function(interval){return this.from==interval.from&&this.to==interval.to},Interval.prototype.clone=function(){return new Interval(this)},Interval.prototype.toString=function(){return this.from+", "+this.to},Interval.prototype.overlaps=function(interval){var result=!0;return(this.to<interval.from||interval.to<this.from)&&(result=!1),result},Rect.prototype.left=function(){return this.x},Rect.prototype.top=function(){return this.y},Rect.prototype.right=function(){return this.x+this.width},Rect.prototype.bottom=function(){return this.y+this.height},Rect.prototype.verticalCenter=function(){return this.y+this.height/2},Rect.prototype.horizontalCenter=function(){return this.x+this.width/2},Rect.prototype.centerPoint=function(){return new Point(this.horizontalCenter(),this.verticalCenter())},Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||this.width<0||this.height<0},Rect.prototype.offset=function(arg0,arg1,arg2,arg3){switch(arguments.length){case 1:null!==arg0&&"object"==typeof arg0?(this.x=this.x-arg0.left,this.y=this.y-arg0.top,this.width=this.width+arg0.left+arg0.right,this.height=this.height+arg0.top+arg0.bottom):(this.x=this.x-arg0,this.y=this.y-arg0,this.width=this.width+2*arg0,this.height=this.height+2*arg0);break;case 4:this.x=this.x-arg0,this.y=this.y-arg1,this.width=this.width+arg0+arg2,this.height=this.height+arg1+arg3}return this},Rect.prototype.scale=function(scale){return this.x=this.x*scale,this.y=this.y*scale,this.width=this.width*scale,this.height=this.height*scale,this},Rect.prototype.translate=function(x,y){return this.x=this.x+x,this.y=this.y+y,this},Rect.prototype.invert=function(){var width=this.width,x=this.x;return this.width=this.height,this.height=width,this.x=this.y,this.y=x,this},Rect.prototype.loopEdges=function(callback){var vertexes=[new Point(this.left(),this.top()),new Point(this.right(),this.top()),new Point(this.right(),this.bottom()),new Point(this.left(),this.bottom())],placements=[enums.TK.Top,enums.TK.Right,enums.TK.Bottom,enums.TK.Left];if(vertexes.push(vertexes[0]),null!=callback)for(var index=1,len=vertexes.length;index<len&&!callback(new Vector(vertexes[index-1],vertexes[index]),placements[index-1]);index+=1);return this},Rect.prototype.contains=function(arg0,arg1){switch(arguments.length){case 1:return this.x<=arg0.x&&arg0.x<=this.x+this.width&&this.y<=arg0.y&&arg0.y<=this.y+this.height;case 2:return this.x<=arg0&&arg0<=this.x+this.width&&this.y<=arg1&&arg1<=this.y+this.height;default:return!1}},Rect.prototype.cropByRect=function(rect){return this.x<rect.x&&(this.width-=rect.x-this.x,this.x=rect.x),this.right()>rect.right()&&(this.width-=this.right()-rect.right()),this.y<rect.y&&(this.height-=rect.y-this.y,this.y=rect.y),this.bottom()>rect.bottom()&&(this.height-=this.bottom()-rect.bottom()),this.isEmpty()&&(this.x=null,this.y=null,this.width=null,this.height=null),this},Rect.prototype.overlaps=function(rect){var result=!0;return(this.x+this.width<rect.x||rect.x+rect.width<this.x||this.y+this.height<rect.y||rect.y+rect.height<this.y)&&(result=!1),result},Rect.prototype.addRect=function(arg0,arg1,arg2,arg3){var right,bottom;switch(arguments.length){case 1:arg0.isEmpty()||(this.isEmpty()?(this.x=arg0.x,this.y=arg0.y,this.width=arg0.width,this.height=arg0.height):(right=Math.max(this.right(),arg0.right()),bottom=Math.max(this.bottom(),arg0.bottom()),this.x=Math.min(this.x,arg0.x),this.y=Math.min(this.y,arg0.y),this.width=right-this.x,this.height=bottom-this.y));break;case 2:this.isEmpty()?(this.x=arg0,this.y=arg1,this.width=0,this.height=0):(right=Math.max(this.right(),arg0),bottom=Math.max(this.bottom(),arg1),this.x=Math.min(this.x,arg0),this.y=Math.min(this.y,arg1),this.width=right-this.x,this.height=bottom-this.y);break;case 4:this.isEmpty()?(this.x=arg0,this.y=arg1,this.width=arg2,this.height=arg3):(right=Math.max(this.right(),arg0+arg2),bottom=Math.max(this.bottom(),arg1+arg3),this.x=Math.min(this.x,arg0),this.y=Math.min(this.y,arg1),this.width=right-this.x,this.height=bottom-this.y)}return this},Rect.prototype.getCSS=function(units){return units=void 0!==units?units:"px",{left:this.x+units,top:this.y+units,width:this.width+units,height:this.height+units}},Rect.prototype.toString=function(units){var result="";return units=void 0!==units?units:"px",result+="left:"+this.x+units+";",result+="top:"+this.y+units+";",result+="width:"+this.width+units+";",result+="height:"+this.height+units+";"},Rect.prototype.validate=function(){if(isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height))throw"Invalid rect position."},Rect.prototype.equalTo=function(rect){return this.x==rect.x&&this.y==rect.y&&this.width==rect.width&&this.height==rect.height},Rect.prototype.getProjectionPoint=function(point){var result=null;if(!this.contains(point)){var vector=new Vector(this.centerPoint(),point);this.loopEdges((function(edge){return null!=(result=vector.getIntersectionPoint(edge,!0,1))}))}return result},Rect.prototype.verticalInterval=function(){return new Interval(this.y,this.bottom())},Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom},Thickness.prototype.isPositive=function(){return this.left>0||this.top>0||this.right>0||this.bottom>0},Thickness.prototype.isNegative=function(){return this.left<0||this.top<0||this.right<0||this.bottom<0},Thickness.prototype.maxThickness=function(thickness){return this.left=Math.max(this.left,thickness.left),this.top=Math.max(this.top,thickness.top),this.right=Math.max(this.right,thickness.right),this.bottom=Math.max(this.bottom,thickness.bottom),this},Thickness.prototype.addThickness=function(arg0,arg1,arg2,arg3){switch(arguments.length){case 1:null!==arg0&&"object"==typeof arg0?(this.left+=arg0.left,this.top+=arg0.top,this.right+=arg0.right,this.bottom+=arg0.bottom):(this.left+=arg0,this.top+=arg0,this.right+=arg0,this.bottom+=arg0);break;case 4:this.left+=arg0,this.top+=arg1,this.right+=arg2,this.bottom+=arg3}return this},Thickness.prototype.scale=function(scale){return this.left=this.left*scale,this.top=this.top*scale,this.right=this.right*scale,this.bottom=this.bottom*scale,this},Thickness.prototype.toString=function(units){return units=void 0!==units?units:"px",this.top+units+" "+this.right+units+" "+this.bottom+units+" "+this.left+units},ArrayReader.prototype.read=function(target,source,path,context){var hash,sequence,item,itemid,index,len,newHashObject,result=[],resultHash={},resultSequence={},sourceHash={},sequencePath=path+"-seq";for(source&&Array.isArray(source)||(source=[]),hash=context.hash.hasOwnProperty(path)?context.hash[path]:{},sequence=context.hash.hasOwnProperty(sequencePath)?context.hash[sequencePath]:{},index=0,len=source.length;index<len;index+=1)item=source[index],itemid=this.containsUniqueItems?this.containsPrimitiveValues?item:item[this.uniquePropertyKey]:index,resultHash.hasOwnProperty(itemid)||(newHashObject=this.itemTemplate.read(hash.hasOwnProperty(itemid)?hash[itemid]:{},item,path+"-"+index,context),result.push(newHashObject),resultHash[itemid]=newHashObject,resultSequence[index]=itemid,this.createSourceHash&&(sourceHash[itemid]=item),this.isOrdered&&sequence[index]!=resultSequence[index]&&(context.isChanged=!0));return context.hash[path]=resultHash,context.hash[sequencePath]=resultSequence,this.createSourceHash&&(context.sourceHash[path]=sourceHash),null!=target&&target.length==result.length||(context.isChanged=!0),result},ValueReader.prototype.stringify=function(target){if(1==this.hash.object){var processed=[];return JSON.stringify(target,(function(key,value){return"_"===key[0]?null:null!==value&&"object"==typeof value?-1==processed.indexOf(value)?(processed.push(value),value):null:value}))}return target},ValueReader.prototype.read=function(target,source,path,context){var result;return null!=source&&this.hash.hasOwnProperty(typeof source)||(source=this.isNullable?null:this.defaultValue),result=source,this.stringify(target)!==this.stringify(source)&&(context.isChanged=!0),result},ObjectReader.prototype.read=function(target,source,path,context){var property,propertyDataTemplate,result=null,isTargetObject=isObject(target);if(source||(source=this.isNullable?null:this.defaultValue),isObject(source))for(property in result={},this.dataTemplate)this.dataTemplate.hasOwnProperty(property)&&(propertyDataTemplate=this.dataTemplate[property],result[property]=propertyDataTemplate.read(isTargetObject?target[property]:null,source[property],path+"-"+property,context));else result=source,target!==source&&(context.isChanged=!0);return result},EnumerationReader.prototype.read=function(target,source,path,context){var result;return null!=source&&this.hash.hasOwnProperty(source)||(source=this.isNullable?null:this.defaultValue),result=source,target!==source&&(context.isChanged=!0),result},FunctionReader.prototype.read=function(target,source,path,context){return"function"==typeof source?source:null};var GroupType={Items:0,Assistants:1,RowChildren:2,Children:3},RowType={Items:0,Advisers:1,SubAdvisers:2,Assistants:3,SubAssistants:4,RowChildren:5,Children:6},RowTypeToGroupTypeMap={};function Row(id){this.id=id,this.rowType=RowType.Items,this.index=0,this.offset=0,this.extend=!0,this.depth=0,this.groups=[],this.groups[GroupType.Items]=[[1,1]],this.getDepth=function(){var[currExtend,currDepth]=this.groups.reduce(((acc,row)=>row.reduce((([currExtend,currDepth],item)=>{var[extend,depth]=item||[1,1];return[currExtend+extend,Math.max(currDepth,currExtend+depth)]}),acc)),[0,0]);return Math.max(currExtend,currDepth)||1},this.addRowDepth=function(rowType,extend,index,depth){var groupIndex=RowTypeToGroupTypeMap[rowType];this.groups[groupIndex]||(this.groups[groupIndex]=[]);var rows=this.groups[groupIndex],[currExtend,currDepth]=rows[index]||[1,1];rows[index]=[Math.max(currExtend,extend?depth:1),Math.max(currDepth,depth)]}}RowTypeToGroupTypeMap[RowType.Items]=GroupType.Items,RowTypeToGroupTypeMap[RowType.Advisers]=GroupType.Items,RowTypeToGroupTypeMap[RowType.SubAdvisers]=GroupType.Items,RowTypeToGroupTypeMap[RowType.Assistants]=GroupType.Assistants,RowTypeToGroupTypeMap[RowType.SubAssistants]=GroupType.Assistants,RowTypeToGroupTypeMap[RowType.RowChildren]=GroupType.RowChildren,RowTypeToGroupTypeMap[RowType.Children]=GroupType.Children;var visualTreeBuilder_BranchAligner=function BranchAligner(){var _rowsTree=Tree(),_rowKeyGenerator=function RowKeyGenerator(){var _rowsHash={},_rowIndex=1;return{find:function find(parentId,rowType,index){var key=parentId+"-"+rowType+"-"+index;return _rowsHash.hasOwnProperty(key)||(_rowsHash[key]=_rowIndex,_rowIndex+=1),_rowsHash[key]},get:function get(){var result=_rowIndex;return _rowIndex+=1,result}}}(),_rowHash={};function _createParentRow(parentNodeId){var parentRowId=_rowKeyGenerator.find(null,RowType.Children,0),parentRow=new Row(parentRowId);return parentRow.rowType=RowType.Items,parentRow.index=0,parentRow.offset=0,parentRow.extend=!1,_rowsTree.add(null,parentRowId,parentRow),_rowHash[parentNodeId]=parentRowId,parentRowId}function _add(parentRowId,rowId,nodes,rowType,index,offset,extendChildren){var row=_rowsTree.node(rowId);row||((row=new Row(rowId)).extend=extendChildren,row.index=index||0,row.offset=offset||0,row.rowType=rowType,_rowsTree.add(parentRowId,rowId,row)),nodes.forEach((child=>{_rowHash[child.id]=rowId}))}return{mergeToParent:function mergeToParent(parentNodeId,nodes){var parentRowId=_rowHash[parentNodeId]||_createParentRow(parentNodeId);nodes.forEach((child=>{_rowHash[child.id]=parentRowId}))},mergeToChild:function mergeToChild(parentNodeId,nodes,rowType,index,offset,extendChildren){var parentRowId=_rowHash[parentNodeId]||_createParentRow(parentNodeId);_add(parentRowId,_rowKeyGenerator.find(parentRowId,rowType,index),nodes,rowType,index,offset,extendChildren)},addChild:function addChild(parentNodeId,nodes,rowType,index,offset,extendChildren){_add(_rowHash[parentNodeId]||_createParentRow(parentNodeId),_rowKeyGenerator.get(),nodes,rowType,index,offset,extendChildren)},addSplitChildren:function addSplitChildren(parentNodeId,nodes,rowType,index,offset){var parentRowId=_rowHash[parentNodeId]||_createParentRow(parentNodeId);nodes.forEach((child=>{var rowId=_rowKeyGenerator.get(),row=new Row(rowId);row.extend=!1,row.index=index||0,row.offset=offset||0,row.rowType=rowType,_rowsTree.add(parentRowId,rowId,row),_rowHash[child.id]=rowId}))},align:function align(debug){_rowsTree.loopPostOrder(this,(function(rowId,row,parentRowId,parentRow){row.depth=row.getDepth()+row.offset,null!=parentRow&&parentRow.addRowDepth(row.rowType,row.extend,row.index,row.depth)}))},loopGroupTypes:function loopGroupTypes(thisArg,nodeId,onGroupType){var rowId=_rowHash[nodeId],row=_rowsTree.node(rowId);if(row)for(var index=0,len=row.groups.length;index<len&&(!row.groups[index]||!onGroupType.call(thisArg,index,len));index+=1);},getRowDepth:function getRowDepth(nodeId,groupType,index){var rowId=_rowHash[nodeId],childRow=(_rowsTree.node(rowId).groups[groupType]||[])[index];return childRow&&childRow[0]||1},getRowsDepth:function getRowsDepth(nodeId,groupType){var rowId=_rowHash[nodeId];return(_rowsTree.node(rowId).groups[groupType]||[]).map((item=>item[0]))},loopRows:function loopRows(thisArg,nodeId,rowType,onRow){for(var rowId=_rowHash[nodeId],row=_rowsTree.node(rowId),groupIndex=RowTypeToGroupTypeMap[rowType],children=row.groups[groupIndex]||[],index=0;index<children.length;index+=1){var childRow=children[index];if(childRow&&onRow.call(thisArg,childRow[0],index))break}},getGroupSize:function getGroupSize(nodeId,groupType){var rowId=_rowHash[nodeId],row=_rowsTree.node(rowId);return row&&row.groups.hasOwnProperty(groupType)?row.groups[groupType].length:0}}};function TreeItem(){this.id=null,this.visualAggregatorId=null,this.partners=[],this.visibility=enums.EE.Normal,this.actualItemType=null,this.connectorPlacement=0,this.gravity=0,this.relationDegree=0}var visualTreeBuilder_NodeTypeSorter=function NodeTypeSorter(){var _rows=[];return{addChild:function addChild(itemType,levelOffset,orgItem){switch(itemType){case enums.qG.SubAssistant:case enums.qG.Assistant:levelOffset=levelOffset<0||null==levelOffset?0:levelOffset;break;default:levelOffset=0}_rows[itemType]=_rows[itemType]||[];var groups=_rows[itemType];groups[levelOffset]=groups[levelOffset]||[],groups[levelOffset].push(orgItem)},getRow:function getRow(itemType,index){return(_rows[itemType]||[])[index||0]||[]},getRows:function getRows(itemType){return _rows[itemType]||[]}}};var visualTreeBuilder_NodeGroupSorter=function NodeGroupSorter(){var _rows=[];function _addChild(groupType,index,orgItem){_rows[groupType]=_rows[groupType]||[];var groups=_rows[groupType];groups[index]=groups[index]||[],groups[index].push(orgItem)}return{addChild:function addChild(itemType,index,orgItem){switch(itemType){case enums.qG.SubAdviser:case enums.qG.Adviser:_addChild(GroupType.Items,0,orgItem);break;case enums.qG.SubAssistant:case enums.qG.Assistant:index=index<0||null==index?0:index,_addChild(GroupType.Assistants,index,orgItem);break;case enums.qG.Regular:index<0||null==index?_addChild(GroupType.Children,0,orgItem):_addChild(GroupType.RowChildren,index,orgItem)}},getLength:function getLength(){return _rows.length},getRow:function getRow(groupType,index){return(_rows[groupType]||[])[index||0]||[]},getRows:function getRows(groupType){return _rows[groupType]||[]}}};function NodeProps(){this.hasVisibleChildren=!1,this.hasPartners=!1,this.isPartner=!1,this.hasLeavesOnly=!0,this.hasChildren=!1,this.typeSorter=visualTreeBuilder_NodeTypeSorter(),this.groupSorter=visualTreeBuilder_NodeGroupSorter()}function VisualTreeBuilder(){var _treeItemCounter;function getMatrixItem(items,x,y,width){var index;return width%2>0&&(x===width-1?x=items.length:x===width&&(x=width-1)),(index=y*width+x)>items.length-1?null:items[index]}function createNewVisualAggregator(visualTree,treeItem,hideChildrenConnector){var newAggregatorItem,hideParentConnector=treeItem.visibility==enums.EE.Invisible&&0==(treeItem.connectorPlacement&enums.En.Top)||hideChildrenConnector;return newAggregatorItem=getNewTreeItem({visibility:enums.EE.Invisible,visualAggregatorId:treeItem.visualAggregatorId,connectorPlacement:hideParentConnector?0:enums.En.Top|enums.En.Bottom}),visualTree.insert(treeItem.id,newAggregatorItem.id,newAggregatorItem),treeItem.visualAggregatorId=newAggregatorItem.id,newAggregatorItem}function getNewTreeItem(properties,orgItem){var optionKey,result=new TreeItem;for(optionKey in null!=orgItem&&(result.actualItemType=orgItem.itemType,result.adviserPlacementType=orgItem.adviserPlacementType),properties)properties.hasOwnProperty(optionKey)&&(result[optionKey]=properties[optionKey]);return null!=orgItem?(result.id=orgItem.id,result.visibility=orgItem.isVisible?enums.EE.Auto:enums.EE.Invisible):(_treeItemCounter+=1,result.id=_treeItemCounter),result}return{build:function build(orgTree,maximumId,activeItems,options){_treeItemCounter=maximumId,activeItems;var{visualTree:visualTree,navigationFamily:navigationFamily,branchAligner:branchAligner}=function createVisualTreeItems(orgTree,options,activeItems){var index,leftSiblingOffset,rightSiblingOffset,orgTreeProps={},visualTree=Tree(),navigationFamily=function NavigationalFamily(activeItems){var _activeItems=activeItems,_navigationFamily=Family();return{define:function define(parentItem,treeItem,skipFirstParent){var parents=[];!skipFirstParent&&parentItem.isVisible&&_activeItems.hasOwnProperty(parentItem.id)?parents.push(parentItem.id):(!skipFirstParent&&parentItem.isVisible&&parents.push(parentItem.id),_navigationFamily.loopParents(this,parentItem.id,(function(parentId,parent,level){if(parent.isVisible&&(parents.push(parentId),_activeItems.hasOwnProperty(parentId)))return _navigationFamily.SKIP}))),null!=_navigationFamily.node(treeItem.id)?_navigationFamily.adopt(parents,treeItem.id):_navigationFamily.add(parents,treeItem.id,treeItem)},getFamily:function getFamily(){return _navigationFamily}}}(activeItems);orgTree.loopPostOrder(this,(function(nodeId,node,parentId,parent){orgTreeProps.hasOwnProperty(nodeId)||(orgTreeProps[nodeId]=new NodeProps);var nodeProps=orgTreeProps[nodeId];if(nodeProps.actualItemType=node.itemType,null!=parent){orgTreeProps.hasOwnProperty(parentId)||(orgTreeProps[parentId]=new NodeProps);var parentProps=orgTreeProps[parentId];parentProps.hasVisibleChildren=parentProps.hasVisibleChildren||node.isVisible||nodeProps.hasVisibleChildren,parentProps.hasChildren=!0,parentProps.hasLeavesOnly=parentProps.hasLeavesOnly&&!nodeProps.hasChildren}})),orgTree.loopPreOrder(this,(function(nodeId,node,parentId,parent){var nodeProps=orgTreeProps[nodeId],parentProps=orgTreeProps[parentId];switch(parentProps||((parentProps=new NodeProps).actualItemType=enums.qG.Regular,orgTreeProps[parentId]=parentProps),nodeProps.actualItemType){case enums.qG.LimitedPartner:case enums.qG.AdviserPartner:case enums.qG.GeneralPartner:parentProps.isPartner?nodeProps.actualItemType=enums.qG.Adviser:(nodeProps.isPartner=!0,parentProps.hasPartners=!0);break;case enums.qG.Regular:parentProps.isPartner&&(nodeProps.actualItemType=enums.qG.Assistant)}}));var branchAligner=visualTreeBuilder_BranchAligner();orgTree.loopLevels(this,(function(parentOrgItemId,parentOrgItem,levelid){var parentProps=orgTreeProps[parentOrgItemId];if(!parentProps.hasVisibleChildren)return orgTree.SKIP;orgTree.loopChildren(this,parentOrgItemId,(function(orgItemId,orgItem,index){var treeItemProps=orgTreeProps[orgItemId];parentProps.typeSorter.addChild(treeItemProps.actualItemType,orgItem.levelOffset,orgItem),parentProps.groupSorter.addChild(treeItemProps.actualItemType,orgItem.levelOffset,orgItem)}));var partners=[];parentProps.hasPartners&&(partners=[...parentProps.typeSorter.getRow(enums.qG.AdviserPartner),...parentProps.typeSorter.getRow(enums.qG.LimitedPartner),...parentProps.typeSorter.getRow(enums.qG.GeneralPartner)]);var advisers=parentProps.typeSorter.getRow(enums.qG.Adviser);if(advisers.length>0){if(!(extendChildren=partners.length>0))switch(parentOrgItem.placeAdvisersAboveChildren){case enums.xB.Auto:extendChildren=options.placeAdvisersAboveChildren;break;case enums.xB.True:extendChildren=!0}options.alignBranches?(parentProps.isPartner&&(extendChildren=!0),extendChildren?branchAligner.mergeToChild(parentOrgItemId,advisers,RowType.Advisers,0,0,extendChildren):branchAligner.mergeToParent(parentOrgItemId,advisers)):branchAligner.addChild(parentOrgItemId,advisers,RowType.Advisers,0,0,extendChildren)}var subAdvisers=parentProps.typeSorter.getRow(enums.qG.SubAdviser);if(subAdvisers.length>0){if(!(extendChildren=partners.length>0))switch(parentOrgItem.placeAdvisersAboveChildren){case enums.xB.Auto:extendChildren=options.placeAdvisersAboveChildren;break;case enums.xB.True:extendChildren=!0}options.alignBranches?(parentProps.isPartner&&(extendChildren=!0),branchAligner.mergeToChild(parentOrgItemId,subAdvisers,RowType.SubAdvisers,0,1,extendChildren)):branchAligner.addChild(parentOrgItemId,subAdvisers,RowType.SubAdvisers,0,1,extendChildren)}var assistants=parentProps.typeSorter.getRows(enums.qG.Assistant);if(assistants.length>0){if(!(extendChildren=partners.length>0))switch(parentOrgItem.placeAssistantsAboveChildren){case enums.xB.Auto:extendChildren=options.placeAssistantsAboveChildren;break;case enums.xB.True:extendChildren=!0}assistants.forEach(((nodes,index)=>{options.alignBranches?branchAligner.mergeToChild(parentOrgItemId,nodes,RowType.Assistants,index,0,extendChildren):branchAligner.addChild(parentOrgItemId,nodes,RowType.Assistants,index,0,extendChildren)}))}var subAssistants=parentProps.typeSorter.getRows(enums.qG.SubAssistant);if(subAssistants.length>0){var extendChildren;if(!(extendChildren=partners.length>0))switch(parentOrgItem.placeAssistantsAboveChildren){case enums.xB.Auto:extendChildren=options.placeAssistantsAboveChildren;break;case enums.xB.True:extendChildren=!0}subAssistants.forEach(((nodes,index)=>{options.alignBranches?branchAligner.mergeToChild(parentOrgItemId,nodes,RowType.SubAssistants,index,1,extendChildren):branchAligner.addChild(parentOrgItemId,nodes,RowType.SubAssistants,index,1,extendChildren)}))}partners.length>0&&branchAligner.mergeToParent(parentOrgItemId,partners);var rowChildren=parentProps.groupSorter.getRows(GroupType.RowChildren);rowChildren.length>0&&rowChildren.forEach(((nodes,index)=>{options.alignBranches?branchAligner.mergeToChild(parentOrgItemId,nodes,RowType.RowChildren,index,0,!0):branchAligner.addChild(parentOrgItemId,nodes,RowType.RowChildren,index,0,!0)}));var children=parentProps.groupSorter.getRow(GroupType.Children);if(children.length>0){var props=orgTreeProps[parentOrgItemId],childrenRows=function getRegularChildrenRows(options,regularChildren,childrenPlacementType,hasLeavesOnly){var results=[];childrenPlacementType===enums.X9.Auto&&(childrenPlacementType=hasLeavesOnly?options.leavesPlacementType===enums.X9.Auto?enums.X9.Matrix:options.leavesPlacementType:options.childrenPlacementType===enums.X9.Auto?enums.X9.Horizontal:options.childrenPlacementType);childrenPlacementType==enums.X9.Matrix&&regularChildren.length<3&&(childrenPlacementType=enums.X9.Horizontal);switch(childrenPlacementType){case enums.X9.Horizontal:results.push(regularChildren);break;case enums.X9.Matrix:for(var width=Math.min(options.maximumColumnsInMatrix,Math.ceil(Math.sqrt(regularChildren.length))),index=0;index<regularChildren.length;index+=width)results.push(regularChildren.slice(index,index+width));break;case enums.X9.Vertical:regularChildren.forEach((childItem=>{results.push([childItem])}))}return results}(options,children,parentOrgItem.childrenPlacementType,props.hasLeavesOnly);childrenRows.forEach(((nodes,index)=>{options.alignBranches?branchAligner.mergeToChild(parentOrgItemId,nodes,RowType.Children,index,0,!0):index==childrenRows.length-1?branchAligner.addSplitChildren(parentOrgItemId,nodes,RowType.Children,index,0):branchAligner.addChild(parentOrgItemId,nodes,RowType.Children,index,0,!0)}))}})),branchAligner.align();var visualPartners={};return orgTree.loopLevels(this,(function(parentOrgItemId,parentOrgItem,levelid){var parentProps=orgTreeProps[parentOrgItemId],logicalParentItem=visualTree.node(parentOrgItemId);logicalParentItem||(logicalParentItem=getNewTreeItem({visibility:enums.EE.Invisible,connectorPlacement:0,parentId:null,actualItemType:enums.qG.Regular},parentOrgItem),visualTree.add(null,parentOrgItemId,logicalParentItem)),leftSiblingOffset=0,rightSiblingOffset=0,null!=(index=visualTree.indexOf(parentOrgItemId))&&(leftSiblingOffset=index,rightSiblingOffset=visualTree.countSiblings(parentOrgItemId)-index-1);var partners=[];parentProps.hasPartners&&(partners=[...parentProps.typeSorter.getRow(enums.qG.AdviserPartner),...parentProps.typeSorter.getRow(enums.qG.LimitedPartner),...parentProps.typeSorter.getRow(enums.qG.GeneralPartner)]);var visualParent=logicalParentItem,visualParent2=null,flagPartners=!0;if(branchAligner.loopGroupTypes(this,parentOrgItemId,(function(groupType,len){if(!parentProps.hasPartners&&!parentProps.isPartner&&groupType>parentProps.groupSorter.getLength()-1)return!0;groupType>GroupType.Assistants&&flagPartners&&(flagPartners=!1,parentProps.hasPartners&&(visualPartners[parentOrgItemId]=[visualParent.id],visualParent=visualParent2||visualParent,visualParent2=null,visualParent.partners=visualPartners[parentOrgItemId]),parentProps.isPartner&&visualPartners[parentOrgItem.parent].push(visualParent.id));var fillEmptyLevels=(parentProps.isPartner||parentProps.hasPartners)&&groupType<=GroupType.Assistants;fillEmptyLevels=fillEmptyLevels||groupType<parentProps.groupSorter.getLength()-1;var rows=[];switch(groupType){case GroupType.Items:var row=parentProps.groupSorter.getRows(GroupType.Items)[0]||[],depth=branchAligner.getRowDepth(parentOrgItemId,GroupType.Items,0);if(function addAdvisers(visualTree,orgTreeProps,parent,advisers,leftSiblingOffset,rightSiblingOffset){advisers.map((adviser=>getNewTreeItem({},adviser))).forEach((item=>{var alteredItem;if(orgTreeProps[item.id].actualItemType===enums.qG.SubAdviser)item.connectorPlacement=enums.En.Top|enums.En.Bottom,alteredItem=getNewTreeItem({visibility:enums.EE.Invisible}),visualTree.add(alteredItem.id,item.id,item);else alteredItem=item;var visualParent=visualTree.parent(parent.id);if(parent.connectorPlacement&enums.En.Right)visualTree.add(visualParent.id,alteredItem.id,alteredItem,leftSiblingOffset),alteredItem.connectorPlacement=enums.En.Right|enums.En.Bottom,alteredItem.gravity=enums.a3.Right;else if(parent.connectorPlacement&enums.En.Left)visualTree.add(visualParent.id,alteredItem.id,alteredItem,visualTree.countChildren(visualParent.id)-rightSiblingOffset),alteredItem.connectorPlacement=enums.En.Left|enums.En.Bottom,alteredItem.gravity=enums.a3.Left;else{if(item.adviserPlacementType===enums.hZ.Left)visualTree.add(visualParent.id,alteredItem.id,alteredItem,leftSiblingOffset),alteredItem.connectorPlacement=enums.En.Right|enums.En.Bottom,alteredItem.gravity=enums.a3.Right;else visualTree.add(visualParent.id,alteredItem.id,alteredItem,visualTree.countChildren(visualParent.id)-rightSiblingOffset),alteredItem.connectorPlacement=enums.En.Left|enums.En.Bottom,alteredItem.gravity=enums.a3.Left;switch(item.actualItemType){case enums.qG.GeneralPartner:alteredItem.connectorPlacement=enums.En.Top|enums.En.Bottom;break;case enums.qG.LimitedPartner:alteredItem.connectorPlacement=enums.En.Bottom}}}))}(visualTree,orgTreeProps,visualParent,row,leftSiblingOffset,rightSiblingOffset),row.forEach((item=>navigationFamily.define(parentOrgItem,item))),partners.length>0&&(visualParent2=function addPartners(visualTree,orgTreeProps,parent,partners,leftSiblingOffset,rightSiblingOffset){var leftItems=[],rightItems=[];partners.map((partner=>getNewTreeItem({},partner))).forEach((item=>{var isLeft=!0;if(parent.connectorPlacement&enums.En.Right)isLeft=!0,item.connectorPlacement=enums.En.Right|enums.En.Bottom;else if(parent.connectorPlacement&enums.En.Left)isLeft=!1,item.connectorPlacement=enums.En.Left|enums.En.Bottom;else{if(item.adviserPlacementType===enums.hZ.Left)isLeft=!0,item.connectorPlacement=enums.En.Right|enums.En.Bottom;else isLeft=!1,item.connectorPlacement=enums.En.Left|enums.En.Bottom;switch(orgTreeProps[item.id].actualItemType){case enums.qG.GeneralPartner:item.connectorPlacement=enums.En.Top|enums.En.Bottom;break;case enums.qG.LimitedPartner:item.connectorPlacement=enums.En.Bottom}}isLeft?leftItems.unshift(item):rightItems.push(item)}));partners=[...leftItems,parent,...rightItems];var parentIndex=leftItems.length,centerIndex=Math.floor(partners.length/2),invisiblePartner=null;partners.length%2==0&&(invisiblePartner=getNewTreeItem({visibility:enums.EE.Invisible}),partners.splice(centerIndex,0,invisiblePartner),centerIndex<=parentIndex&&(parentIndex+=1));for(var visualParent=visualTree.parent(parent.id),index=parentIndex-1;index>=0;index-=1){var item=partners[index];visualTree.add(visualParent.id,item.id,item,leftSiblingOffset),item.gravity=enums.a3.Right}for(index=parentIndex+1;index<partners.length;index+=1){item=partners[index];visualTree.add(visualParent.id,item.id,item,visualTree.countChildren(visualParent.id)-rightSiblingOffset),item.gravity=enums.a3.Left}if(null!=invisiblePartner){var mimicPartner=null;mimicPartner=centerIndex<=parentIndex?partners[centerIndex-1]:partners[centerIndex+1],invisiblePartner.connectorPlacement=mimicPartner.connectorPlacement&(enums.En.Left|enums.En.Right)}var centerPartner=partners[centerIndex];return centerPartner}(visualTree,orgTreeProps,visualParent,partners,leftSiblingOffset,rightSiblingOffset),partners.forEach((partner=>{(navigationFamily.define(parentOrgItem,partner,!0),partner.id!=logicalParentItem.id)&&(parentProps.groupSorter.getRows(GroupType.RowChildren).forEach((row=>row.forEach((child=>navigationFamily.define(partner,child))))),parentProps.groupSorter.getRow(GroupType.Children).forEach((child=>navigationFamily.define(partner,child))))}))),parentProps.hasPartners||parentProps.isPartner||groupType<parentProps.groupSorter.getLength()-1)for(;depth>1;)visualParent=createNewVisualAggregator(visualTree,visualParent,!1),visualParent2&&(visualParent2=createNewVisualAggregator(visualTree,visualParent2,!1)),depth-=1;break;case GroupType.Assistants:rows=parentProps.groupSorter.getRows(GroupType.Assistants);branchAligner.loopRows(this,parentOrgItemId,RowType.Assistants,(function(depth,rowIndex){var row=rows[rowIndex]||[];if(!fillEmptyLevels&&rowIndex>rows.length-1)return!0;if(visualParent=function addAssistants(visualTree,orgTreeProps,visualParent,assistants){var nextVisualParent=createNewVisualAggregator(visualTree,visualParent,!1);return assistants.map((assistant=>getNewTreeItem({},assistant))).forEach((item=>{var alteredItem;switch(orgTreeProps[item.id].actualItemType){case enums.qG.SubAssistant:item.connectorPlacement=enums.En.Top|enums.En.Bottom,alteredItem=getNewTreeItem({visibility:enums.EE.Invisible}),visualTree.add(alteredItem.id,item.id,item);break;case enums.qG.Assistant:alteredItem=item}if(item.adviserPlacementType===enums.hZ.Left)visualTree.add(visualParent.id,alteredItem.id,alteredItem,0),alteredItem.connectorPlacement=enums.En.Right|enums.En.Bottom,alteredItem.gravity=enums.a3.Right;else visualTree.add(visualParent.id,alteredItem.id,alteredItem),alteredItem.connectorPlacement=enums.En.Left|enums.En.Bottom,alteredItem.gravity=enums.a3.Left})),nextVisualParent}(visualTree,orgTreeProps,visualParent,row),visualParent2&&(visualParent2=createNewVisualAggregator(visualTree,visualParent2,!1)),row.forEach((item=>navigationFamily.define(parentOrgItem,item))),parentProps.hasPartners||parentProps.isPartner||rowIndex<rows.length-1||groupType<parentProps.groupSorter.getLength()-1)for(;depth>1;)visualParent=createNewVisualAggregator(visualTree,visualParent,!1),visualParent2&&(visualParent2=createNewVisualAggregator(visualTree,visualParent2,!1)),depth-=1}));break;case GroupType.RowChildren:rows=parentProps.groupSorter.getRows(GroupType.RowChildren);branchAligner.loopRows(this,parentOrgItemId,RowType.RowChildren,(function(depth,rowIndex){var row=rows[rowIndex]||[];if(!fillEmptyLevels&&rowIndex>rows.length-1)return!0;var hideChildConnector=logicalParentItem.visibility==enums.EE.Invisible&&0===logicalParentItem.connectorPlacement;if(visualParent=function addRowChildren(visualTree,visualParent,rowOfChildren,fillEmptyLevels,hideChildConnector,horizontalAlignment){var nextVisualParent=null;fillEmptyLevels&&(nextVisualParent=createNewVisualAggregator(visualTree,visualParent,hideChildConnector));var medianIndex=0;switch(horizontalAlignment){case enums.a3.Center:medianIndex=Math.ceil(rowOfChildren.length/2)-1;break;case enums.a3.Left:medianIndex=-1;break;case enums.a3.Right:medianIndex=rowOfChildren.length-1}for(var index=medianIndex;index>=0;index-=1){var item=getNewTreeItem({},rowOfChildren[index]);visualTree.add(visualParent.id,item.id,item,0),item.connectorPlacement=enums.En.Top|enums.En.Bottom,item.gravity=enums.a3.Right}for(index=medianIndex+1;index<rowOfChildren.length;index+=1)item=getNewTreeItem({},rowOfChildren[index]),visualTree.add(visualParent.id,item.id,item),item.connectorPlacement=enums.En.Top|enums.En.Bottom,item.gravity=enums.a3.Left;return nextVisualParent}(visualTree,visualParent,row,fillEmptyLevels||rowIndex<rows.length-1,hideChildConnector,options.horizontalAlignment),row.forEach((item=>navigationFamily.define(parentOrgItem,item))),rowIndex<rows.length-1||groupType<parentProps.groupSorter.getLength()-1)for(;depth>1;)visualParent=createNewVisualAggregator(visualTree,visualParent,!1),depth-=1}));break;case GroupType.Children:var regularChildren=parentProps.groupSorter.getRow(GroupType.Children);if(regularChildren.length>0){var props=orgTreeProps[logicalParentItem.id],depths=branchAligner.getRowsDepth(parentOrgItemId,GroupType.Children);!function addChildren(orgTree,visualTree,depths,options,treeItem,visualParent,regularChildren,childrenPlacementType,hasLeavesOnly){var currentVisualParent,leftChildItem,rightChildItem,newAggregatorItem,childItem,orgChildItem,width,height,twinColumns,rowIndex,index,len,singleItemPlacement,hideParentConnector=treeItem.visibility==enums.EE.Invisible&&0===treeItem.connectorPlacement;switch(options.horizontalAlignment){case enums.a3.Center:case enums.a3.Left:singleItemPlacement=enums.hZ.Right;break;case enums.a3.Right:singleItemPlacement=enums.hZ.Left}childrenPlacementType===enums.X9.Auto&&(childrenPlacementType=hasLeavesOnly?options.leavesPlacementType===enums.X9.Auto?enums.X9.Matrix:options.leavesPlacementType:options.childrenPlacementType===enums.X9.Auto?enums.X9.Horizontal:options.childrenPlacementType);childrenPlacementType==enums.X9.Matrix&&regularChildren.length<3&&(childrenPlacementType=enums.X9.Horizontal);switch(childrenPlacementType){case enums.X9.Horizontal:for(index=0,len=regularChildren.length;index<len;index+=1)childItem=getNewTreeItem({},regularChildren[index]),orgChildItem=orgTree.node(childItem.id),visualTree.add(visualParent.id,childItem.id,childItem),childItem.connectorPlacement=(orgChildItem.hideParentConnection?0:enums.En.Top)|(orgChildItem.hideChildrenConnection?0:enums.En.Bottom),0===index&&(childItem.relationDegree=1);break;case enums.X9.Matrix:width=Math.min(options.maximumColumnsInMatrix,Math.ceil(Math.sqrt(regularChildren.length))),height=Math.ceil(regularChildren.length/width),twinColumns=Math.ceil(width/2);for(var columnIndex=0;columnIndex<twinColumns;columnIndex+=1)for(currentVisualParent=visualParent,rowIndex=0;rowIndex<height;rowIndex+=1){if(leftChildItem=getMatrixItem(regularChildren,2*columnIndex,rowIndex,width),rightChildItem=getMatrixItem(regularChildren,2*columnIndex+1,rowIndex,width),null!==leftChildItem||null!==rightChildItem)for(var depth=depths[rowIndex-1]||1;depth>1;)newAggregatorItem=getNewTreeItem({visibility:enums.EE.Invisible,connectorPlacement:hideParentConnector?0:enums.En.Top|enums.En.Bottom}),visualTree.add(currentVisualParent.id,newAggregatorItem.id,newAggregatorItem),currentVisualParent=newAggregatorItem,depth-=1;null!==leftChildItem&&(leftChildItem=getNewTreeItem({},leftChildItem),0===columnIndex&&(leftChildItem.relationDegree=1),visualTree.add(currentVisualParent.id,leftChildItem.id,leftChildItem),leftChildItem.connectorPlacement=(hideParentConnector?0:enums.En.Right)|enums.En.Bottom,leftChildItem.gravity=enums.a3.Right),null===leftChildItem&&null===rightChildItem||(newAggregatorItem=getNewTreeItem({visibility:enums.EE.Invisible,connectorPlacement:hideParentConnector?0:enums.En.Top|enums.En.Bottom}),visualTree.add(currentVisualParent.id,newAggregatorItem.id,newAggregatorItem)),null!==rightChildItem&&(rightChildItem=getNewTreeItem({},rightChildItem),visualTree.add(currentVisualParent.id,rightChildItem.id,rightChildItem),rightChildItem.connectorPlacement=(hideParentConnector?0:enums.En.Left)|enums.En.Bottom,rightChildItem.gravity=enums.a3.Left),currentVisualParent=newAggregatorItem}width>2&&(visualParent.visualAggregatorId=null);break;case enums.X9.Vertical:for(index=0,len=regularChildren.length;index<len;index+=1){childItem=getNewTreeItem({},regularChildren[index]);depth=index==len-1?1:depths[index]||1;for(var aggregatorItem=visualParent;depth>0;)newAggregatorItem=getNewTreeItem({visibility:enums.EE.Invisible,connectorPlacement:hideParentConnector?0:enums.En.Top|enums.En.Bottom}),visualTree.add(aggregatorItem.id,newAggregatorItem.id,newAggregatorItem),aggregatorItem=newAggregatorItem,depth-=1;switch(singleItemPlacement){case enums.hZ.Left:visualTree.add(visualParent.id,childItem.id,childItem,0),childItem.connectorPlacement=(hideParentConnector?0:enums.En.Right)|enums.En.Bottom,childItem.gravity=enums.a3.Right;break;case enums.hZ.Right:visualTree.add(visualParent.id,childItem.id,childItem),childItem.connectorPlacement=(hideParentConnector?0:enums.En.Left)|enums.En.Bottom,childItem.gravity=enums.a3.Left}visualParent=newAggregatorItem}break;default:throw"Children placement is undefined!"}}(orgTree,visualTree,depths,options,logicalParentItem,visualParent,regularChildren,parentOrgItem.childrenPlacementType,props.hasLeavesOnly),regularChildren.forEach((item=>navigationFamily.define(parentOrgItem,item)))}}})),flagPartners&&(flagPartners=!1,parentProps.hasPartners&&(visualPartners[parentOrgItemId]=[visualParent.id],visualParent=visualParent2||visualParent,visualParent2=null,visualParent.partners=visualPartners[parentOrgItemId]),parentProps.isPartner&&visualPartners[parentOrgItem.parent].push(visualParent.id)),!parentProps.hasVisibleChildren)return orgTree.SKIP})),{visualTree:visualTree,navigationFamily:navigationFamily,branchAligner:branchAligner}}(orgTree,options,activeItems);return{visualTree:visualTree,navigationFamily:navigationFamily.getFamily(),branchAligner:branchAligner,treeItemCounter:_treeItemCounter}}}}function VisualTreeTask(orgTreeTask,activeItemsTask,visualTreeOptionTask){var _visualTree,_leftMargins,_rightMargins,_navigationFamily,_treeItemCounter,_branchAligner,_visualTreeBuilder=VisualTreeBuilder();return{process:function process(){var orgTree=orgTreeTask.getOrgTree(),options=visualTreeOptionTask.getOptions(),activeItems=null!=activeItemsTask?activeItemsTask.getActiveItems():{};return _treeItemCounter=orgTreeTask.getMaximumId(),orgTree.hasNodes()?({visualTree:_visualTree,navigationFamily:_navigationFamily,treeItemCounter:_treeItemCounter,branchAligner:_branchAligner}=_visualTreeBuilder.build(orgTree,_treeItemCounter,activeItems,options)):(_visualTree=Tree(),_navigationFamily=Family(),_branchAligner=visualTreeBuilder_BranchAligner()),({leftMargins:_leftMargins,rightMargins:_rightMargins}=function getVisualTreeMargins(visualTree){var leftMargins={},rightMargins={};return visualTree.loop(this,(function(nodeid,node){leftMargins[nodeid]=[],rightMargins[nodeid]=[]})),visualTree.loopPostOrder(this,(function(nodeid,node,parentid,parent){var index,len,parentLeftMargins=leftMargins[parentid],parentRightMargins=rightMargins[parentid],nodeLeftMargins=leftMargins[nodeid],nodeRightMargins=rightMargins[nodeid];if(null!=parentid){for(parentLeftMargins[0]||(parentLeftMargins[0]=nodeid),index=0,len=nodeLeftMargins.length;index<len;index+=1)parentLeftMargins[index+1]||(parentLeftMargins[index+1]=nodeLeftMargins[index]);for(parentRightMargins[0]=nodeid,index=0,len=nodeRightMargins.length;index<len;index+=1)parentRightMargins[index+1]=nodeRightMargins[index]}})),{leftMargins:leftMargins,rightMargins:rightMargins}}(_visualTree)),!0},getVisualTree:function getVisualTree(){return _visualTree},getLogicalFamily:function getLogicalFamily(){return _navigationFamily},getLeftMargins:function getLeftMargins(){return _leftMargins},getRightMargins:function getRightMargins(){return _rightMargins},getMaximumId:function getMaximumId(){return _treeItemCounter},getBranchAligner:function getBranchAligner(){return _branchAligner}}}function TreeLevelConnectorStackSize(){this.parentsStackSize=0}function PaletteItem(options){var property,properties,index,len;for(this.lineColor=enums.wL.Silver,this.lineWidth=1,this.lineType=enums.SP.Solid,this.fillColor=null,this.opacity=null,this._key="",index=0,len=(properties=["lineColor","lineWidth","lineType","fillColor","opacity"]).length;index<len;index+=1)property=properties[index],null!=options&&options.hasOwnProperty(property)&&(this[property]=options[property]),this._key+=(isNullOrEmpty(this._key)?"":", ")+property+":"+this[property]}function MoveSegment(){this.parent=Point.prototype,this.parent.constructor.apply(this,arguments),this.segmentType=enums.vZ.Move}function LineSegment(){this.parent=MoveSegment.prototype,this.parent.constructor.apply(this,arguments),this.segmentType=enums.vZ.Line}function QuadraticArcSegment(arg0,arg1,arg2,arg3){switch(this.x=null,this.y=null,this.cpX=null,this.cpY=null,arguments.length){case 2:this.x=arg1.x,this.y=arg1.y,this.cpX=arg0.x,this.cpY=arg0.y;break;case 4:this.cpX=arg0,this.cpY=arg1,this.x=arg2,this.y=arg3}this.segmentType=enums.vZ.QuadraticArc}function Polyline(newPaletteItem){var self,arrowPaletteItem,paletteItem=new PaletteItem,segments=[];if(1===arguments.length)paletteItem=newPaletteItem;function loop(thisArg,onItem){var index,len,segment;if(null!=onItem)for(index=0,len=segments.length;index<len&&(!(segment=segments[index])||!onItem.call(thisArg,segment,index));index+=1);}function isInvertable(){return isNullOrEmpty(paletteItem.fillColor)}function _getArrow(fromX,fromY,toX,toY,length,width){var index,len,point,x,y,result=new Polyline(arrowPaletteItem),perimeter=[new Point(length,-width/2),new Point(0,0),new Point(length,width/2),new Point(length/4*3,0)],angle=Math.atan2(fromY-toY,fromX-toX);for(index=0,len=perimeter.length;index<len;index+=1)x=(point=perimeter[index]).x*Math.cos(angle)-point.y*Math.sin(angle),y=point.x*Math.sin(angle)+point.y*Math.cos(angle),point.x=x+toX,point.y=y+toY;return result.addSegment(new MoveSegment(perimeter[0].x,perimeter[0].y)),result.addSegment(new LineSegment(perimeter[1].x,perimeter[1].y)),result.addSegment(new LineSegment(perimeter[2].x,perimeter[2].y)),result.addSegment(new QuadraticArcSegment(perimeter[3].x,perimeter[3].y,perimeter[0].x,perimeter[0].y)),result}function Vertex(segment,pointIndex){this.segment=segment,this.pointIndex=pointIndex}function _joinVectors(prev,current,offset,polyline,isLoop){var joinSegment,joinVector,newToPoint,relationType=prev.relateTo(current),offset2=isLoop?0:offset;relationType==enums.ZU.Collinear?current.offset(offset2):relationType==enums.ZU.Opposite&&0===current.from.context.pointIndex?(joinSegment=new LineSegment(current.from),polyline.addSegment(joinSegment),current.offset(offset2),(newToPoint=current.from.clone()).context=new Vertex(joinSegment,0),joinVector=new Vector(prev.to.clone(),newToPoint),isLoop||(current.from=newToPoint.clone()),joinVector.offset(offset),joinVector.intersect(prev),joinVector.from.context.pushToSegment(joinVector.from),current.intersect(joinVector),isLoop&&joinVector.to.context.pushToSegment(joinVector.to)):(current.offset(offset2),current.intersect(prev)),current.from.context.pushToSegment(current.from)}function _closeVector(vectorStack,startVectors,offset,polyline){var prevVector=vectorStack[0],closurePoint=prevVector.to.context.segment.getEndPoint().toString();startVectors.hasOwnProperty(closurePoint)&&(_joinVectors(prevVector,startVectors[closurePoint],offset,polyline,!0),delete startVectors[closurePoint]),prevVector.to.context.pushToSegment(prevVector.to),vectorStack.length=0}return arrowPaletteItem=new PaletteItem({lineColor:paletteItem.lineColor,lineWidth:0,fillColor:paletteItem.lineColor,opacity:paletteItem.opacity||1}),Vertex.prototype.pushToSegment=function(point){this.segment.setPoint(point,this.pointIndex)},self={paletteItem:paletteItem,arrowPaletteItem:arrowPaletteItem,addSegment:function addSegment(segment){segments.push(segment)},addSegments:function addSegments(newSegments){var index,len;for(index=0,len=newSegments.length;index<len;index+=1)segments.push(newSegments[index])},mergeTo:function mergeTo(polyline){polyline.addSegments(segments)},length:function length(){return segments.length},loop:loop,loopReversed:function loopReversed(thisArg,onItem){var index,segment;if(null!=onItem)for(index=segments.length-1;index>=0&&(!(segment=segments[index])||!onItem.call(thisArg,segment,index));index-=1);},transform:function transform(transformArg,forward){loop(this,(function(segment){null!=segment.transform&&segment.transform(transformArg,forward)}))},isInvertable:isInvertable,addInverted:function addInverted(polyline){var hasMoved=!1,stack=[];isInvertable()?polyline.loopReversed(this,(function(segment,index){segment.segmentType!=enums.vZ.Dot&&(hasMoved||(segments.push(new MoveSegment(segment.getEndPoint())),hasMoved=!0),stack.unshift(segment),stack.length>1&&(stack[1].invert(stack[0].getEndPoint()),segments.push(stack[1]),stack.length=1))})):polyline.mergeTo(self)},addArrow:function addArrow(lineWidth,onAddArrowSegments){var prevEndPoint,currentEndPoint,currentSegment,newEndPoint,len=segments.length,arrowTipLength=3*lineWidth,arrowTipWidth=2*lineWidth;switch(lineWidth){case 1:arrowTipLength=8,arrowTipWidth=6;break;case 2:arrowTipLength=12,arrowTipWidth=8;break;case 3:arrowTipLength=16,arrowTipWidth=10}null!=onAddArrowSegments&&len>1&&(prevEndPoint=segments[len-2].getEndPoint(),null!=(currentSegment=segments[len-1]).trim&&(currentEndPoint=new Point(currentSegment.getEndPoint())).distanceTo(prevEndPoint)>=arrowTipLength&&onAddArrowSegments(_getArrow((newEndPoint=currentSegment.trim(prevEndPoint,arrowTipLength)).x,newEndPoint.y,currentEndPoint.x,currentEndPoint.y,arrowTipLength,arrowTipWidth),newEndPoint))},addOffsetArrow:function addOffsetArrow(forward,lineWidth,offsetPercent,minimumDistance,onAddArrowSegments){var prevEndPoint,currentEndPoint,currentSegment,newEndPoint,newPrevEndPoint,polyline,offset,distance,len=segments.length,arrowTipLength=3*lineWidth,arrowTipWidth=2*lineWidth;switch(lineWidth){case 1:arrowTipLength=8,arrowTipWidth=6;break;case 2:arrowTipLength=12,arrowTipWidth=8;break;case 3:arrowTipLength=16,arrowTipWidth=10}null!=onAddArrowSegments&&len>1&&(prevEndPoint=segments[len-2].getEndPoint(),null!=(currentSegment=segments[len-1]).offsetPoint&&(currentEndPoint=new Point(currentSegment.getEndPoint()),(distance=prevEndPoint.distanceTo(currentEndPoint))>minimumDistance&&(offset=distance*offsetPercent,forward?(newEndPoint=currentSegment.offsetPoint(prevEndPoint,currentEndPoint,offset),polyline=_getArrow(prevEndPoint.x,prevEndPoint.y,newEndPoint.x,newEndPoint.y,arrowTipLength,arrowTipWidth)):(newPrevEndPoint=currentSegment.offsetPoint(currentEndPoint,prevEndPoint,offset),polyline=_getArrow(currentEndPoint.x,currentEndPoint.y,newPrevEndPoint.x,newPrevEndPoint.y,arrowTipLength,arrowTipWidth)),onAddArrowSegments(polyline))))},optimizeMoveSegments:function optimizeMoveSegments(){var index,len,cursorIndex,key,optimizedSegments,segment,nextSegment,links={},jumps=[],processed=[];for(index=0,len=segments.length;index<len-1;index+=1)switch(segment=segments[index],nextSegment=segments[index+1],segment.segmentType){case enums.vZ.Line:case enums.vZ.QuadraticArc:case enums.vZ.CubicArc:switch(nextSegment.segmentType){case enums.vZ.Move:case enums.vZ.Dot:key=segment.x+"&"+segment.y,links.hasOwnProperty(key)||(links[key]=index)}break;case enums.vZ.Move:key=segment.x+"&"+segment.y,links.hasOwnProperty(key)&&!jumps[links[key]]&&(jumps[links[key]]=index+1,processed[index]=!0)}for(optimizedSegments=[],index=0;index<len;index+=1)if(!processed[index]&&(segment=segments[index],optimizedSegments.push(segment),processed[index]=!0,jumps[index]>0))for(cursorIndex=jumps[index];cursorIndex<len&&!processed[cursorIndex];)segment=segments[cursorIndex],optimizedSegments.push(segment),processed[cursorIndex]=!0,jumps[cursorIndex]>0?cursorIndex=jumps[cursorIndex]:cursorIndex+=1;segments=optimizedSegments},getOffsetPolyine:function getOffsetPolyine(offset){var result=new Polyline(paletteItem),startVectors={},pointStack=[],vectorStack=[];return loop(this,(function(segment){var newPoint,newSegment=segment.clone();switch(newSegment.segmentType){case enums.vZ.Dot:case enums.vZ.Move:vectorStack.length>0&&_closeVector(vectorStack,startVectors,offset,result),pointStack.length=0,newSegment.segmentType==enums.vZ.Move&&((newPoint=new Point(newSegment)).context=new Vertex(newSegment,0),pointStack.push(newPoint));break;default:newSegment.loop(this,(function(x,y,index){var current,closurePoint,newPoint=new Point(x,y);switch(newPoint.context=new Vertex(newSegment,index),pointStack.unshift(newPoint),pointStack.length>1&&(vectorStack.unshift(new Vector(pointStack[1].clone(),pointStack[0].clone())),pointStack.length=1),vectorStack.length){case 1:closurePoint=(current=vectorStack[0]).from.toString(),startVectors[closurePoint]=current,current.offset(offset),current.from.context.pushToSegment(current.from);break;case 2:_joinVectors(vectorStack[1],current=vectorStack[0],offset,result,!1),vectorStack.length=1}}))}result.addSegment(newSegment)})),vectorStack.length>0&&_closeVector(vectorStack,startVectors,offset,result),result},toString:function toString(){return paletteItem.toString()},getStartPoint:function getStartPoint(){var result=null;return segments.length>0&&(result=segments[0].getEndPoint()),result},getEndPoint:function getEndPoint(){var result=null;return segments.length>0&&(result=segments[segments.length-1].getEndPoint()),result},clone:function clone(){var index,len,segment,result=new Polyline(paletteItem),cloneSegments=[];for(index=0,len=segments.length;index<len;index+=1)segment=segments[index],cloneSegments.push(segment.clone());return result.addSegments(cloneSegments),result}}}function CubicArcSegment(arg0,arg1,arg2,arg3,arg4,arg5){switch(this.parent=Point.prototype,this.x=null,this.y=null,this.cpX1=null,this.cpY1=null,this.cpX2=null,this.cpY2=null,arguments.length){case 3:this.parent.constructor.apply(this,[arg2.x,arg2.y]),this.cpX1=arg0.x,this.cpY1=arg0.y,this.cpX2=arg1.x,this.cpY2=arg1.y;break;case 6:this.parent.constructor.apply(this,[arg4,arg5]),this.cpX1=arg0,this.cpY1=arg1,this.cpX2=arg2,this.cpY2=arg3}this.segmentType=enums.vZ.CubicArc}function BaseConnectorBundle(){this.NORMAL_ITEM_WEIGHT=10010,this.LINE_ITEM_WEIGHT=1e4}function VerticalConnectorBundle(fromItems,toItems,dotId){this.fromItems=fromItems,this.toItems=toItems,this.dotId=dotId||null,this.fromOffset=0,this.fromStackSize=0}function HorizontalConnectorBundle(fromItem,toItem){this.fromItem=fromItem,this.toItem=toItem}function VisualTreeLevelsTask(visualTreeTask,itemTemplateParamsTask){var _data={treeLevels:null,bundles:null,connectorStacks:null},_nullTreeLevelConnectorStackSize=new TreeLevelConnectorStackSize;return{process:function process(){var visualTree=visualTreeTask.getVisualTree();return _data.treeLevels=TreeLevels(),visualTree.loopLevels(this,(function(treeItemId,treeItem,levelIndex){_data.treeLevels.addItem(levelIndex,treeItemId,treeItem)})),_data.bundles=[],_data.connectorStacks=[],function recalcLevelsDepth(bundles,connectorStacks,treeLevels,orgTree,orgPartners){var index2,len2,index3,len3,itemPosition,bundle,bundlesToStack,startIndex,endIndex,stackSegments,bundlesByItemId={};treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var stacksSizes=new TreeLevelConnectorStackSize;if(connectorStacks[levelIndex]=stacksSizes,bundlesToStack=[],treeLevels.loopLevelItems(this,levelIndex,(function(itemid,treeItem,position){var parents=[];if(!bundlesByItemId.hasOwnProperty(itemid)&&(treeItem.connectorPlacement&enums.En.Bottom&&parents.push(itemid),(parents=parents.concat(treeItem.partners)).length>0)){bundle=new VerticalConnectorBundle(parents,[]);for(var index=0,len=parents.length;index<len;index+=1)bundlesByItemId[parents[index]]=bundle;orgTree.loopChildren(this,itemid,(function(childid,child,index){child.connectorPlacement&enums.En.Top&&bundle.toItems.push(childid)})),parents.length>1&&bundlesToStack.push(bundle),(bundle.fromItems.length>1||bundle.toItems.length>0)&&bundles.push(bundle)}treeItem.connectorPlacement&enums.En.Left&&(bundle=new HorizontalConnectorBundle(itemid,treeLevels.getPrevItem(itemid)),bundles.push(bundle)),treeItem.connectorPlacement&enums.En.Right&&(bundle=new HorizontalConnectorBundle(itemid,treeLevels.getNextItem(itemid)),bundles.push(bundle))})),bundlesToStack.length>0){for(stackSegments=Pile(),index2=0,len2=bundlesToStack.length;index2<len2;index2+=1){for(bundle=bundlesToStack[index2],startIndex=null,endIndex=null,index3=0,len3=bundle.fromItems.length;index3<len3;index3+=1)itemPosition=treeLevels.getItemPosition(bundle.fromItems[index3]),startIndex=null!=startIndex?Math.min(startIndex,itemPosition):itemPosition,endIndex=null!=endIndex?Math.max(endIndex,itemPosition):itemPosition;stackSegments.add(startIndex,endIndex,bundle)}stacksSizes.parentsStackSize=stackSegments.resolve(this,(function(from,to,bundle,offset,stackSize){bundle.fromOffset=offset+1,bundle.fromStackSize=stackSize}))}}))}(_data.bundles,_data.connectorStacks,_data.treeLevels,visualTree),!0},getTreeLevels:function getTreeLevels(){return _data.treeLevels},getBundles:function getBundles(){return _data.bundles},getConnectorsStacksSizes:function getConnectorsStacksSizes(levelid){return _data.connectorStacks[levelid]||_nullTreeLevelConnectorStackSize},getNestedLayoutParentConnectorIds:function getNestedLayoutParentConnectorIds(){return{}},getNestedLayoutBottomConnectorIds:function getNestedLayoutBottomConnectorIds(){return{}}}}function OrgExtractNestedLayoutsTask(extractNestedLayoutsOptionTask,bindFamilyConnectorsTask){return{process:function process(debug){return!1},getNestedLayoutParentConnectorIds:function getNestedLayoutParentConnectorIds(){return{}},getNestedLayoutBottomConnectorIds:function getNestedLayoutBottomConnectorIds(){return{}},getBundles:function getBundles(){return[]},getLayouts:function getLayouts(){return{}}}}function TreeLevelPosition(source){if(this.currentvisibility=enums.EE.Normal,this.actualVisibility=enums.EE.Normal,this.shift=0,this.depth=0,this.nextLevelShift=0,this.horizontalConnectorsDepth=0,this.topConnectorShift=0,this.connectorShift=0,this.levelSpace=0,this.currentOffset=0,this.labels=[],this.labelsRect=null,this.showLabels=!0,this.hasFixedLabels=!1,null!=source)for(var property in source)source.hasOwnProperty(property)&&(this[property]=source[property])}function TreeItemPosition(source){if(this.level=null,this.actualVisibility=enums.EE.Normal,this.actualSize=null,this.actualPosition=null,this.contentPosition=null,this.horizontalConnectorsShift=null,this.topConnectorShift=null,this.topConnectorInterval=0,this.bottomConnectorShift=null,this.bottomConnectorInterval=0,this.leftMedianOffset=null,this.rightMedianOffset=null,null!=source)for(var property in source)if(source.hasOwnProperty(property))if("actualPosition"===property)this.actualPosition=new Rect(source.actualPosition);else this[property]=source[property]}function ChildLayoutPosition(offset,leftPadding,rightPadding){this.offset=offset,this.leftPadding=leftPadding,this.rightPadding=rightPadding}function OrgLayout(visualTree,treeLevels,leftMargins,rightMargins,getConnectorsStacksSizes){this.visualTree=visualTree,this.treeLevels=treeLevels,this.leftMargins=leftMargins,this.rightMargins=rightMargins,this.getConnectorsStacksSizes=getConnectorsStacksSizes,this.treeLevelsPositions=[],this.childLayoutsPositions={}}function ItemLayout(visibility){this.visibility=visibility}function OrgCreateLayoutsTreeTask(visualTreeTask,visualTreeLevelsTask,extractNestedLayoutsTask){var _data={layoutsTree:{},maximumId:null};return{process:function process(){var visualTree=visualTreeTask.getVisualTree(),leftMargins=visualTreeTask.getLeftMargins(),rightMargins=visualTreeTask.getRightMargins(),maximumId=visualTreeTask.getMaximumId(),treeLevels=visualTreeLevelsTask.getTreeLevels(),getConnectorsStacksSizes=visualTreeLevelsTask.getConnectorsStacksSizes,layouts=extractNestedLayoutsTask.getLayouts(),rootLayout=new OrgLayout(visualTree,treeLevels,leftMargins,rightMargins,getConnectorsStacksSizes),layoutsTree=Tree();maximumId++,layoutsTree.add(null,maximumId,rootLayout);for(var levelLayouts=[{id:maximumId,levelLayout:rootLayout}];levelLayouts.length>0;){for(var nextLevelLayouts=[],index=0;index<levelLayouts.length;index+=1){var{id:id,levelLayout:levelLayout}=levelLayouts[index];levelLayout.loop(this,(function(treeItem){var treeItemId=treeItem.id,itemLayout=layouts[treeItemId];itemLayout?nextLevelLayouts.push({id:treeItemId,levelLayout:itemLayout}):itemLayout=new ItemLayout(treeItem.visibility),layoutsTree.add(id,treeItemId,itemLayout)}))}levelLayouts=nextLevelLayouts}return _data.layoutsTree=layoutsTree,_data.maximumId=maximumId,!0},getLayoutsTree:function getLayoutsTree(){return _data.layoutsTree},getMaximumId:function getMaximumId(){return _data.maximumId}}}function ConnectionsGraphTask(getGraphics,createTransformTask,connectorsOptionTask,visualTreeLevelsTask,extractNestedLayoutsTask,alignDiagramTask,removeLoopsTask){var _data={graph:null,nodeid:0};return{process:function process(){var bundles=visualTreeLevelsTask.getBundles(),bundles2=extractNestedLayoutsTask.getBundles(),nestedLayoutParentConnectorIds=extractNestedLayoutsTask.getNestedLayoutParentConnectorIds(),nestedLayoutBottomConnectorIds=extractNestedLayoutsTask.getNestedLayoutBottomConnectorIds(),connectorsOptions=connectorsOptionTask.getOptions(),loops=null!=removeLoopsTask?removeLoopsTask.getLoops():[];bundles=bundles.concat(bundles2);for(var data={graph:Graph(),nodeid:0},params={treeItemsPositions:alignDiagramTask.getItemsPositions(),nestedLayoutParentConnectorIds:nestedLayoutParentConnectorIds,nestedLayoutBottomConnectorIds:nestedLayoutBottomConnectorIds,transform:createTransformTask.getTransform()},options={connectorType:connectorsOptions.connectorType,showExtraArrows:connectorsOptions.showExtraArrows,bevelSize:connectorsOptions.bevelSize,elbowType:connectorsOptions.elbowType},index=0,len=bundles.length;index<len;index+=1){bundles[index].trace(data,params,options)}return function TraceLoops(graph,loops){for(var edges=[],isOppositeFlow=1;isOppositeFlow>=0;isOppositeFlow-=1)for(var index=0,len=loops.length;index<len;index+=1){var loop=loops[index];loop.isOppositeFlow==(1==isOppositeFlow)&&graph.getShortestPath(this,loop.from,[loop.to],(function(connectorEdge,fromItem,toItem){return connectorEdge.weight}),(function(path,to){for(var index2=0,len2=path.length-1;index2<len2;index2+=1){var fromItem=path[index2],toItem=path[index2+1],edge=graph.edge(fromItem,toItem);edge.polyline.length()>0&&(edge.isOppositeFlow=1==isOppositeFlow,edges.push(edge))}}))}for(index=0,len=edges.length;index<len;index+=1){var edge=edges[index];edge.isOppositeFlow&&(edge.hasArrow=!0)}}(data.graph,loops,connectorsOptions.extraArrowsMinimumSpace),_data=data,!0},getGraph:function getGraph(){return _data.graph}}}function HighlightItemTask(highlightItemOptionTask,activeItemsTask){var _data={highlightTreeItemId:null};return{process:function process(){var treeItemId=highlightItemOptionTask.getHighlightItem(),activeItems=null!=activeItemsTask?activeItemsTask.getActiveItems():{};return _data.highlightTreeItemId=null!=treeItemId&&activeItems.hasOwnProperty(treeItemId)?treeItemId:null,!0},getHighlightTreeItem:function getHighlightTreeItem(){return _data.highlightTreeItemId}}}function CursorItemTask(cursorItemOptionTask,activeItemsTask){var _data={cursorTreeItemId:null};return{process:function process(){var treeItemId=cursorItemOptionTask.getCursorItem(),activeItems=null!=activeItemsTask?activeItemsTask.getActiveItems():{};return _data.cursorTreeItemId=null!=treeItemId&&activeItems.hasOwnProperty(treeItemId)?treeItemId:null,!0},getCursorTreeItem:function getCursorTreeItem(){return _data.cursorTreeItemId},getItems:function getItems(){return null!=_data.cursorTreeItemId?[_data.cursorTreeItemId]:[]}}}function OrgCursorNeighboursTask(cursorItemTask,navigationFamilyTask){var _data={items:[]};return{process:function process(){var navigationFamily=navigationFamilyTask.getLogicalFamily(),cursorTreeItemId=cursorItemTask.getCursorTreeItem();return _data.items=function getCursorNeighbours(cursorTreeItemId,navigationFamily){var result=[];null!==cursorTreeItemId&&navigationFamily.loopNeighbours(this,cursorTreeItemId,(function(treeItemId,treeItem,distance){return treeItem.isVisible&&result.push(treeItemId),!0}));return result}(cursorTreeItemId,navigationFamily),!0},getItems:function getItems(){return _data.items}}}function SelectedItemsTask(selectedItemsOptionTask,itemsOptionTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},selectedItems=selectedItemsOptionTask.getSelectedItems();return _data.items=_dataTemplate.read(_data.items,function getSelectedItems(selectedItems){var index,len,treeItemId,result=[],processed={};for(index=0,len=selectedItems.length;index<len;index+=1)null==(treeItemId=selectedItems[index])||processed.hasOwnProperty(treeItemId)||(processed[treeItemId]=!0,null!=itemsOptionTask.getConfig(treeItemId)&&result.push(treeItemId));return result}(selectedItems),"items",context),context.isChanged},getItems:function getItems(){return _data.items},isSelected:function isSelected(itemid){return _hash.items.hasOwnProperty(itemid)}}}function OrgSelectionPathItemsTask(navigationFamilyTask,cursorItemTask,selectedItemsTask,cursorSelectionPathModeOptionTask){var _data={items:[]};return{process:function process(){var selectionPathMode=cursorSelectionPathModeOptionTask.getSelectionPathMode(),navigationFamily=navigationFamilyTask.getLogicalFamily(),cursorTreeItemId=cursorItemTask.getCursorTreeItem(),selectedItems=selectedItemsTask.getItems().slice(0);return selectedItems.push(cursorTreeItemId),_data.items=function getSelectionPathItems(selectedItems,navigationFamily,selectionPathMode){var selectedItem,index,len,result=[],processed={};for(index=0,len=selectedItems.length;index<len;index+=1)switch(selectedItem=selectedItems[index],selectionPathMode){case enums.lz.None:break;case enums.lz.FullStack:navigationFamily.loopParents(this,selectedItem,(function(parentItemId,parentItem){if(null!=processed[parentItemId])return navigationFamily.SKIP;parentItem.visibility!=enums.EE.Invisible&&result.push(parentItemId),processed[parentItemId]=!0}))}return result}(selectedItems,navigationFamily,selectionPathMode),!0},getItems:function getItems(){return _data.items}}}function NormalVisibilityItemsByAnnotationTask(annotationOptionTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},annotations=annotationOptionTask.getAnnotations();return _data.items=_dataTemplate.read(_data.items,function getSelectedItems(annotations){var index,len,index2,len2,items,annotation,treeItemId,result=[],processed={};for(index=0,len=annotations.length;index<len;index+=1)if((annotation=annotations[index]).selectItems)for(index2=0,len2=(items=annotation.items).length;index2<len2;index2+=1)null==(treeItemId=items[index2])||processed.hasOwnProperty(treeItemId)||(result.push(treeItemId),processed[treeItemId]=!0);return result}(annotations),"items",context),context.isChanged},getItems:function getItems(){return _data.items}}}function NormalVisibilityItemsByConnectorAnnotationTask(connectorAnnotationOptionTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},annotations=connectorAnnotationOptionTask.getAnnotations();return _data.items=_dataTemplate.read(_data.items,function getSelectedItems(annotations){var index,len,annotation,result=[],processed={};for(index=0,len=annotations.length;index<len;index+=1)(annotation=annotations[index]).selectItems&&(null==annotation.fromItem||processed.hasOwnProperty(annotation.fromItem)||(result.push(annotation.fromItem),processed[annotation.fromItem]=!0),null==annotation.toItem||processed.hasOwnProperty(annotation.toItem)||(result.push(annotation.toItem),processed[annotation.toItem]=!0));return result}(annotations),"items",context),context.isChanged},getItems:function getItems(){return _data.items}}}function OrgNormalVisibilityItemsByMinimumVisibleLevelsTask(minimumVisibleLevelsOptionTask,orgTreeTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},orgTree=orgTreeTask.getOrgTree(),{pageFitMode:pageFitMode,minimalVisibility:minimalVisibility,minimumVisibleLevels:minimumVisibleLevels}=minimumVisibleLevelsOptionTask.getOptions();return _data.items=_dataTemplate.read(_data.items,function getSelectedItems(orgTree,pageFitMode,minimalVisibility,minimumVisibleLevels){var result=[],buckets=[];if(minimumVisibleLevels>0&&(enums.sj.PageWidth==pageFitMode||enums.sj.PageHeight||enums.sj.FitToPage)&&minimalVisibility!=enums.EE.Normal){orgTree.loopLevels(this,(function(nodeId,node,levelIndex){if(node.isVisible){var nodeLevel=levelIndex+node.levelOffset;buckets[nodeLevel]?buckets[nodeLevel].push(nodeId):buckets[nodeLevel]=[nodeId]}}));for(var actualLevel=0,index=0;index<buckets.length&&!(null!=buckets[index]&&(result=result.concat(buckets[index]),(actualLevel+=1)>=minimumVisibleLevels));index+=1);}return result}(orgTree,pageFitMode,minimalVisibility,minimumVisibleLevels),"items",context),context.isChanged},getItems:function getItems(){return _data.items}}}function CombinedNormalVisibilityItemsTask(itemsSizesOptionTask,cursorItemTask,cursorNeighboursTask,selectedItemsTask,selectionPathItemsTask,normalVisibilityItemsByForegroundShapeAnnotationTask,normalVisibilityItemsByBackgroundShapeAnnotationTask,normalVisibilityItemsByBackgroundAnnotationTask,normalVisibilityItemsByForegroundHighlightPathAnnotationTask,normalVisibilityItemsByBackgroundHighlightPathAnnotationTask,normalVisibilityItemsByForegroundConnectorAnnotationTask,normalVisibilityItemsByBackgroundConnectorAnnotationTask,NormalVisibilityItemsByMinimumVisibleLevelsTask){var _data={items:[]},_hash={},_sourceTasks=[cursorItemTask,cursorNeighboursTask,selectedItemsTask,selectionPathItemsTask,normalVisibilityItemsByForegroundShapeAnnotationTask,normalVisibilityItemsByBackgroundShapeAnnotationTask,normalVisibilityItemsByBackgroundAnnotationTask,normalVisibilityItemsByForegroundHighlightPathAnnotationTask,normalVisibilityItemsByBackgroundHighlightPathAnnotationTask,normalVisibilityItemsByForegroundConnectorAnnotationTask,normalVisibilityItemsByBackgroundConnectorAnnotationTask,NormalVisibilityItemsByMinimumVisibleLevelsTask],_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},itemsSizesOption=itemsSizesOptionTask.getOptions();return _data.items=_dataTemplate.read(_data.items,function getSelectedItems(sourceTasks,getItemOptions){var sourceIndex,sourceLen,index,len,items,item,result=[],processed={};for(sourceIndex=0,sourceLen=sourceTasks.length;sourceIndex<sourceLen;sourceIndex+=1)for(index=0,len=(items=sourceTasks[sourceIndex].getItems()).length;index<len;index+=1)item=items[index],processed.hasOwnProperty(item)||(result.push(item),processed[item]=!0);return result}(_sourceTasks),"items",context),itemsSizesOption.pageFitMode!=enums.sj.None&&itemsSizesOption.minimalVisibility!=enums.EE.Normal||(context.isChanged=!1),context.isChanged},isItemSelected:function isItemSelected(treeItem){return _hash.items.hasOwnProperty(treeItem)}}}function FrameSizeTask(frameOptionTask,readTemplatesTask,scaleOptionTask){var _data={},_hash={},_dataTemplate=new ObjectReader({median:new ObjectReader({left:new ValueReader(["number"],!1,0),top:new ValueReader(["number"],!1,0),right:new ValueReader(["number"],!1,0),bottom:new ValueReader(["number"],!1,0)},!1,new Thickness(0,0,0,0)),thickness:new ObjectReader({left:new ValueReader(["number"],!1,0),top:new ValueReader(["number"],!1,0),right:new ValueReader(["number"],!1,0),bottom:new ValueReader(["number"],!1,0)},!1,new Thickness(0,0,0,0))});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,function getFrameSize(){var frameOptions=frameOptionTask.getOptions(),showFrame=frameOptions.showFrame,frameInnerPadding=frameOptions.frameInnerPadding,frameOuterPadding=frameOptions.frameOuterPadding,scale=scaleOptionTask.getOptions().scale,median=new Thickness(0,0,0,0),thickness=new Thickness(0,0,0,0);if(showFrame){var index,len,maximumMarkerSize=new Size(0,0),maximumMarkerPadding=new Thickness(0,0,0,0),templates=readTemplatesTask.getItemTemplates();for(index=0,len=templates.length;index<len;index+=1){var templateConfig=templates[index].templateConfig,cursorPadding=new Thickness(templateConfig.cursorPadding),highlightPadding=new Thickness(templateConfig.highlightPadding);cursorPadding.addThickness(templateConfig.cursorBorderWidth),highlightPadding.addThickness(templateConfig.highlightBorderWidth),maximumMarkerSize.maxSize(templateConfig.minimizedItemSize),maximumMarkerPadding.maxThickness(templateConfig.cursorPadding),maximumMarkerPadding.maxThickness(templateConfig.highlightPadding)}(median=new Thickness(Math.ceil(maximumMarkerSize.width/2)+maximumMarkerPadding.right,Math.ceil(maximumMarkerSize.height/2)+maximumMarkerPadding.bottom,Math.ceil(maximumMarkerSize.width/2)+maximumMarkerPadding.left,Math.ceil(maximumMarkerSize.height/2)+maximumMarkerPadding.top)).addThickness(frameInnerPadding),median.scale(scale),(thickness=new Thickness(maximumMarkerSize.width+maximumMarkerPadding.left+maximumMarkerPadding.right,maximumMarkerSize.height+maximumMarkerPadding.top+maximumMarkerPadding.bottom,maximumMarkerSize.width+maximumMarkerPadding.left+maximumMarkerPadding.right,maximumMarkerSize.height+maximumMarkerPadding.top+maximumMarkerPadding.bottom)).addThickness(frameInnerPadding),thickness.addThickness(frameOuterPadding),thickness.scale(scale)}return{median:median,thickness:thickness}}(),"options",context),context.isChanged},getMedian:function getMedian(){return _data.median},getThickness:function getThickness(){return _data.thickness}}}function LevelTitleSizeTask(levelTitlePlacementOptionTask,levelAnnotationOptionTask,orientationOptionTask,scaleOptionTask){var _data={},_hash={},_dataTemplate=new ObjectReader({thickness:new ObjectReader({left:new ValueReader(["number"],!1,0),top:new ValueReader(["number"],!1,0),right:new ValueReader(["number"],!1,0),bottom:new ValueReader(["number"],!1,0)},!1,new Thickness(0,0,0,0))});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,function getThickness(){var{levelTitlePlaceInside:levelTitlePlaceInside,levelTitlePanelSize:levelTitlePanelSize,levelTitlePlacementType:levelTitlePlacementType}=levelTitlePlacementOptionTask.getOptions(),{scale:scale}=scaleOptionTask.getOptions(),{orientationType:orientationType}=orientationOptionTask.getOptions(),annotations=levelAnnotationOptionTask.getAnnotations(),thickness=new Thickness(0,0,0,0);if(annotations.length>0){switch(levelTitlePlaceInside&&(levelTitlePanelSize=-levelTitlePanelSize),levelTitlePlacementType){case enums.hZ.Right:switch(orientationType){case enums.F7.Left:thickness=new Thickness(0,levelTitlePanelSize,0,0);break;case enums.F7.Right:thickness=new Thickness(0,0,0,levelTitlePanelSize);break;case enums.F7.Top:case enums.F7.Bottom:thickness=new Thickness(0,0,levelTitlePanelSize,0)}break;case enums.hZ.Left:default:switch(orientationType){case enums.F7.Left:thickness=new Thickness(0,0,0,levelTitlePanelSize);break;case enums.F7.Right:thickness=new Thickness(0,levelTitlePanelSize,0,0);break;case enums.F7.Top:case enums.F7.Bottom:thickness=new Thickness(levelTitlePanelSize,0,0,0)}}thickness.scale(scale)}return{thickness:thickness}}(),"options",context),context.isChanged},getOptions:function getOptions(){return _data}}}function LayoutOptionsTask(getLayout,optionsTask){var _data={};return{process:function process(){return _data=getLayout(),!0},getOptions:function getOptions(){return _data},description:"Raw layout options."}}function CurrentControlSizeTask(layoutOptionsTask,itemsSizesOptionTask,frameSizeTask,levelTitleSizeTask){var _data={},_hash={},_dataTemplate=new ObjectReader({scrollPanelSize:new ObjectReader({width:new ValueReader(["number"],!0),height:new ValueReader(["number"],!0)},!0),optimalPanelSize:new ObjectReader({width:new ValueReader(["number"],!0),height:new ValueReader(["number"],!0)},!0),hasFrame:new ValueReader(["boolean"],!0),hasLevelTitles:new ValueReader(["boolean"],!0)});return{process:function process(){var result=!1,context={isChanged:!1,hash:_hash},layoutOptions=layoutOptionsTask.getOptions(),{pageFitMode:pageFitMode}=itemsSizesOptionTask.getOptions(),frameThickness=new Thickness(frameSizeTask.getThickness()),levelTitlesThickness=new Thickness(levelTitleSizeTask.getOptions().thickness);if(layoutOptions.hasLevelTitles=!1,levelTitlesThickness.isPositive()){let viewportSize=new Size(layoutOptions.scrollPanelSize);viewportSize.removeThickness(levelTitlesThickness),layoutOptions.scrollPanelSize.space()<2*viewportSize.space()&&(layoutOptions.scrollPanelSize=viewportSize,layoutOptions.hasLevelTitles=!0)}if(layoutOptions.hasFrame=!1,frameThickness.isPositive()){let viewportSize=new Size(layoutOptions.scrollPanelSize);viewportSize.removeThickness(frameThickness),layoutOptions.scrollPanelSize.space()<2*viewportSize.space()&&(layoutOptions.scrollPanelSize=viewportSize,layoutOptions.hasFrame=!0)}switch(layoutOptions.optimalPanelSize=new Size(layoutOptions.scrollPanelSize.width-25,layoutOptions.scrollPanelSize.height-25),_data=_dataTemplate.read(_data,layoutOptions,"layout",context),pageFitMode){case enums.sj.PageWidth:case enums.sj.PageHeight:case enums.sj.FitToPage:case enums.sj.None:case enums.sj.SelectionOnly:result=context.isChanged}return result},getOptions:function getOptions(){return _data}}}function CurrentScrollPositionTask(layoutOptionsTask){var _data={placeholderOffset:null},_hash={},_dataTemplate=new ObjectReader({placeholderOffset:new ObjectReader({x:new ValueReader(["number"],!0),y:new ValueReader(["number"],!0)},!0)});return{process:function process(){var context={isChanged:!1,hash:_hash},layoutOptions=layoutOptionsTask.getOptions();return _data=_dataTemplate.read(_data,layoutOptions,"layout",context),context.isChanged},getPlaceholderOffset:function getPlaceholderOffset(){return _data.placeholderOffset}}}function LevelVisibility(level,visibility){this.level=level,this.visibility=visibility}function ItemsPositionsTask(currentControlSizeTask,scaleOptionTask,orientationOptionTask,itemsSizesOptionTask,connectorsOptionTask,normalizeOptionTask,createLayoutsTreeTask,itemTemplateParamsTask,cursorItemTask,combinedNormalVisibilityItemsTask){var _data={treeItemsPositions:{},size:null};function measureLayout(rootLayoutId,layoutsTree,levelVisibilities,levelIndexes,cursorItemId,isItemSelected,getTemplateParams,options){var treeItemsPositions={};return layoutsTree.loopPostOrder(this,(function(childLayoutId,childLayout,parentLayoutId,parentLayout){var levelIndex=levelIndexes[childLayoutId],levelVisibility=levelVisibilities[levelIndex],isCursor=cursorItemId==childLayoutId,isSelected=isItemSelected(childLayoutId),treeItemTemplate=getTemplateParams(childLayoutId);treeItemsPositions[childLayoutId]=childLayout.measure(levelVisibility,isCursor,isSelected,treeItemTemplate,treeItemsPositions,options)})),{treeItemsPositions:treeItemsPositions,size:treeItemsPositions[rootLayoutId].actualSize}}function getLevelVisibilities(maximumLevelIndex,possibleLevelVisibilities,cursorIndex){for(var index,levelVisibility,result=[],levelIndex=0;levelIndex<=maximumLevelIndex;levelIndex+=1)result.push(enums.EE.Normal);for(index=0;index<=cursorIndex;index+=1)result[(levelVisibility=possibleLevelVisibilities[index]).level]=levelVisibility.visibility;return result}function checkDiagramSize(diagramSize,panelSize,pageFitMode){var result=!1;switch(pageFitMode){case enums.sj.PageWidth:panelSize.width>=diagramSize.width&&(result=!0);break;case enums.sj.PageHeight:panelSize.height>=diagramSize.height&&(result=!0);break;case enums.sj.FitToPage:panelSize.height>=diagramSize.height&&panelSize.width>=diagramSize.width&&(result=!0)}return result}function getShifts(normalLevelShift,dotLevelShift,lineLevelShift,invisibleLineLevelShift){var result=[];return result[enums.EE.Normal]=normalLevelShift,result[enums.EE.Dot]=dotLevelShift,result[enums.EE.Line]=lineLevelShift,result[enums.EE.Invisible]=invisibleLineLevelShift,result}function getIntervals(normalItemsInterval,dotItemsInterval,lineItemsInterval,invisibleLineItemsInterval){var result=[];return result[enums.EE.Normal]=normalItemsInterval,result[enums.EE.Dot]=dotItemsInterval,result[enums.EE.Line]=lineItemsInterval,result[enums.EE.Invisible]=invisibleLineItemsInterval,result}return{process:function process(){var{verticalAlignment:verticalAlignment,pageFitMode:pageFitMode,minimalVisibility:minimalVisibility,padding:padding,normalLevelShift:normalLevelShift,dotLevelShift:dotLevelShift,lineLevelShift:lineLevelShift,normalItemsInterval:normalItemsInterval,dotItemsInterval:dotItemsInterval,lineItemsInterval:lineItemsInterval,checkBoxPanelSize:checkBoxPanelSize,buttonsPanelSize:buttonsPanelSize,groupTitlePanelSize:groupTitlePanelSize,groupTitlePlacementType:groupTitlePlacementType,cousinsIntervalMultiplier:cousinsIntervalMultiplier}=itemsSizesOptionTask.getOptions(),{arrowsDirection:arrowsDirection,linesWidth:linesWidth}=connectorsOptionTask.getOptions(),{maximumColumnsInMatrix:maximumColumnsInMatrix,horizontalAlignment:horizontalAlignment}=normalizeOptionTask.getOptions(),{orientationType:orientationType}=orientationOptionTask.getOptions(),isItemSelected=combinedNormalVisibilityItemsTask.isItemSelected,cursorItemId=cursorItemTask.getCursorTreeItem(),getTemplateParams=itemTemplateParamsTask.getTemplateParams,{optimalPanelSize:optimalPanelSize}=currentControlSizeTask.getOptions(),panelSize=new Size(optimalPanelSize),{scale:scale}=scaleOptionTask.getOptions();panelSize.scale(1/scale);var layoutsTree=createLayoutsTreeTask.getLayoutsTree(),rootLayoutId=null;layoutsTree.loopLevels(this,(function(nodeId,node,levelIndex){return rootLayoutId=nodeId,layoutsTree.BREAK}));var levelIndexes={},maximumLevelIndex=0,hasNodes=!1;layoutsTree.loopLevels(this,(function(layoutId,layout,levelIndex){if(null!=layout.loop){var parentId=layoutsTree.parentid(layoutId),parentLevelIndex=levelIndexes[parentId]||0;layout.loop(this,(function(treeItem,levelIndex){var itemLevelIndex=parentLevelIndex+levelIndex;levelIndexes[treeItem.id]=itemLevelIndex,maximumLevelIndex=Math.max(maximumLevelIndex,itemLevelIndex),hasNodes=!0}))}}));var options={verticalAlignment:verticalAlignment,pageFitMode:pageFitMode,padding:padding,minimalVisibility:minimalVisibility,orientationType:orientationType,arrowsDirection:arrowsDirection,linesWidth:linesWidth,checkBoxPanelSize:checkBoxPanelSize,buttonsPanelSize:buttonsPanelSize,groupTitlePanelSize:groupTitlePanelSize,groupTitlePlacementType:groupTitlePlacementType,maximumColumnsInMatrix:maximumColumnsInMatrix,horizontalAlignment:horizontalAlignment,shifts:getShifts(normalLevelShift,dotLevelShift,lineLevelShift,lineLevelShift),intervals:getIntervals(normalItemsInterval,dotItemsInterval,lineItemsInterval,lineItemsInterval),cousinsIntervalMultiplier:cousinsIntervalMultiplier};if(_data.treeItemsPositions={},_data.size=panelSize,hasNodes){var{treeItemsPositions:treeItemsPositions,size:size}=function autoFitDiagramToPageSize(panelSize,maximumLevelIndex,rootLayoutId,layoutsTree,levelIndexes,cursorItemId,isItemSelected,getTemplateParams,options){var result,possibleLevelVisibilities,enabledLevelVisibilities,{orientationType:orientationType,pageFitMode:pageFitMode,minimalVisibility:minimalVisibility}=options;switch(orientationType){case enums.F7.Left:case enums.F7.Right:panelSize.invert()}switch(pageFitMode){case enums.sj.None:case enums.sj.AutoSize:possibleLevelVisibilities=[new LevelVisibility(0,enums.EE.Normal)],enabledLevelVisibilities=getLevelVisibilities(maximumLevelIndex,possibleLevelVisibilities,0),result=measureLayout(rootLayoutId,layoutsTree,enabledLevelVisibilities,levelIndexes,cursorItemId,isItemSelected,getTemplateParams,options);break;default:if(possibleLevelVisibilities=function getPossibleLevelVisibilities(maximumLevelIndex,minimalVisibility){var result=[new LevelVisibility(0,enums.EE.Normal)],visibilities=[];switch(minimalVisibility){case enums.EE.Normal:break;case enums.EE.Dot:visibilities.push(enums.EE.Dot);break;case enums.EE.Auto:case enums.EE.Line:case enums.EE.Invisible:visibilities.push(enums.EE.Dot),visibilities.push(enums.EE.Line)}for(var levelIndex=maximumLevelIndex;levelIndex>=0;levelIndex-=1)for(var index=0;index<visibilities.length;index+=1)result.push(new LevelVisibility(levelIndex,visibilities[index]));return result}(maximumLevelIndex,minimalVisibility),enabledLevelVisibilities=getLevelVisibilities(maximumLevelIndex,possibleLevelVisibilities,possibleLevelVisibilities.length-1),checkDiagramSize((result=measureLayout(rootLayoutId,layoutsTree,enabledLevelVisibilities,levelIndexes,cursorItemId,isItemSelected,getTemplateParams,options)).size,panelSize,pageFitMode)){var minimalPlaceholderSize=new Rect(0,0,result.size.width,result.size.height);minimalPlaceholderSize.addRect(0,0,panelSize.width,panelSize.height),minimalPlaceholderSize.offset(0,0,5,5),function findOptimalSize(thisArg,maximum,funcCheckSize){var cursorIndex,minimum=0;if(!funcCheckSize.call(thisArg,minimum)){for(cursorIndex=maximum;maximum-minimum>1;)cursorIndex=Math.floor((maximum+minimum)/2),funcCheckSize.call(thisArg,cursorIndex)?maximum=cursorIndex:minimum=cursorIndex;maximum!==cursorIndex&&funcCheckSize.call(thisArg,maximum)}}(this,possibleLevelVisibilities.length-1,(function(index){return enabledLevelVisibilities=getLevelVisibilities(maximumLevelIndex,possibleLevelVisibilities,index),checkDiagramSize((result=measureLayout(rootLayoutId,layoutsTree,enabledLevelVisibilities,levelIndexes,cursorItemId,isItemSelected,getTemplateParams,options)).size,minimalPlaceholderSize,options.pageFitMode)}))}}return result}(panelSize,maximumLevelIndex,rootLayoutId,layoutsTree,levelIndexes,cursorItemId,isItemSelected,getTemplateParams,options);_data.treeItemsPositions=treeItemsPositions,_data.size=size,_data.treeItemsPositions[rootLayoutId].actualPosition=new Rect(0,0,_data.size.width,_data.size.height);var layoutsDirections={};layoutsTree.loopPreOrder(this,(function(childLayoutId,childLayout,parentLayoutId,parentLayout){var treeItemPosition=_data.treeItemsPositions[childLayoutId],layoutDirection=layoutsDirections[childLayoutId];childLayout.arrange(this,treeItemPosition.actualPosition,layoutDirection,_data.treeItemsPositions,options,(function(treeItemId,treeItemPosition,layoutDirection){_data.treeItemsPositions[treeItemId]=treeItemPosition,layoutsDirections[treeItemId]=layoutDirection}))}))}return!0},getItemsPositions:function getItemsPositions(){return _data.treeItemsPositions},getItemPosition:function getItemPosition(itemid){return _data.treeItemsPositions[itemid]},getContentSize:function getContentSize(){return _data.size}}}function AlignDiagramTask(orientationOptionTask,itemsSizesOptionTask,visualTreeOptionTask,scaleOptionTask,currentControlSizeTask,activeItemsTask,itemsPositionsTask){var _activeItems,_treeItemsPositions,_spatialIndex,_keyboardNavigationManager,_data={treeItemsPositions:{},panelSize:null};function getSpatialIndex(){if(null==_spatialIndex)for(var itemid in _spatialIndex=SpatialIndex(function getSizes(){var result=[],hash={};for(var itemid in _data.treeItemsPositions)if(_data.treeItemsPositions.hasOwnProperty(itemid)){var treeItemPosition=_data.treeItemsPositions[itemid];switch(treeItemPosition.actualVisibility){case enums.EE.Normal:case enums.EE.Dot:case enums.EE.Line:var item=treeItemPosition.actualPosition,size=Math.max(item.width,item.height);hash.hasOwnProperty(size)||(hash[size]=!0,result.push(size))}}return result}()),_data.treeItemsPositions)if(_data.treeItemsPositions.hasOwnProperty(itemid)){var treeItemPosition=_data.treeItemsPositions[itemid];if(_activeItems.hasOwnProperty(itemid))switch(treeItemPosition.actualVisibility){case enums.EE.Normal:case enums.EE.Dot:case enums.EE.Line:var rect=new Rect(treeItemPosition.actualPosition);rect.context=itemid,_spatialIndex.addRect(rect)}}return _spatialIndex}function getKeyboardNavigationManager(){if(null==_keyboardNavigationManager)for(var itemid in _keyboardNavigationManager=function KeyboardNavigationManager(){var _rows,_treeLevels,_placements=[],_cursor=null;function Cursor(itemid,row){this.itemid=itemid,this.row=row}function prepair(){if(null==_treeLevels){var levelIndex=0;_rows=SortedList(),getMinimumCrossingRows(this,_placements,(function(row){_rows.add(row,levelIndex),levelIndex+=1})),_treeLevels=TreeLevels(),_placements.sort((function(a,b){return a.horizontalCenter()-b.horizontalCenter()}));for(var index=0,len=_placements.length;index<len;index+=1){var placement=_placements[index];_rows.loopForward(this,placement.y,(function(row,levelIndex){if(row>placement.bottom())return!0;_treeLevels.addItem(levelIndex,placement.context,placement)}))}}}function getCursor(itemid){return prepair(),null!=_cursor&&_cursor.itemid==itemid||(_cursor=new Cursor(itemid,_treeLevels.getLevelIndex(itemid))),_cursor}function moveCursorNextRow(isBelow){var cursorCenter=_treeLevels.getItemContext(_cursor.itemid).horizontalCenter(),previousCursorItem=_cursor.itemid;_treeLevels.loopLevelsFromItem(this,_cursor.itemid,isBelow,(function(levelIndex){return _cursor.row=levelIndex,_cursor.itemid=_treeLevels.binarySearch(this,levelIndex,(function(itemid,placement){return cursorCenter-placement.horizontalCenter()})),!0})),previousCursorItem==_cursor.itemid&&(_cursor.row=isBelow?_treeLevels.getEndLevelIndex(_cursor.itemid):_treeLevels.getLevelIndex(_cursor.itemid))}return{addRect:function addRect(rect,itemid){var newRect=new Rect(rect);newRect.context=itemid,_placements.push(newRect)},prepair:prepair,getItemAbove:function getItemAbove(itemid){return _cursor=getCursor(itemid),moveCursorNextRow(!1),_cursor.itemid},getItemBelow:function getItemBelow(itemid){return _cursor=getCursor(itemid),moveCursorNextRow(!0),_cursor.itemid},getItemOnLeft:function getItemOnLeft(itemid){_cursor=getCursor(itemid);var nextItem=_treeLevels.getPrevItem(_cursor.itemid,_cursor.row);return null!=nextItem&&(_cursor.itemid=nextItem),_cursor.itemid},getItemOnRight:function getItemOnRight(itemid){_cursor=getCursor(itemid);var nextItem=_treeLevels.getNextItem(_cursor.itemid,_cursor.row);return null!=nextItem&&(_cursor.itemid=nextItem),_cursor.itemid},getNavigationLevels:function getNavigationLevels(){prepair();var result=[];return _treeLevels.loopLevels(this,(function(levelIndex,level){var levelItems=[];_treeLevels.loopLevelItems(this,levelIndex,(function(itemid,item,position){levelItems.push(itemid)})),result.push(levelItems)})),result}}}(),_data.treeItemsPositions)if(_data.treeItemsPositions.hasOwnProperty(itemid)){var treeItemPosition=_data.treeItemsPositions[itemid];if(_activeItems.hasOwnProperty(itemid)&&treeItemPosition.actualVisibility===enums.EE.Normal){var rect=new Rect(treeItemPosition.actualPosition);_keyboardNavigationManager.addRect(rect,itemid)}}return _keyboardNavigationManager}return{process:function process(){var placeholderSize=new Size(itemsPositionsTask.getContentSize()),{optimalPanelSize:optimalPanelSize}=currentControlSizeTask.getOptions(),{pageFitMode:pageFitMode}=itemsSizesOptionTask.getOptions(),{orientationType:orientationType}=orientationOptionTask.getOptions(),{horizontalAlignment:horizontalAlignment}=visualTreeOptionTask.getOptions(),{scale:scale}=scaleOptionTask.getOptions();_spatialIndex=null,_keyboardNavigationManager=null,_activeItems=null!=activeItemsTask?activeItemsTask.getActiveItems():{},_treeItemsPositions=itemsPositionsTask.getItemsPositions();var panelSize=new Size(optimalPanelSize);switch(orientationType){case enums.F7.Left:case enums.F7.Right:panelSize.invert()}if(panelSize.scale(1/scale),_data.panelSize=panelSize,_data.treeItemsPositions=_treeItemsPositions,pageFitMode===enums.sj.AutoSize)_data.panelSize=new Size(placeholderSize);else _data.panelSize=new Size(placeholderSize),placeholderSize.width<panelSize.width&&(_data.treeItemsPositions={},function stretchToWidth(treeItemsPositions,treeWidth,panelWidth,horizontalAlignment){var offset;switch(horizontalAlignment){case enums.a3.Left:offset=0;break;case enums.a3.Right:offset=panelWidth-treeWidth;break;case enums.a3.Center:offset=(panelWidth-treeWidth)/2}!function translateItemPositions(treeItemsPositions,offsetX,offsetY){var treeItemId,treeItemPosition;for(treeItemId in _treeItemsPositions)_treeItemsPositions.hasOwnProperty(treeItemId)&&((treeItemPosition=new TreeItemPosition(_treeItemsPositions[treeItemId])).actualPosition.translate(offsetX,offsetY),treeItemsPositions[treeItemId]=treeItemPosition)}(treeItemsPositions,offset,0)}(_data.treeItemsPositions,placeholderSize.width,panelSize.width,horizontalAlignment),_data.panelSize.width=panelSize.width),placeholderSize.height<panelSize.height&&(_data.panelSize.height=panelSize.height);switch(orientationType){case enums.F7.Left:case enums.F7.Right:_data.panelSize.invert()}return!0},getItemPosition:function getItemPosition(itemid){return _data.treeItemsPositions[itemid]},getItemsPositions:function getItemsPositions(){return _data.treeItemsPositions},getContentSize:function getContentSize(){return _data.panelSize},getTreeItemForMousePosition:function getTreeItemForMousePosition(x,y,gravityRadius){var selection,center,result=null,bestDistance=null,spatialIndex=getSpatialIndex();return selection=new Rect(x,y,0,0),center=new Point(x,y),selection.offset(gravityRadius,gravityRadius,gravityRadius,gravityRadius),spatialIndex.loopArea(this,selection,(function(rect){var itemid=rect.context;if(rect.contains(x,y))return result=itemid,!0;switch(_data.treeItemsPositions[itemid].actualVisibility){case enums.EE.Dot:case enums.EE.Line:var distance=center.distanceTo(rect.horizontalCenter(),rect.verticalCenter());(null==bestDistance||distance<bestDistance)&&(bestDistance=distance,result=itemid)}})),result},getNextItem:function getNextItem(cursorItem,direction){var result,manager=getKeyboardNavigationManager();switch(direction){case enums.F7.Top:result=manager.getItemAbove(cursorItem);break;case enums.F7.Bottom:result=manager.getItemBelow(cursorItem);break;case enums.F7.Left:result=manager.getItemOnLeft(cursorItem);break;case enums.F7.Right:result=manager.getItemOnRight(cursorItem)}return result}}}function Transform(){this.invertArea=!1,this.invertHorizontally=!1,this.invertVertically=!1,this.size=null}function CreateTransformTask(orientationOptionTask,scaleOptionTask,alignDiagramTask){var _data={transform:null};return{process:function process(){var orientationOptions=orientationOptionTask.getOptions(),panelSize=new Size(alignDiagramTask.getContentSize());return _data.transform=new Transform,_data.transform.setOrientation(orientationOptions.orientationType),_data.transform.size=new Size(panelSize),!0},getTransform:function getTransform(){return _data.transform},getTreeItemForMousePosition:function getTreeItemForMousePosition(x,y,gravityRadius){var result=null,{scale:scale}=scaleOptionTask.getOptions();return x/=scale,y/=scale,_data.transform.transformPoint(x,y,!1,this,(function(x,y){result=alignDiagramTask.getTreeItemForMousePosition(x,y,gravityRadius)})),result},description:"Create coordinate system transformation object."}}function PaletteManager(options,linesPalette){var index,len;if(this.palette=[],this.cursor=0,0===linesPalette.length)this.palette=[new PaletteItem({lineColor:options.linesColor,lineWidth:options.linesWidth,lineType:options.linesType})],this.paletteLength=this.palette.length,this.regularIndex=0;else{for(index=0,len=linesPalette.length;index<len;index+=1)this.palette.push(new PaletteItem(linesPalette[index]));this.paletteLength=this.palette.length,this.palette.push(new PaletteItem({lineColor:options.linesColor,lineWidth:options.linesWidth,lineType:options.linesType})),this.regularIndex=this.palette.length-1}this.palette.push(new PaletteItem({lineColor:options.highlightLinesColor,lineWidth:options.highlightLinesWidth,lineType:options.highlightLinesType})),this.highlightIndex=this.palette.length-1}function PaletteManagerTask(connectorsOptionTask,linePaletteOptionTask){var _paletteManager;return{process:function process(){var linesPalette=[];return null!=linePaletteOptionTask&&(linesPalette=linePaletteOptionTask.getOptions().linesPalette),_paletteManager=new PaletteManager(connectorsOptionTask.getOptions(),linesPalette),!0},getPaletteManager:function getPaletteManager(){return _paletteManager}}}function ApplyLayoutChangesTask(getGraphics,setLayout,itemsSizesOptionTask,currentControlSizeTask,scaleOptionTask,alignDiagramTask,frameSizeTask,levelTitleSizeTask){var _data={viewportSize:null,frameThickness:null,framePlaceholderSize:null};return{process:function process(){var graphics=getGraphics(),{scale:scale}=scaleOptionTask.getOptions(),{pageFitMode:pageFitMode,autoSizeMinimum:autoSizeMinimum,autoSizeMaximum:autoSizeMaximum}=itemsSizesOptionTask.getOptions(),placeholderSize=alignDiagramTask.getContentSize(),{scrollPanelSize:scrollPanelSize,hasFrame:hasFrame,hasLevelTitles:hasLevelTitles}=currentControlSizeTask.getOptions(),viewportSize=new Size(scrollPanelSize),frameThickness=frameSizeTask.getThickness(),titlesThickness=new Thickness(levelTitleSizeTask.getOptions().thickness),autoSize=pageFitMode==enums.sj.AutoSize,mousePanelSize=new Size(placeholderSize);if(mousePanelSize.scale(scale),autoSize){(viewportSize=new Size(mousePanelSize.width+25,mousePanelSize.height+25)).addThickness(frameThickness),titlesThickness.isPositive()&&viewportSize.addThickness(titlesThickness),viewportSize.cropBySize(autoSizeMaximum),viewportSize.maxSize(autoSizeMinimum);var framedViewportSize=new Size(viewportSize);framedViewportSize.removeThickness(frameThickness),titlesThickness.isPositive()&&framedViewportSize.removeThickness(titlesThickness),viewportSize.space()<2*framedViewportSize.space()?viewportSize=framedViewportSize:(frameThickness=new Thickness(0,0,0,0),titlesThickness=new Thickness(0,0,0,0))}else hasFrame||(frameThickness=new Thickness(0,0,0,0)),!hasLevelTitles&&titlesThickness.isPositive()&&(titlesThickness=new Thickness(0,0,0,0));var decorThickness=new Thickness(frameThickness);titlesThickness.isPositive()&&decorThickness.addThickness(titlesThickness);var controlSize=new Size(viewportSize);controlSize.addThickness(decorThickness);var scrollPanelRect=new Rect(decorThickness.left,decorThickness.top,viewportSize.width,viewportSize.height),framePlaceholderSize=new Size(controlSize),frameMousePanelRect=new Rect(0,0,framePlaceholderSize.width,framePlaceholderSize.height);framePlaceholderSize.scale(1/scale);var firstPoint=new Point(0,0),secondPoint=new Point(0,0);0!=titlesThickness.left?(firstPoint=new Point(scrollPanelRect.x,scrollPanelRect.y),secondPoint=new Point(scrollPanelRect.x-titlesThickness.left,scrollPanelRect.bottom())):0!=titlesThickness.right?(firstPoint=new Point(scrollPanelRect.right(),scrollPanelRect.y),secondPoint=new Point(scrollPanelRect.right()+titlesThickness.right,scrollPanelRect.bottom())):0!=titlesThickness.top?(firstPoint=new Point(scrollPanelRect.x,scrollPanelRect.y),secondPoint=new Point(scrollPanelRect.right(),scrollPanelRect.y-titlesThickness.top)):0!=titlesThickness.bottom&&(firstPoint=new Point(scrollPanelRect.x,scrollPanelRect.bottom()),secondPoint=new Point(scrollPanelRect.right(),scrollPanelRect.bottom()+titlesThickness.bottom));var titlesMousePanelRect=new Rect(firstPoint,secondPoint),titlesPlaceholderSize=new Size(titlesMousePanelRect);return titlesPlaceholderSize.scale(1/scale),graphics.resize("frameplaceholder",framePlaceholderSize.width,framePlaceholderSize.height),graphics.resize("titlesplaceholder",titlesPlaceholderSize.width,titlesPlaceholderSize.height),graphics.resize("placeholder",placeholderSize.width,placeholderSize.height),setLayout({autoSize:autoSize,controlSize:controlSize,scale:scale,frameMousePanelRect:frameMousePanelRect,framePlaceholderSize:framePlaceholderSize,titlesMousePanelRect:titlesMousePanelRect,titlesPlaceholderSize:titlesPlaceholderSize,scrollPanelRect:scrollPanelRect,mousePanelSize:mousePanelSize,placeholderSize:placeholderSize}),_data.viewportSize=viewportSize,_data.frameThickness=frameThickness,_data.frameOffset=titlesThickness.isPositive()?titlesThickness:new Thickness(0,0,0,0),_data.titlesThickness=titlesThickness,_data.framePlaceholderSize=framePlaceholderSize,!0},getOptimalPanelSize:function getOptimalPanelSize(){return new Size(_data.viewportSize.width-25,_data.viewportSize.height-25)},getScrollPanelSize:function getScrollPanelSize(){return new Size(_data.viewportSize.width,_data.viewportSize.height)},getFrameThickness:function getFrameThickness(){return new Thickness(_data.frameThickness)},getFrameOffset:function getFrameOffset(){return new Thickness(_data.frameOffset)},getTitlesThickness:function getTitlesThickness(){return new Thickness(_data.titlesThickness)}}}function CenterOnCursorTask(layoutOptionsTask,applyLayoutChangesTask,currentScrollPositionTask,cursorItemTask,alignDiagramTask,createTransformTask,scaleOptionTask){var _transform,_data={placeholderOffset:null};return{process:function process(){var snapRect,scrollPanelSize,layoutOptions=layoutOptionsTask.getOptions(),cursorTreeItemId=cursorItemTask.getCursorTreeItem(),treeItemPosition=alignDiagramTask.getItemPosition(cursorTreeItemId),contentSize=new Size(alignDiagramTask.getContentSize()),scale=scaleOptionTask.getOptions().scale;return _data.placeholderOffset=currentScrollPositionTask.getPlaceholderOffset(),layoutOptions.forceCenterOnCursor&&(_transform=createTransformTask.getTransform(),null!=treeItemPosition&&((snapRect=function getTransformedItemPosition(position){var result=!1;return _transform.transformRect(position.x,position.y,position.width,position.height,!0,this,(function(x,y,width,height){result=new Rect(x,y,width,height)})),result}(treeItemPosition.actualPosition)).scale(scale),contentSize.scale(scale),scrollPanelSize=applyLayoutChangesTask.getScrollPanelSize(),_data.placeholderOffset=new Point(Math.max(Math.min(snapRect.horizontalCenter()-scrollPanelSize.width/2,contentSize.width-scrollPanelSize.width),0),Math.max(Math.min(snapRect.verticalCenter()-scrollPanelSize.height/2,contentSize.height-scrollPanelSize.height),0)))),!0},getPlaceholderOffset:function getPlaceholderOffset(){return _data.placeholderOffset}}}function ProjectItemsToFrameTask(createTransformTask,frameSizeTask,applyLayoutChangesTask,scaleOptionTask,alignDiagramTask,centerOnCursorTask,itemTemplateParamsTask,selectedItemsTask){var _scaleOptions,_spatialIndex,_data={positions:{}};function getSpatialIndex(){if(null==_spatialIndex)for(var treeItemId in _spatialIndex=SpatialIndex(function getSizes(){var result=[],hash={};for(var treeItemId in _data.positions)if(_data.positions.hasOwnProperty(treeItemId)){var rect=_data.positions[treeItemId],size=Math.max(rect.width,rect.height);hash.hasOwnProperty(size)||(hash[size]=!0,result.push(size))}return result}()),_data.positions)if(_data.positions.hasOwnProperty(treeItemId)){var rect=_data.positions[treeItemId];rect.context=treeItemId,_spatialIndex.addRect(rect)}return _spatialIndex}return{getPositions:function getPositions(){return _data.positions},getTreeItemForMousePosition:function getTreeItemForMousePosition(x,y,gravityRadius){var selection,center,result=null,bestDistance=null,scale=_scaleOptions.scale,spatialIndex=getSpatialIndex();return selection=new Rect(x/=scale,y/=scale,0,0),center=new Point(x,y),selection.offset(gravityRadius,gravityRadius,gravityRadius,gravityRadius),spatialIndex.loopArea(this,selection,(function(rect){var itemid=rect.context,distance=center.distanceTo(rect.horizontalCenter(),rect.verticalCenter());(null==bestDistance||distance<bestDistance)&&(bestDistance=distance,result=itemid)})),result},process:function process(){var positions=alignDiagramTask.getItemsPositions(),transform=createTransformTask.getTransform();_scaleOptions=scaleOptionTask.getOptions(),_spatialIndex=null,_data.positions=[];var medianPosition=function getFrameMedianPosition(){var result=null;if(null!=centerOnCursorTask){var scale=_scaleOptions.scale,placeholderOffset=new Point(centerOnCursorTask.getPlaceholderOffset()),scrollPanelSize=new Size(applyLayoutChangesTask.getScrollPanelSize()),frameThickness=new Thickness(applyLayoutChangesTask.getFrameThickness()),frameBaseOffset=new Thickness(applyLayoutChangesTask.getFrameOffset()),medianThickness=new Thickness(frameSizeTask.getMedian());if(!frameThickness.isEmpty()){placeholderOffset.scale(1/scale),frameThickness.scale(1/scale),frameBaseOffset.scale(1/scale),scrollPanelSize.scale(1/scale),medianThickness.scale(1/scale);var frameOffset=new Point(placeholderOffset.x-frameBaseOffset.left-frameThickness.left,placeholderOffset.y-frameBaseOffset.top-frameThickness.top),medianRect=new Rect(placeholderOffset.x,placeholderOffset.y,scrollPanelSize.width,scrollPanelSize.height);medianRect.offset(frameBaseOffset),medianRect.offset(medianThickness),result={offset:frameOffset,rect:medianRect}}}return result}(),selectedItems=selectedItemsTask.getItems();if(null!=medianPosition)for(var index=0,len=selectedItems.length;index<len;index+=1){var treeItemId=selectedItems[index],actualPosition=positions[treeItemId].actualPosition;transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){var nodePosition=new Rect(x,y,width,height);if(!medianPosition.rect.overlaps(nodePosition)){var projectionPoint=medianPosition.rect.getProjectionPoint(nodePosition.centerPoint());if(null!=projectionPoint){var markerSize=new Size(itemTemplateParamsTask.getTemplateParams(treeItemId).template.templateConfig.minimizedItemSize),markerProjectionRect=new Rect(projectionPoint.x-markerSize.width/2,projectionPoint.y-markerSize.height/2,markerSize.width,markerSize.height);markerProjectionRect.translate(-medianPosition.offset.x,-medianPosition.offset.y),_data.positions[treeItemId]=markerProjectionRect}}}))}return!0}}}function ViewPortPlacementTask(scaleOptionTask,centerOnCursorTask,createTransformTask,applyLayoutChangesTask){var _data={},_hash={},_dataTemplate=new ObjectReader({viewPortPosition:new ObjectReader({x:new ValueReader(["number"],!1,0),y:new ValueReader(["number"],!1,0),width:new ValueReader(["number"],!1,0),height:new ValueReader(["number"],!1,0)},!1,new Rect(0,0,0,0))});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,function getTransformedPosition(){var viewPortPosition,transform=createTransformTask.getTransform(),position=function getPosition(){var scale=scaleOptionTask.getOptions().scale,placeholderOffset=centerOnCursorTask?new Point(centerOnCursorTask.getPlaceholderOffset()):new Point(0,0),optimalPanelSize=new Size(applyLayoutChangesTask.getOptimalPanelSize());return placeholderOffset.scale(1/scale),optimalPanelSize.scale(1/scale),new Rect(placeholderOffset.x,placeholderOffset.y,optimalPanelSize.width,optimalPanelSize.height)}();null!=position&&transform.transformRect(position.x,position.y,position.width,position.height,!1,this,(function(x,y,width,height){viewPortPosition=new Rect(x,y,width,height)}));return{viewPortPosition:viewPortPosition}}(),"options",context),context.isChanged},getViewPortPosition:function getViewPortPosition(){return _data.viewPortPosition}}}function VerticalOffsetTask(viewPortPlacementTask){var _data={},_hash={},_dataTemplate=new ObjectReader({verticalOffset:new ObjectReader({from:new ValueReader(["number"],!1,0),to:new ValueReader(["number"],!1,0)},!1,new Interval(0,0))});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,function getOffset(){return{verticalOffset:new Rect(viewPortPlacementTask.getViewPortPosition()).verticalInterval()}}(),"options",context),context.isChanged},getVerticalOffset:function getVerticalOffset(){return _data.verticalOffset}}}function OrgLogicalLevelsPlacementTask(orgTreeTask,visualTreeTask,alignDiagramTask){var _data={positions:[]};return{getPositions:function getPositions(){return _data.positions||(_data.positions=function createPositions(){var intervals=[],orgTree=orgTreeTask.getOrgTree(),itemsPositions=alignDiagramTask.getItemsPositions(),branchAligner=visualTreeTask.getBranchAligner(),visited={};orgTree.loopLevels(this,(function(nodeId,node,levelIndex){if(node.itemType!=enums.qG.Regular)return orgTree.SKIP;if(node.isVisible){var itemPosition=itemsPositions[nodeId];if(itemPosition){var levelOffset=node.levelOffset;null===levelOffset&&(levelOffset=branchAligner.getGroupSize(node.parent,GroupType.RowChildren));var interval=new Interval(itemPosition.topConnectorShift,itemPosition.bottomConnectorShift-1,levelIndex+levelOffset),key=interval.toString();visited[key]||(visited[key]=!0,intervals.push(interval))}}}));var mergedIntervals=[];getMergedIntervals(this,intervals,(function(interval){mergedIntervals.push(interval)})),intervals=mergedIntervals,mergedIntervals=[];for(var currentInterval=null,index=0,len=intervals.length;index<len;index+=1){var interval=intervals[index];currentInterval&&currentInterval.context===interval.context?currentInterval.to=interval.to:(currentInterval=interval,mergedIntervals.push(interval))}for((intervals=mergedIntervals).length>0&&(intervals[0].from=0),index=0,len=intervals.length-1;index<len;index+=1){var prev=intervals[index],next=intervals[index+1];prev.to=next.from}var minLevelIndex=null;for(index=0,len=intervals.length;index<len;index+=1)interval=intervals[index],minLevelIndex=null===minLevelIndex?interval.context:Math.min(minLevelIndex,interval.context);var result={};for(index=0,len=intervals.length;index<len;index+=1){var levelIndex=(interval=intervals[index]).context-minLevelIndex,logicalLevelPosition=result[levelIndex];logicalLevelPosition?logicalLevelPosition.push(interval):result[levelIndex]=[interval]}return result}()),_data.positions},process:function process(){return _data.positions=null,!0}}}function MergeLevelIntervalsTask(levelAnnotationOptionTask,logicalLevelsPlacementTask){var _data={positions:[]};return{getPositions:function getPositions(){return _data.positions},process:function process(){var annotations=levelAnnotationOptionTask.getAnnotations();if(_data.positions=[],annotations.length>0){var positions=logicalLevelsPlacementTask.getPositions();_data.positions=function createPositions(annotations,positions){var index,len,index2,len2,used={},result={};for(index=0,len=annotations.length;index<len;index+=1){var levels=annotations[index].levels,intervals=[];if(null!=levels&&levels.length>0)for(index2=0,len2=levels.length;index2<len2;index2+=1){var level=levels[index2];if(!used[level]){used[level]=!0;intervals=[];null!=positions[level]&&(intervals=intervals.concat(positions[level]))}}result[index]=[],getMergedIntervals(this,intervals,(function(interval){result[index].push(interval)}))}return result}(annotations,positions)}return!0}}}function BaseShape(){}function MergedRectangles(graphics){this.graphics=graphics,this.transform=null,this.lineWidth=1,this.opacity=1,this.fillColor=null,this.lineType=enums.SP.Solid,this.borderColor=null}function DrawBackgroundAnnotationTask(getGraphics,createTransformTask,applyLayoutChangesTask,backgroundAnnotationOptionTask,navigationFamilyTask,alignDiagramTask){var _graphics,_transform;return{process:function process(){var annotations=backgroundAnnotationOptionTask.getAnnotations();return(_graphics=getGraphics()).reset("placeholder",enums.S9.BackgroundAnnotation),annotations.length>0&&(alignDiagramTask.getItemsPositions(),_transform=createTransformTask.getTransform(),function drawAnnotations(annotations,positions,navigationFamily){var index,len,index2,len2,index3,len3,shape,defaultConfig,rects,rect,itemsHash,item,properties,property,annotationConfig,treeItemPosition;for(index=0,len=annotations.length;index<len;index+=1)if(null!=(annotationConfig=annotations[index]).items&&annotationConfig.items.length>0){for((shape=new MergedRectangles(_graphics)).transform=_transform,defaultConfig=new BackgroundAnnotationConfig,index3=0,len3=(properties=["opacity","lineWidth","borderColor","fillColor","lineType"]).length;index3<len3;index3+=1)shape[property=properties[index3]]=annotationConfig.hasOwnProperty(property)?annotationConfig[property]:defaultConfig[property];for(_graphics.activate("placeholder",enums.S9.BackgroundAnnotation),rects=[],itemsHash={},index2=0,len2=annotationConfig.items.length;index2<len2;index2+=1)item=annotationConfig.items[index2],null!=(treeItemPosition=alignDiagramTask.getItemPosition(item))&&(itemsHash[item]=!0,(rect=new Rect(treeItemPosition.actualPosition)).offset(annotationConfig.offset),rects.push(rect),annotationConfig.includeChildren&&navigationFamily.loopChildren(this,item,(function(childItemId,childItem){itemsHash[childItemId]||(itemsHash[childItemId]=!0,null!=(treeItemPosition=alignDiagramTask.getItemPosition(childItemId))&&((rect=new Rect(treeItemPosition.actualPosition)).offset(annotationConfig.offset),rects.push(rect)))})));shape.draw(rects)}}(annotations,0,navigationFamilyTask.getLogicalFamily())),!1}}}function PolylinesBuffer(){var polylines={};function _getPolyline(polylines,paletteItem){return polylines[paletteItem.toString()]||(polylines[paletteItem.toString()]=new Polyline(paletteItem)),polylines[paletteItem.toString()]}function loop(thisArg,onItem){var key,polyline;if(null!=onItem)for(key in polylines)if(polylines.hasOwnProperty(key)&&(polyline=polylines[key])&&(polyline.optimizeMoveSegments(),onItem.call(thisArg,polyline)))break}return{getPolyline:function getPolyline(paletteItem){return _getPolyline(polylines,paletteItem)},loop:loop,addInverted:function addInverted(callbackFun,copyOnly){var backupPolylines,backupPolyline;backupPolylines=polylines,polylines={},null!=callbackFun&&callbackFun(this),loop(this,(function(polyline){backupPolyline=_getPolyline(backupPolylines,polyline.paletteItem),copyOnly?polyline.mergeTo(backupPolyline):backupPolyline.addInverted(polyline)})),polylines=backupPolylines},transform:function transform(transformArg,forward){loop(this,(function(polyline){polyline.transform(transformArg,forward)}))}}}function DrawHighlightPathAnnotationTask(getGraphics,connectorsOptionTask,highlightPathAnnotationOptionTask,connectionsGraphTask,zOrderType){return{process:function process(){var graph=connectionsGraphTask.getGraph(),highlightOptions=connectorsOptionTask.getOptions(),annotations=highlightPathAnnotationOptionTask.getAnnotations(),graphics=getGraphics();switch(zOrderType){case enums.k0.Background:graphics.reset("placeholder",enums.S9.BackgroundHighlightPathAnnotations);break;case enums.k0.Foreground:graphics.reset("placeholder",enums.S9.ForegroundHighlightPathAnnotations)}return function drawAnnotations(graphics,highlightOptions,annotations,graph){var index,len,index2,len2,index3,firstItemId,nextItemId,path,items,connectorEdge,annotationConfig,buffer,from,to;if(annotations.length>0){switch(buffer=new PolylinesBuffer,zOrderType){case enums.k0.Background:graphics.activate("placeholder",enums.S9.BackgroundHighlightPathAnnotations);break;case enums.k0.Foreground:graphics.activate("placeholder",enums.S9.ForegroundHighlightPathAnnotations)}var pairs={};for(index=0,len=annotations.length;index<len;index+=1)if(null!=(annotationConfig=annotations[index]).items&&annotationConfig.items.length>0&&(firstItemId=(items=annotationConfig.items.slice(0))[0],graph.hasNode(firstItemId)))for(index2=1,len2=items.length;index2<len2;index2+=1)nextItemId=items[index2],graph.hasNode(nextItemId)&&(pairs.hasOwnProperty(firstItemId)?pairs[firstItemId].push(nextItemId):pairs[firstItemId]=[nextItemId],firstItemId=nextItemId);var paths={};for(from in pairs)paths[from]={},pairs.hasOwnProperty(from)&&graph.getShortestPath(this,from,pairs[from],(function(connectorEdge,fromItem,toItem){return connectorEdge.weight}),(function(path2,to2){paths[from][to2]=path2}));for(index=0,len=annotations.length;index<len;index+=1){var paletteItem=new PaletteItem({lineColor:null!=(annotationConfig=annotations[index]).color?annotationConfig.color:highlightOptions.highlightLinesColor,lineWidth:null!=annotationConfig.lineWidth?annotationConfig.lineWidth:highlightOptions.highlightLinesWidth,lineType:null!=annotationConfig.lineType?annotationConfig.lineType:highlightOptions.highlightLinesType,fillColor:null,opacity:annotationConfig.opacity}),polyline=buffer.getPolyline(paletteItem);if(null!=annotationConfig.items&&annotationConfig.items.length>0&&(firstItemId=(items=annotationConfig.items.slice(0))[0],graph.hasNode(firstItemId)))for(index2=1,len2=items.length;index2<len2;index2+=1)if(nextItemId=items[index2],graph.hasNode(nextItemId)){for(index3=(path=paths[firstItemId][nextItemId]||[]).length-2;index3>=0;index3-=1)from=path[index3+1],to=path[index3],(connectorEdge=graph.edge(from,to)).from==from?connectorEdge.polyline.clone().mergeTo(polyline):polyline.addInverted(connectorEdge.polyline.clone()),annotationConfig.showArrows&&(to!=connectorEdge.parentsArrowId&&to!=connectorEdge.childrenArrowId||polyline.addArrow(annotationConfig.lineWidth,(function(arrowPolyline){arrowPolyline.mergeTo(buffer.getPolyline(arrowPolyline.paletteItem))})));firstItemId=nextItemId}}graphics.polylinesBuffer(buffer)}}(graphics,highlightOptions,annotations,graph),!1}}}function RenderEventArgs(){this.id=null,this.element=null,this.context=null,this.templateName=null,this.renderingMode=null,this.isCursor=!1,this.isSelected=!1}function CollinearVectorBundle(){var _boundingRect=new Rect,_vectors=[],_continuations=[];return{addVector:function addVector(vector,continuation){_vectors.push(vector),_continuations.push(continuation),_boundingRect.addRect(vector.from.x,vector.from.y),_boundingRect.addRect(vector.to.x,vector.to.y)},resolve:function resolve(){if(1==_vectors.length)_continuations[0](0,1,1);else{var stackSegments=Pile();!function loopProjections(callback){var index,len,vector;if(_boundingRect.width>_boundingRect.height)for(index=0,len=_vectors.length;index<len;index+=1)callback((vector=_vectors[index]).from.x,vector.to.x,_continuations[index]);else for(index=0,len=_vectors.length;index<len;index+=1)callback((vector=_vectors[index]).from.y,vector.to.y,_continuations[index])}((function(from,to,continuation){stackSegments.add(from,to,continuation)}));stackSegments.resolve(this,(function(from,to,context,offset,bundleSize,direction){context(offset,bundleSize,direction)}))}}}}function ConnectorStraight(){}function ConnectorOffbeat(){}function DrawConnectorAnnotationTask(getGraphics,createTransformTask,applyLayoutChangesTask,orientationOptionTask,connectorAnnotationOptionTask,alignDiagramTask,annotationLabelTemplateTask,zOrderType){var _graphics,_transform,_annotationLabelTemplate,_panelSize;return{process:function process(){switch(_graphics=getGraphics(),_transform=createTransformTask.getTransform(),orientationOptionTask.getOptions(),_annotationLabelTemplate=annotationLabelTemplateTask.getTemplate(),_panelSize=new Size(alignDiagramTask.getContentSize()),zOrderType){case enums.k0.Background:_graphics.reset("placeholder",enums.S9.BackgroundConnectorAnnotation);break;case enums.k0.Foreground:_graphics.reset("placeholder",enums.S9.ForegroundConnectorAnnotation)}return function drawAnnotations(annotations,getItemPosition){enums.S9.ForegroundConnectorAnnotation;var index,len,fromItemPosition,fromActualPosition,toItemPosition,toActualPosition,shape,annotationConfig,uiHash,buffer=new PolylinesBuffer,connectorAnnotationOffsetResolver=function ConnectorAnnotationOffsetResolver(){var _bundles={};return{getOffset:function getOffset(vector,callback){var key=vector.getLineKey();_bundles.hasOwnProperty(key)||(_bundles[key]=new CollinearVectorBundle),_bundles[key].addVector(vector,callback)},resolve:function resolve(){for(var key in _bundles)_bundles.hasOwnProperty(key)&&_bundles[key].resolve()}}}(),maximumLineWidth=0;switch(zOrderType){case enums.k0.Background:_graphics.activate("placeholder",enums.S9.BackgroundConnectorAnnotation);break;case enums.k0.Foreground:_graphics.activate("placeholder",enums.S9.ForegroundConnectorAnnotation)}for(index=0,len=annotations.length;index<len;index+=1)annotationConfig=annotations[index],maximumLineWidth=Math.max(maximumLineWidth,annotationConfig.lineWidth);for(index=0,len=annotations.length;index<len;index+=1)if(null!=(annotationConfig=annotations[index]).fromItem&&null!=annotationConfig.toItem&&(fromItemPosition=getItemPosition(annotationConfig.fromItem),toItemPosition=getItemPosition(annotationConfig.toItem),null!=fromItemPosition&&null!=toItemPosition)){switch(fromActualPosition=fromItemPosition.actualPosition,toActualPosition=toItemPosition.actualPosition,annotationConfig.connectorPlacementType){case enums.$I.Offbeat:shape=new ConnectorOffbeat;break;case enums.$I.Straight:shape=new ConnectorStraight}var labelSize;_transform.transformRect(0,0,annotationConfig.labelSize.width,annotationConfig.labelSize.height,!1,this,(function(x,y,width,height){labelSize=new Size(width,height)}));var panelSize=null;_transform.transformRect(0,0,_panelSize.width,_panelSize.height,!1,this,(function(x,y,width,height){panelSize=new Size(width,height)}));var linePaletteItem=new PaletteItem({lineColor:annotationConfig.color,lineWidth:annotationConfig.lineWidth,lineType:annotationConfig.lineType}),hasLabel=!isNullOrEmpty(annotationConfig.label),fromRect=new Rect(fromActualPosition).offset(annotationConfig.offset),toRect=new Rect(toActualPosition).offset(annotationConfig.offset),linesOffset=3*annotationConfig.lineWidth,bundleOffset=6*maximumLineWidth;shape.draw(buffer,linePaletteItem,fromRect,toRect,linesOffset,bundleOffset,labelSize,panelSize,annotationConfig.connectorShapeType,4,annotationConfig.labelPlacementType,hasLabel,connectorAnnotationOffsetResolver,(function(labelPlacement,labelConfig){!isNullOrEmpty(labelConfig.label)&&null!=labelPlacement&&(_transform.transformRect(labelPlacement.x,labelPlacement.y,labelPlacement.width,labelPlacement.height,!0,this,(function(x,y,width,height){labelPlacement=new Rect(x,y,width,height)})),(uiHash=new RenderEventArgs).context=labelConfig,_graphics.template(labelPlacement.x,labelPlacement.y,0,0,0,0,labelPlacement.width,labelPlacement.height,_annotationLabelTemplate.template(),_annotationLabelTemplate.getHashCode(),_annotationLabelTemplate.render,uiHash,null))}),annotationConfig)}connectorAnnotationOffsetResolver.resolve(),buffer.transform(_transform,!0),_graphics.polylinesBuffer(buffer)}(connectorAnnotationOptionTask.getAnnotations(),alignDiagramTask.getItemPosition),!1}}}function Callout(graphics){this.m_graphics=graphics,this.pointerPlacement=enums.TK.Auto,this.cornerRadius="10%",this.offset=0,this.opacity=1,this.lineWidth=1,this.pointerWidth="10%",this.borderColor=enums.wL.Black,this.lineType=enums.SP.Solid,this.fillColor=enums.wL.LightGray,this.m_map=[[enums.TK.TopLeft,enums.TK.Left,enums.TK.BottomLeft],[enums.TK.Top,null,enums.TK.Bottom],[enums.TK.TopRight,enums.TK.Right,enums.TK.BottomRight]]}function Marker(){}function Shape(graphics){this.m_graphics=graphics,this.transform=null,this.orientationType=enums.F7.Top,this.panelSize=null,this.shapeType=enums.DY.Rectangle,this.offset=new Thickness(0,0,0,0),this.lineWidth=1,this.labelOffset=4,this.cornerRadius="10%",this.opacity=1,this.fillColor=null,this.labelSize=new Size(60,30),this.lineType=enums.SP.Solid,this.borderColor=null,this.hasLabel=!1,this.labelTemplate=null,this.labelPlacement=enums.TK.Auto}function DrawShapeAnnotationTask(getGraphics,createTransformTask,applyLayoutChangesTask,orientationOptionTask,shapeAnnotationOptionTask,alignDiagramTask,annotationLabelTemplateTask,zOrderType){var _graphics,_transform,_orientationOptions,_annotationLabelTemplate;return{process:function process(){switch(_graphics=getGraphics(),_transform=createTransformTask.getTransform(),_orientationOptions=orientationOptionTask.getOptions(),_annotationLabelTemplate=annotationLabelTemplateTask.getTemplate(),zOrderType){case enums.k0.Background:_graphics.reset("placeholder",enums.S9.BackgroundAnnotations);break;case enums.k0.Foreground:_graphics.reset("placeholder",enums.S9.ForegroundAnnotations)}return function _drawAnnotations(annotations,getItemPosition){var panel,index,len,index2,len2,index3,len3,shape,defaultConfig,itemPosition,position,properties,property,annotationConfig,uiHash;switch(zOrderType){case enums.k0.Background:panel=_graphics.activate("placeholder",enums.S9.BackgroundAnnotations);break;case enums.k0.Foreground:panel=_graphics.activate("placeholder",enums.S9.ForegroundAnnotations)}for(index=0,len=annotations.length;index<len;index+=1)if(null!=(annotationConfig=annotations[index]).items&&annotationConfig.items.length>0){for(position=new Rect,index2=0,len2=annotationConfig.items.length;index2<len2;index2+=1)null!=(itemPosition=getItemPosition(annotationConfig.items[index2]))&&position.addRect(itemPosition.actualPosition);if(!position.isEmpty()){for(shape=new Shape(_graphics),defaultConfig=new ShapeAnnotationConfig,index3=0,len3=(properties=["opacity","cornerRadius","shapeType","offset","lineWidth","borderColor","fillColor","lineType","labelSize","labelOffset","labelPlacement","zOrderType"]).length;index3<len3;index3+=1)property=properties[index3],shape[property]=annotationConfig.hasOwnProperty(property)?annotationConfig[property]:defaultConfig[property];shape.position=position,shape.orientationType=_orientationOptions.orientationType,shape.panelSize=panel.size,shape.labelTemplate=_annotationLabelTemplate,shape.hasLabel=null!=annotationConfig.templateName||null!=annotationConfig.label,(uiHash=new RenderEventArgs).context=annotationConfig,uiHash.templateName=shape.labelTemplate,_transform.transformRect(position.x,position.y,position.width,position.height,!0,this,(function(x,y,width,height){var position=new Rect(x,y,width,height);shape.draw(position,uiHash)}))}}}(shapeAnnotationOptionTask.getAnnotations(),alignDiagramTask.getItemPosition),!1}}}function DrawCursorTask(getGraphics,createTransformTask,applyLayoutChangesTask,combinedContextsTask,alignDiagramTask,itemTemplateParamsTask,cursorItemTask,selectedItemsTask){var _graphics,_transform;return{process:function process(){var treeItemId=cursorItemTask.getCursorTreeItem();return(_graphics=getGraphics()).reset("placeholder",enums.S9.Cursor),null!=treeItemId&&(_transform=createTransformTask.getTransform(),function drawCursor(treeItemId){_graphics.activate("placeholder",enums.S9.Cursor);var uiHash,treeItemPosition=alignDiagramTask.getItemPosition(treeItemId);if(null!=treeItemPosition){var actualPosition=treeItemPosition.actualPosition,position=new Rect(treeItemPosition.contentPosition),template=itemTemplateParamsTask.getTemplateParams(treeItemId).template,templateConfig=template.templateConfig,cursorPadding=templateConfig.cursorPadding;position.offset(cursorPadding.left,cursorPadding.top,cursorPadding.right,cursorPadding.bottom),(uiHash=new RenderEventArgs).context=combinedContextsTask.getConfig(treeItemId),uiHash.isCursor=!0,uiHash.isSelected=selectedItemsTask.isSelected(treeItemId),uiHash.templateName=templateConfig.name,_transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){_graphics.template(x,y,width,height,position.x,position.y,position.width,position.height,template.cursorTemplate.template(),template.cursorTemplate.getHashCode(),template.cursorTemplate.render,uiHash,{borderWidth:templateConfig.cursorBorderWidth})}))}}(treeItemId)),!1}}}function DrawHighlightTask(getGraphics,createTransformTask,applyLayoutChangesTask,combinedContextsTask,alignDiagramTask,itemTemplateParamsTask,highlightItemTask,cursorItemTask,selectedItemsTask){var _graphics,_transform;return{process:function process(){var treeItemId=highlightItemTask.getHighlightTreeItem();return(_graphics=getGraphics()).reset("placeholder",enums.S9.Highlight),null!=treeItemId&&(_transform=createTransformTask.getTransform(),function drawHighlight(treeItemId){_graphics.activate("placeholder",enums.S9.Highlight);var uiHash,treeItemPosition=alignDiagramTask.getItemPosition(treeItemId),actualPosition=treeItemPosition.actualPosition,templateParams=itemTemplateParamsTask.getTemplateParams(treeItemId),template=templateParams.template,templateConfig=template.templateConfig,highlightPadding=templateConfig.highlightPadding;(uiHash=new RenderEventArgs).context=combinedContextsTask.getConfig(treeItemId),uiHash.isCursor=cursorItemTask.getCursorTreeItem()==treeItemId,uiHash.isSelected=selectedItemsTask.isSelected(treeItemId),uiHash.templateName=templateConfig.name,_transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){var position=new Rect(0,0,Math.round(width),Math.round(height));position.offset(highlightPadding.left,highlightPadding.top,highlightPadding.right,highlightPadding.bottom),treeItemPosition.actualVisibility==enums.EE.Normal?_graphics.template(x,y,width,height,position.x,position.y,position.width,position.height,template.highlightTemplate.template(),template.highlightTemplate.getHashCode(),template.highlightTemplate.render,uiHash,{borderWidth:templateConfig.highlightBorderWidth}):_graphics.template(Math.round(x),Math.round(y),Math.round(width),Math.round(height),Math.round(position.x),Math.round(position.y),Math.round(position.width),Math.round(position.height),template.dotHighlightTemplate.template(),template.dotHighlightTemplate.getHashCode(),template.dotHighlightTemplate.render,uiHash,{borderWidth:templateConfig.highlightBorderWidth})}))}(treeItemId)),!1}}}function DrawHighlightAnnotationTask(getGraphics,createTransformTask,applyLayoutChangesTask,scaleOptionTask,combinedContextsTask,calloutOptionTask,readTemplatesTask,alignDiagramTask,centerOnCursorTask,highlightItemTask,cursorItemTask,selectedItemsTask,frameSizeTask){var _graphics,_transform,_options,_calloutShape=new Callout(getGraphics());return{process:function process(){var treeItemId=highlightItemTask.getHighlightTreeItem();return(_graphics=getGraphics()).reset("calloutplaceholder",enums.S9.Annotation),null!==treeItemId&&(_transform=createTransformTask.getTransform(),_options=calloutOptionTask.getOptions(),function drawHighlightAnnotation(treeItemId){var itemConfig,calloutPanelPosition,position,uiHash,calloutTemplateName,calloutTemplate,showCallout=!0,treeItemPosition=alignDiagramTask.getItemPosition(treeItemId),actualPosition=treeItemPosition.actualPosition;switch(treeItemPosition.actualVisibility){case enums.EE.Dot:case enums.EE.Line:case enums.EE.Normal:switch((itemConfig=calloutOptionTask.getItemOptions(treeItemId)).showCallout){case enums.xB.False:case enums.xB.True:showCallout=!1;break;default:showCallout=_options.showCallout}showCallout?(_graphics.activate("placeholder",enums.S9.Item),_transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){var snapRect=new Rect(x,y,width,height),snapPoint=new Point(snapRect.centerPoint()),{medianRect:medianRect,viewPortRect:viewPortRect}=function getFrameMedianPosition(){var scale=scaleOptionTask.getOptions().scale,placeholderOffset=new Point(centerOnCursorTask.getPlaceholderOffset()),scrollPanelSize=new Size(applyLayoutChangesTask.getScrollPanelSize()),frameBaseOffset=new Thickness(applyLayoutChangesTask.getFrameOffset()),medianThickness=new Thickness(frameSizeTask.getMedian());placeholderOffset.scale(1/scale),frameBaseOffset.scale(1/scale),scrollPanelSize.scale(1/scale),medianThickness.scale(1/scale);var viewPortRect=new Rect(placeholderOffset.x,placeholderOffset.y,scrollPanelSize.width,scrollPanelSize.height),medianRect=new Rect(viewPortRect);return medianRect.offset(frameBaseOffset),medianRect.offset(medianThickness),{medianRect:medianRect,viewPortRect:viewPortRect}}(),projectionPoint=medianRect.getProjectionPoint(snapRect.centerPoint());null==projectionPoint&&(projectionPoint=snapPoint),treeItemPosition.actualVisibility>=_options.calloutMaximumVisibility&&treeItemPosition.actualVisibility!=enums.EE.Invisible||!medianRect.overlaps(snapRect)?(calloutTemplateName=isNullOrEmpty(itemConfig.calloutTemplateName)?isNullOrEmpty(itemConfig.templateName)?isNullOrEmpty(_options.defaultCalloutTemplateName)?_options.defaultTemplateName:_options.defaultCalloutTemplateName:itemConfig.templateName:itemConfig.calloutTemplateName,calloutTemplate=readTemplatesTask.getTemplate(calloutTemplateName,readTemplatesTask.DefaultWidgetTemplateName),position=function getAnnotationPosition(snapPoint,panelRect,itemSize){var result=new Rect(snapPoint.x,snapPoint.y,itemSize.width,itemSize.height);switch(_options.orientationType){case enums.F7.Top:case enums.F7.Bottom:result.y-=itemSize.height/4,snapPoint.x<panelRect.horizontalCenter()?result.x+=_options.calloutPlacementOffset:result.x-=_options.calloutPlacementOffset+itemSize.width;break;default:result.x-=itemSize.width/4,snapPoint.y<panelRect.verticalCenter()?result.y+=_options.calloutPlacementOffset:result.y-=_options.calloutPlacementOffset+itemSize.height}result.x<panelRect.x?result.x=panelRect.x+_options.calloutPlacementOffset:result.right()>panelRect.right()&&(result.x-=result.right()-panelRect.right()+_options.calloutPlacementOffset);result.y<panelRect.y?result.y=panelRect.y+_options.calloutPlacementOffset:result.bottom()>panelRect.bottom()&&(result.y-=result.bottom()-panelRect.bottom()+_options.calloutPlacementOffset);return result}(projectionPoint,viewPortRect,calloutTemplate.templateConfig.itemSize),(calloutPanelPosition=new Rect(position)).addRect(projectionPoint.x,projectionPoint.y),calloutPanelPosition.offset(50),projectionPoint.x-=calloutPanelPosition.x,projectionPoint.y-=calloutPanelPosition.y,position.x-=calloutPanelPosition.x,position.y-=calloutPanelPosition.y,(uiHash=new RenderEventArgs).context=combinedContextsTask.getConfig(treeItemId),uiHash.isCursor=cursorItemTask.getCursorTreeItem()==treeItemId,uiHash.isSelected=selectedItemsTask.isSelected(treeItemId),uiHash.templateName=calloutTemplate.templateConfig.name,_graphics.show("calloutplaceholder"),_graphics.activate("calloutplaceholder",enums.S9.Annotation),_graphics.position("calloutplaceholder",calloutPanelPosition.x,calloutPanelPosition.y,calloutPanelPosition.width,calloutPanelPosition.height),_graphics.template(position.x,position.y,position.width,position.height,0,0,position.width,position.height,calloutTemplate.itemTemplate.template(),calloutTemplate.itemTemplate.getHashCode(),calloutTemplate.itemTemplate.render,uiHash,null),_calloutShape.pointerPlacement=enums.TK.Auto,_calloutShape.cornerRadius=_options.calloutCornerRadius,_calloutShape.offset=_options.calloutOffset,_calloutShape.opacity=_options.calloutOpacity,_calloutShape.lineWidth=_options.calloutLineWidth,_calloutShape.pointerWidth=_options.calloutPointerWidth,_calloutShape.borderColor=_options.calloutBorderColor,_calloutShape.fillColor=_options.calloutfillColor,_calloutShape.draw(projectionPoint,position)):_graphics.hide("calloutplaceholder")}))):_graphics.hide("calloutplaceholder");break;case enums.EE.Invisible:_graphics.hide("calloutplaceholder")}}(treeItemId)),!1}}}function DrawTreeItemsTask(getGraphics,createTransformTask,applyLayoutChangesTask,scaleOptionTask,itemsSizesOptionTask,combinedContextsTask,alignDiagramTask,centerOnCursorTask,itemTemplateParamsTask,cursorItemTask,selectedItemsTask,groupTitleTemplateTask,checkBoxTemplateTask,buttonsTemplateTask){var _positions,_graphics,_transform,_itemsSizesOptions,_buttonsTemplate,_checkBoxTemplate,_groupTitleTemplate;return{process:function process(){return _graphics=getGraphics(),_itemsSizesOptions=itemsSizesOptionTask.getOptions(),_positions=alignDiagramTask.getItemsPositions(),_transform=createTransformTask.getTransform(),_buttonsTemplate=buttonsTemplateTask.getTemplate(),_checkBoxTemplate=checkBoxTemplateTask.getTemplate(),_groupTitleTemplate=groupTitleTemplateTask.getTemplate(),_graphics.reset("placeholder",enums.S9.Item),_graphics.reset("placeholder",enums.S9.Controls),function redrawTreeItems(){var uiHash,treeItemPosition,actualPosition,cursorItemId=cursorItemTask.getCursorTreeItem(),viewPortPosition=function getViewPortPosition(){var result=null;if(null!=centerOnCursorTask){var scale=scaleOptionTask.getOptions().scale,placeholderOffset=new Point(centerOnCursorTask.getPlaceholderOffset()),panelSize=new Rect(alignDiagramTask.getContentSize()),optimalPanelSize=new Size(applyLayoutChangesTask.getOptimalPanelSize());placeholderOffset.scale(1/scale),optimalPanelSize.scale(1/scale),result=new Rect(placeholderOffset.x,placeholderOffset.y,Math.min(optimalPanelSize.width,panelSize.width),Math.min(optimalPanelSize.height,panelSize.height))}return result}();for(var treeItemId in _positions)_positions.hasOwnProperty(treeItemId)&&(actualPosition=(treeItemPosition=_positions[treeItemId]).actualPosition,treeItemPosition.actualVisibility==enums.EE.Normal&&_transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){var nodePosition=new Rect(x,y,width,height);if(null==viewPortPosition||viewPortPosition.overlaps(nodePosition)){var templateParams=itemTemplateParamsTask.getTemplateParams(treeItemId);if(null!=templateParams){var template=templateParams.template;if((uiHash=new RenderEventArgs).id=treeItemId,uiHash.context=combinedContextsTask.getConfig(treeItemId),uiHash.isCursor=treeItemId==cursorItemId,uiHash.isSelected=selectedItemsTask.isSelected(treeItemId),uiHash.templateName=template.templateConfig.name,uiHash.template=templateParams.template,uiHash.isActive=templateParams.isActive,uiHash.hasSelectorCheckbox=templateParams.hasSelectorCheckbox,uiHash.hasButtons=templateParams.hasButtons,uiHash.hasGroupTitle=templateParams.hasGroupTitle,uiHash.onButtonsRender=templateParams.onButtonsRender,_graphics.activate("placeholder",enums.S9.Item),_graphics.template(x,y,width,height,treeItemPosition.contentPosition.x,treeItemPosition.contentPosition.y,treeItemPosition.contentPosition.width,treeItemPosition.contentPosition.height,template.itemTemplate.template(),template.itemTemplate.getHashCode(),template.itemTemplate.render,uiHash,{borderWidth:template.templateConfig.itemBorderWidth}),templateParams.hasGroupTitle){var groupTitlePosition=0;switch(_itemsSizesOptions.groupTitlePlacementType){case enums.hZ.Left:case enums.hZ.Auto:groupTitlePosition=2;break;case enums.hZ.Right:groupTitlePosition=width-(_itemsSizesOptions.groupTitlePanelSize-4)}_graphics.template(x,y,width,height,groupTitlePosition,treeItemPosition.contentPosition.y,_itemsSizesOptions.groupTitlePanelSize-4,treeItemPosition.contentPosition.height+2,_groupTitleTemplate.template(),_groupTitleTemplate.getHashCode(),_groupTitleTemplate.render,uiHash,null)}if(templateParams.hasSelectorCheckbox&&(_graphics.activate("placeholder",enums.S9.Controls),_graphics.template(x,y,width,height,treeItemPosition.contentPosition.x,height-(_itemsSizesOptions.checkBoxPanelSize-4),treeItemPosition.contentPosition.width,_itemsSizesOptions.checkBoxPanelSize-4,_checkBoxTemplate.template(),_checkBoxTemplate.getHashCode(),_checkBoxTemplate.render,uiHash,null)),templateParams.hasButtons){_graphics.activate("placeholder",enums.S9.Controls);var buttonsPanelPosition=0;switch(_itemsSizesOptions.groupTitlePlacementType){case enums.hZ.Left:case enums.hZ.Auto:buttonsPanelPosition=width-(_itemsSizesOptions.buttonsPanelSize-4);break;case enums.hZ.Right:buttonsPanelPosition=2}_graphics.template(x,y,width,height,buttonsPanelPosition,treeItemPosition.contentPosition.y,_itemsSizesOptions.buttonsPanelSize-4,Math.max(treeItemPosition.contentPosition.height,height-treeItemPosition.contentPosition.y),_buttonsTemplate.template(),template.templateConfig.name+_buttonsTemplate.getHashCode(),_buttonsTemplate.render,uiHash,null)}}}})))}(),!1}}}function DotSegment(x,y,width,height,cornerRadius){this.segmentType=enums.vZ.Dot,this.x=x,this.y=y,this.width=width,this.height=height,this.cornerRadius=cornerRadius}function DrawMinimizedItemsTask(getGraphics,createTransformTask,applyLayoutChangesTask,minimizedItemsOptionTask,itemTemplateParamsTask,alignDiagramTask){var _graphics,_transform,_options,_positions,_debug=!1;return{process:function process(){return _graphics=getGraphics(),_transform=createTransformTask.getTransform(),_options=minimizedItemsOptionTask.getOptions(),_positions=alignDiagramTask.getItemsPositions(),_graphics.reset("placeholder",enums.S9.Marker),function drawMinimizedItems(){var itemTitleColor,itemFillColor,minimizedItemShapeType,minimizedItemCornerRadius,treeItemPosition,actualPosition,minimizedItemsOptions,templateParams,templateConfig,markers=new PolylinesBuffer,paletteItems={},marker=new Marker;for(var treeItemId in _positions)_positions.hasOwnProperty(treeItemId)&&(actualPosition=(treeItemPosition=_positions[treeItemId]).actualPosition,minimizedItemsOptions=minimizedItemsOptionTask.getItemOptions(treeItemId),_transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){switch(treeItemPosition.actualVisibility){case enums.EE.Dot:templateParams=itemTemplateParamsTask.getTemplateParams(treeItemId),templateConfig=templateParams.template.templateConfig,itemTitleColor=null,itemFillColor=null,minimizedItemShapeType=null,minimizedItemCornerRadius=0,null!=minimizedItemsOptions&&(itemTitleColor=minimizedItemsOptions.itemTitleColor,itemFillColor=minimizedItemsOptions.itemTitleColor,minimizedItemShapeType=minimizedItemsOptions.minimizedItemShapeType),itemTitleColor=itemTitleColor||templateConfig.minimizedItemBorderColor||enums.wL.Navy,itemFillColor=itemFillColor||templateConfig.minimizedItemFillColor||enums.wL.Navy,null==minimizedItemShapeType&&(minimizedItemShapeType=null!==templateConfig.minimizedItemShapeType?templateConfig.minimizedItemShapeType:_options.minimizedItemShapeType),minimizedItemCornerRadius=null===templateConfig.minimizedItemCornerRadius?templateConfig.minimizedItemSize.width:templateConfig.minimizedItemCornerRadius,null==minimizedItemShapeType||minimizedItemShapeType==enums.DY.None?markers.getPolyline(new PaletteItem({lineColor:itemTitleColor,lineWidth:templateConfig.minimizedItemLineWidth,lineType:templateConfig.minimizedItemLineType,fillColor:itemFillColor,opacity:templateConfig.minimizedItemOpacity})).addSegment(new DotSegment(x,y,width,height,minimizedItemCornerRadius)):marker.draw(markers,minimizedItemShapeType,new Rect(x,y,width,height),new PaletteItem({lineColor:itemTitleColor,lineWidth:templateConfig.minimizedItemLineWidth,lineType:templateConfig.minimizedItemLineType,fillColor:itemFillColor,opacity:templateConfig.minimizedItemOpacity}));break;case enums.EE.Invisible:_debug&&(itemTitleColor=enums.wL.Red,paletteItems.hasOwnProperty(itemTitleColor)||(paletteItems[itemTitleColor]=new PaletteItem({lineColor:itemTitleColor,lineWidth:1,lineType:enums.SP.Solid,fillColor:itemTitleColor,opacity:1})),markers.getPolyline(paletteItems[itemTitleColor]).addSegment(new DotSegment(x-4,y-4,8,8,4)))}})));_graphics.activate("placeholder",enums.S9.Marker),_graphics.polylinesBuffer(markers)}(),!1}}}function DrawConnectorsTask(getGraphics,connectionsGraphTask,connectorsOptionTask,showElbowDots,paletteManagerTask){return{process:function process(){var graphics=getGraphics(),graph=connectionsGraphTask.getGraph(),connectorsOptions=connectorsOptionTask.getOptions(),paletteManager=paletteManagerTask.getPaletteManager();graphics.reset("placeholder",enums.S9.Connector),graphics.activate("placeholder",enums.S9.Connector);var buffer=new PolylinesBuffer,elbowDotRadius=Math.round(connectorsOptions.elbowDotSize/2),processed={},processedDots={};return graph.loopNodes(this,null,(function(itemid){graph.loopNodeEdges(this,itemid,(function(to,connectorEdge){if(!processed.hasOwnProperty(to)){var paletteItem=null;connectorEdge.fromOffset<=1?paletteItem=paletteManager.getPalette(enums.ML.Regular):(paletteManager.selectPalette(connectorEdge.fromOffset),paletteItem=paletteManager.getPalette(enums.ML.Extra));var polyline=buffer.getPolyline(paletteItem);if(showElbowDots&&null!=connectorEdge.dotId&&connectorsOptions.elbowType!=enums.ex.None&&!processedDots.hasOwnProperty(connectorEdge.dotId)){var dotPolyline=buffer.getPolyline(polyline.arrowPaletteItem),dotPoint=connectorEdge.dotId==connectorEdge.from?connectorEdge.polyline.getStartPoint():connectorEdge.polyline.getEndPoint();dotPolyline.addSegment(new DotSegment(dotPoint.x-elbowDotRadius,dotPoint.y-elbowDotRadius,2*elbowDotRadius,2*elbowDotRadius,elbowDotRadius)),processedDots[connectorEdge.dotId]=!0}var arrowId=null;if(connectorEdge.hasArrow)switch(connectorsOptions.arrowsDirection){case enums.zX.Parents:arrowId=connectorEdge.isOppositeFlow?connectorEdge.childrenArrowId:connectorEdge.parentsArrowId;break;case enums.zX.Children:arrowId=connectorEdge.isOppositeFlow?connectorEdge.parentsArrowId:connectorEdge.childrenArrowId}if(null==arrowId){var newSegment=connectorEdge.polyline.clone();if(connectorEdge.hasMiddle&&connectorsOptions.arrowsDirection!=enums.zX.None){var isForward=!0;isForward=connectorEdge.from==connectorEdge.middleParent?connectorsOptions.arrowsDirection==enums.zX.Children:connectorsOptions.arrowsDirection==enums.zX.Parents,connectorEdge.isOppositeFlow&&(isForward=!isForward),newSegment.addOffsetArrow(isForward,connectorsOptions.linesWidth,.4,connectorsOptions.extraArrowsMinimumSpace,(function(arrowPolyline){arrowPolyline.mergeTo(buffer.getPolyline(polyline.arrowPaletteItem))}))}connectorEdge.from==itemid?newSegment.mergeTo(polyline):polyline.addInverted(newSegment)}else arrowId==connectorEdge.to?connectorEdge.polyline.clone().mergeTo(polyline):polyline.addInverted(connectorEdge.polyline.clone()),polyline.addArrow(connectorsOptions.linesWidth,(function(arrowPolyline){arrowPolyline.mergeTo(buffer.getPolyline(arrowPolyline.paletteItem))}))}})),processed[itemid]=!0})),graphics.polylinesBuffer(buffer),!1}}}function Label(){this.text=null,this.position=null,this.weight=0,this.isActive=!0,this.labelType=enums.JG.Regular,this.labelOrientation=enums.GE.Horizontal,this.horizontalAlignmentType=enums.a3.Center,this.verticalAlignmentType=enums.Vn.Bottom,this.parent=Rect.prototype,this.parent.constructor.apply(this,arguments)}function DrawItemLabelsTask(getGraphics,createTransformTask,applyLayoutChangesTask,labelsOptionTask,alignDiagramTask){function createLabel(x,y,width,height,labelOptions,treeItemPosition,options){var labelWidth,labelHeight,labelSize,labelPlacement,weight,result=null;if(!isNullOrEmpty(labelOptions.label)){var labelType=function getLabelType(actualVisibility,showLabel,showLabels){var result=enums.JG.None;switch(showLabel){case enums.xB.Auto:switch(showLabels){case enums.xB.Auto:switch(actualVisibility){case enums.EE.Line:case enums.EE.Dot:result=enums.JG.Regular}break;case enums.xB.False:break;case enums.xB.True:result=enums.JG.Fixed}break;case enums.xB.False:break;case enums.xB.True:result=enums.JG.Fixed}return result}(treeItemPosition.actualVisibility,labelOptions.showLabel,options.showLabels);switch(labelType){case enums.JG.Regular:weight=treeItemPosition.actualSize.width+treeItemPosition.actualSize.height;break;case enums.JG.Fixed:weight=1e4;break;case enums.JG.None:weight=0}if(labelType!=enums.JG.None){labelSize=null!=labelOptions.labelSize?labelOptions.labelSize:options.labelSize;var labelOrientation=labelOptions.labelOrientation!=enums.GE.Auto?labelOptions.labelOrientation:options.labelOrientation!=enums.GE.Auto?options.labelOrientation:enums.GE.Horizontal;switch(labelPlacement=labelOptions.labelPlacement!=enums.TK.Auto?labelOptions.labelPlacement:options.labelPlacement!=enums.TK.Auto?options.labelPlacement:enums.TK.Top,labelOrientation){case enums.GE.Horizontal:labelWidth=labelSize.width,labelHeight=labelSize.height;break;case enums.GE.RotateLeft:case enums.GE.RotateRight:labelHeight=labelSize.width,labelWidth=labelSize.height}var position=function getLabelPosition(labelPlacement,labelOrientation,x,y,width,height,labelWidth,labelHeight,labelOffset){var position,horizontalAlignmentType,verticalAlignmentType;switch(labelPlacement){case enums.TK.Auto:case enums.TK.Top:switch(position=new Rect(x+width/2-labelWidth/2,y-labelOffset-labelHeight,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Center,verticalAlignmentType=enums.Vn.Bottom;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Middle;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Middle}break;case enums.TK.TopRight:case enums.TK.RightTop:switch(position=new Rect(x+width+labelOffset,y-labelOffset-labelHeight,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Bottom;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Top;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Bottom}break;case enums.TK.Right:switch(position=new Rect(x+width+labelOffset,y+height/2-labelHeight/2,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Middle;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Center,verticalAlignmentType=enums.Vn.Top;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Center,verticalAlignmentType=enums.Vn.Bottom}break;case enums.TK.BottomRight:case enums.TK.RightBottom:switch(position=new Rect(x+width+labelOffset,y+height+labelOffset,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Top;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Top;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Bottom}break;case enums.TK.Bottom:switch(position=new Rect(x+width/2-labelWidth/2,y+height+labelOffset,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Center,verticalAlignmentType=enums.Vn.Top;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Middle;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Middle}break;case enums.TK.BottomLeft:case enums.TK.LeftBottom:switch(position=new Rect(x-labelWidth-labelOffset,y+height+labelOffset,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Top;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Bottom;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Top}break;case enums.TK.Left:switch(position=new Rect(x-labelWidth-labelOffset,y+height/2-labelHeight/2,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Middle;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Center,verticalAlignmentType=enums.Vn.Bottom;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Center,verticalAlignmentType=enums.Vn.Top}break;case enums.TK.TopLeft:case enums.TK.LeftTop:switch(position=new Rect(x-labelWidth-labelOffset,y-labelOffset-labelHeight,labelWidth,labelHeight),labelOrientation){case enums.GE.Horizontal:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Bottom;break;case enums.GE.RotateLeft:horizontalAlignmentType=enums.a3.Left,verticalAlignmentType=enums.Vn.Bottom;break;case enums.GE.RotateRight:horizontalAlignmentType=enums.a3.Right,verticalAlignmentType=enums.Vn.Top}}return{position:position,horizontalAlignmentType:horizontalAlignmentType,verticalAlignmentType:verticalAlignmentType}}(labelPlacement,labelOrientation,x,y,width,height,labelWidth,labelHeight,options.labelOffset);(result=new Label(position.position)).labelType=labelType,result.weight=weight,result.text=labelOptions.label,result.labelOrientation=labelOrientation,result.horizontalAlignmentType=position.horizontalAlignmentType,result.verticalAlignmentType=position.verticalAlignmentType}}return result}return{process:function process(){var labelsOption=labelsOptionTask.getOptions(),params={graphics:getGraphics(),transform:createTransformTask.getTransform(),treeItemsPositions:alignDiagramTask.getItemsPositions()},options={showLabels:labelsOption.showLabels,labelFontSize:labelsOption.labelFontSize,labelFontFamily:labelsOption.labelFontFamily,labelFontStyle:labelsOption.labelFontStyle,labelFontWeight:labelsOption.labelFontWeight,labelColor:labelsOption.labelColor,itemsOptions:labelsOptionTask.getItemsOptions(),labelSize:labelsOption.labelSize,labelOrientation:labelsOption.labelOrientation,labelPlacement:labelsOption.labelPlacement,labelOffset:labelsOption.labelOffset};return params.graphics.reset("placeholder",enums.S9.Label),function redrawLabels(params,options){var labels=[];if(options.showLabels==enums.xB.Auto||options.showLabels==enums.xB.True)for(var treeItemId in params.treeItemsPositions)if(params.treeItemsPositions.hasOwnProperty(treeItemId)){var labelOptions=options.itemsOptions[treeItemId],treeItemPosition=params.treeItemsPositions[treeItemId],actualPosition=treeItemPosition.actualPosition;null!=labelOptions&&params.transform.transformRect(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,!0,this,(function(x,y,width,height){switch(treeItemPosition.actualVisibility){case enums.EE.Normal:options.showLabels==enums.xB.Auto&&((label=new Label(x,y,width,height)).weight=1e4,label.labelType=enums.JG.Dummy,labels.push(label));break;case enums.EE.Dot:case enums.EE.Line:var label=createLabel(x,y,width,height,labelOptions,treeItemPosition,options);null!=label&&labels.push(label)}}))}options.showLabels==enums.xB.Auto&&getCrossingRectangles(this,labels,(function(label1,label2){if(label1.isActive&&label2.isActive)switch(label1.labelType){case enums.JG.Dummy:switch(label2.labelType){case enums.JG.Dummy:break;case enums.JG.Regular:case enums.JG.Fixed:label2.isActive=!1}break;case enums.JG.Fixed:switch(label2.labelType){case enums.JG.Dummy:label1.isActive=!1;break;case enums.JG.Regular:label2.isActive=!1;case enums.JG.Fixed:}break;case enums.JG.Regular:switch(label2.labelType){case enums.JG.Dummy:label1.isActive=!1;break;case enums.JG.Regular:label1.weight<=label2.weight?label1.isActive=!1:label2.isActive=!1;break;case enums.JG.Fixed:label1.isActive=!1}}}));params.graphics.activate("placeholder",enums.S9.Label);for(var attr={fontSize:options.labelFontSize,fontFamily:options.labelFontFamily,fontStyle:options.labelFontStyle,fontWeight:options.labelFontWeight,fontColor:options.labelColor},index=0,len=labels.length;index<len;index+=1){var label=labels[index];if(label.isActive)switch(label.labelType){case enums.JG.Regular:case enums.JG.Fixed:params.graphics.text(label.x,label.y,label.width,label.height,label.text,label.labelOrientation,label.horizontalAlignmentType,label.verticalAlignmentType,attr)}}}(params,options),!1}}}function DrawFrameItemsTask(getGraphics,applyLayoutChangesTask,projectItemsToFrameTask,itemTemplateParamsTask,minimizedItemsOptionTask){var _graphics;return{process:function process(){var frameThickness=new Thickness(applyLayoutChangesTask.getFrameThickness());return(_graphics=getGraphics()).reset("frameplaceholder",enums.S9.Marker),frameThickness.isEmpty()||function drawFrameItems(){var markers=new PolylinesBuffer,positions=projectItemsToFrameTask.getPositions(),options=minimizedItemsOptionTask.getOptions(),marker=new Marker;for(var treeItemId in positions)if(positions.hasOwnProperty(treeItemId)){var actualPosition=positions[treeItemId],templateConfig=itemTemplateParamsTask.getTemplateParams(treeItemId).template.templateConfig,minimizedItemsOptions=minimizedItemsOptionTask.getItemOptions(treeItemId),itemTitleColor=null,itemFillColor=null,minimizedItemShapeType=null,minimizedItemCornerRadius=0;null!=minimizedItemsOptions&&(itemTitleColor=minimizedItemsOptions.itemTitleColor,itemFillColor=minimizedItemsOptions.itemTitleColor,minimizedItemShapeType=minimizedItemsOptions.minimizedItemShapeType),itemTitleColor=itemTitleColor||templateConfig.minimizedItemBorderColor||enums.wL.Navy,itemFillColor=itemFillColor||templateConfig.minimizedItemFillColor||enums.wL.Navy,null==minimizedItemShapeType&&(minimizedItemShapeType=null!==templateConfig.minimizedItemShapeType?templateConfig.minimizedItemShapeType:options.minimizedItemShapeType),minimizedItemCornerRadius=null===templateConfig.minimizedItemCornerRadius?templateConfig.minimizedItemSize.width:templateConfig.minimizedItemCornerRadius,null==minimizedItemShapeType||minimizedItemShapeType==enums.DY.None?markers.getPolyline(new PaletteItem({lineColor:itemTitleColor,lineWidth:templateConfig.minimizedItemLineWidth,lineType:templateConfig.minimizedItemLineType,fillColor:itemFillColor,opacity:templateConfig.minimizedItemOpacity})).addSegment(new DotSegment(actualPosition.x,actualPosition.y,actualPosition.width,actualPosition.height,minimizedItemCornerRadius)):marker.draw(markers,minimizedItemShapeType,actualPosition,new PaletteItem({lineColor:itemTitleColor,lineWidth:templateConfig.minimizedItemLineWidth,lineType:templateConfig.minimizedItemLineType,fillColor:itemFillColor,opacity:templateConfig.minimizedItemOpacity}))}_graphics.activate("frameplaceholder",enums.S9.Marker),_graphics.polylinesBuffer(markers)}(),!1}}}function DrawFrameHighlightTask(getGraphics,projectItemsToFrameTask,combinedContextsTask,itemTemplateParamsTask,highlightItemTask,cursorItemTask){var _graphics;return{process:function process(){var treeItemId=highlightItemTask.getHighlightTreeItem();return(_graphics=getGraphics()).reset("frameplaceholder",enums.S9.Highlight),null!=treeItemId&&function drawHighlight(treeItemId){var uiHash,position=projectItemsToFrameTask.getPositions()[treeItemId];if(null!=position){var template=itemTemplateParamsTask.getTemplateParams(treeItemId).template,templateConfig=template.templateConfig,highlightPadding=templateConfig.highlightPadding;_graphics.activate("frameplaceholder",enums.S9.Highlight),(uiHash=new RenderEventArgs).context=combinedContextsTask.getConfig(treeItemId),uiHash.isCursor=cursorItemTask.getCursorTreeItem()==treeItemId,uiHash.isSelected=!0,uiHash.templateName=templateConfig.name;var contentPosition=new Rect(0,0,Math.round(position.width),Math.round(position.height));contentPosition.offset(highlightPadding.left,highlightPadding.top,highlightPadding.right,highlightPadding.bottom),_graphics.template(Math.round(position.x),Math.round(position.y),Math.round(position.width),Math.round(position.height),Math.round(contentPosition.x),Math.round(contentPosition.y),Math.round(contentPosition.width),Math.round(contentPosition.height),template.dotHighlightTemplate.template(),template.dotHighlightTemplate.getHashCode(),template.dotHighlightTemplate.render,uiHash,{borderWidth:templateConfig.highlightBorderWidth})}}(treeItemId),!1}}}function DrawLevelAnnotationTitlesTask(getGraphics,verticalOffsetTask,createTransformTask,applyLayoutChangesTask,levelAnnotationOptionTask,mergeLevelIntervalsTask,levelAnnotationTemplateTask,levelTitlePlacementOptionTask){var _graphics,_positions,_transform,_template;return{process:function process(){var annotations=levelAnnotationOptionTask.getAnnotations();return(_graphics=getGraphics()).reset("titlesplaceholder",enums.S9.LevelAnnotation),annotations.length>0&&(_positions=mergeLevelIntervalsTask.getPositions(),_transform=createTransformTask.getTransform(),_template=levelAnnotationTemplateTask.getTitleTemplate(),function drawAnnotations(annotations,positions){var transformedVerticalOffset,verticalOffset=new Interval(verticalOffsetTask.getVerticalOffset()),{levelTitlePanelSize:levelTitlePanelSize}=levelTitlePlacementOptionTask.getOptions();_graphics.activate("titlesplaceholder",enums.S9.LevelAnnotation),_transform.transformRect(0,verticalOffset.from,0,verticalOffset.width(),!0,this,(function(x,y,width,height){transformedVerticalOffset=new Rect(x,y,width,height)}));for(var index=0,len=annotations.length;index<len;index+=1){var annotationConfig=annotations[index],intervals=positions[index];if(null!=intervals)for(var index3=0,len3=intervals.length;index3<len3;index3+=1){var interval=intervals[index3],position=new Rect(0,interval.from,levelTitlePanelSize,interval.width());if(position.verticalInterval().overlaps(verticalOffset)){var offset=new Thickness(0,annotationConfig.offset.top,0,annotationConfig.offset.bottom);position.offset(offset);var uiHash=new RenderEventArgs;uiHash.context=annotationConfig,_transform.transformRect(position.x,position.y,position.width,position.height,!0,this,(function(x,y,width,height){_graphics.template(x-transformedVerticalOffset.x,y-transformedVerticalOffset.y,width,height,0,0,width,height,_template.template(),_template.getHashCode(),_template.render,uiHash,null)}))}}}}(annotations,_positions)),!1}}}function DrawLevelAnnotationBackgroundTask(getGraphics,verticalOffsetTask,createTransformTask,applyLayoutChangesTask,levelAnnotationOptionTask,mergeLevelIntervalsTask,levelAnnotationTemplateTask){var _graphics,_positions,_transform,_backgroundTemplate;return{process:function process(){var annotations=levelAnnotationOptionTask.getAnnotations();return(_graphics=getGraphics()).reset("placeholder",enums.S9.LevelAnnotation),annotations.length>0&&(_positions=mergeLevelIntervalsTask.getPositions(),_transform=createTransformTask.getTransform(),_backgroundTemplate=levelAnnotationTemplateTask.getBackgroundTemplate(),function drawAnnotations(annotations,positions){var panelRect,verticalOffset=new Interval(verticalOffsetTask.getVerticalOffset()),panel=_graphics.activate("placeholder",enums.S9.LevelAnnotation);_transform.transformRect(0,0,panel.size.width,panel.size.height,!1,this,(function(x,y,width,height){panelRect=new Rect(x,y,width,height)}));for(var index=0,len=annotations.length;index<len;index+=1){var annotationConfig=annotations[index],lineWidth=_transform.transformThickness(annotationConfig.lineWidth,!0),intervals=positions[index];if(null!=intervals)for(var index3=0,len3=intervals.length;index3<len3;index3+=1){var interval=intervals[index3],position=new Rect(0,interval.from,panelRect.width,interval.width());if(position.offset(annotationConfig.offset),position.verticalInterval().overlaps(verticalOffset)){var uiHash=new RenderEventArgs;uiHash.context=annotationConfig,mergeObjects(uiHash.context,{lineWidth:lineWidth}),_transform.transformRect(position.x,position.y,position.width,position.height,!0,this,(function(x,y,width,height){_graphics.template(x,y,width,height,0,0,width,height,_backgroundTemplate.template(),_backgroundTemplate.getHashCode(),_backgroundTemplate.render,uiHash,null)}))}}}}(annotations,_positions)),!1}}}function TaskManagerFactory(getOptions,getGraphics,getLayout,setLayout,templates){var tasks=new TaskManager;return tasks.addDependency("options",getOptions),tasks.addDependency("graphics",getGraphics),tasks.addDependency("getLayout",getLayout),tasks.addDependency("setLayout",setLayout),tasks.addDependency("templates",templates),tasks.addDependency("defaultConfig",new OrgConfig),tasks.addDependency("defaultItemConfig",new OrgItemConfig),tasks.addDependency("defaultTemplateConfig",new TemplateConfig),tasks.addDependency("defaultBackgroundAnnotationConfig",new BackgroundAnnotationConfig),tasks.addDependency("defaultConnectorAnnotationConfig",new ConnectorAnnotationConfig),tasks.addDependency("defaultHighlightPathAnnotationConfig",new HighlightPathAnnotationConfig),tasks.addDependency("defaultShapeAnnotationConfig",new ShapeAnnotationConfig),tasks.addDependency("defaultLevelAnnotationConfig",new LevelAnnotationConfig),tasks.addDependency("showElbowDots",!1),tasks.addDependency("null",null),tasks.addDependency("foreground",enums.k0.Foreground),tasks.addDependency("background",enums.k0.Background),tasks.addTask("OptionsTask",["options"],OptionsTask,enums.wL.Black),tasks.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],CalloutOptionTask,enums.wL.Navy),tasks.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],ConnectorsOptionTask,enums.wL.Navy),tasks.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],OrgItemsOptionTask,enums.wL.Navy),tasks.addTask("ItemsContentOptionTask",["OptionsTask","defaultItemConfig"],ItemsContentOptionTask,enums.wL.Navy),tasks.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],ItemsSizesOptionTask,enums.wL.Navy),tasks.addTask("MinimumVisibleLevelsOptionTask",["OptionsTask","defaultConfig"],MinimumVisibleLevelsOptionTask,enums.wL.Navy),tasks.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],LabelsOptionTask,enums.wL.Navy),tasks.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultTemplateConfig"],TemplatesOptionTask,enums.wL.Navy),tasks.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],OrientationOptionTask,enums.wL.Navy),tasks.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],OrgVisualTreeOptionTask,enums.wL.Navy),tasks.addTask("MinimizedItemsOptionTask",["OptionsTask"],MinimizedItemsOptionTask,enums.wL.Navy),tasks.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],CursorItemOptionTask,enums.wL.Navy),tasks.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],HighlightItemOptionTask,enums.wL.Navy),tasks.addTask("SelectedItemsOptionTask",["OptionsTask"],SelectedItemsOptionTask,enums.wL.Navy),tasks.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],CursorSelectionPathModeOptionTask,enums.wL.Navy),tasks.addTask("SplitAnnotationsOptionTask",["OptionsTask"],SplitAnnotationsOptionTask,enums.wL.Cyan),tasks.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],BackgroundAnnotationOptionTask,enums.wL.Navy),tasks.addTask("LevelAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultLevelAnnotationConfig"],LevelAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],ScaleOptionTask,enums.wL.Navy),tasks.addTask("FrameOptionTask",["OptionsTask","defaultConfig"],FrameOptionTask,enums.wL.Navy),tasks.addTask("LevelTitlePlacementOptionTask",["OptionsTask","defaultConfig"],LevelTitlePlacementOptionTask,enums.wL.Navy),tasks.addTask("LevelTitleTemplateOptionTask",["OptionsTask","defaultConfig"],LevelTitleTemplateOptionTask,enums.wL.Navy),tasks.addTask("CombinedContextsTask",["ItemsContentOptionTask"],CombinedContextsTask,enums.wL.Cyan),tasks.addTask("OrgTreeTask",["ItemsOptionTask"],OrgTreeTask,enums.wL.Red),tasks.addTask("ReadTemplatesTask",["TemplatesOptionTask","templates"],ReadTemplatesTask,enums.wL.Cyan),tasks.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],ActiveItemsTask,enums.wL.Cyan),tasks.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],ItemTemplateParamsTask,enums.wL.Cyan),tasks.addTask("GroupTitleTemplateTask",["TemplatesOptionTask","templates"],GroupTitleTemplateTask,enums.wL.Cyan),tasks.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask","templates"],CheckBoxTemplateTask,enums.wL.Cyan),tasks.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],ButtonsTemplateTask,enums.wL.Cyan),tasks.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask","templates"],AnnotationLabelTemplateTask,enums.wL.Cyan),tasks.addTask("LevelAnnotationTemplateTask",["OrientationOptionTask","LevelTitleTemplateOptionTask","templates"],LevelAnnotationTemplateTask,enums.wL.Cyan),tasks.addTask("VisualTreeTask",["OrgTreeTask","ActiveItemsTask","VisualTreeOptionTask"],VisualTreeTask,enums.wL.Red),tasks.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],VisualTreeLevelsTask,enums.wL.Red),tasks.addTask("ExtractNestedLayoutsTask",["OptionsTask"],OrgExtractNestedLayoutsTask,enums.wL.Red),tasks.addTask("CreateLayoutsTreeTask",["VisualTreeTask","VisualTreeLevelsTask","ExtractNestedLayoutsTask"],OrgCreateLayoutsTreeTask,enums.wL.Red),tasks.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","ExtractNestedLayoutsTask","AlignDiagramTask"],ConnectionsGraphTask,enums.wL.Cyan),tasks.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],HighlightItemTask,enums.wL.Cyan),tasks.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],CursorItemTask,enums.wL.Cyan),tasks.addTask("CursorNeighboursTask",["CursorItemTask","VisualTreeTask"],OrgCursorNeighboursTask,enums.wL.Cyan),tasks.addTask("SelectedItemsTask",["SelectedItemsOptionTask","ItemsOptionTask"],SelectedItemsTask,enums.wL.Cyan),tasks.addTask("SelectionPathItemsTask",["VisualTreeTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],OrgSelectionPathItemsTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",["ForegroundConnectorAnnotationOptionTask"],NormalVisibilityItemsByConnectorAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],NormalVisibilityItemsByConnectorAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByMinimumVisibleLevelsTask",["MinimumVisibleLevelsOptionTask","OrgTreeTask"],OrgNormalVisibilityItemsByMinimumVisibleLevelsTask,enums.wL.Cyan),tasks.addTask("CombinedNormalVisibilityItemsTask",["ItemsSizesOptionTask","CursorItemTask","CursorNeighboursTask","SelectedItemsTask","SelectionPathItemsTask","NormalVisibilityItemsByForegroundShapeAnnotationTask","NormalVisibilityItemsByBackgroundShapeAnnotationTask","NormalVisibilityItemsByBackgroundAnnotationTask","NormalVisibilityItemsByForegroundHighlightPathAnnotationTask","NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask","NormalVisibilityItemsByForegroundConnectorAnnotationTask","NormalVisibilityItemsByBackgroundConnectorAnnotationTask","NormalVisibilityItemsByMinimumVisibleLevelsTask"],CombinedNormalVisibilityItemsTask,enums.wL.Cyan),tasks.addTask("FrameSizeTask",["FrameOptionTask","ReadTemplatesTask","ScaleOptionTask"],FrameSizeTask,enums.wL.Navy),tasks.addTask("LevelTitleSizeTask",["LevelTitlePlacementOptionTask","LevelAnnotationOptionTask","OrientationOptionTask","ScaleOptionTask"],LevelTitleSizeTask,enums.wL.Navy),tasks.addTask("LayoutOptionsTask",["getLayout","OptionsTask"],LayoutOptionsTask,enums.wL.Black),tasks.addTask("CurrentControlSizeTask",["LayoutOptionsTask","ItemsSizesOptionTask","FrameSizeTask","LevelTitleSizeTask"],CurrentControlSizeTask,enums.wL.Black),tasks.addTask("CurrentScrollPositionTask",["LayoutOptionsTask"],CurrentScrollPositionTask,enums.wL.Black),tasks.addTask("ItemsPositionsTask",["CurrentControlSizeTask","ScaleOptionTask","OrientationOptionTask","ItemsSizesOptionTask","ConnectorsOptionTask","VisualTreeOptionTask","CreateLayoutsTreeTask","ItemTemplateParamsTask","CursorItemTask","CombinedNormalVisibilityItemsTask"],ItemsPositionsTask,enums.wL.Red),tasks.addTask("AlignDiagramTask",["OrientationOptionTask","ItemsSizesOptionTask","VisualTreeOptionTask","ScaleOptionTask","CurrentControlSizeTask","ActiveItemsTask","ItemsPositionsTask"],AlignDiagramTask,enums.wL.Red),tasks.addTask("CreateTransformTask",["OrientationOptionTask","ScaleOptionTask","AlignDiagramTask"],CreateTransformTask,enums.wL.Cyan),tasks.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],PaletteManagerTask,enums.wL.Cyan),tasks.addTask("ApplyLayoutChangesTask",["graphics","setLayout","ItemsSizesOptionTask","CurrentControlSizeTask","ScaleOptionTask","AlignDiagramTask","FrameSizeTask","LevelTitleSizeTask"],ApplyLayoutChangesTask,enums.wL.Green),tasks.addTask("CenterOnCursorTask",["LayoutOptionsTask","ApplyLayoutChangesTask","CurrentScrollPositionTask","CursorItemTask","AlignDiagramTask","CreateTransformTask","ScaleOptionTask"],CenterOnCursorTask,enums.wL.Cyan),tasks.addTask("ProjectItemsToFrameTask",["CreateTransformTask","FrameSizeTask","ApplyLayoutChangesTask","ScaleOptionTask","AlignDiagramTask","CenterOnCursorTask","ItemTemplateParamsTask","SelectedItemsTask"],ProjectItemsToFrameTask,enums.wL.Green),tasks.addTask("ViewPortPlacementTask",["ScaleOptionTask","CenterOnCursorTask","CreateTransformTask","ApplyLayoutChangesTask"],ViewPortPlacementTask,enums.wL.Green),tasks.addTask("VerticalOffsetTask",["ViewPortPlacementTask"],VerticalOffsetTask,enums.wL.Green),tasks.addTask("LogicalLevelsPlacementTask",["OrgTreeTask","VisualTreeTask","AlignDiagramTask"],OrgLogicalLevelsPlacementTask,enums.wL.Green),tasks.addTask("MergeLevelIntervalsTask",["LevelAnnotationOptionTask","LogicalLevelsPlacementTask"],MergeLevelIntervalsTask,enums.wL.Green),tasks.addTask("DrawBackgroundAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","BackgroundAnnotationOptionTask","VisualTreeTask","AlignDiagramTask"],DrawBackgroundAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawForegroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawForegroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawCursorTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","ItemTemplateParamsTask","CursorItemTask","SelectedItemsTask"],DrawCursorTask,enums.wL.Green),tasks.addTask("DrawHighlightTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","ItemTemplateParamsTask","HighlightItemTask","CursorItemTask","SelectedItemsTask"],DrawHighlightTask,enums.wL.Green),tasks.addTask("DrawHighlightAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","ScaleOptionTask","CombinedContextsTask","CalloutOptionTask","ReadTemplatesTask","AlignDiagramTask","CenterOnCursorTask","HighlightItemTask","CursorItemTask","SelectedItemsTask","FrameSizeTask"],DrawHighlightAnnotationTask,enums.wL.Green),tasks.addTask("DrawTreeItemsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","ScaleOptionTask","ItemsSizesOptionTask","CombinedContextsTask","AlignDiagramTask","CenterOnCursorTask","ItemTemplateParamsTask","CursorItemTask","SelectedItemsTask","GroupTitleTemplateTask","CheckBoxTemplateTask","ButtonsTemplateTask"],DrawTreeItemsTask,enums.wL.Green),tasks.addTask("DrawMinimizedItemsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","MinimizedItemsOptionTask","ItemTemplateParamsTask","AlignDiagramTask"],DrawMinimizedItemsTask,enums.wL.Green),tasks.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],DrawConnectorsTask,enums.wL.Green),tasks.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],DrawItemLabelsTask,enums.wL.Green),tasks.addTask("DrawFrameItemsTask",["graphics","ApplyLayoutChangesTask","ProjectItemsToFrameTask","ItemTemplateParamsTask","MinimizedItemsOptionTask"],DrawFrameItemsTask,enums.wL.Green),tasks.addTask("DrawFrameHighlightTask",["graphics","ProjectItemsToFrameTask","CombinedContextsTask","ItemTemplateParamsTask","HighlightItemTask","CursorItemTask"],DrawFrameHighlightTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationBackgroundTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask"],DrawLevelAnnotationBackgroundTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationTitlesTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask","LevelTitlePlacementOptionTask"],DrawLevelAnnotationTitlesTask,enums.wL.Green),tasks}function EventArgsFactory(data,oldTreeItemId,newTreeItemId,name){var itemPosition,offset,panelOffset,result=new OrgEventArgs,combinedContextsTask=data.tasks.getTask("CombinedContextsTask"),alignDiagramTask=data.tasks.getTask("AlignDiagramTask"),oldItemConfig=combinedContextsTask.getConfig(oldTreeItemId),newItemConfig=combinedContextsTask.getConfig(newTreeItemId);return oldItemConfig&&null!=oldItemConfig.id&&(result.oldContext=oldItemConfig),newItemConfig&&null!=newItemConfig.id&&(result.context=newItemConfig,null!==newItemConfig.parent&&(result.parentItem=combinedContextsTask.getConfig(newItemConfig.parent)),panelOffset=getElementOffset(data.layout.mousePanel),offset=getElementOffset(data.layout.element),itemPosition=alignDiagramTask.getItemPosition(newTreeItemId),result.position=new Rect(itemPosition.actualPosition).translate(panelOffset.left,panelOffset.top).translate(-offset.left,-offset.top)),null!=name&&(result.name=name),result}function Cache(){this.threshold=20,this.m_visible={},this.m_invisible={}}function Placeholder(name){this.name=name,this.layers={},this.activeLayer=null,this.size=null,this.rect=null,this.div=null}function Layer(name){this.name=name,this.canvas=null,this.svgcanvas=null}function Graphics(element){this.m_element=element,this.m_placeholders={},this.m_activePlaceholder=null,this.m_cache=new Cache,this.debug=!1,this.layerNames={},loop(this,enums.S9,(function(key,value){this.layerNames[value]=key}))}function Element(arg0,arg1){switch(this.ns=null,this.name=null,this.attr={},this.style={},this.children=[],arguments.length){case 1:this.name=arg0;break;case 2:this.ns=arg0,this.name=arg1}}function SvgGraphics(element){this.parent=Graphics.prototype,this.parent.constructor.apply(this,arguments),this._svgxmlns="http://www.w3.org/2000/svg"}function BaseControl(element,options,taskManagerFactory,eventArgsFactory,templates){var _dragFrom,_scrollFrom,_scrollTo,_dragImage,_dragTimer,_data={name:"orgdiagram",options:options,tasks:null,graphics:null,mouse:null,layout:{element:element,controlPanel:null,frameMousePanel:null,framePlaceholder:null,titlesMousePanel:null,titlesPlaceholder:null,scrollPanel:null,mousePanel:null,placeholder:null,calloutPlaceholder:null,forceCenterOnCursor:!0}},_debug=!1,_timer=null;function update(updateMode,forceCenterOnCursor){switch(null==forceCenterOnCursor&&(forceCenterOnCursor=!0),updateMode){case enums.lO.Refresh:refresh(forceCenterOnCursor,_debug);break;case enums.lO.PositonHighlight:!function positionHighlight(debug){_data.layout.forceCenterOnCursor=!1,_data.tasks.process("HighlightItemOptionTask",null,debug),_data.graphics.end()}(_debug);break;default:!function redraw(){unbind(_data.layout),cleanLayout(_data.layout),function createLayout(layout,name){var viewportSize=getInnerSize(layout.element),viewportRect=new Rect(0,0,viewportSize.width,viewportSize.height),pixelAlignmentFix=getFixOfPixelAlignment(element);jsonml_html.appendDOM(layout.element,jsonml_html.toHTML(["div",{tabindex:0,style:{position:"relative",overflow:"hidden",top:"0px",left:"0px",width:"100%",height:"100%",padding:"0px",marginBottom:"0px",marginRight:"0px",marginLeft:pixelAlignmentFix.width+"px",marginTop:pixelAlignmentFix.height+"px"},name:"controlPanel",class:name,$:function(element){layout.controlPanel=element}},["div",{style:mergeObjects({position:"absolute",overflow:"hidden"},viewportRect.getCSS()),name:"frameMousePanel",class:name,$:function(element){layout.frameMousePanel=element}},["div",{style:mergeObjects({position:"absolute",overflow:"hidden"},viewportRect.getCSS()),name:"framePlaceholder",class:["frameplaceholder",name],$:function(element){layout.framePlaceholder=element}}]],["div",{style:mergeObjects({position:"absolute",overflow:"hidden"},viewportRect.getCSS()),name:"titlesMousePanel",class:["bp-titles-frame",name],$:function(element){layout.titlesMousePanel=element}},["div",{style:mergeObjects({position:"absolute",overflow:"hidden"},viewportRect.getCSS()),name:"titlesPlaceholder",class:["titlesplaceholder",name],$:function(element){layout.titlesPlaceholder=element}}]],["div",{style:mergeObjects({position:"absolute",overflow:"auto","-webkit-overflow-scrolling":"touch",top:"0px",left:"0px",width:viewportRect.width+"px",height:viewportRect.height+"px"},viewportRect.getCSS()),name:"scrollPanel",class:name,$:function(element){layout.scrollPanel=element}},["div",{style:mergeObjects({position:"absolute",overflow:"visible"},viewportRect.getCSS()),name:"mousePanel",class:name,$:function(element){layout.mousePanel=element}},["div",{style:mergeObjects({position:"absolute",overflow:"hidden"},viewportRect.getCSS()),name:"placeholder",class:["placeholder",name],$:function(element){layout.placeholder=element}},["div",{style:{position:"absolute",overflow:"visible",top:"0px",left:"0px",width:"0px",height:"0px"},name:"calloutPlaceholder",class:["calloutplaceholder",name],$:function(element){layout.calloutPlaceholder=element}}]]]]]))}(_data.layout,_data.name),function bind(layout){layout.mousePanel.addEventListener("mousemove",onMouseMove),layout.mousePanel.addEventListener("click",onMouseClick),layout.mousePanel.addEventListener("dblclick",onMouseDblClick),layout.mousePanel.addEventListener("change",onCheckboxChange),layout.element.addEventListener("keydown",onKeyDown),layout.scrollPanel.addEventListener("scroll",onScroll),_data.options.enablePanning&&function isChrome(){return null!=navigator&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}()&&(layout.scrollPanel.draggable=!0,layout.scrollPanel.addEventListener("dragstart",onDragStart),layout.scrollPanel.addEventListener("drag",onDragScroll),layout.scrollPanel.addEventListener("dragend",onDragScroll),layout.scrollPanel.addEventListener("dragover",onDragOver));layout.frameMousePanel.addEventListener("mousemove",onFrameMouseMove),layout.frameMousePanel.addEventListener("click",onFrameMouseClick)}(_data.layout),_data.tasks=taskManagerFactory(getOptions,getGraphics,getLayout,setLayout,templates),_data.graphics=function createGraphics(element){return new SvgGraphics(element)}(_data.layout.element),_data.graphics.debug=_debug,refresh(!0,_debug)}()}}function refresh(forceCenterOnCursor,debug){var placeholderOffset;_data.layout.forceCenterOnCursor=forceCenterOnCursor,_data.tasks.process("OptionsTask",null,debug),_data.graphics.end(),forceCenterOnCursor&&(placeholderOffset=_data.tasks.getTask("CenterOnCursorTask").getPlaceholderOffset(),_data.layout.scrollPanel.scrollLeft=placeholderOffset.x,_data.layout.scrollPanel.scrollTop=placeholderOffset.y);var pixelAlignmentFix=getFixOfPixelAlignment(_data.layout.element);jsonml_html.applyStyles(_data.layout.scrollPanel,{marginBottom:"0px",marginRight:"0px",marginLeft:pixelAlignmentFix.width+"px",marginTop:pixelAlignmentFix.height+"px"})}function onScroll(event){null==_timer&&(_timer=window.setTimeout((function(){!function redrawCurrentViewPort(debug){_data.layout.forceCenterOnCursor=!1,_data.tasks.process("LayoutOptionsTask",null,debug),_data.graphics.end()}(_debug),window.clearTimeout(_timer),_timer=null}),200))}function getOptions(){return _data.options}function getGraphics(){return _data.graphics}function getLayout(){var layout=_data.layout,scrollPanelSize=getInnerSize(layout.controlPanel),placeholderOffset=new Point(layout.scrollPanel.scrollLeft,layout.scrollPanel.scrollTop);return{forceCenterOnCursor:layout.forceCenterOnCursor,scrollPanelSize:scrollPanelSize,placeholderOffset:placeholderOffset}}function setLayout(layoutOptions){var layout=_data.layout,pixelAlignmentFix=getFixOfPixelAlignment(layout.element);jsonml_html.applyStyles(layout.controlPanel,{marginLeft:pixelAlignmentFix.width+"px",marginTop:pixelAlignmentFix.height+"px"}),jsonml_html.applyStyles(layout.scrollPanel,layoutOptions.scrollPanelRect.getCSS()),jsonml_html.applyStyles(layout.mousePanel,layoutOptions.mousePanelSize.getCSS());var scaleText="scale("+layoutOptions.scale+","+layoutOptions.scale+")",scaleProperties={"transform-origin":"0 0",transform:scaleText,"-ms-transform":scaleText,"-webkit-transform":scaleText,"-o-transform":scaleText,"-moz-transform":scaleText};jsonml_html.applyStyles(layout.placeholder,mergeObjects(scaleProperties,layoutOptions.placeholderSize.getCSS())),layoutOptions.autoSize&&jsonml_html.applyStyles(layout.element,layoutOptions.controlSize.getCSS()),jsonml_html.applyStyles(layout.titlesMousePanel,layoutOptions.titlesMousePanelRect.getCSS()),jsonml_html.applyStyles(layout.titlesPlaceholder,mergeObjects(scaleProperties,layoutOptions.titlesPlaceholderSize.getCSS())),jsonml_html.applyStyles(layout.frameMousePanel,layoutOptions.frameMousePanelRect.getCSS()),jsonml_html.applyStyles(layout.framePlaceholder,mergeObjects(scaleProperties,layoutOptions.framePlaceholderSize.getCSS())),layout.scrollPanel.setAttribute("class",layoutOptions.scrollPanelRect.left>0?name:"bp-scrollframe "+name)}function cleanLayout(){var controlPanel=_data.layout.controlPanel;if(null!=controlPanel){var parent=controlPanel.parentNode;null!=parent&&parent.removeChild(controlPanel)}}function unbind(layout){null!=layout.mousePanel&&(layout.mousePanel.removeEventListener("mousemove",onMouseMove),layout.mousePanel.removeEventListener("click",onMouseClick),layout.mousePanel.removeEventListener("dblclick",onMouseDblClick),layout.mousePanel.removeEventListener("change",onCheckboxChange)),null!=layout.element&&layout.element.removeEventListener("keydown",onKeyDown),null!=layout.scrollPanel&&(layout.scrollPanel.removeEventListener("scroll",onScroll),layout.scrollPanel.removeEventListener("dragstart",onDragStart),layout.scrollPanel.removeEventListener("drag",onDragScroll),layout.scrollPanel.removeEventListener("dragend",onDragScroll),layout.scrollPanel.removeEventListener("dragover",onDragOver)),null!=layout.frameMousePanel&&(layout.frameMousePanel.removeEventListener("mousemove",onFrameMouseMove),layout.frameMousePanel.removeEventListener("click",onFrameMouseClick))}function onFrameMouseMove(event){var placeholderOffset=getElementOffset(_data.layout.frameMousePanel),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,projectItemsToFrameTask=_data.tasks.getTask("ProjectItemsToFrameTask"),highlightItemOptionTask=_data.tasks.getTask("HighlightItemOptionTask");highlightItemOptionTask.hasHighlightEnabled()&&setHighlightItem(event,projectItemsToFrameTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius()))}function onFrameMouseClick(event){var eventArgs,placeholderOffset=getElementOffset(_data.layout.frameMousePanel),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,projectItemsToFrameTask=_data.tasks.getTask("ProjectItemsToFrameTask"),cursorItemOptionTask=_data.tasks.getTask("CursorItemOptionTask"),highlightItemOptionTask=_data.tasks.getTask("HighlightItemOptionTask"),newCursorItemId=projectItemsToFrameTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());event.target,null!==newCursorItemId&&(trigger("onMouseClick",event,eventArgs=getEventArgs(null,newCursorItemId)),eventArgs.cancel||cursorItemOptionTask.hasCursorEnabled()&&(setCursorItem(event,newCursorItemId),_data.layout.element.focus()))}function onMouseMove(event){var placeholderOffset=getElementOffset(_data.layout.mousePanel),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,createTransformTask=_data.tasks.getTask("CreateTransformTask"),highlightItemOptionTask=_data.tasks.getTask("HighlightItemOptionTask");highlightItemOptionTask.hasHighlightEnabled()&&setHighlightItem(event,createTransformTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius()))}function onCheckboxChange(event){var target=event.target,selectedId=target.getAttribute("data-id");if(null!=selectedId){var selectedItems=(_data.options.selectedItems||[]).slice(),eventArgs=getEventArgs(null,selectedId),position=selectedItems.findIndex((function(itemid){return selectedId==itemid}));trigger("onSelectionChanging",event,eventArgs),eventArgs.cancel||(position>=0?selectedItems.splice(position,1):selectedItems.push(selectedId),_data.options.selectedItems=selectedItems,position<0?target.setAttribute("checked","checked"):target.removeAttribute("checked"),trigger("onSelectionChanged",event,eventArgs))}}function onMouseClick(event){var target,eventArgs,buttonName,placeholderOffset=getElementOffset(_data.layout.mousePanel),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,createTransformTask=_data.tasks.getTask("CreateTransformTask"),cursorItemOptionTask=_data.tasks.getTask("CursorItemOptionTask"),highlightItemOptionTask=_data.tasks.getTask("HighlightItemOptionTask"),newCursorItemId=createTransformTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());(target=event.target,null!==newCursorItemId)&&(isNullOrEmpty(buttonName=target.getAttribute("data-buttonname"))&&(buttonName=target.parentNode&&target.parentNode.getAttribute("data-buttonname")),isNullOrEmpty(buttonName)?"checkbox"===target.getAttribute("name")||"selectiontext"===target.getAttribute("name")||(trigger("onMouseClick",event,eventArgs=getEventArgs(null,newCursorItemId)),eventArgs.cancel||cursorItemOptionTask.hasCursorEnabled()&&(setCursorItem(event,newCursorItemId),_data.layout.element.focus())):trigger("onButtonClick",event,eventArgs=getEventArgs(null,newCursorItemId,buttonName)))}function onMouseDblClick(event){var highlightTreeItem=_data.tasks.getTask("HighlightItemTask").getHighlightTreeItem();null!==highlightTreeItem&&trigger("onMouseDblClick",event,getEventArgs(null,highlightTreeItem))}function onKeyDown(event){var newNavigationItem,accepted,highlightItemTask=_data.tasks.getTask("HighlightItemTask"),highlightItemOptionTask=_data.tasks.getTask("HighlightItemOptionTask"),cursorItemTask=_data.tasks.getTask("CursorItemTask"),cursorItemOptionTask=_data.tasks.getTask("CursorItemOptionTask"),alignDiagramTask=_data.tasks.getTask("AlignDiagramTask"),transform=_data.tasks.getTask("CreateTransformTask").getTransform(),navigationItem=null,direction=null,layout=_data.layout;if(highlightItemOptionTask.hasHighlightEnabled()&&cursorItemOptionTask.hasCursorEnabled()?null===(navigationItem=highlightItemTask.getHighlightTreeItem())&&(navigationItem=cursorItemTask.getCursorTreeItem()):highlightItemOptionTask.hasHighlightEnabled()?navigationItem=highlightItemTask.getHighlightTreeItem():cursorItemOptionTask.hasCursorEnabled()&&(navigationItem=cursorItemTask.getCursorTreeItem()),null!=navigationItem){switch(event.which){case 13:cursorItemOptionTask.hasCursorEnabled()&&(setCursorItem(event,navigationItem),event.preventDefault(),layout.element.focus());break;case 40:direction=enums.F7.Bottom;break;case 38:direction=enums.F7.Top;break;case 37:direction=enums.F7.Left;break;case 39:direction=enums.F7.Right}if(null!=direction){for(accepted=!1;!accepted;)accepted=!0,direction=transform.getOrientation(direction),null!=(newNavigationItem=alignDiagramTask.getNextItem(navigationItem,direction))&&(event.preventDefault(),highlightItemOptionTask.hasHighlightEnabled()?setHighlightItem(event,newNavigationItem):cursorItemOptionTask.hasCursorEnabled()&&setCursorItem(event,newNavigationItem));layout.element.focus()}}}function onDragStart(event){var scrollPanel=_data.layout.scrollPanel;_dragFrom=new Point(event.clientX,event.clientY),_scrollFrom=new Point(scrollPanel.scrollLeft,scrollPanel.scrollTop),_dragImage=_dragImage||new Image,event.dataTransfer.setDragImage(_dragImage,0,0)}function onDragOver(event){event.preventDefault(),event.dataTransfer.dropEffect="move"}function onDragScroll(event){_scrollTo=new Point(_scrollFrom.x-(event.clientX-_dragFrom.x),_scrollFrom.y-(event.clientY-_dragFrom.y)),null==_dragTimer&&(_dragTimer=window.setTimeout((function(){var scrollPanel=_data.layout.scrollPanel;scrollPanel.scrollLeft=_scrollTo.x,scrollPanel.scrollTop=_scrollTo.y,window.clearTimeout(_dragTimer),_dragTimer=null}),50))}function setHighlightItem(event,newHighlightItemId){var eventArgs,result=!0;return null!==newHighlightItemId?newHighlightItemId!==_data.options.highlightItem&&(eventArgs=getEventArgs(_data.options.highlightItem,newHighlightItemId),_data.options.highlightItem=newHighlightItemId,trigger("onHighlightChanging",event,eventArgs),eventArgs.cancel?result=!1:(refresh(!1,!1),trigger("onHighlightChanged",event,eventArgs))):null!==_data.options.highlightItem&&(eventArgs=getEventArgs(_data.options.highlightItem,null),_data.options.highlightItem=null,trigger("onHighlightChanging",event,eventArgs),eventArgs.cancel?result=!1:(refresh(!1,!1),trigger("onHighlightChanged",event,eventArgs))),result}function setCursorItem(event,newCursorItemId){var eventArgs;newCursorItemId!==_data.options.cursorItem&&(eventArgs=getEventArgs(_data.options.cursorItem,newCursorItemId),_data.options.cursorItem=newCursorItemId,trigger("onCursorChanging",event,eventArgs),eventArgs.cancel||(refresh(!0,_debug),trigger("onCursorChanged",event,eventArgs)))}function getEventArgs(oldTreeItemId,newTreeItemId,name){return eventArgsFactory(_data,oldTreeItemId,newTreeItemId,name)}function trigger(eventHandlerName,event,eventArgs){var eventHandler=_data.options[eventHandlerName];null!=eventHandler&&eventHandler(event,eventArgs)}return update(),{destroy:function destroy(){unbind(_data.layout),cleanLayout(_data.layout),_data.tasks=null,_data.graphics=null},setOptions:function setOptions(options){for(var option in options)options.hasOwnProperty(option)&&(_data.options[option]=options[option])},getOptions:getOptions,setOption:function setOption(option,value){return _data.options[option]=value},getOption:function getOption(option){return _data.options[option]},update:update}}function OrgDiagram(element,options,templates){return BaseControl(element,options,TaskManagerFactory,EventArgsFactory,{AnnotationLabelTemplate:AnnotationLabelTemplate,ButtonsTemplate:ButtonsTemplate,CustomRenderTemplate:CustomRenderTemplate,CheckBoxTemplate:CheckBoxTemplate,CursorTemplate:CursorTemplate,DotHighlightTemplate:DotHighlightTemplate,GroupTitleTemplate:GroupTitleTemplate,HighlightTemplate:HighlightTemplate,ItemTemplate:ItemTemplate,UserTemplate:UserTemplate,LevelTitleTemplate:LevelTitleTemplate,LevelBackgroundTemplate:LevelBackgroundTemplate,LabelAnnotationTemplate:LabelAnnotationTemplate,...templates})}function FamItemsOptionTask(optionsTask,defaultItemConfig){var _data={},_hash={},_sourceHash={},_dataTemplate=new ObjectReader({items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),parents:new ArrayReader(new ValueReader(["string","number"],!0),!0),isActive:new ValueReader(["boolean"],!1,defaultItemConfig.isActive)}),!0,"id",!0)});return{process:function process(){var context={isChanged:!1,hash:_hash,sourceHash:_sourceHash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getItems:function getItems(){return _data.items},getConfig:function getConfig(itemId){return _sourceHash["options-items"][itemId]}}}function FamNormalVisibilityItemsByMinimumVisibleLevelsTask(minimumVisibleLevelsOptionTask,orderFamilyNodesTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},treeLevels=orderFamilyNodesTask.getTreeLevels(),{pageFitMode:pageFitMode,minimalVisibility:minimalVisibility,minimumVisibleLevels:minimumVisibleLevels}=minimumVisibleLevelsOptionTask.getOptions();return _data.items=_dataTemplate.read(_data.items,function getSelectedItems(treeLevels,pageFitMode,minimalVisibility,minimumVisibleLevels){var result=[];if(minimumVisibleLevels>0&&(enums.sj.PageWidth==pageFitMode||enums.sj.PageHeight||enums.sj.FitToPage)&&minimalVisibility!=enums.EE.Normal){var index=0,currentLevel=null;treeLevels.loopLevels(this,(function(levelIndex,level){if(treeLevels.loopLevelItems(this,levelIndex,(function(nodeId,node,position){node.isVisible&&(currentLevel!==levelIndex&&(currentLevel=levelIndex,index+=1),result.push(nodeId))})),index>=minimumVisibleLevels)return!0}))}return result}(treeLevels,pageFitMode,minimalVisibility,minimumVisibleLevels),"items",context),context.isChanged},getItems:function getItems(){return _data.items}}}function FamLogicalLevelsPlacementTask(orderFamilyNodesTask,alignDiagramTask){var _data={positions:[]};return{getPositions:function getPositions(){return _data.positions||(_data.positions=function createPositions(){var intervals=[],treeLevels=orderFamilyNodesTask.getTreeLevels(),itemsPositions=alignDiagramTask.getItemsPositions(),index=0;treeLevels.loopLevels(this,(function(levelIndex,level){treeLevels.loopLevelItems(this,levelIndex,(function(nodeId,node,position){if(node.isVisible&&node.isActive){var itemPosition=itemsPositions[nodeId];if(itemPosition){var interval=new Interval(itemPosition.topConnectorShift||itemPosition.actualPosition.y,itemPosition.bottomConnectorShift-1,index++);intervals.push(interval)}return!0}}))}));var mergedIntervals=[];getMergedIntervals(this,intervals,(function(interval){mergedIntervals.push(interval)})),intervals=mergedIntervals,mergedIntervals=[];for(var currentInterval=null,len=(index=0,intervals.length);index<len;index+=1){var interval=intervals[index];currentInterval&&currentInterval.context===interval.context?currentInterval.to=interval.to:(currentInterval=interval,mergedIntervals.push(interval))}for((intervals=mergedIntervals).length>0&&(intervals[0].from=0),index=0,len=intervals.length-1;index<len;index+=1){var prev=intervals[index],next=intervals[index+1];prev.to=next.from}var minLevelIndex=null;for(index=0,len=intervals.length;index<len;index+=1)interval=intervals[index],minLevelIndex=null===minLevelIndex?interval.context:Math.min(minLevelIndex,interval.context);var result={};for(index=0,len=intervals.length;index<len;index+=1){var levelIndex=(interval=intervals[index]).context-minLevelIndex,logicalLevelPosition=result[levelIndex];logicalLevelPosition?logicalLevelPosition.push(interval):result[levelIndex]=[interval]}return result}()),_data.positions},process:function process(){return _data.positions=null,!0}}}function FamVisualTreeOptionTask(optionsTask){var _data={leavesPlacementType:enums.X9.Horizontal,childrenPlacementType:enums.X9.Horizontal,maximumColumnsInMatrix:6,horizontalAlignment:enums.a3.Center};return{process:function process(){return!1},getOptions:function getOptions(){return _data}}}function HideGrandParentsConnectorsOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({hideGrandParentsConnectors:new ValueReader(["boolean"],!1,defaultConfig.hideGrandParentsConnectors)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data}}}function NormalizeOptionTask(optionsTask,defaultConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({groupByType:new EnumerationReader(enums.zX,!1,defaultConfig.groupByType),alignBylevels:new ValueReader(["boolean"],!1,defaultConfig.alignBylevels)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data}}}function ExtractNestedLayoutsOptionTask(optionsTask,defaultConfig,defaultItemConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({enableMatrixLayout:new ValueReader(["boolean"],!1,defaultConfig.enableMatrixLayout),minimumMatrixSize:new ValueReader(["number"],!1,defaultConfig.minimumMatrixSize),maximumColumnsInMatrix:new ValueReader(["number"],!1,defaultConfig.maximumColumnsInMatrix),items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),matrixId:new ValueReader(["string","number"],!1,defaultItemConfig.matrixId),addToMatrix:new ValueReader(["boolean"],!1,defaultItemConfig.addToMatrix)}),!0,"id")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},getConfig:function getConfig(itemId){return _hash["options-items"][itemId]}}}function OrderFamilyNodesOptionTask(optionsTask,defaultConfig,defaultItemConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({enableMatrixLayout:new ValueReader(["boolean"],!1,defaultConfig.enableMatrixLayout),minimumMatrixSize:new ValueReader(["number"],!1,defaultConfig.minimumMatrixSize),maximumColumnsInMatrix:new ValueReader(["number"],!1,defaultConfig.maximumColumnsInMatrix),items:new ArrayReader(new ObjectReader({id:new ValueReader(["string","number"],!0),position:new ValueReader(["number"],!0),relativeItem:new ValueReader(["string","number"],!0),placementType:new EnumerationReader(enums.hZ,!1,defaultItemConfig.placementType),primaryParent:new ValueReader(["string","number"],!0),matrixId:new ValueReader(["string","number"],!1,defaultItemConfig.matrixId),addToMatrix:new ValueReader(["boolean"],!1,defaultItemConfig.addToMatrix)}),!0,"id")});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data},getConfig:function getConfig(itemId){return _hash["options-items"][itemId]}}}function LinePaletteOptionTask(optionsTask,defaultPaletteItemConfig){var _data={},_hash={},_dataTemplate=new ObjectReader({linesPalette:new ArrayReader(new ObjectReader({lineColor:new ValueReader(["string"],!1,defaultPaletteItemConfig.lineColor),lineWidth:new ValueReader(["number"],!1,defaultPaletteItemConfig.lineWidth),lineType:new EnumerationReader(enums.SP,!1,defaultPaletteItemConfig.lineType)}),!1)});return{process:function process(){var context={isChanged:!1,hash:_hash};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getOptions:function getOptions(){return _data}}}function NeighboursSelectionModeOptionTask(optionsTask,defaultConfig){var _data={},_dataTemplate=new ObjectReader({neighboursSelectionMode:new EnumerationReader(enums.DL,!1,defaultConfig.neighboursSelectionMode)});return{process:function process(){var context={isChanged:!1};return _data=_dataTemplate.read(_data,optionsTask.getOptions(),"options",context),context.isChanged},getNeighboursSelectionMode:function getNeighboursSelectionMode(){return _data.neighboursSelectionMode}}}function UserDefinedNodesOrder(){}function UserDefinedNodesOrderTask(orderFamilyNodesOptionTask){var _data={position:null,group:null},_userDefinedNodesOrder=new UserDefinedNodesOrder;return{process:function process(){var options=orderFamilyNodesOptionTask.getOptions(),result=_userDefinedNodesOrder.getUserDefinedPositions(options.items);return _data.position=result.position,_data.group=result.group,!0},getPositions:function getPositions(){return _data.position},getGroups:function getGroups(){return _data.group}}}function FamilyItem(arg0){var property;if(this.id=null,this.familyId=null,this.itemConfig=null,this.isVisible=!0,this.isActive=!0,this.isLevelNeutral=!1,this.level=null,this.levelGravity=enums.zX.None,this.hideParentConnection=!1,this.hideChildrenConnection=!1,1===arguments.length)for(property in arg0)arg0.hasOwnProperty(property)&&(this[property]=arg0[property])}function LogicalFamilyTask(itemsOptionTask){var _data={logicalFamily:null,maximumId:null};return{process:function process(debug){var index,len,itemConfig,famItem,parsedId,items=itemsOptionTask.getItems(),logicalFamily=Family(),maximumId=0;if(items.length>0)for(index=0,len=items.length;index<len;index+=1)null!=(itemConfig=items[index])&&(famItem=new FamilyItem({id:itemConfig.id,itemConfig:itemConfig,isActive:itemConfig.isActive}),logicalFamily.add(itemConfig.parents,famItem.id,famItem),parsedId=parseInt(itemConfig.id,10),maximumId=Math.max(isNaN(parsedId)?0:parsedId,maximumId));if(_data.logicalFamily=logicalFamily,_data.maximumId=maximumId,debug&&!logicalFamily.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId}}}function RemoveLoopsTask(logicalFamilyTask){var _data={logicalFamily:null,maximumId:null,loops:[]};return{process:function process(debug){var logicalFamily=logicalFamilyTask.getLogicalFamily(),result=function removeLoops(logicalFamily,maximumId,debug){var fakeChild,fakeParent,index,len,index2,len2,edgesToReverse=getFamilyLoops(logicalFamily,debug),fakePairs=[],loops=[],loopsHash={};for(index=0,len=edgesToReverse.length;index<len;index+=1){var edge=edgesToReverse[index];loopsHash.hasOwnProperty(edge.to)?loopsHash[edge.to].parents.push(edge.from):(loopsHash[edge.to]={itemid:edge.to,parents:[edge.from]},loops.push(loopsHash[edge.to]))}var fakeChildren={};if(loops.length>0)for(logicalFamily=logicalFamily.clone(),index=0,len=loops.length;index<len;index+=1){var loop=loops[index],parents=loop.parents,itemParents=[];for(logicalFamily.loopParents(this,loop.itemid,(function(parentid,parent){return itemParents.push(parentid),logicalFamily.SKIP})),index2=0,len2=itemParents.length;index2<len2;index2+=1)logicalFamily.removeChildRelation(itemParents[index2],loop.itemid);maximumId+=1;var isConnectionsVisible=itemParents.length<=parents.length;for(fakeParent=new FamilyItem({id:maximumId,isVisible:!1,isActive:!1,isLevelNeutral:!1,hideParentConnection:isConnectionsVisible,hideChildrenConnection:isConnectionsVisible,levelGravity:enums.zX.Children,itemConfig:{title:"fake parent #"+maximumId,description:"This is a fake parent item, it was created by loops removal task."}}),logicalFamily.add([],fakeParent.id,fakeParent),logicalFamily.adopt([fakeParent.id],loop.itemid),fakePairs.push({from:fakeParent.id,to:loop.itemid,isOppositeFlow:!1}),index2=0,len2=parents.length;index2<len2;index2+=1){var parentid=parents[index2];null==(fakeChild=fakeChildren[parentid])&&(fakeChild=new FamilyItem({id:maximumId+=1,isVisible:!1,isActive:!1,isLevelNeutral:!1,hideParentConnection:!0,hideChildrenConnection:!0,levelGravity:enums.zX.Parents,itemConfig:{title:"fake child #"+maximumId,description:"This is a fake child item, it was created by loops removal task."}}),fakeChildren[parentid]=fakeChild,logicalFamily.add([parentid],fakeChild.id,fakeChild),fakePairs.push({from:parentid,to:fakeChild.id,isOppositeFlow:!1})),logicalFamily.adopt([fakeParent.id],fakeChild.id),fakePairs.push({from:fakeParent.id,to:fakeChild.id,isOppositeFlow:!0})}var parentsHash={};for(index2=0,len2=parents.length;index2<len2;index2+=1)parentsHash[parents[index2]]=!0;for(index2=0,len2=itemParents.length;index2<len2;index2+=1)parentsHash.hasOwnProperty(itemParents[index2])||logicalFamily.adopt([itemParents[index2]],fakeParent.id)}return{maximumId:maximumId,logicalFamily:logicalFamily,loops:fakePairs}}(logicalFamily,logicalFamilyTask.getMaximumId(),debug);if(_data.logicalFamily=result.logicalFamily,_data.maximumId=result.maximumId,_data.loops=result.loops,debug&&!logicalFamily.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId},getLoops:function getLoops(){return _data.loops}}}function LabelAnnotationOptionTask(splitAnnotationsOptionTask,logicalFamilyTask,defaultLabelAnnotationConfig){var _data={annotations:[],configs:{},maximumId:null},_hash={},_dataTemplate=new ArrayReader(new ObjectReader({zOrderType:new EnumerationReader(enums.k0,!1,defaultLabelAnnotationConfig.zOrderType),fromItem:new ValueReader(["string","number"],!0),toItems:new ArrayReader(new ValueReader(["string","number"],!0),!0),title:new ValueReader(["string"],!0),itemTitleColor:new ValueReader(["string"],!1,defaultLabelAnnotationConfig.itemTitleColor),templateName:new ValueReader(["string"],!0)},!1),!1,null,!0);return{process:function process(){var index,len,annotation,context={isChanged:!1,hash:_hash,sourceHash:{}},maximumId=logicalFamilyTask.getMaximumId();_data.annotations=_dataTemplate.read(_data.annotations,splitAnnotationsOptionTask.getAnnotations(enums.JJ.Label),"annotations",context),_data.configs={};var sourceItems=context.sourceHash.annotations;for(index=0,len=_data.annotations.length;index<len;index+=1)maximumId+=1,(annotation=_data.annotations[index]).id=maximumId,_data.configs[annotation.id]=sourceItems[index];return _data.maximumId=maximumId,context.isChanged},getAnnotations:function getAnnotations(){return _data.annotations},getMaximumId:function getMaximumId(){return _data.maximumId},getConfig:function getConfig(itemId){return _data.configs[itemId]}}}function LabelAnnotationTemplateOptionTask(labelAnnotationOptionTask,defaultLabelAnnotationConfig){var _data={annotations:[]},_hash={},_dataTemplate=new ArrayReader(new ObjectReader({id:new ValueReader(["number"],!0),title:new ValueReader(["string"],!0),itemTitleColor:new ValueReader(["string"],!1,defaultLabelAnnotationConfig.itemTitleColor),templateName:new ValueReader(["string"],!0)}),!0,"id");return{process:function process(){var context={isChanged:!1,hash:_hash};return _data.annotations=_dataTemplate.read(_data.annotations,labelAnnotationOptionTask.getAnnotations(),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _data.annotations}}}function LabelAnnotationPlacementOptionTask(labelAnnotationOptionTask,defaultLabelAnnotationConfig){var _data={annotations:[]},_hash={},_dataTemplate=new ArrayReader(new ObjectReader({id:new ValueReader(["number"],!0),fromItem:new ValueReader(["string","number"],!0),toItems:new ArrayReader(new ValueReader(["string","number"],!0),!0)}),!0,"id");return{process:function process(){var context={isChanged:!1,hash:_hash};return _data.annotations=_dataTemplate.read(_data.annotations,labelAnnotationOptionTask.getAnnotations(),"annotations",context),context.isChanged},getAnnotations:function getAnnotations(){return _data.annotations},getMaximumId:function getMaximumId(){return labelAnnotationOptionTask.getMaximumId()}}}function EdgeItem(key0,val0,key1,val1){this.values=[val0,val1],this[key0]=0,this[key1]=1}function AddLabelAnnotationsTask(labelAnnotationPlacementOptionTask,removeLoopsTask){var _data={logicalFamily:null,maximumId:null};function addLabelAnnotation(logicalFamily,edges,fromItem,toItems,onCreate){var edge,toItem,index,len,bundleItem,isValid=!0,commonParentId=null,bundleItems=[];for(index=0,len=toItems.length;index<len;index+=1){if(toItem=toItems[index],null==(edge=edges.edge(fromItem,toItem))){isValid=!1;break}if(null==commonParentId)commonParentId=edge.getFar(toItem);else if(commonParentId!=edge.getFar(toItem)){isValid=!1;break}bundleItems.push(edge.getNear(toItem))}if(isValid&&(bundleItem=onCreate(),logicalFamily.bundleParents(commonParentId,bundleItems,bundleItem.id,bundleItem)?(bundleItem.levelGravity=enums.zX.Children,isValid=!0):logicalFamily.bundleChildren(commonParentId,bundleItems,bundleItem.id,bundleItem)?(bundleItem.levelGravity=enums.zX.Parents,isValid=!0):logicalFamily.bundleParents(commonParentId,toItems,bundleItem.id,bundleItem)?(bundleItem.levelGravity=enums.zX.Children,isValid=!0):logicalFamily.bundleParents(commonParentId,toItems,bundleItem.id,bundleItem)&&(bundleItem.levelGravity=enums.zX.Parents,isValid=!0),isValid))for(index=0,len=toItems.length;index<len;index+=1)toItem=toItems[index],(edge=edges.edge(fromItem,toItem)).setFar(toItem,bundleItem.id)}return{process:function process(debug){var logicalFamily=removeLoopsTask.getLogicalFamily(),annotations=labelAnnotationPlacementOptionTask.getAnnotations();if(function addLabelAnnotations(logicalFamily,annotations){var configs,config,fromItem,index,len,edges=Graph(),configsHash={};if(annotations.length>0){for(index=0,len=annotations.length;index<len;index+=1)config=annotations[index],configsHash.hasOwnProperty(config.fromItem)?configsHash[config.fromItem].push(config):(configsHash[config.fromItem]=[config],logicalFamily.loopChildren(this,config.fromItem,(function(childid,child,level){return edges.addEdge(config.fromItem,childid,new EdgeItem(config.fromItem,config.fromItem,childid,childid)),logicalFamily.SKIP})),logicalFamily.loopParents(this,config.fromItem,(function(parentid,parent,level){return edges.addEdge(parentid,config.fromItem,new EdgeItem(parentid,parentid,config.fromItem,config.fromItem)),logicalFamily.SKIP})));for(fromItem in configsHash)if(configsHash.hasOwnProperty(fromItem))for((configs=configsHash[fromItem]).sort((function(a,b){return b.toItems.length-a.toItems.length})),index=0;index<configs.length;index+=1)config=configs[index],addLabelAnnotation(logicalFamily,edges,config.fromItem,config.toItems,(function(){return new FamilyItem({id:config.id,isVisible:!0,isLevelNeutral:!0,isActive:!1,itemConfig:config})}))}}(logicalFamily=logicalFamily.clone(),annotations),_data.logicalFamily=logicalFamily,_data.maximumId=labelAnnotationPlacementOptionTask.getMaximumId(),debug&&!logicalFamily.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId}}}function HideGrandParentsConnectorsTask(hideGrandParentsConnectorsOptionTask,removeLoopsTask){var _data={maximumId:null,logicalFamily:null};return{process:function process(debug){var logicalFamily=removeLoopsTask.getLogicalFamily(),maximumId=removeLoopsTask.getMaximumId();return logicalFamily=1==hideGrandParentsConnectorsOptionTask.getOptions().hideGrandParentsConnectors?logicalFamily.getFamilyWithoutGrandParentsRelations():logicalFamily.clone(),_data.logicalFamily=logicalFamily,_data.maximumId=maximumId,!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId}}}function BindFamilyConnectorsTask(hideGrandParentsConnectorsTask){var _data={maximumId:null,logicalFamily:null};return{process:function process(debug){var logicalFamily=hideGrandParentsConnectorsTask.getLogicalFamily(),maximumId=hideGrandParentsConnectorsTask.getMaximumId();if((logicalFamily=logicalFamily.clone()).optimizeReferences((function(){return new FamilyItem({id:maximumId+=1,isVisible:!1,isActive:!1,itemConfig:{title:"bundle #"+maximumId,description:" This item was created by references optimizer."},levelGravity:enums.zX.Children,isLevelNeutral:!0})})),debug&&!logicalFamily.validate())throw"References are broken in family structure!";if(debug&&logicalFamily.hasLoops())throw"Structure has loops!";if(logicalFamily.eliminateManyToMany((function(){return new FamilyItem({id:maximumId+=1,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+maximumId,description:"This is item used to eliminate M:M relations."},levelGravity:enums.zX.Children,hideParentConnection:!1,hideChildrenConnection:!1,isLevelNeutral:!0})})),debug&&!logicalFamily.validate())throw"References are broken in family structure!";return _data.logicalFamily=logicalFamily,_data.maximumId=maximumId,!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId}}}function BaseTransformer(debug){this.debug=debug}function MatrixConnectorBundle(isChildren,items,matrixNodeId,connectionId,matrixWidth){this.isChildren=isChildren,this.items=items,this.len=items.length,this.matrixNodeId=matrixNodeId,this.connectionId=connectionId,this.matrixWidth=matrixWidth,this.blocksCount=Math.ceil(this.matrixWidth/2),this.rowsCount=Math.ceil(this.len/this.matrixWidth)}function MatrixLayout(items,hideParentConnection,hideChildrenConnection){this.items=items,this.hideParentConnection=hideParentConnection,this.hideChildrenConnection=hideChildrenConnection,this.data={columns:[],rows:[]}}function HorizontalLayout(items,hideParentConnection,hideChildrenConnection){this.items=items,this.hideParentConnection=hideParentConnection,this.hideChildrenConnection=hideChildrenConnection,this.data={columns:[],row:null}}function FamilyMatrixesExtractor(debug){this.parent=BaseTransformer.prototype,this.parent.constructor.apply(this,arguments)}function ExtractNestedLayoutsTask(extractNestedLayoutsOptionTask,bindFamilyConnectorsTask){var _data={maximumId:null,logicalFamily:null},_familyMatrixesExtractor=new FamilyMatrixesExtractor(!1);return{process:function process(debug){var logicalFamily=bindFamilyConnectorsTask.getLogicalFamily(),maximumId=bindFamilyConnectorsTask.getMaximumId(),extractNestedLayoutsOptions=extractNestedLayoutsOptionTask.getOptions(),options={enableMatrixLayout:extractNestedLayoutsOptions.enableMatrixLayout,minimumMatrixSize:extractNestedLayoutsOptions.minimumMatrixSize,maximumColumnsInMatrix:extractNestedLayoutsOptions.maximumColumnsInMatrix};logicalFamily=logicalFamily.clone();var{maximumId:maximumId,layouts:layouts,nestedLayoutParentConnectorIds:nestedLayoutParentConnectorIds,nestedLayoutBottomConnectorIds:nestedLayoutBottomConnectorIds,bundles:bundles}=_familyMatrixesExtractor.extract(options,extractNestedLayoutsOptionTask.getConfig,logicalFamily,maximumId);return _data.logicalFamily=logicalFamily,_data.maximumId=maximumId,_data.layouts=layouts,_data.nestedLayoutParentConnectorIds=nestedLayoutParentConnectorIds,_data.nestedLayoutBottomConnectorIds=nestedLayoutBottomConnectorIds,_data.bundles=bundles,!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId},getLayouts:function getLayouts(){return _data.layouts},getNestedLayoutParentConnectorIds:function getNestedLayoutParentConnectorIds(){return _data.nestedLayoutParentConnectorIds},getNestedLayoutBottomConnectorIds:function getNestedLayoutBottomConnectorIds(){return _data.nestedLayoutBottomConnectorIds},getBundles:function getBundles(){return _data.bundles}}}function FamilyNormalizer(debug){this.parent=BaseTransformer.prototype,this.parent.constructor.apply(this,arguments)}function NormalizeLogicalFamilyTask(normalizeOptionTask,extractNestedLayoutsTask){var _data={maximumId:null,logicalFamily:null},_familyNormalizer=new FamilyNormalizer(!1);return{process:function process(debug){var logicalFamily=extractNestedLayoutsTask.getLogicalFamily(),maximumId=extractNestedLayoutsTask.getMaximumId(),normalizeOptions=normalizeOptionTask.getOptions(),options={groupByType:normalizeOptions.groupByType,alignBylevels:normalizeOptions.alignBylevels};return logicalFamily=logicalFamily.clone(),maximumId=_familyNormalizer.normalize(options,logicalFamily,maximumId),_data.logicalFamily=logicalFamily,_data.maximumId=maximumId,!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId}}}function FamilyBalanceItem(id,familyId,level){this.id=id,this.familyId=familyId,this.level=level,this.childIndex=0}function Slot(itemid){this.itemId=itemid,this.position=null,this.balance=0,this.left={},this.right={},this.crossings={}}function FamilyBalance(){}function UserDefinedPrimaryParents(){}function OrderFamilyNodesTask(orderFamilyNodesOptionTask,userDefinedNodesOrderTask,normalizeLogicalFamilyTask){var _data={maximumId:null,logicalFamily:null,treeLevels:null,bundles:null,connectorStacks:null},_familyBalance=new FamilyBalance,_userDefinedPrimaryParents=new UserDefinedPrimaryParents,_nullTreeLevelConnectorStackSize=new TreeLevelConnectorStackSize;return{process:function process(debug){var logicalFamily=normalizeLogicalFamilyTask.getLogicalFamily(),maximumId=normalizeLogicalFamilyTask.getMaximumId(),orderFamilyNodesOptions=orderFamilyNodesOptionTask.getOptions(),balanceParams={logicalFamily:logicalFamily,maximumId:maximumId,itemsPositions:userDefinedNodesOrderTask.getPositions(),itemsGroups:userDefinedNodesOrderTask.getGroups(),primaryParents:_userDefinedPrimaryParents.getUserDefinedPrimaryParents(orderFamilyNodesOptions.items,logicalFamily)},{maximumId:maximumId,treeLevels:treeLevels,bundles:bundles,connectorStacks:connectorStacks}=_familyBalance.balance(balanceParams);return _data.maximumId=maximumId,_data.treeLevels=treeLevels,_data.bundles=bundles,_data.connectorStacks=connectorStacks,_data.logicalFamily=logicalFamily,!0},getLogicalFamily:function getLogicalFamily(){return _data.logicalFamily},getMaximumId:function getMaximumId(){return _data.maximumId},getTreeLevels:function getTreeLevels(){return _data.treeLevels},getBundles:function getBundles(){return _data.bundles},getConnectorsStacksSizes:function getConnectorsStacksSizes(levelid){return _data.connectorStacks[levelid]||_nullTreeLevelConnectorStackSize}}}function LabelAnnotationTemplateParamsTask(itemsSizesOptionTask,labelAnnotationTemplateOptionTask,readTemplatesTask){var _data={items:{}};return{process:function process(){var index,len,itemsSizesOptions=itemsSizesOptionTask.getOptions(),items=labelAnnotationTemplateOptionTask.getAnnotations();for(_data.items={},index=0,len=items.length;index<len;index+=1){var annotation=items[index],templateParams=new TemplateParams,template=readTemplatesTask.getTemplate(annotation.templateName,itemsSizesOptions.defaultLabelAnnotationTemplate,readTemplatesTask.DefaultWidgetLabelAnnotationTemplateName);templateParams.template=template,_data.items[annotation.id]=templateParams}return!0},getTemplateParams:function getTemplateParams(itemId){return _data.items[itemId]}}}function CombinedTemplateParamsTask(itemTemplateParamsTask,labelAnnotationTemplateParamsTask){return{process:function process(){return!0},getTemplateParams:function getTemplateParams(itemId){return itemTemplateParamsTask.getTemplateParams(itemId)||labelAnnotationTemplateParamsTask.getTemplateParams(itemId)}}}function FamCursorNeighboursTask(cursorItemTask,neighboursSelectionModeOptionTask,navigationFamilyTask,activeItemsTask){var _data={items:[]},_hash={},_dataTemplate=new ArrayReader(new ValueReader(["string","number"],!0),!0);return{process:function process(){var context={isChanged:!1,hash:_hash},cursorTreeItemId=cursorItemTask.getCursorTreeItem(),navigationFamily=navigationFamilyTask.getLogicalFamily(),neighboursSelectionMode=neighboursSelectionModeOptionTask.getNeighboursSelectionMode(),activeItems=activeItemsTask.getActiveItems();return _data.items=_dataTemplate.read(_data.items,function getCursorNeighbours(cursorTreeItemId,neighboursSelectionMode,navigationFamily,activeItems){var result=[],processed={};if(null!==cursorTreeItemId)switch(neighboursSelectionMode){case enums.DL.ParentsAndChildren:navigationFamily.loopParents(this,cursorTreeItemId,(function(itemid,item){if(item.isVisible&&!processed.hasOwnProperty(itemid)&&(processed[itemid]=!0,result.push(itemid)),activeItems.hasOwnProperty(itemid))return navigationFamily.SKIP})),navigationFamily.loopChildren(this,cursorTreeItemId,(function(itemid,item){if(item.isVisible&&!processed.hasOwnProperty(itemid)&&(processed[itemid]=!0,result.push(itemid)),activeItems.hasOwnProperty(itemid))return navigationFamily.SKIP}));break;case enums.DL.ParentsChildrenSiblingsAndSpouses:navigationFamily.loopNeighbours(this,cursorTreeItemId,(function(itemid,item){if(item.isVisible&&!processed.hasOwnProperty(itemid)&&(processed[itemid]=!0,result.push(itemid)),activeItems.hasOwnProperty(itemid))return!0}))}return result}(cursorTreeItemId,neighboursSelectionMode,navigationFamily,activeItems),"items",context),context.isChanged},getItems:function getItems(){return _data.items}}}function FamSelectionPathItemsTask(navigationFamilyTask,cursorItemTask,selectedItemsTask,cursorSelectionPathModeOptionTask){var _data={items:[]};return{process:function process(){var selectionPathMode=cursorSelectionPathModeOptionTask.getSelectionPathMode(),navigationFamily=navigationFamilyTask.getLogicalFamily(),cursorTreeItemId=cursorItemTask.getCursorTreeItem(),selectedItems=selectedItemsTask.getItems().slice(0);return selectedItems.push(cursorTreeItemId),_data.items=function getSelectionPathItems(selectedItems,navigationFamily,selectionPathMode){var selectedItem,index,len,result=[],processed={};for(index=0,len=selectedItems.length;index<len;index+=1)switch(selectedItem=selectedItems[index],selectionPathMode){case enums.lz.None:break;case enums.lz.FullStack:navigationFamily.loopParents(this,selectedItem,(function(parentItemId,parentItem){if(null!=processed[parentItemId])return navigationFamily.SKIP;parentItem.isVisible&&result.push(parentItemId),processed[parentItemId]=!0}))}return result}(selectedItems,navigationFamily,selectionPathMode),!0},getItems:function getItems(){return _data.items}}}function FamilyLayout_ChildLayoutPosition(offset,leftPadding,rightPadding){this.offset=offset,this.leftPadding=leftPadding,this.rightPadding=rightPadding}function FamilyLayout(logicalFamily,treeLevels,getConnectorsStacksSizes){this.logicalFamily=logicalFamily,this.treeLevels=treeLevels,this.getConnectorsStacksSizes=getConnectorsStacksSizes,this.treeLevelsPositions=[],this.childLayoutsPositions={}}function FamCreateLayoutsTreeTask(orderFamilyNodesTask,extractNestedLayoutsTask){var _data={layoutsTree:{},maximumId:null};return{process:function process(){var logicalFamily=orderFamilyNodesTask.getLogicalFamily(),treeLevels=orderFamilyNodesTask.getTreeLevels(),maximumId=orderFamilyNodesTask.getMaximumId(),getConnectorsStacksSizes=orderFamilyNodesTask.getConnectorsStacksSizes,layouts=extractNestedLayoutsTask.getLayouts(),rootLayout=new FamilyLayout(logicalFamily,treeLevels,getConnectorsStacksSizes),layoutsTree=Tree();maximumId++,layoutsTree.add(null,maximumId,rootLayout);for(var levelLayouts=[{id:maximumId,levelLayout:rootLayout}];levelLayouts.length>0;){for(var nextLevelLayouts=[],index=0;index<levelLayouts.length;index+=1){var{id:id,levelLayout:levelLayout}=levelLayouts[index];levelLayout.loop(this,(function(treeItem){var treeItemId=treeItem.id,itemLayout=layouts[treeItemId];itemLayout?nextLevelLayouts.push({id:treeItemId,levelLayout:itemLayout}):itemLayout=new ItemLayout(treeItem.isVisible?enums.EE.Auto:enums.EE.Invisible),layoutsTree.add(id,treeItemId,itemLayout)}))}levelLayouts=nextLevelLayouts}return _data.layoutsTree=layoutsTree,_data.maximumId=maximumId,!0},getLayoutsTree:function getLayoutsTree(){return _data.layoutsTree},getMaximumId:function getMaximumId(){return _data.maximumId}}}function FamTaskManagerFactory(getOptions,getGraphics,getLayout,setLayout,templates){var tasks=new TaskManager;return tasks.addDependency("options",getOptions),tasks.addDependency("graphics",getGraphics),tasks.addDependency("getLayout",getLayout),tasks.addDependency("setLayout",setLayout),tasks.addDependency("templates",templates),tasks.addDependency("defaultConfig",new FamConfig),tasks.addDependency("defaultItemConfig",new FamItemConfig),tasks.addDependency("defaultTemplateConfig",new TemplateConfig),tasks.addDependency("defaultPaletteItemConfig",new PaletteItemConfig),tasks.addDependency("defaultBackgroundAnnotationConfig",new BackgroundAnnotationConfig),tasks.addDependency("defaultConnectorAnnotationConfig",new ConnectorAnnotationConfig),tasks.addDependency("defaultHighlightPathAnnotationConfig",new HighlightPathAnnotationConfig),tasks.addDependency("defaultShapeAnnotationConfig",new ShapeAnnotationConfig),tasks.addDependency("defaultLabelAnnotationConfig",new LabelAnnotationConfig),tasks.addDependency("defaultLevelAnnotationConfig",new LevelAnnotationConfig),tasks.addDependency("showElbowDots",!0),tasks.addDependency("null",null),tasks.addDependency("foreground",enums.k0.Foreground),tasks.addDependency("background",enums.k0.Background),tasks.addTask("OptionsTask",["options"],OptionsTask,enums.wL.Black),tasks.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],CalloutOptionTask,enums.wL.Navy),tasks.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],ConnectorsOptionTask,enums.wL.Navy),tasks.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],FamItemsOptionTask,enums.wL.Navy),tasks.addTask("ItemsContentOptionTask",["OptionsTask","defaultItemConfig"],ItemsContentOptionTask,enums.wL.Navy),tasks.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],ItemsSizesOptionTask,enums.wL.Navy),tasks.addTask("MinimumVisibleLevelsOptionTask",["OptionsTask","defaultConfig"],MinimumVisibleLevelsOptionTask,enums.wL.Navy),tasks.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],LabelsOptionTask,enums.wL.Navy),tasks.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultTemplateConfig"],TemplatesOptionTask,enums.wL.Navy),tasks.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],OrientationOptionTask,enums.wL.Navy),tasks.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],FamVisualTreeOptionTask,enums.wL.Navy),tasks.addTask("MinimizedItemsOptionTask",["OptionsTask"],MinimizedItemsOptionTask,enums.wL.Navy),tasks.addTask("HideGrandParentsConnectorsOptionTask",["OptionsTask","defaultConfig"],HideGrandParentsConnectorsOptionTask,enums.wL.Navy),tasks.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],NormalizeOptionTask,enums.wL.Navy),tasks.addTask("ExtractNestedLayoutsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],ExtractNestedLayoutsOptionTask,enums.wL.Navy),tasks.addTask("OrderFamilyNodesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],OrderFamilyNodesOptionTask,enums.wL.Navy),tasks.addTask("LinePaletteOptionTask",["OptionsTask","defaultPaletteItemConfig"],LinePaletteOptionTask,enums.wL.Navy),tasks.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],CursorItemOptionTask,enums.wL.Navy),tasks.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],HighlightItemOptionTask,enums.wL.Navy),tasks.addTask("SelectedItemsOptionTask",["OptionsTask"],SelectedItemsOptionTask,enums.wL.Navy),tasks.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],CursorSelectionPathModeOptionTask,enums.wL.Navy),tasks.addTask("NeighboursSelectionModeOptionTask",["OptionsTask","defaultConfig"],NeighboursSelectionModeOptionTask,enums.wL.Navy),tasks.addTask("SplitAnnotationsOptionTask",["OptionsTask"],SplitAnnotationsOptionTask,enums.wL.Cyan),tasks.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],BackgroundAnnotationOptionTask,enums.wL.Navy),tasks.addTask("LevelAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultLevelAnnotationConfig"],LevelAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],ScaleOptionTask,enums.wL.Navy),tasks.addTask("FrameOptionTask",["OptionsTask","defaultConfig"],FrameOptionTask,enums.wL.Navy),tasks.addTask("LevelTitlePlacementOptionTask",["OptionsTask","defaultConfig"],LevelTitlePlacementOptionTask,enums.wL.Navy),tasks.addTask("LevelTitleTemplateOptionTask",["OptionsTask","defaultConfig"],LevelTitleTemplateOptionTask,enums.wL.Navy),tasks.addTask("UserDefinedNodesOrderTask",["OrderFamilyNodesOptionTask","defaultItemConfig"],UserDefinedNodesOrderTask,enums.wL.Red),tasks.addTask("LogicalFamilyTask",["ItemsOptionTask"],LogicalFamilyTask,enums.wL.Cyan),tasks.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],LabelAnnotationOptionTask,enums.wL.Navy),tasks.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],LabelAnnotationTemplateOptionTask,enums.wL.Navy),tasks.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],LabelAnnotationPlacementOptionTask,enums.wL.Navy),tasks.addTask("CombinedContextsTask",["ItemsContentOptionTask","LabelAnnotationOptionTask"],CombinedContextsTask,enums.wL.Cyan),tasks.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],AddLabelAnnotationsTask,enums.wL.Red),tasks.addTask("RemoveLoopsTask",["AddLabelAnnotationsTask"],RemoveLoopsTask,enums.wL.Red),tasks.addTask("HideGrandParentsConnectorsTask",["HideGrandParentsConnectorsOptionTask","RemoveLoopsTask"],HideGrandParentsConnectorsTask,enums.wL.Red),tasks.addTask("BindFamilyConnectorsTask",["HideGrandParentsConnectorsTask"],BindFamilyConnectorsTask,enums.wL.Red),tasks.addTask("ExtractNestedLayoutsTask",["ExtractNestedLayoutsOptionTask","BindFamilyConnectorsTask"],ExtractNestedLayoutsTask,enums.wL.Red),tasks.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","ExtractNestedLayoutsTask"],NormalizeLogicalFamilyTask,enums.wL.Red),tasks.addTask("OrderFamilyNodesTask",["OrderFamilyNodesOptionTask","UserDefinedNodesOrderTask","NormalizeLogicalFamilyTask"],OrderFamilyNodesTask,enums.wL.Red),tasks.addTask("FamCreateLayoutsTreeTask",["OrderFamilyNodesTask","ExtractNestedLayoutsTask"],FamCreateLayoutsTreeTask,enums.wL.Red),tasks.addTask("ReadTemplatesTask",["TemplatesOptionTask","templates"],ReadTemplatesTask,enums.wL.Cyan),tasks.addTask("ActiveItemsTask",["ItemsSizesOptionTask","ReadTemplatesTask"],ActiveItemsTask,enums.wL.Cyan),tasks.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],ItemTemplateParamsTask,enums.wL.Cyan),tasks.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],LabelAnnotationTemplateParamsTask,enums.wL.Cyan),tasks.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],CombinedTemplateParamsTask,enums.wL.Cyan),tasks.addTask("GroupTitleTemplateTask",["TemplatesOptionTask","templates"],GroupTitleTemplateTask,enums.wL.Cyan),tasks.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask","templates"],CheckBoxTemplateTask,enums.wL.Cyan),tasks.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],ButtonsTemplateTask,enums.wL.Cyan),tasks.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask","templates"],AnnotationLabelTemplateTask,enums.wL.Cyan),tasks.addTask("LevelAnnotationTemplateTask",["OrientationOptionTask","LevelTitleTemplateOptionTask","templates"],LevelAnnotationTemplateTask,enums.wL.Cyan),tasks.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","OrderFamilyNodesTask","ExtractNestedLayoutsTask","AlignDiagramTask","RemoveLoopsTask"],ConnectionsGraphTask,enums.wL.Cyan),tasks.addTask("HighlightItemTask",["HighlightItemOptionTask","ActiveItemsTask"],HighlightItemTask,enums.wL.Cyan),tasks.addTask("CursorItemTask",["CursorItemOptionTask","ActiveItemsTask"],CursorItemTask,enums.wL.Cyan),tasks.addTask("CursorNeighboursTask",["CursorItemTask","NeighboursSelectionModeOptionTask","AddLabelAnnotationsTask","ActiveItemsTask"],FamCursorNeighboursTask,enums.wL.Cyan),tasks.addTask("SelectedItemsTask",["SelectedItemsOptionTask","ItemsOptionTask"],SelectedItemsTask,enums.wL.Cyan),tasks.addTask("SelectionPathItemsTask",["RemoveLoopsTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],FamSelectionPathItemsTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],NormalVisibilityItemsByAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",["ForegroundConnectorAnnotationOptionTask"],NormalVisibilityItemsByConnectorAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],NormalVisibilityItemsByConnectorAnnotationTask,enums.wL.Cyan),tasks.addTask("NormalVisibilityItemsByMinimumVisibleLevelsTask",["MinimumVisibleLevelsOptionTask","OrderFamilyNodesTask"],FamNormalVisibilityItemsByMinimumVisibleLevelsTask,enums.wL.Cyan),tasks.addTask("CombinedNormalVisibilityItemsTask",["ItemsSizesOptionTask","CursorItemTask","CursorNeighboursTask","SelectedItemsTask","SelectionPathItemsTask","NormalVisibilityItemsByForegroundShapeAnnotationTask","NormalVisibilityItemsByBackgroundShapeAnnotationTask","NormalVisibilityItemsByBackgroundAnnotationTask","NormalVisibilityItemsByForegroundHighlightPathAnnotationTask","NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask","NormalVisibilityItemsByForegroundConnectorAnnotationTask","NormalVisibilityItemsByBackgroundConnectorAnnotationTask","NormalVisibilityItemsByMinimumVisibleLevelsTask"],CombinedNormalVisibilityItemsTask,enums.wL.Cyan),tasks.addTask("FrameSizeTask",["FrameOptionTask","ReadTemplatesTask","ScaleOptionTask"],FrameSizeTask,enums.wL.Navy),tasks.addTask("LevelTitleSizeTask",["LevelTitlePlacementOptionTask","LevelAnnotationOptionTask","OrientationOptionTask","ScaleOptionTask"],LevelTitleSizeTask,enums.wL.Navy),tasks.addTask("LayoutOptionsTask",["getLayout","OptionsTask"],LayoutOptionsTask,enums.wL.Black),tasks.addTask("CurrentControlSizeTask",["LayoutOptionsTask","ItemsSizesOptionTask","FrameSizeTask","LevelTitleSizeTask"],CurrentControlSizeTask,enums.wL.Black),tasks.addTask("CurrentScrollPositionTask",["LayoutOptionsTask"],CurrentScrollPositionTask,enums.wL.Black),tasks.addTask("ItemsPositionsTask",["CurrentControlSizeTask","ScaleOptionTask","OrientationOptionTask","ItemsSizesOptionTask","ConnectorsOptionTask","OrderFamilyNodesOptionTask","FamCreateLayoutsTreeTask","CombinedTemplateParamsTask","CursorItemTask","CombinedNormalVisibilityItemsTask"],ItemsPositionsTask,enums.wL.Red),tasks.addTask("AlignDiagramTask",["OrientationOptionTask","ItemsSizesOptionTask","VisualTreeOptionTask","ScaleOptionTask","CurrentControlSizeTask","ActiveItemsTask","ItemsPositionsTask"],AlignDiagramTask,enums.wL.Red),tasks.addTask("CreateTransformTask",["OrientationOptionTask","ScaleOptionTask","AlignDiagramTask"],CreateTransformTask,enums.wL.Cyan),tasks.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],PaletteManagerTask,enums.wL.Cyan),tasks.addTask("ApplyLayoutChangesTask",["graphics","setLayout","ItemsSizesOptionTask","CurrentControlSizeTask","ScaleOptionTask","AlignDiagramTask","FrameSizeTask","LevelTitleSizeTask"],ApplyLayoutChangesTask,enums.wL.Cyan),tasks.addTask("CenterOnCursorTask",["LayoutOptionsTask","ApplyLayoutChangesTask","CurrentScrollPositionTask","CursorItemTask","AlignDiagramTask","CreateTransformTask","ScaleOptionTask"],CenterOnCursorTask,enums.wL.Cyan),tasks.addTask("ProjectItemsToFrameTask",["CreateTransformTask","FrameSizeTask","ApplyLayoutChangesTask","ScaleOptionTask","AlignDiagramTask","CenterOnCursorTask","ItemTemplateParamsTask","SelectedItemsTask"],ProjectItemsToFrameTask,enums.wL.Cyan),tasks.addTask("ViewPortPlacementTask",["ScaleOptionTask","CenterOnCursorTask","CreateTransformTask","ApplyLayoutChangesTask"],ViewPortPlacementTask,enums.wL.Green),tasks.addTask("VerticalOffsetTask",["ViewPortPlacementTask"],VerticalOffsetTask,enums.wL.Green),tasks.addTask("LogicalLevelsPlacementTask",["OrderFamilyNodesTask","AlignDiagramTask"],FamLogicalLevelsPlacementTask,enums.wL.Green),tasks.addTask("MergeLevelIntervalsTask",["LevelAnnotationOptionTask","LogicalLevelsPlacementTask"],MergeLevelIntervalsTask,enums.wL.Green),tasks.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawBackgroundAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","BackgroundAnnotationOptionTask","LogicalFamilyTask","AlignDiagramTask"],DrawBackgroundAnnotationTask,enums.wL.Green),tasks.addTask("DrawForegroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawForegroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawCursorTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","CombinedTemplateParamsTask","CursorItemTask","SelectedItemsTask"],DrawCursorTask,enums.wL.Green),tasks.addTask("DrawHighlightTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","CombinedTemplateParamsTask","HighlightItemTask","CursorItemTask","SelectedItemsTask"],DrawHighlightTask,enums.wL.Green),tasks.addTask("DrawHighlightAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","ScaleOptionTask","CombinedContextsTask","CalloutOptionTask","ReadTemplatesTask","AlignDiagramTask","CenterOnCursorTask","HighlightItemTask","CursorItemTask","SelectedItemsTask","FrameSizeTask"],DrawHighlightAnnotationTask,enums.wL.Green),tasks.addTask("DrawTreeItemsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","ScaleOptionTask","ItemsSizesOptionTask","CombinedContextsTask","AlignDiagramTask","CenterOnCursorTask","CombinedTemplateParamsTask","CursorItemTask","SelectedItemsTask","GroupTitleTemplateTask","CheckBoxTemplateTask","ButtonsTemplateTask"],DrawTreeItemsTask,enums.wL.Green),tasks.addTask("DrawMinimizedItemsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","MinimizedItemsOptionTask","CombinedTemplateParamsTask","AlignDiagramTask"],DrawMinimizedItemsTask,enums.wL.Green),tasks.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],DrawConnectorsTask,enums.wL.Green),tasks.addTask("DrawItemLabelsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","LabelsOptionTask","AlignDiagramTask"],DrawItemLabelsTask,enums.wL.Green),tasks.addTask("DrawFrameItemsTask",["graphics","ApplyLayoutChangesTask","ProjectItemsToFrameTask","ItemTemplateParamsTask","MinimizedItemsOptionTask"],DrawFrameItemsTask,enums.wL.Green),tasks.addTask("DrawFrameHighlightTask",["graphics","ProjectItemsToFrameTask","CombinedContextsTask","ItemTemplateParamsTask","HighlightItemTask","CursorItemTask"],DrawFrameHighlightTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationBackgroundTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask"],DrawLevelAnnotationBackgroundTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationTitlesTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask","LevelTitlePlacementOptionTask"],DrawLevelAnnotationTitlesTask,enums.wL.Green),tasks}function FamEventArgsFactory(data,oldTreeItemId,newTreeItemId,name){var itemPosition,offset,panelOffset,result=new FamEventArgs,combinedContextsTask=data.tasks.getTask("CombinedContextsTask"),alignDiagramTask=data.tasks.getTask("AlignDiagramTask"),logicalFamilyTask=data.tasks.getTask("LogicalFamilyTask"),oldItemConfig=combinedContextsTask.getConfig(oldTreeItemId),newItemConfig=combinedContextsTask.getConfig(newTreeItemId),family=logicalFamilyTask.getLogicalFamily();return oldItemConfig&&null!=oldItemConfig.id&&(result.oldContext=oldItemConfig),newItemConfig&&null!=newItemConfig.id&&(result.context=newItemConfig,family.loopParents(this,newItemConfig.id,(function(itemid,item,levelIndex){if(levelIndex>0)return family.BREAK;result.parentItems.push(combinedContextsTask.getConfig(itemid))})),family.loopChildren(this,newItemConfig.id,(function(itemid,item,levelIndex){if(levelIndex>0)return family.BREAK;result.childrenItems.push(combinedContextsTask.getConfig(itemid))})),panelOffset=getElementOffset(data.layout.mousePanel),offset=getElementOffset(data.layout.element),itemPosition=alignDiagramTask.getItemPosition(newTreeItemId),result.position=new Rect(itemPosition.actualPosition).translate(panelOffset.left,panelOffset.top).translate(-offset.left,-offset.top)),null!=name&&(result.name=name),result}function FamDiagram(element,options,templates){return BaseControl(element,options,FamTaskManagerFactory,FamEventArgsFactory,{AnnotationLabelTemplate:AnnotationLabelTemplate,ButtonsTemplate:ButtonsTemplate,CustomRenderTemplate:CustomRenderTemplate,CheckBoxTemplate:CheckBoxTemplate,CursorTemplate:CursorTemplate,DotHighlightTemplate:DotHighlightTemplate,GroupTitleTemplate:GroupTitleTemplate,HighlightTemplate:HighlightTemplate,ItemTemplate:ItemTemplate,UserTemplate:UserTemplate,LevelTitleTemplate:LevelTitleTemplate,LevelBackgroundTemplate:LevelBackgroundTemplate,LabelAnnotationTemplate:LabelAnnotationTemplate,...templates})}function AnnotationLabelTemplate_AnnotationLabelTemplate(){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var annotationConfig=data.context;doc.save(),doc.font("Helvetica",12).text(annotationConfig.label,position.x,position.y,{width:position.width,height:position.height,align:"center"}),doc.restore()}}}function CheckBoxTemplate_CheckBoxTemplate(selectCheckBoxLabel){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var image=data.isSelected?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAF/SURBVDhPpZM7rwFREMf/u4hEY5vVkigoSERiKwq1QqOh28R30QnFRqnSKHwFn0C37Sbi0SCE2KzE41wzd/feG48g91ftmdn5zznzkLLZrNhutzidTvgEv98PRVEgxeNx0e12EYvFcDweXfdjZFmGEIKDx+MxdF0HotGomEwmV/tnUAzFyqT8KrNHLpdDJpPBZrPh81UHLPAO7XYb6/Ua8/kcpmnC5/NBkqT3BJbLJRqNBgKBACqVCgqFAg6HA/veEiiVSlBVFZfLBZ1Ox7V+81KAMtPVV6sV+v2+a/2FBeg9RDqdhqZp/E1Mp1O0Wi32V6tVLuAtLEBvGw6HmM1m2O/3yOfz7CyXy4hEItz3ZrPJtr/8dIEKUiwWYRgGX3e32yGZTOJ8PnMBB4MBB9xy14VarcaZFosFQqEQHMdBvV5HIpFw/3gATZNlWTxdHr1eT4TDYZFKpVzLPRRDsU9HeTQaCdu23dM91wKzwNNlCgaDXINHW0pF95bpn+us4AsY2TIOZFyZ9AAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACjSURBVDhPrZNNCsQgDEY/f2q33sCCN+iNPJlXE2/gTtDiVBln1TJo+zZBJS+YELLvewkhIOeMETjnkFKCaK2LtRbbtiGl9H2+hlKKUkpLds7BGAMopYr3/rwfo+bUXFrN/yrfcXrQBDMwxkAImRfEGFucFnTeEdT/zNIEy7K0wyi/KfSGjPJoCp13BDM9EEK0eLtM67riOI7LLa0F+zI9XGeJDyTldfBA9FNyAAAAAElFTkSuQmCC";doc.save(),doc.image(image,position.x,position.y),doc.font("Helvetica",11).text(selectCheckBoxLabel,position.x+20,position.y+4,{ellipsis:!0,width:position.width-4,height:position.height,align:"left"}),doc.restore()}}}function CustomRenderTemplate_CustomRenderTemplate(options,onRender){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){null!=onRender&&onRender(doc,position,data)}}}function CursorTemplate_CursorTemplate(options,itemTemplateConfig){var _config=itemTemplateConfig;return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){doc.save(),doc.roundedRect(position.x,position.y,position.width,position.height,4).lineWidth(_config.cursorBorderWidth).stroke("#fbd850"),doc.restore()}}}function DummyTemplate(){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(){}}}function renderRotatedText({doc:doc,textOrientation:textOrientation,label:label,fontSize:fontSize,fontColor:fontColor,position:position,titleColor:titleColor,horizontalAlignment:horizontalAlignment,verticalAlignment:verticalAlignment}){doc.save(),doc.fillColor(titleColor).roundedRect(position.x,position.y,position.width-2,position.height,4).fill();var labelPosition=new Rect(position.x+4,position.y,position.width-8,position.height);switch(textOrientation){case enums.GE.RotateLeft:doc.translate(0,position.height).rotate(-90,{origin:[position.x,position.y]}),labelPosition=new Rect(position.x+4,position.y,position.height-8,position.width);break;case enums.GE.RotateRight:doc.translate(position.width,0).rotate(90,{origin:[position.x,position.y]}),labelPosition=new Rect(position.x+4,position.y,position.height-8,position.width)}doc.font("Helvetica",fontSize);var textHeight=doc.currentLineHeight();switch(verticalAlignment){case enums.Vn.Top:labelPosition.y+=2;break;case enums.Vn.Middle:labelPosition.y+=Math.ceil(labelPosition.height/2-textHeight/2);break;case enums.Vn.Bottom:labelPosition.y+=Math.ceil(labelPosition.height-textHeight-1)}doc.fillColor(fontColor).text(label,labelPosition.x,labelPosition.y,{ellipsis:!0,width:labelPosition.width,height:labelPosition.height,align:getTextAlign(horizontalAlignment)}),doc.restore()}function GroupTitleTemplate_GroupTitleTemplate(options){var{groupTitleFontSize:groupTitleFontSize,groupTitleFontFamily:fontFamily,groupTitleFontWeight:fontWeight,groupTitleFontStyle:fontStyle,groupTitleOrientation:textOrientation,groupTitleHorizontalAlignment:horizontalAlignment,groupTitleVerticalAlignment:verticalAlignment,groupTitleColor:groupTitleColor,itemTitleFirstFontColor:itemTitleFirstFontColor,itemTitleSecondFontColor:itemTitleSecondFontColor}=options;return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var itemConfig=data.context,titleColor=itemConfig.groupTitleColor||groupTitleColor,fontColor=highestContrast(titleColor,itemTitleSecondFontColor,itemTitleFirstFontColor),label=itemConfig.groupTitle,fontSize=parseInt(groupTitleFontSize,10);renderRotatedText({doc:doc,textOrientation:textOrientation,label:label,fontSize:fontSize,fontColor:fontColor,position:position,titleColor:titleColor,horizontalAlignment:horizontalAlignment,verticalAlignment:verticalAlignment})}}}function HighlightTemplate_HighlightTemplate(options,itemTemplateConfig){var _config=itemTemplateConfig;return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,_data){doc.save(),doc.roundedRect(position.x,position.y,position.width,position.height,4).lineWidth(_config.highlightBorderWidth).stroke("#fbcb09"),doc.restore()}}}function ItemTemplate_ItemTemplate(options,itemTemplateConfig){var _config=itemTemplateConfig;return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var itemConfig=data.context,itemTitleColor=null!=itemConfig.itemTitleColor?itemConfig.itemTitleColor:enums.wL.RoyalBlue,color=highestContrast(itemTitleColor,options.itemTitleSecondFontColor,options.itemTitleFirstFontColor),contentSize=new Size(_config.itemSize);contentSize.width-=2*_config.itemBorderWidth,contentSize.height-=2*_config.itemBorderWidth,doc.save(),doc.roundedRect(position.x,position.y,position.width,position.height,4).lineWidth(_config.itemBorderWidth).stroke("#dddddd"),doc.fillColor(itemTitleColor).roundedRect(position.x+2,position.y+2,contentSize.width-4,18,2).fill(),doc.fillColor(color).font("Helvetica",12).text(itemConfig.title,position.x+4,position.y+7,{ellipsis:!0,width:contentSize.width-4-8,height:16,align:"left"}),null!=itemConfig.image&&doc.image(itemConfig.image,position.x+3,position.y+24),doc.rect(position.x+3,position.y+24,50,60).stroke("#cccccc"),doc.fillColor("black").font("Helvetica",10).text(itemConfig.description,position.x+56,position.y+24,{ellipsis:!0,width:contentSize.width-4-56,height:74,align:"left"}),doc.restore()}}}function UserTemplate_UserTemplate(options,itemTemplateConfig,onRender){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){null!=onRender?onRender(doc,position,data):ItemTemplate_ItemTemplate(options,itemTemplateConfig).render(doc,position,data)}}}function LabelAnnotationTemplate_LabelAnnotationTemplate(){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var itemConfig=data.context;doc.save(),doc.font("Helvetica",12).text(itemConfig.title,position.x,position.y,{width:position.width,height:position.height,align:"center"}),doc.restore()}}}function LevelTitleTemplate_LevelTitleTemplate(options,orientation){var{levelTitleFontSize:levelTitleFontSize,levelTitleFontFamily:fontFamily,levelTitleFontWeight:fontWeight,levelTitleFontStyle:fontStyle,levelTitleFontColor:levelTitleFontColor,levelTitleOrientation:textOrientation,levelTitleHorizontalAlignment:horizontalAlignment,levelTitleVerticalAlignment:verticalAlignment,levelTitleColor:levelTitleColor}=options;return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var config=data.context,titleColor=config.titleColor||levelTitleColor,label=config.title,fontColor=config.titleFontColor||levelTitleFontColor;if(textOrientation==enums.GE.Auto)switch(orientation){case enums.F7.Top:textOrientation=enums.GE.RotateRight;break;case enums.F7.Bottom:textOrientation=enums.GE.RotateLeft;case enums.F7.Left:case enums.F7.Right:}var fontSize=parseInt(levelTitleFontSize,10);renderRotatedText({doc:doc,textOrientation:textOrientation,label:label,fontSize:fontSize,fontColor:fontColor,position:position,titleColor:titleColor,horizontalAlignment:horizontalAlignment,verticalAlignment:verticalAlignment})}}}function LevelBackgroundTemplate_LevelBackgroundTemplate(options,levelAnnotationConfig){return{template:function template(){return{}},getHashCode:function getHashCode(){return 0},render:function render(doc,position,data){var annotationConfig=data.context,{opacity:opacity,borderColor:borderColor,fillColor:fillColor,lineWidth:borderWidth,lineType:lineType}=annotationConfig;doc.save(),doc.rect(position.x,position.y,position.width,position.height,0).fillColor(fillColor,opacity).fill(),doc.lineJoin("round"),position.loopEdges((function(vector,placementType){var lineWidth=0;switch(placementType){case enums.TK.Top:lineWidth=borderWidth.top;break;case enums.TK.Right:lineWidth=borderWidth.right;break;case enums.TK.Bottom:lineWidth=borderWidth.bottom;break;case enums.TK.Left:lineWidth=borderWidth.left}if(lineWidth>0){if(null!=lineType){var step=Math.round(lineWidth)||1;switch(lineType){case enums.SP.Solid:break;case enums.SP.Dotted:doc.dash(step,2*step);break;case enums.SP.Dashed:doc.dash(5*step,3*step)}}doc.moveTo(vector.from.x,vector.from.y).lineTo(vector.to.x,vector.to.y).lineWidth(lineWidth).strokeColor(borderColor).stroke()}})),doc.restore()}}}function PdfGraphics(doc){this._doc=doc,this._context=this._doc,this.m_placeholders={},this.m_activePlaceholder=null,this.saveCounter=0}function BasePdfkitPlugin(options,createTaskManager,templates){var _data={doc:null,options:options,tasks:null,graphics:null,controlSize:null};function getOptions(){return _data.options}function getGraphics(){return _data.graphics}function setLayout(options){var{graphics:graphics}=_data,{frameMousePanelRect:frameMousePanelRect,titlesMousePanelRect:titlesMousePanelRect,scrollPanelRect:scrollPanelRect,controlSize:controlSize}=options;graphics.position("frameplaceholder",frameMousePanelRect.x,frameMousePanelRect.y,frameMousePanelRect.width,frameMousePanelRect.height),graphics.position("titlesplaceholder",titlesMousePanelRect.x,titlesMousePanelRect.y,titlesMousePanelRect.width,titlesMousePanelRect.height),graphics.position("placeholder",scrollPanelRect.x,scrollPanelRect.y,scrollPanelRect.width,scrollPanelRect.height),_data.controlSize=controlSize}function _disableNotAvailableFunctionality(){_data.options.scale=1,_data.options.showFrame=!1,_data.options.hasButtons=enums.xB.False,_data.options.pageFitMode=enums.sj.AutoSize,_data.options.autoSizeMinimum=new Size(0,0),_data.options.autoSizeMaximum=new Size(1e6,1e6)}return{draw:function draw(doc,positionX,positionY){return _data.doc=doc,_data.tasks=createTaskManager(getOptions,getGraphics,setLayout,templates),_data.graphics=new PdfGraphics(_data.doc),_data.graphics.debug=false,_disableNotAvailableFunctionality(),_data.doc.save(),_data.doc.translate(positionX,positionY),_data.tasks.process("OptionsTask",null,false),_data.graphics.clean(),_data.doc.restore(),new Size(_data.controlSize)},getSize:function getSize(){return _data.tasks=createTaskManager(getOptions,getGraphics,setLayout,templates),_data.graphics=new PdfGraphics(_data.doc),_data.graphics.debug=false,_disableNotAvailableFunctionality(),_data.tasks.process("OptionsTask","ApplyLayoutChangesTask",false),_data.graphics.clean(),new Size(_data.controlSize)}}}function DummyCombinedNormalVisibilityItemsTask(optionsTask){return{process:function process(){return!0},isItemSelected:function isItemSelected(treeItem){return!1}}}function DummyCurrentControlSizeTask(optionsTask){return{process:function process(){return!0},getOptions:function getOptions(){return{scrollPanelSize:new Size(800,600),optimalPanelSize:new Size(775,575),hasFrame:!0,hasLevelTitles:!0}}}}function OrgPdfkitTaskManagerFactory(getOptions,getGraphics,setLayout,templates){var tasks=new TaskManager;return tasks.addDependency("options",getOptions),tasks.addDependency("graphics",getGraphics),tasks.addDependency("setLayout",setLayout),tasks.addDependency("templates",templates),tasks.addDependency("defaultConfig",new OrgConfig),tasks.addDependency("defaultItemConfig",new OrgItemConfig),tasks.addDependency("defaultTemplateConfig",new TemplateConfig),tasks.addDependency("defaultBackgroundAnnotationConfig",new BackgroundAnnotationConfig),tasks.addDependency("defaultConnectorAnnotationConfig",new ConnectorAnnotationConfig),tasks.addDependency("defaultHighlightPathAnnotationConfig",new HighlightPathAnnotationConfig),tasks.addDependency("defaultShapeAnnotationConfig",new ShapeAnnotationConfig),tasks.addDependency("defaultLevelAnnotationConfig",new LevelAnnotationConfig),tasks.addDependency("showElbowDots",!1),tasks.addDependency("null",null),tasks.addDependency("foreground",enums.k0.Foreground),tasks.addDependency("background",enums.k0.Background),tasks.addTask("OptionsTask",["options"],OptionsTask,enums.wL.Black),tasks.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],CalloutOptionTask,enums.wL.Navy),tasks.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],ConnectorsOptionTask,enums.wL.Navy),tasks.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],OrgItemsOptionTask,enums.wL.Navy),tasks.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],ItemsSizesOptionTask,enums.wL.Navy),tasks.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultTemplateConfig"],TemplatesOptionTask,enums.wL.Navy),tasks.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],OrientationOptionTask,enums.wL.Navy),tasks.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],OrgVisualTreeOptionTask,enums.wL.Navy),tasks.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],CursorItemOptionTask,enums.wL.Navy),tasks.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],HighlightItemOptionTask,enums.wL.Navy),tasks.addTask("SelectedItemsOptionTask",["OptionsTask"],SelectedItemsOptionTask,enums.wL.Navy),tasks.addTask("SplitAnnotationsOptionTask",["OptionsTask"],SplitAnnotationsOptionTask,enums.wL.Cyan),tasks.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],BackgroundAnnotationOptionTask,enums.wL.Navy),tasks.addTask("LevelAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultLevelAnnotationConfig"],LevelAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],ScaleOptionTask,enums.wL.Navy),tasks.addTask("FrameOptionTask",["OptionsTask","defaultConfig"],FrameOptionTask,enums.wL.Navy),tasks.addTask("LevelTitlePlacementOptionTask",["OptionsTask","defaultConfig"],LevelTitlePlacementOptionTask,enums.wL.Navy),tasks.addTask("LevelTitleTemplateOptionTask",["OptionsTask","defaultConfig"],LevelTitleTemplateOptionTask,enums.wL.Navy),tasks.addTask("CombinedContextsTask",["ItemsOptionTask"],CombinedContextsTask,enums.wL.Cyan),tasks.addTask("OrgTreeTask",["ItemsOptionTask"],OrgTreeTask,enums.wL.Red),tasks.addTask("ReadTemplatesTask",["TemplatesOptionTask","templates"],ReadTemplatesTask,enums.wL.Cyan),tasks.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],ItemTemplateParamsTask,enums.wL.Cyan),tasks.addTask("GroupTitleTemplateTask",["TemplatesOptionTask","templates"],GroupTitleTemplateTask,enums.wL.Cyan),tasks.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask","templates"],CheckBoxTemplateTask,enums.wL.Cyan),tasks.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],ButtonsTemplateTask,enums.wL.Cyan),tasks.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask","templates"],AnnotationLabelTemplateTask,enums.wL.Cyan),tasks.addTask("LevelAnnotationTemplateTask",["OrientationOptionTask","LevelTitleTemplateOptionTask","templates"],LevelAnnotationTemplateTask,enums.wL.Cyan),tasks.addTask("VisualTreeTask",["OrgTreeTask","null","VisualTreeOptionTask"],VisualTreeTask,enums.wL.Red),tasks.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],VisualTreeLevelsTask,enums.wL.Red),tasks.addTask("ExtractNestedLayoutsTask",["OptionsTask"],OrgExtractNestedLayoutsTask,enums.wL.Red),tasks.addTask("CreateLayoutsTreeTask",["VisualTreeTask","VisualTreeLevelsTask","ExtractNestedLayoutsTask"],OrgCreateLayoutsTreeTask,enums.wL.Red),tasks.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","ExtractNestedLayoutsTask","AlignDiagramTask"],ConnectionsGraphTask,enums.wL.Cyan),tasks.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],HighlightItemTask,enums.wL.Cyan),tasks.addTask("CursorItemTask",["CursorItemOptionTask","null"],CursorItemTask,enums.wL.Cyan),tasks.addTask("SelectedItemsTask",["SelectedItemsOptionTask","ItemsOptionTask"],SelectedItemsTask,enums.wL.Cyan),tasks.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],DummyCombinedNormalVisibilityItemsTask,enums.wL.Cyan),tasks.addTask("FrameSizeTask",["FrameOptionTask","ReadTemplatesTask","ScaleOptionTask"],FrameSizeTask,enums.wL.Navy),tasks.addTask("LevelTitleSizeTask",["LevelTitlePlacementOptionTask","LevelAnnotationOptionTask","OrientationOptionTask","ScaleOptionTask"],LevelTitleSizeTask,enums.wL.Navy),tasks.addTask("CurrentControlSizeTask",["OptionsTask"],DummyCurrentControlSizeTask,enums.wL.Cyan),tasks.addTask("ItemsPositionsTask",["CurrentControlSizeTask","ScaleOptionTask","OrientationOptionTask","ItemsSizesOptionTask","ConnectorsOptionTask","VisualTreeOptionTask","CreateLayoutsTreeTask","ItemTemplateParamsTask","CursorItemTask","CombinedNormalVisibilityItemsTask"],ItemsPositionsTask,enums.wL.Red),tasks.addTask("AlignDiagramTask",["OrientationOptionTask","ItemsSizesOptionTask","VisualTreeOptionTask","ScaleOptionTask","CurrentControlSizeTask","null","ItemsPositionsTask"],AlignDiagramTask,enums.wL.Red),tasks.addTask("CreateTransformTask",["OrientationOptionTask","ScaleOptionTask","AlignDiagramTask"],CreateTransformTask,enums.wL.Cyan),tasks.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],PaletteManagerTask,enums.wL.Cyan),tasks.addTask("ApplyLayoutChangesTask",["graphics","setLayout","ItemsSizesOptionTask","CurrentControlSizeTask","ScaleOptionTask","AlignDiagramTask","FrameSizeTask","LevelTitleSizeTask"],ApplyLayoutChangesTask,enums.wL.Green),tasks.addTask("ViewPortPlacementTask",["ScaleOptionTask","CenterOnCursorTask","CreateTransformTask","ApplyLayoutChangesTask"],ViewPortPlacementTask,enums.wL.Green),tasks.addTask("VerticalOffsetTask",["ViewPortPlacementTask"],VerticalOffsetTask,enums.wL.Green),tasks.addTask("LogicalLevelsPlacementTask",["OrgTreeTask","VisualTreeTask","AlignDiagramTask"],OrgLogicalLevelsPlacementTask,enums.wL.Green),tasks.addTask("MergeLevelIntervalsTask",["LevelAnnotationOptionTask","LogicalLevelsPlacementTask"],MergeLevelIntervalsTask,enums.wL.Green),tasks.addTask("DrawBackgroundAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","BackgroundAnnotationOptionTask","VisualTreeTask","AlignDiagramTask"],DrawBackgroundAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background","DrawBackgroundAnnotationTask"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background","DrawBackgroundShapeAnnotationTask"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawTreeItemsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","null","ItemsSizesOptionTask","CombinedContextsTask","AlignDiagramTask","null","ItemTemplateParamsTask","CursorItemTask","SelectedItemsTask","GroupTitleTemplateTask","CheckBoxTemplateTask","ButtonsTemplateTask","DrawBackgroundConnectorAnnotationTask"],DrawTreeItemsTask,enums.wL.Green),tasks.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground","DrawTreeItemsTask"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask","DrawBackgroundHighlightPathAnnotationTask"],DrawConnectorsTask,enums.wL.Green),tasks.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background","DrawConnectorsTask"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawForegroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground","DrawForegroundHighlightPathAnnotationTask"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawForegroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground","DrawForegroundShapeAnnotationTask"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawCursorTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","ItemTemplateParamsTask","CursorItemTask","SelectedItemsTask","DrawForegroundConnectorAnnotationTask"],DrawCursorTask,enums.wL.Green),tasks.addTask("DrawHighlightTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","ItemTemplateParamsTask","HighlightItemTask","CursorItemTask","SelectedItemsTask","DrawCursorTask"],DrawHighlightTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationBackgroundTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask"],DrawLevelAnnotationBackgroundTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationTitlesTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask","LevelTitlePlacementOptionTask"],DrawLevelAnnotationTitlesTask,enums.wL.Green),tasks}function OrgDiagramPdfkit(options,templates){return BasePdfkitPlugin(options,OrgPdfkitTaskManagerFactory,{AnnotationLabelTemplate:AnnotationLabelTemplate_AnnotationLabelTemplate,ButtonsTemplate:DummyTemplate,CheckBoxTemplate:CheckBoxTemplate_CheckBoxTemplate,CursorTemplate:CursorTemplate_CursorTemplate,CustomRenderTemplate:CustomRenderTemplate_CustomRenderTemplate,DotHighlightTemplate:DummyTemplate,GroupTitleTemplate:GroupTitleTemplate_GroupTitleTemplate,HighlightTemplate:HighlightTemplate_HighlightTemplate,ItemTemplate:ItemTemplate_ItemTemplate,UserTemplate:UserTemplate_UserTemplate,LevelTitleTemplate:LevelTitleTemplate_LevelTitleTemplate,LevelBackgroundTemplate:LevelBackgroundTemplate_LevelBackgroundTemplate,LabelAnnotationTemplate:LabelAnnotationTemplate_LabelAnnotationTemplate,...templates})}function FamPdfkitTaskManagerFactory(getOptions,getGraphics,setLayout,templates){var tasks=new TaskManager;return tasks.addDependency("options",getOptions),tasks.addDependency("graphics",getGraphics),tasks.addDependency("setLayout",setLayout),tasks.addDependency("templates",templates),tasks.addDependency("defaultConfig",new FamConfig),tasks.addDependency("defaultItemConfig",new FamItemConfig),tasks.addDependency("defaultTemplateConfig",new TemplateConfig),tasks.addDependency("defaultPaletteItemConfig",new PaletteItemConfig),tasks.addDependency("defaultBackgroundAnnotationConfig",new BackgroundAnnotationConfig),tasks.addDependency("defaultConnectorAnnotationConfig",new ConnectorAnnotationConfig),tasks.addDependency("defaultHighlightPathAnnotationConfig",new HighlightPathAnnotationConfig),tasks.addDependency("defaultShapeAnnotationConfig",new ShapeAnnotationConfig),tasks.addDependency("defaultLabelAnnotationConfig",new LabelAnnotationConfig),tasks.addDependency("defaultLevelAnnotationConfig",new LevelAnnotationConfig),tasks.addDependency("showElbowDots",!0),tasks.addDependency("null",null),tasks.addDependency("foreground",enums.k0.Foreground),tasks.addDependency("background",enums.k0.Background),tasks.addTask("OptionsTask",["options"],OptionsTask,enums.wL.Black),tasks.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],CalloutOptionTask,enums.wL.Navy),tasks.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],ConnectorsOptionTask,enums.wL.Navy),tasks.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],FamItemsOptionTask,enums.wL.Navy),tasks.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],ItemsSizesOptionTask,enums.wL.Navy),tasks.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultTemplateConfig"],TemplatesOptionTask,enums.wL.Navy),tasks.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],OrientationOptionTask,enums.wL.Navy),tasks.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],FamVisualTreeOptionTask,enums.wL.Navy),tasks.addTask("HideGrandParentsConnectorsOptionTask",["OptionsTask","defaultConfig"],HideGrandParentsConnectorsOptionTask,enums.wL.Navy),tasks.addTask("ExtractNestedLayoutsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],ExtractNestedLayoutsOptionTask,enums.wL.Navy),tasks.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],NormalizeOptionTask,enums.wL.Navy),tasks.addTask("OrderFamilyNodesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],OrderFamilyNodesOptionTask,enums.wL.Navy),tasks.addTask("LinePaletteOptionTask",["OptionsTask","defaultPaletteItemConfig"],LinePaletteOptionTask,enums.wL.Navy),tasks.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],CursorItemOptionTask,enums.wL.Navy),tasks.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],HighlightItemOptionTask,enums.wL.Navy),tasks.addTask("SelectedItemsOptionTask",["OptionsTask"],SelectedItemsOptionTask,enums.wL.Navy),tasks.addTask("SplitAnnotationsOptionTask",["OptionsTask"],SplitAnnotationsOptionTask,enums.wL.Cyan),tasks.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],ShapeAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],HighlightPathAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],ConnectorAnnotationOptionTask,enums.wL.Navy),tasks.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],BackgroundAnnotationOptionTask,enums.wL.Navy),tasks.addTask("LevelAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultLevelAnnotationConfig"],LevelAnnotationOptionTask,enums.wL.Navy),tasks.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],ScaleOptionTask,enums.wL.Navy),tasks.addTask("FrameOptionTask",["OptionsTask","defaultConfig"],FrameOptionTask,enums.wL.Navy),tasks.addTask("LevelTitlePlacementOptionTask",["OptionsTask","defaultConfig"],LevelTitlePlacementOptionTask,enums.wL.Navy),tasks.addTask("LevelTitleTemplateOptionTask",["OptionsTask","defaultConfig"],LevelTitleTemplateOptionTask,enums.wL.Navy),tasks.addTask("UserDefinedNodesOrderTask",["OrderFamilyNodesOptionTask","defaultItemConfig"],UserDefinedNodesOrderTask,enums.wL.Red),tasks.addTask("LogicalFamilyTask",["ItemsOptionTask"],LogicalFamilyTask,enums.wL.Cyan),tasks.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],LabelAnnotationOptionTask,enums.wL.Navy),tasks.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],LabelAnnotationTemplateOptionTask,enums.wL.Navy),tasks.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],LabelAnnotationPlacementOptionTask,enums.wL.Navy),tasks.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],CombinedContextsTask,enums.wL.Cyan),tasks.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],AddLabelAnnotationsTask,enums.wL.Red),tasks.addTask("RemoveLoopsTask",["AddLabelAnnotationsTask"],RemoveLoopsTask,enums.wL.Red),tasks.addTask("HideGrandParentsConnectorsTask",["HideGrandParentsConnectorsOptionTask","RemoveLoopsTask"],HideGrandParentsConnectorsTask,enums.wL.Red),tasks.addTask("BindFamilyConnectorsTask",["HideGrandParentsConnectorsTask"],BindFamilyConnectorsTask,enums.wL.Red),tasks.addTask("ExtractNestedLayoutsTask",["ExtractNestedLayoutsOptionTask","BindFamilyConnectorsTask"],ExtractNestedLayoutsTask,enums.wL.Red),tasks.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","ExtractNestedLayoutsTask"],NormalizeLogicalFamilyTask,enums.wL.Red),tasks.addTask("OrderFamilyNodesTask",["OrderFamilyNodesOptionTask","UserDefinedNodesOrderTask","NormalizeLogicalFamilyTask"],OrderFamilyNodesTask,enums.wL.Red),tasks.addTask("FamCreateLayoutsTreeTask",["OrderFamilyNodesTask","ExtractNestedLayoutsTask"],FamCreateLayoutsTreeTask,enums.wL.Red),tasks.addTask("ReadTemplatesTask",["TemplatesOptionTask","templates"],ReadTemplatesTask,enums.wL.Cyan),tasks.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],ItemTemplateParamsTask,enums.wL.Cyan),tasks.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],LabelAnnotationTemplateParamsTask,enums.wL.Cyan),tasks.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],CombinedTemplateParamsTask,enums.wL.Cyan),tasks.addTask("GroupTitleTemplateTask",["TemplatesOptionTask","templates"],GroupTitleTemplateTask,enums.wL.Cyan),tasks.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask","templates"],CheckBoxTemplateTask,enums.wL.Cyan),tasks.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask","templates"],ButtonsTemplateTask,enums.wL.Cyan),tasks.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask","templates"],AnnotationLabelTemplateTask,enums.wL.Cyan),tasks.addTask("LevelAnnotationTemplateTask",["OrientationOptionTask","LevelTitleTemplateOptionTask","templates"],LevelAnnotationTemplateTask,enums.wL.Cyan),tasks.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","OrderFamilyNodesTask","ExtractNestedLayoutsTask","AlignDiagramTask","RemoveLoopsTask"],ConnectionsGraphTask,enums.wL.Cyan),tasks.addTask("HighlightItemTask",["HighlightItemOptionTask","null"],HighlightItemTask,enums.wL.Cyan),tasks.addTask("CursorItemTask",["CursorItemOptionTask","null"],CursorItemTask,enums.wL.Cyan),tasks.addTask("SelectedItemsTask",["SelectedItemsOptionTask","ItemsOptionTask"],SelectedItemsTask,enums.wL.Cyan),tasks.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],DummyCombinedNormalVisibilityItemsTask,enums.wL.Cyan),tasks.addTask("FrameSizeTask",["FrameOptionTask","ReadTemplatesTask","ScaleOptionTask"],FrameSizeTask,enums.wL.Navy),tasks.addTask("LevelTitleSizeTask",["LevelTitlePlacementOptionTask","LevelAnnotationOptionTask","OrientationOptionTask","ScaleOptionTask"],LevelTitleSizeTask,enums.wL.Navy),tasks.addTask("CurrentControlSizeTask",["OptionsTask"],DummyCurrentControlSizeTask,enums.wL.Cyan),tasks.addTask("ItemsPositionsTask",["CurrentControlSizeTask","ScaleOptionTask","OrientationOptionTask","ItemsSizesOptionTask","ConnectorsOptionTask","OrderFamilyNodesOptionTask","FamCreateLayoutsTreeTask","CombinedTemplateParamsTask","CursorItemTask","CombinedNormalVisibilityItemsTask"],ItemsPositionsTask,enums.wL.Red),tasks.addTask("AlignDiagramTask",["OrientationOptionTask","ItemsSizesOptionTask","VisualTreeOptionTask","ScaleOptionTask","CurrentControlSizeTask","null","ItemsPositionsTask"],AlignDiagramTask,enums.wL.Red),tasks.addTask("CreateTransformTask",["OrientationOptionTask","ScaleOptionTask","AlignDiagramTask"],CreateTransformTask,enums.wL.Cyan),tasks.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],PaletteManagerTask,enums.wL.Cyan),tasks.addTask("ApplyLayoutChangesTask",["graphics","setLayout","ItemsSizesOptionTask","CurrentControlSizeTask","ScaleOptionTask","AlignDiagramTask","FrameSizeTask","LevelTitleSizeTask"],ApplyLayoutChangesTask,enums.wL.Green),tasks.addTask("ViewPortPlacementTask",["ScaleOptionTask","CenterOnCursorTask","CreateTransformTask","ApplyLayoutChangesTask"],ViewPortPlacementTask,enums.wL.Green),tasks.addTask("VerticalOffsetTask",["ViewPortPlacementTask"],VerticalOffsetTask,enums.wL.Green),tasks.addTask("LogicalLevelsPlacementTask",["OrderFamilyNodesTask","AlignDiagramTask"],FamLogicalLevelsPlacementTask,enums.wL.Green),tasks.addTask("MergeLevelIntervalsTask",["LevelAnnotationOptionTask","LogicalLevelsPlacementTask"],MergeLevelIntervalsTask,enums.wL.Green),tasks.addTask("DrawBackgroundAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","BackgroundAnnotationOptionTask","LogicalFamilyTask","AlignDiagramTask"],DrawBackgroundAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background","DrawBackgroundAnnotationTask"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","BackgroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","background","DrawBackgroundShapeAnnotationTask"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground","DrawBackgroundConnectorAnnotationTask"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask","DrawBackgroundHighlightPathAnnotationTask"],DrawConnectorsTask,enums.wL.Green),tasks.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background","DrawConnectorsTask"],DrawHighlightPathAnnotationTask,enums.wL.Cyan),tasks.addTask("DrawTreeItemsTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","null","ItemsSizesOptionTask","CombinedContextsTask","AlignDiagramTask","null","CombinedTemplateParamsTask","CursorItemTask","SelectedItemsTask","GroupTitleTemplateTask","CheckBoxTemplateTask","ButtonsTemplateTask","DrawForegroundHighlightPathAnnotationTask"],DrawTreeItemsTask,enums.wL.Green),tasks.addTask("DrawCursorTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","CombinedTemplateParamsTask","CursorItemTask","SelectedItemsTask","DrawTreeItemsTask"],DrawCursorTask,enums.wL.Green),tasks.addTask("DrawHighlightTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","CombinedContextsTask","AlignDiagramTask","CombinedTemplateParamsTask","HighlightItemTask","CursorItemTask","SelectedItemsTask","DrawCursorTask"],DrawHighlightTask,enums.wL.Green),tasks.addTask("DrawForegroundShapeAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundShapeAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground","DrawHighlightTask"],DrawShapeAnnotationTask,enums.wL.Green),tasks.addTask("DrawForegroundConnectorAnnotationTask",["graphics","CreateTransformTask","ApplyLayoutChangesTask","OrientationOptionTask","ForegroundConnectorAnnotationOptionTask","AlignDiagramTask","AnnotationLabelTemplateTask","foreground","DrawForegroundShapeAnnotationTask"],DrawConnectorAnnotationTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationBackgroundTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask"],DrawLevelAnnotationBackgroundTask,enums.wL.Green),tasks.addTask("DrawLevelAnnotationTitlesTask",["graphics","VerticalOffsetTask","CreateTransformTask","ApplyLayoutChangesTask","LevelAnnotationOptionTask","MergeLevelIntervalsTask","LevelAnnotationTemplateTask","LevelTitlePlacementOptionTask"],DrawLevelAnnotationTitlesTask,enums.wL.Green),tasks}function FamDiagramPdfkit(options,templates){return BasePdfkitPlugin(options,FamPdfkitTaskManagerFactory,{AnnotationLabelTemplate:AnnotationLabelTemplate_AnnotationLabelTemplate,ButtonsTemplate:DummyTemplate,CheckBoxTemplate:CheckBoxTemplate_CheckBoxTemplate,CursorTemplate:CursorTemplate_CursorTemplate,CustomRenderTemplate:CustomRenderTemplate_CustomRenderTemplate,DotHighlightTemplate:DummyTemplate,GroupTitleTemplate:GroupTitleTemplate_GroupTitleTemplate,HighlightTemplate:HighlightTemplate_HighlightTemplate,ItemTemplate:ItemTemplate_ItemTemplate,UserTemplate:UserTemplate_UserTemplate,LevelTitleTemplate:LevelTitleTemplate_LevelTitleTemplate,LevelBackgroundTemplate:LevelBackgroundTemplate_LevelBackgroundTemplate,LabelAnnotationTemplate:LabelAnnotationTemplate_LabelAnnotationTemplate,...templates})}PaletteItem.prototype.toAttr=function(){var attr={lineWidth:this.lineWidth,lineType:this.lineType};return null!==this.fillColor&&(attr.fillColor=this.fillColor),null!==this.opacity&&(attr.opacity=this.opacity),null!==this.lineColor&&(attr.borderColor=this.lineColor),attr},PaletteItem.prototype.toString=function(){return this._key},MoveSegment.prototype=new Point,MoveSegment.prototype.clone=function(){return new MoveSegment(this)},MoveSegment.prototype.loop=function(thisArg,onItem){null!=onItem&&onItem.call(thisArg,this.x,this.y,0)},MoveSegment.prototype.setPoint=function(point,index){this.x=point.x,this.y=point.y},MoveSegment.prototype.getEndPoint=function(){return this},MoveSegment.prototype.invert=function(endPoint){this.x=endPoint.x,this.y=endPoint.y},MoveSegment.prototype.transform=function(transform,forward){var self=this;transform.transformPoint(self.x,self.y,forward,self,(function(x,y){self.x=x,self.y=y}))},LineSegment.prototype=new MoveSegment,LineSegment.prototype.clone=function(){return new LineSegment(this)},LineSegment.prototype.trim=function(prevEndPoint,offset){var endPoint=this.offsetPoint(this,prevEndPoint,offset);return this.x=endPoint.x,this.y=endPoint.y,this},LineSegment.prototype.offsetPoint=function(first,second,offset){var distance=first.distanceTo(second);return 0===distance||0===offset?new Point(first):new Point(first.x+(second.x-first.x)/distance*offset,first.y+(second.y-first.y)/distance*offset)},QuadraticArcSegment.prototype.clone=function(){return new QuadraticArcSegment(this.cpX,this.cpY,this.x,this.y)},QuadraticArcSegment.prototype.loop=function(thisArg,onItem){null!=onItem&&(onItem.call(thisArg,this.cpX,this.cpY,0),onItem.call(thisArg,this.x,this.y,1))},QuadraticArcSegment.prototype.setPoint=function(point,index){switch(index){case 0:this.cpX=point.x,this.cpY=point.y;break;case 1:this.x=point.x,this.y=point.y}},QuadraticArcSegment.prototype.getEndPoint=function(){return this},QuadraticArcSegment.prototype.invert=function(endPoint){this.x=endPoint.x,this.y=endPoint.y},QuadraticArcSegment.prototype.transform=function(transform,forward){var self=this;transform.transformPoints(self.x,self.y,self.cpX,self.cpY,forward,self,(function(x,y,cpX,cpY){self.x=x,self.y=y,self.cpX=cpX,self.cpY=cpY}))},QuadraticArcSegment.prototype.trim=function(prevEndPoint,offset){var time=.5,endPoint=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,prevEndPoint.x,prevEndPoint.y,time),endPoint2=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,prevEndPoint.x,prevEndPoint.y,.1);return time=offset*(time/endPoint.distanceTo(this.x,this.y)+.1/endPoint2.distanceTo(this.x,this.y))/2,endPoint=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,prevEndPoint.x,prevEndPoint.y,time),this.x=endPoint.x,this.y=endPoint.y,this},QuadraticArcSegment.prototype.offsetPoint=function(firstX,firstY,controlX,controlY,secondX,secondY,time){return new Point((1-time)*(1-time)*firstX+2*(1-time)*time*controlX+time*time*secondX,(1-time)*(1-time)*firstY+2*(1-time)*time*controlY+time*time*secondY)},CubicArcSegment.prototype=new Point,CubicArcSegment.prototype.clone=function(){return new CubicArcSegment(this.cpX1,this.cpY1,this.cpX2,this.cpY2,this.x,this.y)},CubicArcSegment.prototype.loop=function(thisArg,onItem){null!=onItem&&(onItem.call(thisArg,this.cpX1,this.cpY1,0),onItem.call(thisArg,this.cpX2,this.cpY2,1),onItem.call(thisArg,this.x,this.y,2))},CubicArcSegment.prototype.setPoint=function(point,index){switch(index){case 0:this.cpX1=point.x,this.cpY1=point.y;break;case 1:this.cpX2=point.x,this.cpY2=point.y;break;case 2:this.x=point.x,this.y=point.y}},CubicArcSegment.prototype.getEndPoint=function(){return this},CubicArcSegment.prototype.invert=function(endPoint){var tempX=this.cpX1,tempY=this.cpY1;this.x=endPoint.x,this.y=endPoint.y,this.cpX1=this.cpX2,this.cpY1=this.cpY2,this.cpX2=tempX,this.cpY2=tempY},CubicArcSegment.prototype.transform=function(transform,forward){var self=this;transform.transform3Points(self.x,self.y,self.cpX1,self.cpY1,self.cpX2,self.cpY2,forward,self,(function(x,y,cpX1,cpY1,cpX2,cpY2){self.x=x,self.y=y,self.cpX1=cpX1,self.cpY1=cpY1,self.cpX2=cpX2,self.cpY2=cpY2}))},CubicArcSegment.prototype.trim=function(prevEndPoint,offset){var time=.5,endPoint=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,prevEndPoint.x,prevEndPoint.y,time),endPoint2=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,prevEndPoint.x,prevEndPoint.y,.1);return time=offset*(time/endPoint.distanceTo(this.x,this.y)+.1/endPoint2.distanceTo(this.x,this.y))/2,endPoint=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,prevEndPoint.x,prevEndPoint.y,time),this.x=endPoint.x,this.y=endPoint.y,this},CubicArcSegment.prototype.offsetPoint=function(x,y,cpX1,cpY1,cpX2,cpY2,x2,y2,time){return new Point((1-time)*(1-time)*(1-time)*x+3*(1-time)*(1-time)*time*cpX1+3*(1-time)*time*time*cpX2+time*time*time*x2,(1-time)*(1-time)*(1-time)*y+3*(1-time)*(1-time)*time*cpY1+3*(1-time)*time*time*cpY2+time*time*time*y2)},BaseConnectorBundle.prototype.trace=function(data,params,options){},BaseConnectorBundle.prototype.getId=function(data){var result="_"+data.nodeid;return data.nodeid+=1,result},BaseConnectorBundle.prototype.ConnectorEdge=function(from,to,polyline,parentsArrowId,childrenArrowId,dotId,weight,fromOffset,hasMiddle,middleParent,hasArrow){this.polyline=polyline,this.from=from,this.to=to,this.weight=weight||0,this.fromOffset=fromOffset||0,this.hasArrow=hasArrow||!1,this.parentsArrowId=parentsArrowId,this.childrenArrowId=childrenArrowId,this.dotId=dotId,this.hasMiddle=hasMiddle,this.middleParent=middleParent,this.isOppositeFlow=!1},BaseConnectorBundle.prototype.ConnectorDestination=function(options){for(var key in this.id=null,this.x=null,this.y=null,this.bundleid=null,this.hasElbow=!1,this.elbowPoint1=null,this.elbowPoint2=null,this.visibility=null,this.isSquared=!0,options)options.hasOwnProperty(key)&&(this[key]=options[key])},BaseConnectorBundle.prototype.traceFork=function(data,params,options,parentPoint,points,hasSquared,isParents,fromOffset,showHorizontalArrows){var startIndex,endIndex,len,connectorPoint,bundlePoint,connectorDestination,index,polyline,bevelSize,fromPoint,fromPointId,toPoint,toPointId,curvedPoints=[];if(hasSquared){for(curvedPoints=[],startIndex=0,len=points.length;startIndex<len&&((connectorPoint=points[startIndex]).x<parentPoint.x&&!connectorPoint.isSquared);startIndex+=1)curvedPoints.push(connectorPoint);for((len=curvedPoints.length)>0&&(bundlePoint=(connectorDestination=curvedPoints[len-1]).x==parentPoint.x?parentPoint:new this.ConnectorDestination({id:connectorDestination.bundleid,x:connectorDestination.x,y:parentPoint.y}),this.traceAngularSegments(data,params,options,bundlePoint,curvedPoints,!1)),curvedPoints=[],endIndex=points.length-1;endIndex>=startIndex&&((connectorPoint=points[endIndex]).x>parentPoint.x&&!connectorPoint.isSquared);endIndex-=1)curvedPoints.push(connectorPoint);for((len=curvedPoints.length)>0&&(bundlePoint=(connectorDestination=curvedPoints[len-1]).x==parentPoint.x?parentPoint:new this.ConnectorDestination({id:connectorDestination.bundleid,x:connectorDestination.x,y:parentPoint.y}),this.traceAngularSegments(data,params,options,bundlePoint,curvedPoints,!1)),index=startIndex;index<=endIndex;index+=1){switch(connectorPoint=points[index],(bevelSize=options.bevelSize)<2&&(bevelSize=0),options.elbowType){case enums.ex.Bevel:case enums.ex.Round:bevelSize>0&&Math.abs(parentPoint.x-connectorPoint.x)>bevelSize&&Math.abs(parentPoint.y-connectorPoint.y)>bevelSize&&(connectorPoint.hasElbow=!0,connectorPoint.elbowPoint1=new Point(connectorPoint.x,parentPoint.y+(parentPoint.y>connectorPoint.y?-bevelSize:bevelSize)),connectorPoint.elbowPoint2=new Point(connectorPoint.x+(parentPoint.x>connectorPoint.x?bevelSize:-bevelSize),parentPoint.y))}polyline=new Polyline,connectorPoint.hasElbow?(params.transform.transform3Points(connectorPoint.elbowPoint2.x,connectorPoint.elbowPoint2.y,connectorPoint.elbowPoint1.x,connectorPoint.elbowPoint2.y,connectorPoint.elbowPoint1.x,connectorPoint.elbowPoint1.y,!0,this,(function(fromX,fromY,toX,toY,toX2,toY2){switch(options.elbowType){case enums.ex.Bevel:polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX2,toY2));break;case enums.ex.Round:polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new CubicArcSegment(fromX,fromY,toX,toY,toX2,toY2))}})),params.transform.transformPoints(connectorPoint.elbowPoint1.x,connectorPoint.elbowPoint1.y,connectorPoint.x,connectorPoint.y,!0,this,(function(fromX,fromY,toX,toY){polyline.addSegment(new LineSegment(toX,toY))}))):params.transform.transformPoints(connectorPoint.x,parentPoint.y,connectorPoint.x,connectorPoint.y,!0,this,(function(fromX,fromY,toX,toY){polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY))}));var bundleid=connectorPoint.x==parentPoint.x?parentPoint.id:connectorPoint.bundleid,isVisible=connectorPoint.visibility!==enums.EE.Invisible;data.graph.addEdge(bundleid,connectorPoint.id,new this.ConnectorEdge(bundleid,connectorPoint.id,polyline,isParents?connectorPoint.id:null,isParents?null:connectorPoint.id,null,isVisible?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT,fromOffset,null,null,isVisible))}for(startIndex=Math.max(startIndex-1,0),endIndex=Math.min(endIndex+1,points.length-1),fromPoint=parentPoint,fromPointId=parentPoint.id,index=startIndex;index<=endIndex;index+=1)toPointId=(toPoint=points[index]).bundleid,toPoint.x>fromPoint.x&&(polyline=new Polyline,params.transform.transformPoints(fromPoint.x,parentPoint.y,null!=toPoint.elbowPoint2?toPoint.elbowPoint2.x:toPoint.x,parentPoint.y,!0,this,(function(startX,startY,endX,endY){polyline.addSegment(new MoveSegment(startX,startY)),polyline.addSegment(new LineSegment(endX,endY))})),data.graph.addEdge(fromPointId,toPointId,new this.ConnectorEdge(fromPointId,toPointId,polyline,null,null,fromPointId,Math.abs(toPoint.x-fromPoint.x)/1e4,fromOffset,showHorizontalArrows,isParents?toPointId:fromPointId)),fromPoint=toPoint.elbowPoint2||toPoint,fromPointId=toPointId);for(fromPoint=parentPoint,fromPointId=parentPoint.id,index=endIndex;index>=startIndex;index-=1)toPointId=(toPoint=points[index]).bundleid,toPoint.x<fromPoint.x&&(polyline=new Polyline,params.transform.transformPoints(fromPoint.x,parentPoint.y,null!=toPoint.elbowPoint2?toPoint.elbowPoint2.x:toPoint.x,parentPoint.y,!0,this,(function(startX,startY,endX,endY){polyline.addSegment(new MoveSegment(startX,startY)),polyline.addSegment(new LineSegment(endX,endY))})),data.graph.addEdge(fromPointId,toPointId,new this.ConnectorEdge(fromPointId,toPointId,polyline,null,null,fromPointId,Math.abs(toPoint.x-fromPoint.x)/1e4,fromOffset,showHorizontalArrows,isParents?toPointId:fromPointId)),fromPoint=toPoint.elbowPoint2||toPoint,fromPointId=toPointId)}else this.traceAngularSegments(data,params,options,parentPoint,points,!0)},BaseConnectorBundle.prototype.traceAngularSegments=function(data,params,options,bundlePoint,points,drawToBundle){var index,len,rect,point,polyline;for(index=0,len=points.length;index<len;index+=1){switch(point=points[index],polyline=new Polyline,params.transform.transformPoint(bundlePoint.x,bundlePoint.y,!0,this,(function(x,y){polyline.addSegment(new MoveSegment(x,y))})),options.connectorType){case enums.r7.Angular:params.transform.transformPoint(point.x,point.y,!0,this,(function(x,y){polyline.addSegment(new LineSegment(x,y))}));break;case enums.r7.Curved:rect=new Rect(bundlePoint,point),drawToBundle?bundlePoint.x>rect.x?params.transform.transform3Points(rect.right(),rect.verticalCenter(),rect.x,rect.verticalCenter(),rect.x,rect.bottom(),!0,this,(function(cpX1,cpY1,cpX2,cpY2,x,y){polyline.addSegment(new CubicArcSegment(cpX1,cpY1,cpX2,cpY2,x,y))})):params.transform.transform3Points(rect.x,rect.verticalCenter(),rect.right(),rect.verticalCenter(),rect.right(),rect.bottom(),!0,this,(function(cpX1,cpY1,cpX2,cpY2,x,y){polyline.addSegment(new CubicArcSegment(cpX1,cpY1,cpX2,cpY2,x,y))})):bundlePoint.x>rect.x?params.transform.transformPoints(rect.x,rect.y,rect.x,rect.bottom(),!0,this,(function(cpX,cpY,x,y){polyline.addSegment(new QuadraticArcSegment(cpX,cpY,x,y))})):params.transform.transformPoints(rect.right(),rect.y,rect.right(),rect.bottom(),!0,this,(function(cpX,cpY,x,y){polyline.addSegment(new QuadraticArcSegment(cpX,cpY,x,y))}))}var isVisible=point.visibility!==enums.EE.Invisible;data.graph.addEdge(bundlePoint.id,point.id,new this.ConnectorEdge(bundlePoint.id,point.id,polyline,null,isVisible?point.id:null,isVisible?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT,null,null,null,!0))}},VerticalConnectorBundle.prototype=new BaseConnectorBundle,VerticalConnectorBundle.prototype.trace=function(data,params,options){var parents,children,items,treeItemId,treeItemPosition,index,len,isSquared,hasSquared,parentHorizontalCenter,parentsConnectorOffset,childrenConnectorOffset,connectorPoint,chartHasSquaredConnectors=options.connectorType===enums.r7.Squared;if(parents=[],this.fromItems.length>0){for(index=0,len=(items=this.fromItems).length;index<len;index+=1)treeItemId=items[index],treeItemPosition=params.treeItemsPositions[treeItemId],connectorPoint=new this.ConnectorDestination({id:params.nestedLayoutBottomConnectorIds.hasOwnProperty(treeItemId)?params.nestedLayoutBottomConnectorIds[treeItemId]:treeItemId,bundleid:this.getId(data),x:treeItemPosition.actualPosition.horizontalCenter(),y:treeItemPosition.actualPosition.bottom(),isSquared:!0,visibility:treeItemPosition.actualVisibility}),parents.push(connectorPoint);parents.sort((function(a,b){return a.x-b.x})),parentsConnectorOffset=treeItemPosition.bottomConnectorShift-treeItemPosition.bottomConnectorInterval*(this.fromStackSize-this.fromOffset+1)}if(children=[],this.toItems.length>0){for(hasSquared=!1,items=this.toItems,index=0;index<items.length;index+=1){switch(treeItemId=items[index],isSquared=!0,(treeItemPosition=params.treeItemsPositions[treeItemId]).actualVisibility){case enums.EE.Dot:case enums.EE.Line:isSquared=chartHasSquaredConnectors}0,connectorPoint=new this.ConnectorDestination({id:treeItemId,bundleid:this.getId(data),x:treeItemPosition.actualPosition.horizontalCenter()+0,y:treeItemPosition.actualPosition.top(),isSquared:isSquared,visibility:treeItemPosition.actualVisibility}),children.push(connectorPoint),hasSquared=hasSquared||connectorPoint.isSquared}children.sort((function(a,b){return a.x-b.x})),childrenConnectorOffset=treeItemPosition.topConnectorShift}parentHorizontalCenter=1==children.length?children[0].x:1==parents.length?parents[0].x:children.length>0&&parents.length>0?(parents[0].x+parents[parents.length-1].x+children[0].x+children[children.length-1].x)/4:children.length>0?(children[0].x+children[children.length-1].x)/2:(parents[0].x+parents[parents.length-1].x)/2;var topCenterPoint=null;parents.length>0&&(topCenterPoint=new this.ConnectorDestination({id:0==children.length&&this.dotId?this.dotId:this.getId(data),x:parentHorizontalCenter,y:parentsConnectorOffset}),this.traceFork(data,params,options,topCenterPoint,parents,!0,!0,this.fromOffset,options.showExtraArrows));var bottomCenterPoint=null;children.length>0&&(bottomCenterPoint=new this.ConnectorDestination({id:0==parents.length&&this.dotId?this.dotId:this.getId(data),x:parentHorizontalCenter,y:childrenConnectorOffset}),null!=topCenterPoint&&bottomCenterPoint.y==topCenterPoint.y&&(bottomCenterPoint=topCenterPoint),this.traceFork(data,params,options,bottomCenterPoint,children,hasSquared,!1,0,options.showExtraArrows)),null!=topCenterPoint&&null!=bottomCenterPoint&&topCenterPoint.id!=bottomCenterPoint.id&&params.transform.transformPoints(topCenterPoint.x,topCenterPoint.y,bottomCenterPoint.x,bottomCenterPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),data.graph.addEdge(topCenterPoint.id,bottomCenterPoint.id,new this.ConnectorEdge(topCenterPoint.id,bottomCenterPoint.id,polyline,null,null,null,0))}))},HorizontalConnectorBundle.prototype=new BaseConnectorBundle,HorizontalConnectorBundle.prototype.trace=function(data,params,options){var fromItemId=this.fromItem,toItemId=this.toItem,fromItemPosition=params.treeItemsPositions[fromItemId],toItemPosition=params.treeItemsPositions[toItemId],polyline=new Polyline;fromItemPosition.actualPosition.x<toItemPosition.actualPosition.x?params.transform.transformPoints(fromItemPosition.actualPosition.right(),fromItemPosition.horizontalConnectorsShift,toItemPosition.actualPosition.x,toItemPosition.horizontalConnectorsShift,!0,this,(function(fromX,fromY,toX,toY){polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY))})):params.transform.transformPoints(fromItemPosition.actualPosition.x,fromItemPosition.horizontalConnectorsShift,toItemPosition.actualPosition.right(),fromItemPosition.horizontalConnectorsShift,!0,this,(function(fromX,fromY,toX,toY){polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY))}));var toItemIsVisible=toItemPosition.actualVisibility!==enums.EE.Invisible,fromItemIsVisible=fromItemPosition.actualVisibility!==enums.EE.Invisible;data.graph.addEdge(fromItemId,toItemId,new this.ConnectorEdge(fromItemId,toItemId,polyline,toItemIsVisible?toItemId:null,fromItemIsVisible?fromItemId:null,null,toItemIsVisible||fromItemIsVisible?this.NORMAL_ITEM_WEIGHT:this.LINE_ITEM_WEIGHT,null,null,null,!0))},TreeLevelPosition.prototype.setShift=function(shift,levelSpace,topConnectorSpace,connectorSpace,partnerConnectorOffset){return this.shift=shift,this.levelSpace=levelSpace,this.topConnectorShift=-levelSpace/2-topConnectorSpace,this.connectorShift=this.depth+connectorSpace+(partnerConnectorOffset+1)*(levelSpace/2),this.nextLevelShift=topConnectorSpace+this.depth+connectorSpace+levelSpace+partnerConnectorOffset*levelSpace/2,this.nextLevelShift},TreeLevelPosition.prototype.getNodesBottom=function(){return this.shift+this.depth},TreeLevelPosition.prototype.toString=function(){return this.currentvisibility},OrgLayout.prototype.loop=function(thisArg,onItem){if(null!=onItem){var zeroBasedLevelIndex=0;this.treeLevels.loopLevels(this,(function(levelIndex){this.treeLevels.loopLevelItems(this,levelIndex,(function(treeItemId,treeItem){onItem.call(thisArg,treeItem,zeroBasedLevelIndex)})),zeroBasedLevelIndex+=1}))}},OrgLayout.prototype.measure=function(levelVisibility,isCursor,isSelected,treeItemTemplate,treeItemsPositions,options){this.treeLevelsPositions=[],this.treeLevels.loopLevels(this,(function(index,levelContext){var treeLevelPosition=new TreeLevelPosition;this.treeLevelsPositions.push(treeLevelPosition)})),this.setOffsets(this.treeLevels,treeItemsPositions,this.childLayoutsPositions,this.treeLevelsPositions,this.visualTree,this.rightMargins,this.leftMargins,options.intervals,options.arrowsDirection,options.linesWidth,options.cousinsIntervalMultiplier,options.horizontalAlignment,options.padding),this.setLevelsDepth(this.treeLevels,treeItemsPositions,this.treeLevelsPositions,options.verticalAlignment),this.shiftLevels(this.treeLevelsPositions,options.padding.top,options.shifts,options.arrowsDirection,options.linesWidth,this.getConnectorsStacksSizes);var treeItemPosition=new TreeItemPosition;return treeItemPosition.actualVisibility=enums.EE.Normal,treeItemPosition.actualSize=this.getLayoutSize(this.treeLevels,treeItemsPositions,this.childLayoutsPositions,this.treeLevelsPositions,options.padding),treeItemPosition},OrgLayout.prototype.getLayoutSize=function(treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions,padding){return new Rect(0,0,Math.round(this.getLayoutWidth(treeLevels,treeItemsPositions,childLayoutsPositions,padding)),Math.round(this.getLayoutHeight(treeLevelsPositions,padding)))},OrgLayout.prototype.getLayoutWidth=function(treeLevels,treeItemsPositions,childLayoutsPositions,padding){var result=0;return treeLevels.loopLevels(this,(function(levelIndex,level){var levelLength=treeLevels.getLevelLength(levelIndex);if(levelLength>0){var itemId=treeLevels.getItemAtPosition(levelIndex,levelLength-1),treeItemPosition=treeItemsPositions[itemId],childLayoutPosition=childLayoutsPositions[itemId];result=Math.max(result,childLayoutPosition.offset+treeItemPosition.actualSize.width+padding.right)}})),result},OrgLayout.prototype.getLayoutHeight=function(treeLevelsPositions,padding){return treeLevelsPositions[treeLevelsPositions.length-1].getNodesBottom()+padding.bottom},OrgLayout.prototype.setLevelsDepth=function(treeLevels,treeItemsPositions,treeLevelsPositions,verticalAlignment){var minimalDepth,dotsDepth;treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var treeLevelPosition=treeLevelsPositions[levelIndex];switch(treeLevelPosition.shift=0,treeLevelPosition.depth=0,treeLevelPosition.actualVisibility=enums.EE.Invisible,minimalDepth=null,dotsDepth=null,treeLevels.loopLevelItems(this,levelIndex,(function(itemId,treeItem,position){var treeItemPosition=treeItemsPositions[itemId];switch(treeLevelPosition.depth=Math.max(treeLevelPosition.depth,treeItemPosition.actualSize.height),treeItemPosition.actualVisibility){case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:dotsDepth=dotsDepth?Math.min(dotsDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height;break;default:minimalDepth=minimalDepth?Math.min(minimalDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height}treeLevelPosition.actualVisibility=Math.min(treeLevelPosition.actualVisibility,treeItemPosition.actualVisibility)})),null==minimalDepth&&(minimalDepth=treeLevelPosition.depth),null!=dotsDepth&&dotsDepth>minimalDepth&&(minimalDepth=dotsDepth),verticalAlignment){case enums.Vn.Top:treeLevelPosition.horizontalConnectorsDepth=minimalDepth/2;break;case enums.Vn.Middle:treeLevelPosition.horizontalConnectorsDepth=treeLevelPosition.depth/2;break;case enums.Vn.Bottom:treeLevelPosition.horizontalConnectorsDepth=treeLevelPosition.depth-minimalDepth/2}}))},OrgLayout.prototype.shiftLevels=function(treeLevelsPositions,shift,shifts,arrowsDirection,linesWidth,getConnectorsStacksSizes){var index,len,treeLevelPosition,childrenSpace=0,parentsSpace=0,arrowTipLength=8*linesWidth;switch(arrowsDirection){case enums.zX.Parents:childrenSpace=arrowTipLength,parentsSpace=0;break;case enums.zX.Children:childrenSpace=0,parentsSpace=arrowTipLength}var isTopLevel=!0;for(index=0,len=treeLevelsPositions.length;index<len;index+=1)if(treeLevelPosition=treeLevelsPositions[index],isTopLevel&&treeLevelPosition.actualVisibility==enums.EE.Invisible)treeLevelPosition.setShift(0,0,0,0,0);else{var parentsStackSize=getConnectorsStacksSizes(index).parentsStackSize;shift+=treeLevelPosition.setShift(shift,shifts[treeLevelPosition.actualVisibility],parentsSpace,childrenSpace,parentsStackSize),isTopLevel=!1}},OrgLayout.prototype.setOffsets=function(treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions,visualTree,rightMargins,leftMargins,intervals,arrowsDirection,linesWidth,cousinsIntervalMultiplier,horizontalAlignment,padding){var index,len;for(index=0,len=treeLevelsPositions.length;index<len;index+=1)treeLevelsPositions[index].currentOffset=0;visualTree.loopPostOrder(this,(function(treeItemId,treeItem,parentId,parent){var index,len,offset,siblings,gaps,gap,leftMargin,parentItem,groups,items,item1,item2,groupIndex,groupOffset,group,sibling,treeItemPosition=treeItemsPositions[treeItemId],treeItemVisibility=treeItemPosition.actualVisibility,treeItemLevelIndex=treeLevels.getLevelIndex(treeItemId),treeLevelPosition=treeLevelsPositions[treeItemLevelIndex],treeItemPadding=intervals[treeItemVisibility===enums.EE.Auto?treeLevelPosition.currentvisibility:treeItemVisibility]/2,leftPadding=treeLevelPosition.currentOffset>0?treeItemPadding+treeItemPadding*treeItem.relationDegree*cousinsIntervalMultiplier:padding.left,arrowTipLength=8*linesWidth;childLayoutsPositions[treeItemId]=new ChildLayoutPosition(0,leftPadding,treeItemPadding);var childLayoutPosition=childLayoutsPositions[treeItemId];if(arrowsDirection!=enums.zX.None&&(treeItem.connectorPlacement&enums.En.Left&&(childLayoutPosition.leftPadding+=arrowTipLength),treeItem.connectorPlacement&enums.En.Right&&(childLayoutPosition.rightPadding+=arrowTipLength)),childLayoutPosition.offset=treeLevelPosition.currentOffset+childLayoutPosition.leftPadding,treeLevelPosition.currentOffset=childLayoutPosition.offset+treeItemPosition.actualSize.width+childLayoutPosition.rightPadding,visualTree.hasChildren(treeItemId))if((offset=this.getChildrenOffset(treeItem,treeItemsPositions,childLayoutsPositions,visualTree,horizontalAlignment))>0)this.offsetItemChildren(treeItem,offset,treeLevels,visualTree,treeItemsPositions,childLayoutsPositions,treeLevelsPositions);else if(offset<0&&(offset=-offset,this.offsetItem(treeItem,offset,treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions),siblings=null,gaps={},leftMargin=null,null!==(parentItem=visualTree.parent(treeItem.id))&&(visualTree.loopChildrenReversed(this,parentItem.id,(function(childItemId,childItem,index){if(childItem===treeItem)siblings=[];else if(null!==siblings){if(gap=this.getGapBetweenSiblings(childItem,treeItem,rightMargins,leftMargins,treeItemsPositions,childLayoutsPositions),gaps[childItem.id]=gap,!(gap>0))return leftMargin=childItem,!0;siblings.splice(0,0,childItem)}})),siblings.length>0))){if(groups=null,null!==leftMargin)for((items=(items=[leftMargin]).concat(siblings)).push(treeItem),groups=[[leftMargin]],index=1,len=items.length;index<len;index+=1)item1=items[index-1],item2=items[index],item1.gravity==enums.a3.Right||item2.gravity==enums.a3.Left?groups[groups.length-1].push(item2):groups.push([item2]);else(groups=[siblings.slice(0)])[groups.length-1].push(treeItem);if(groups.length>0)for(index=(siblings=groups[groups.length-1]).length-2;index>=0;index-=1)sibling=siblings[index],gap=gaps[sibling.id],offset=Math.min(gap,offset),this.offsetItem(sibling,offset,treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions),this.offsetItemChildren(sibling,offset,treeLevels,visualTree,treeItemsPositions,childLayoutsPositions,treeLevelsPositions);for(groupOffset=offset/(groups.length-1),groupIndex=groups.length-2;groupIndex>0;groupIndex-=1)for(index=(group=groups[groupIndex]).length-1;index>=0;index-=1)sibling=group[index],gap=gaps[sibling.id],offset=Math.min(groupIndex*groupOffset,Math.min(gap,offset)),this.offsetItem(sibling,offset,treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions),this.offsetItemChildren(sibling,offset,treeLevels,visualTree,treeItemsPositions,childLayoutsPositions,treeLevelsPositions)}}))},OrgLayout.prototype.getGapBetweenSiblings=function(leftItem,rightItem,rightMargins,leftMargins,treeItemsPositions,childLayoutsPositions){for(var result=null,itemRightMargins=this.getRightMargins(leftItem,rightMargins,treeItemsPositions,childLayoutsPositions),itemLeftMargins=this.getLeftMargins(rightItem,leftMargins,childLayoutsPositions),depth=Math.min(itemRightMargins.length,itemLeftMargins.length),index=0;index<depth;index+=1){var gap=itemLeftMargins[index]-itemRightMargins[index];if(result=null!==result?Math.min(result,gap):gap,gap<=0)break}return Math.floor(result)},OrgLayout.prototype.getRightMargins=function(treeItem,rightMargins,treeItemsPositions,childLayoutsPositions){var result=[],itemRightMargins=rightMargins[treeItem.id];void 0===itemRightMargins&&(itemRightMargins=[]),(itemRightMargins=itemRightMargins.slice()).splice(0,0,treeItem.id);for(var index=0,len=itemRightMargins.length;index<len;index+=1){var treeItemId=itemRightMargins[index],treeItemPosition=treeItemsPositions[treeItemId],childLayoutPosition=childLayoutsPositions[treeItemId];result[index]=childLayoutPosition.offset+treeItemPosition.actualSize.width+childLayoutPosition.rightPadding}return result},OrgLayout.prototype.getLeftMargins=function(treeItem,leftMargins,childLayoutsPositions){var result=[],itemLeftMargins=leftMargins[treeItem.id];void 0===itemLeftMargins&&(itemLeftMargins=[]),(itemLeftMargins=itemLeftMargins.slice()).splice(0,0,treeItem.id);for(var index=0,len=itemLeftMargins.length;index<len;index+=1){var childLayoutPosition=childLayoutsPositions[itemLeftMargins[index]];result[index]=childLayoutPosition.offset-childLayoutPosition.leftPadding}return result},OrgLayout.prototype.getChildrenOffset=function(treeItem,treeItemsPositions,childLayoutsPositions,visualTree,horizontalAlignment){var treeItemPosition=treeItemsPositions[treeItem.id],treeItemCenterOffset=childLayoutsPositions[treeItem.id].offset+treeItemPosition.actualSize.width/2,childrenCenterOffset=null;if(null===treeItem.visualAggregatorId){var firstItem=null;visualTree.loopChildren(this,treeItem.id,(function(childItemId,childItem,index){if((firstItem=childItem).connectorPlacement&enums.En.Top)return!0}));var firstItemPosition=treeItemsPositions[firstItem.id],firstLayoutPosition=childLayoutsPositions[firstItem.id],lastItem=null;visualTree.loopChildrenReversed(this,treeItem.id,(function(childItemId,childItem,index){if((lastItem=childItem).connectorPlacement&enums.En.Top)return!0}));var lastItemPosition=treeItemsPositions[lastItem.id],lastLayoutPosition=childLayoutsPositions[lastItem.id];switch(horizontalAlignment){case enums.a3.Left:childrenCenterOffset=firstLayoutPosition.offset+firstItemPosition.actualSize.width/2;break;case enums.a3.Right:childrenCenterOffset=lastLayoutPosition.offset+lastItemPosition.actualSize.width/2;break;case enums.a3.Center:childrenCenterOffset=(firstLayoutPosition.offset+lastLayoutPosition.offset+lastItemPosition.actualSize.width)/2}}else{var visualAggregatorPosition=treeItemsPositions[treeItem.visualAggregatorId];childrenCenterOffset=childLayoutsPositions[treeItem.visualAggregatorId].offset+visualAggregatorPosition.actualSize.width/2}return treeItemCenterOffset-childrenCenterOffset},OrgLayout.prototype.offsetItem=function(treeItem,offset,treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions){var treeItemPosition=treeItemsPositions[treeItem.id],childLayoutPosition=childLayoutsPositions[treeItem.id];childLayoutPosition.offset+=offset;var treeLevelPosition=treeLevelsPositions[treeLevels.getLevelIndex(treeItem.id)];treeLevelPosition.currentOffset=Math.max(treeLevelPosition.currentOffset,childLayoutPosition.offset+treeItemPosition.actualSize.width+childLayoutPosition.rightPadding)},OrgLayout.prototype.offsetItemChildren=function(treeItem,offset,treeLevels,visualTree,treeItemsPositions,childLayoutsPositions,treeLevelsPositions){visualTree.loopLevels(this,treeItem.id,(function(childItemId,childItem,levelid){var treeItemPosition=treeItemsPositions[childItemId],childLayoutPosition=childLayoutsPositions[childItemId];childLayoutPosition.offset+=offset;var treeLevelPosition=treeLevelsPositions[treeLevels.getLevelIndex(childItemId)];return treeLevelPosition.currentOffset=Math.max(treeLevelPosition.currentOffset,childLayoutPosition.offset+treeItemPosition.actualSize.width),!0}))},OrgLayout.prototype.arrange=function(thisArg,position,layoutDirection,treeItemsPositions,options,onItemPositioned){var prevLevelPosition=null;null!=onItemPositioned&&this.treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var treeLevelPosition=this.treeLevelsPositions[levelIndex];this.treeLevels.loopLevelItems(this,levelIndex,(function(itemId,treeItem,position){var treeItemPosition=treeItemsPositions[itemId],childLayoutPosition=this.childLayoutsPositions[itemId],result=this.getItemPosition(treeItemPosition.actualVisibility,childLayoutPosition.offset,treeItemPosition.actualSize,prevLevelPosition,treeLevelPosition,options.verticalAlignment);onItemPositioned.call(thisArg,itemId,{...treeItemPosition,...result})})),prevLevelPosition=treeLevelPosition}))},OrgLayout.prototype.getItemPosition=function(visibility,offset,size,prevLevel,level,verticalAlignment){var itemShift=0;switch(visibility){case enums.EE.Normal:switch(verticalAlignment){case enums.Vn.Top:itemShift=0;break;case enums.Vn.Middle:itemShift=(level.depth-size.height)/2;break;case enums.Vn.Bottom:itemShift=level.depth-size.height}break;case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:itemShift=level.horizontalConnectorsDepth-size.height/2}return{actualPosition:new Rect(offset,level.shift+itemShift,size.width,size.height),horizontalConnectorsShift:level.shift+level.horizontalConnectorsDepth,topConnectorShift:null!=prevLevel?prevLevel.shift+prevLevel.connectorShift:null,topConnectorInterval:null!=prevLevel?prevLevel.levelSpace/2:null,bottomConnectorShift:level.shift+level.connectorShift,bottomConnectorInterval:level.levelSpace/2}},ItemLayout.prototype.measure=function(levelVisibility,isCursor,isSelected,treeItemTemplate,treeItemsPositions,options){var templateConfig,size,contentPosition,{orientationType:orientationType,checkBoxPanelSize:checkBoxPanelSize,buttonsPanelSize:buttonsPanelSize,groupTitlePanelSize:groupTitlePanelSize,groupTitlePlacementType:groupTitlePlacementType}=options,treeItemVisibility=isSelected||isCursor?enums.EE.Normal:this.visibility,actualVisibility=treeItemVisibility===enums.EE.Auto?levelVisibility:treeItemVisibility;switch(actualVisibility){case enums.EE.Normal:if(contentPosition=new Rect(0,0,(size=new Size((templateConfig=treeItemTemplate.template.templateConfig).itemSize)).width,size.height),isCursor&&(size.height+=templateConfig.cursorPadding.top+templateConfig.cursorPadding.bottom,size.width+=templateConfig.cursorPadding.left+templateConfig.cursorPadding.right,contentPosition.x=templateConfig.cursorPadding.left,contentPosition.y=templateConfig.cursorPadding.top),treeItemTemplate.hasSelectorCheckbox&&(size.height+=checkBoxPanelSize),treeItemTemplate.hasButtons&&(size.width+=buttonsPanelSize,groupTitlePlacementType===enums.hZ.Right))contentPosition.x+=buttonsPanelSize;if(treeItemTemplate.hasGroupTitle)if(size.width+=groupTitlePanelSize,groupTitlePlacementType===enums.hZ.Right);else contentPosition.x+=groupTitlePanelSize;break;case enums.EE.Dot:size=new Size((templateConfig=treeItemTemplate.template.templateConfig).minimizedItemSize);break;case enums.EE.Line:case enums.EE.Invisible:size=new Size}switch(orientationType){case enums.F7.Left:case enums.F7.Right:size.invert()}var treeItemPosition=new TreeItemPosition;return treeItemPosition.actualVisibility=actualVisibility,treeItemPosition.actualSize=size,treeItemPosition.contentPosition=contentPosition,treeItemPosition},ItemLayout.prototype.arrange=function(thisArg,position,layoutDirection,treeItemsPositions,options,onItemPositioned){},Transform.prototype.setOrientation=function(orientationType){switch(orientationType){case enums.F7.Top:this.invertArea=!1,this.invertHorizontally=!1,this.invertVertically=!1;break;case enums.F7.Bottom:this.invertArea=!1,this.invertHorizontally=!1,this.invertVertically=!0;break;case enums.F7.Left:this.invertArea=!0,this.invertHorizontally=!1,this.invertVertically=!1;break;case enums.F7.Right:this.invertArea=!0,this.invertHorizontally=!0,this.invertVertically=!1}},Transform.prototype.getOrientation=function(orientationType){var result=orientationType;if(this.invertHorizontally)switch(orientationType){case enums.F7.Left:result=enums.F7.Right;break;case enums.F7.Right:result=enums.F7.Left}if(this.invertVertically)switch(orientationType){case enums.F7.Top:result=enums.F7.Bottom;break;case enums.F7.Bottom:result=enums.F7.Top}if(this.invertArea)switch(result){case enums.F7.Top:result=enums.F7.Left;break;case enums.F7.Bottom:result=enums.F7.Right;break;case enums.F7.Left:result=enums.F7.Top;break;case enums.F7.Right:result=enums.F7.Bottom}return result},Transform.prototype.transformPoint=function(x,y,forward,self,func){var value;forward&&this.invertArea&&(value=x,x=y,y=value),this.invertHorizontally&&(x=this.size.width-x),this.invertVertically&&(y=this.size.height-y),forward||this.invertArea&&(value=x,x=y,y=value),func.call(self,x,y)},Transform.prototype.transformPoints=function(x,y,x2,y2,forward,self,func){var value;forward&&this.invertArea&&(value=x,x=y,y=value,value=x2,x2=y2,y2=value),this.invertHorizontally&&(x=this.size.width-x,x2=this.size.width-x2),this.invertVertically&&(y=this.size.height-y,y2=this.size.height-y2),forward||this.invertArea&&(value=x,x=y,y=value,value=x2,x2=y2,y2=value),func.call(self,x,y,x2,y2)},Transform.prototype.transform3Points=function(x,y,x2,y2,x3,y3,forward,self,func){var value;forward&&this.invertArea&&(value=x,x=y,y=value,value=x2,x2=y2,y2=value,value=x3,x3=y3,y3=value),this.invertHorizontally&&(x=this.size.width-x,x2=this.size.width-x2,x3=this.size.width-x3),this.invertVertically&&(y=this.size.height-y,y2=this.size.height-y2,y3=this.size.height-y3),forward||this.invertArea&&(value=x,x=y,y=value,value=x2,x2=y2,y2=value,value=x3,x3=y3,y3=value),func.call(self,x,y,x2,y2,x3,y3)},Transform.prototype.transformRect=function(x,y,width,height,forward,self,func){var value;forward&&this.invertArea&&(value=x,x=y,y=value,value=width,width=height,height=value),this.invertHorizontally&&(x=this.size.width-x-width),this.invertVertically&&(y=this.size.height-y-height),forward||this.invertArea&&(value=x,x=y,y=value,value=width,width=height,height=value),func.call(self,x,y,width,height)},Transform.prototype.transformThickness=function(thickness,forward){var value,{left:left,right:right,top:top,bottom:bottom}=thickness;return forward&&this.invertArea&&(value=left,left=top,top=value,value=right,right=bottom,bottom=value),this.invertHorizontally&&(value=left,left=right,right=value),this.invertVertically&&(value=top,top=bottom,bottom=value),forward||this.invertArea&&(value=left,left=top,top=value,value=right,right=bottom,bottom=value),new Thickness(left,top,right,bottom)},PaletteManager.prototype.selectPalette=function(index){this.cursor=index%this.paletteLength},PaletteManager.prototype.getPalette=function(connectorStyleType){var index=null;switch(connectorStyleType){case enums.ML.Regular:index=this.regularIndex;break;case enums.ML.Highlight:index=this.highlightIndex;break;case enums.ML.Extra:index=this.cursor}return this.palette[index]},BaseShape.prototype._getLabelPosition=function(x,y,width,height,labelWidth,labelHeight,labelOffset,labelPlacement){var result=null;switch(labelPlacement){case enums.TK.Top:result=new Rect(x+width/2-labelWidth/2,y-labelOffset-labelHeight,labelWidth,labelHeight);break;case enums.TK.TopRight:result=new Rect(x+width-labelWidth,y-labelOffset-labelHeight,labelWidth,labelHeight);break;case enums.TK.TopLeft:result=new Rect(x,y-labelOffset-labelHeight,labelWidth,labelHeight);break;case enums.TK.Right:result=new Rect(x+width+labelOffset,y+height/2-labelHeight/2,labelWidth,labelHeight);break;case enums.TK.RightTop:result=new Rect(x+width+labelOffset,y,labelWidth,labelHeight);break;case enums.TK.RightBottom:result=new Rect(x+width+labelOffset,y+height-labelHeight,labelWidth,labelHeight);break;case enums.TK.BottomRight:result=new Rect(x+width-labelWidth,y+height+labelOffset,labelWidth,labelHeight);break;case enums.TK.BottomLeft:result=new Rect(x,y+height+labelOffset,labelWidth,labelHeight);break;case enums.TK.Left:result=new Rect(x-labelWidth-labelOffset,y+height/2-labelHeight/2,labelWidth,labelHeight);break;case enums.TK.LeftTop:result=new Rect(x-labelWidth-labelOffset,y,labelWidth,labelHeight);break;case enums.TK.LeftBottom:result=new Rect(x-labelWidth-labelOffset,y+height-labelHeight,labelWidth,labelHeight);break;case enums.TK.Auto:case enums.TK.Bottom:default:result=new Rect(x+width/2-labelWidth/2,y+height+labelOffset,labelWidth,labelHeight)}return result},BaseShape.prototype._betweenPoint=function(first,second){return new Point((first.x+second.x)/2,(first.y+second.y)/2)},BaseShape.prototype._offsetPoint=function(first,second,offset){var distance=first.distanceTo(second);return 0===distance||0===offset?new Point(first):new Point(first.x+(second.x-first.x)/distance*offset,first.y+(second.y-first.y)/distance*offset)},MergedRectangles.prototype=new BaseShape,MergedRectangles.prototype.draw=function(rects){var polyline=new Polyline(new PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,fillColor:this.fillColor,lineType:this.lineType,opacity:this.opacity}));getMergedRectangles(this,rects,(function(points){for(var index=0,len=points.length;index<len;index+=1){var point=points[index];0==index?polyline.addSegment(new MoveSegment(point.x,point.y)):polyline.addSegment(new LineSegment(point.x,point.y))}})),polyline.transform(this.transform,!0),this.graphics.polyline(polyline)},ConnectorStraight.prototype=new BaseShape,ConnectorStraight.prototype.draw=function(buffer,linePaletteItem,fromRect,toRect,linesOffset,bundleOffset,labelSize,panelSize,connectorShapeType,labelOffset,labelPlacementType,hasLabel,connectorAnnotationOffsetResolver,onLabelPlacement,labelConfig){var fromPoint,toPoint,betweenPoint,vector,newVector,offset=linesOffset/2,labelPlacement=null,fromLabelPlacement=enums.TK.Auto,toLabelPlacement=enums.TK.Auto,self=this;if(vector=new Vector(fromRect.centerPoint(),toRect.centerPoint()),fromRect.loopEdges((function(sideVector,placementType){return fromPoint=sideVector.getIntersectionPoint(vector,!0,1),fromLabelPlacement=placementType,null!=fromPoint})),toRect.loopEdges((function(sideVector,placementType){return toPoint=sideVector.getIntersectionPoint(vector,!0,1),toLabelPlacement=placementType,null!=toPoint})),null!=fromPoint&&null!=toPoint){var baseVector=new Vector(fromPoint,toPoint);connectorAnnotationOffsetResolver.getOffset(baseVector,(function(offsetIndex,bundleSize,direction){var tempOffset=(offsetIndex*bundleOffset-(bundleSize-1)*bundleOffset/2)*direction;switch(baseVector.offset(tempOffset),fromPoint=baseVector.from,toPoint=baseVector.to,connectorShapeType){case enums.GV.TwoWay:(newVector=new Vector(toPoint.clone(),fromPoint.clone())).offset(offset),self._drawLine(buffer,linePaletteItem,newVector.from,newVector.to,!1),(newVector=new Vector(fromPoint.clone(),toPoint.clone())).offset(offset),self._drawLine(buffer,linePaletteItem,newVector.from,newVector.to,!1);break;case enums.GV.OneWay:self._drawLine(buffer,linePaletteItem,fromPoint,toPoint,!1);break;case enums.GV.BothWay:self._drawLine(buffer,linePaletteItem,fromPoint,toPoint,!0)}if(hasLabel){switch(labelPlacementType){case enums.xj.From:labelPlacement=self._getLabelPositionBySnapPoint(fromPoint.x,fromPoint.y,labelSize.width,labelSize.height,labelOffset,fromLabelPlacement);break;case enums.xj.Between:betweenPoint=self._betweenPoint(fromPoint,toPoint),labelPlacement=self._getLabelPositionBySnapPoint(betweenPoint.x,betweenPoint.y,labelSize.width,labelSize.height,labelOffset,enums.TK.Right);break;case enums.xj.To:labelPlacement=self._getLabelPositionBySnapPoint(toPoint.x,toPoint.y,labelSize.width,labelSize.height,labelOffset,toLabelPlacement)}null!=onLabelPlacement&&onLabelPlacement.call(this,labelPlacement,labelConfig)}}))}},ConnectorStraight.prototype._drawLine=function(buffer,linePaletteItem,fromPoint,toPoint,bothWays){var polyline;buffer.addInverted((function(invertedBuffer){(polyline=invertedBuffer.getPolyline(linePaletteItem)).addSegment(new MoveSegment(fromPoint)),polyline.addSegment(new LineSegment(toPoint)),polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}))}),!1),bothWays&&(polyline=buffer.getPolyline(linePaletteItem)).addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}))},ConnectorStraight.prototype._getLabelPositionBySnapPoint=function(x,y,labelWidth,labelHeight,labelOffset,placementType){var result=null;switch(placementType){case enums.TK.Auto:case enums.TK.Top:result=new Rect(x-labelWidth/2,y-labelOffset-labelHeight,labelWidth,labelHeight);break;case enums.TK.Right:result=new Rect(x+labelOffset,y-labelHeight/2,labelWidth,labelHeight);break;case enums.TK.Bottom:result=new Rect(x-labelWidth/2,y+labelOffset,labelWidth,labelHeight);break;case enums.TK.Left:result=new Rect(x-labelWidth-labelOffset,y-labelHeight/2,labelWidth,labelHeight)}return result},ConnectorOffbeat.prototype=new BaseShape,ConnectorOffbeat.prototype.draw=function(buffer,linePaletteItem,fromRect,toRect,linesOffset,bundleOffset,labelSize,panelSize,connectorShapeType,labelOffset,labelPlacementType,hasLabel,connectorAnnotationOffsetResolver,onLabelPlacement,labelConfig){var minimalGap,connectorRect,fromPoint,toPoint,snapPoint,index,len,offsets,tempOffset,invertX,invertY,polyline,bothWay,fromLabelPlacement=enums.TK.Auto,toLabelPlacement=enums.TK.Auto,labelPlacement=null;switch(polyline=buffer.getPolyline(linePaletteItem),offsets=[],connectorShapeType){case enums.GV.TwoWay:offsets=[-linesOffset/2,linesOffset/2],bothWay=!1;break;case enums.GV.OneWay:offsets=[0],bothWay=!1;break;case enums.GV.BothWay:offsets=[0],bothWay=!0}if(minimalGap=Math.max(hasLabel?labelSize.width:0,5*linesOffset),fromRect.right()+minimalGap<toRect.left()||fromRect.left()>toRect.right()+minimalGap)if(fromRect.left()>toRect.right()?(fromPoint=new Point(fromRect.left(),fromRect.verticalCenter()),toPoint=new Point(toRect.right(),toRect.verticalCenter())):(fromPoint=new Point(fromRect.right(),fromRect.verticalCenter()),toPoint=new Point(toRect.left(),toRect.verticalCenter())),hasLabel&&(fromRect.left()>toRect.right()?(fromLabelPlacement=enums.TK.Left,toLabelPlacement=enums.TK.Right):(fromLabelPlacement=enums.TK.Right,toLabelPlacement=enums.TK.Left)),connectorRect=new Rect(fromPoint,toPoint),invertY=fromPoint.y<=toPoint.y,invertX=fromPoint.x<toPoint.x,connectorRect.height<connectorRect.width){for(connectorRect.height<2*linesOffset&&connectorRect.offset(0,invertY?2*linesOffset:0,0,invertY?0:2*linesOffset),index=0,len=offsets.length;index<len;index+=1)tempOffset=offsets[index],buffer.addInverted((function(invertedBuffer){var polyline=invertedBuffer.getPolyline(linePaletteItem);polyline.addSegment(new MoveSegment(fromPoint.x,fromPoint.y+tempOffset)),polyline.addSegment(new QuadraticArcSegment(connectorRect.horizontalCenter(),(invertY?connectorRect.top():connectorRect.bottom())+tempOffset,toPoint.x,toPoint.y+tempOffset)),bothWay&&polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}))}),index||connectorShapeType==enums.GV.OneWay),polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}));hasLabel&&(labelPlacement=new Rect((snapPoint=labelSize.width<connectorRect.width/5*2?QuadraticArcSegment.prototype.offsetPoint(fromPoint.x,fromPoint.y,connectorRect.horizontalCenter(),invertY?connectorRect.top():connectorRect.bottom(),toPoint.x,toPoint.y,.5):new Point(fromPoint.x,invertY?connectorRect.top():connectorRect.bottom())).x+(invertX?linesOffset:-labelSize.width-linesOffset),invertY?snapPoint.y-labelSize.height-linesOffset:snapPoint.y+linesOffset,labelSize.width,labelSize.height))}else{for(index=0,len=offsets.length;index<len;index+=1)tempOffset=offsets[index],buffer.addInverted((function(invertedBuffer){var polyline=invertedBuffer.getPolyline(linePaletteItem);polyline.addSegment(new MoveSegment(fromPoint.x,fromPoint.y+tempOffset)),polyline.addSegment(new QuadraticArcSegment(connectorRect.horizontalCenter()+tempOffset*(invertY!=invertX?1:-1),(invertY?connectorRect.top():connectorRect.bottom())+tempOffset,connectorRect.horizontalCenter()+tempOffset*(invertY!=invertX?1:-1),connectorRect.verticalCenter()+tempOffset)),polyline.addSegment(new QuadraticArcSegment(connectorRect.horizontalCenter()+tempOffset*(invertY!=invertX?1:-1),(invertY?connectorRect.bottom():connectorRect.top())+tempOffset,toPoint.x,toPoint.y+tempOffset)),bothWay&&polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}))}),index||connectorShapeType==enums.GV.OneWay),polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}));hasLabel&&(labelPlacement=new Rect(connectorRect.horizontalCenter()+(invertY!=invertX?linesOffset:-(linesOffset+labelSize.width)),connectorRect.verticalCenter()-labelSize.height/2,labelSize.width,labelSize.height))}else if(fromRect.verticalCenter()<toRect.top()||fromRect.verticalCenter()>toRect.bottom()){for(invertX=fromRect.x<panelSize.width/2,fromPoint=new Point(invertX?fromRect.right():fromRect.left(),fromRect.verticalCenter()),toPoint=new Point(invertX?toRect.right():toRect.left(),toRect.verticalCenter()),(connectorRect=new Rect(fromPoint,toPoint)).offset(10*linesOffset,0,10*linesOffset,0),invertY=fromPoint.y<=toPoint.y,index=0,len=offsets.length;index<len;index+=1)tempOffset=offsets[index],buffer.addInverted((function(invertedBuffer){var polyline=invertedBuffer.getPolyline(linePaletteItem);polyline.addSegment(new MoveSegment(fromPoint.x,fromPoint.y+tempOffset)),polyline.addSegment(new QuadraticArcSegment(invertX?connectorRect.right()+tempOffset*(invertY?-1:1):connectorRect.left()-tempOffset*(invertY?-1:1),connectorRect.verticalCenter(),invertX?toRect.right():toRect.left(),toRect.verticalCenter()-tempOffset)),bothWay&&polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}))}),index||connectorShapeType==enums.GV.OneWay),polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}));hasLabel&&(toLabelPlacement=fromLabelPlacement=invertX?enums.TK.Right:enums.TK.Left,labelPlacement=new Rect((snapPoint=QuadraticArcSegment.prototype.offsetPoint(fromPoint.x,fromPoint.y,invertX?connectorRect.right():connectorRect.left(),connectorRect.verticalCenter(),toPoint.x,toPoint.y,.5)).x+(invertX?linesOffset/2:-linesOffset/2-labelSize.width),snapPoint.y-labelSize.height/2,labelSize.width,labelSize.height))}else{for(fromPoint=new Point(fromRect.horizontalCenter(),fromRect.top()),toPoint=new Point(toRect.horizontalCenter(),toRect.top()),(connectorRect=new Rect(fromPoint,toPoint)).offset(0,7*linesOffset,0,0),invertX=fromPoint.x<toPoint.x,index=0,len=offsets.length;index<len;index+=1)tempOffset=offsets[index],buffer.addInverted((function(invertedBuffer){var polyline=invertedBuffer.getPolyline(linePaletteItem);polyline.addSegment(new MoveSegment(fromPoint.x+tempOffset,fromPoint.y)),polyline.addSegment(new QuadraticArcSegment(connectorRect.horizontalCenter(),connectorRect.top()-tempOffset*(invertX?-1:1),toRect.horizontalCenter()-tempOffset,toRect.top())),bothWay&&polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}))}),index||connectorShapeType==enums.GV.OneWay),polyline.addArrow(linePaletteItem.lineWidth,(function(polyline){polyline.mergeTo(buffer.getPolyline(polyline.paletteItem))}));hasLabel&&(fromLabelPlacement=enums.TK.Top,toLabelPlacement=enums.TK.Top,labelPlacement=new Rect((snapPoint=QuadraticArcSegment.prototype.offsetPoint(fromPoint.x,fromPoint.y,connectorRect.horizontalCenter(),connectorRect.top(),toPoint.x,toPoint.y,.5)).x-labelSize.width/2,snapPoint.y-(labelOffset+labelSize.height),labelSize.width,labelSize.height))}if(hasLabel)switch(labelPlacementType){case enums.xj.From:labelPlacement=this._getLabelPosition(fromRect.x,fromRect.y,fromRect.width,fromRect.height,labelPlacement.width,labelPlacement.height,labelOffset,fromLabelPlacement);break;case enums.xj.To:labelPlacement=this._getLabelPosition(toRect.x,toRect.y,toRect.width,toRect.height,labelPlacement.width,labelPlacement.height,labelOffset,toLabelPlacement)}null!=onLabelPlacement&&onLabelPlacement(labelPlacement,labelConfig)},Callout.prototype=new BaseShape,Callout.prototype.draw=function(snapPoint,position){var placementType,point,index,attr,linePaletteItem,buffer,polyline,pointA=new Point((position=new Rect(position).offset(this.offset)).x,position.y),pointB=new Point(position.right(),position.y),pointC=new Point(position.right(),position.bottom()),snapPoints=[null,null,null,null,null,null,null,null],points=[pointA,pointB,pointC,new Point(position.left(),position.bottom())],radius=this.m_graphics.getPxSize(this.cornerRadius,Math.min(pointA.distanceTo(pointB),pointB.distanceTo(pointC)));for(attr={},null!==this.fillColor&&(attr.fillColor=this.fillColor,attr.opacity=this.opacity),null!==this.lineColor&&(attr.lineColor=this.borderColor),attr.lineWidth=this.lineWidth,attr.lineType=this.lineType,linePaletteItem=new PaletteItem(attr),polyline=(buffer=new PolylinesBuffer).getPolyline(linePaletteItem),null!==snapPoint&&null!==(placementType=this.pointerPlacement===enums.TK.Auto?this._getPlacement(snapPoint,pointA,pointC):this.pointerPlacement)&&(snapPoints[placementType]=snapPoint),index=0;index<points.length;index+=1)this._drawSegment(polyline,points[0],points[1],points[2],this.pointerWidth,radius,snapPoints[1],snapPoints[2]),point=points.shift(),points.push(point),point=snapPoints.shift(),snapPoints.push(point),point=snapPoints.shift(),snapPoints.push(point);this.m_graphics.polylinesBuffer(buffer)},Callout.prototype._getPlacement=function(point,point1,point2){var row=null,column=null;return row=point.x<point1.x?0:point.x>point2.x?2:1,column=point.y<point1.y?0:point.y>point2.y?2:1,this.m_map[row][column]},Callout.prototype._drawSegment=function(polyline,pointA,pointB,pointC,base,radius,sideSnapPoint,cornerSnapPoint){var pointS,pointS1,pointS2,pointA1=this._offsetPoint(pointA,pointB,radius),pointB1=this._offsetPoint(pointB,pointA,radius),pointB2=this._offsetPoint(pointB,pointC,radius);base=this.m_graphics.getPxSize(base,pointA.distanceTo(pointB)/2),0===polyline.length()&&polyline.addSegment(new MoveSegment(pointA1)),null!==sideSnapPoint&&(pointS=this._betweenPoint(pointA,pointB),pointS1=this._offsetPoint(pointS,pointA,base),pointS2=this._offsetPoint(pointS,pointB,base),polyline.addSegment(new LineSegment(pointS1)),polyline.addSegment(new LineSegment(sideSnapPoint)),polyline.addSegment(new LineSegment(pointS2))),polyline.addSegment(new LineSegment(pointB1)),null!==cornerSnapPoint?(polyline.addSegment(new LineSegment(cornerSnapPoint)),polyline.addSegment(new LineSegment(pointB2))):polyline.addSegment(new QuadraticArcSegment(pointB,pointB2))},Marker.Markers={},Marker.DrawCircle=function(polyline,position){var quarter=Math.min(position.width/2,position.height/2);position=new Rect(position.horizontalCenter()-quarter,position.verticalCenter()-quarter,2*quarter,2*quarter),Marker.DrawOval(polyline,position)},Marker.DrawRectangle=function(polyline,position){polyline.addSegment(new MoveSegment(position.x,position.verticalCenter())),polyline.addSegment(new LineSegment(position.x,position.y)),polyline.addSegment(new LineSegment(position.right(),position.y)),polyline.addSegment(new LineSegment(position.right(),position.bottom())),polyline.addSegment(new LineSegment(position.x,position.bottom())),polyline.addSegment(new LineSegment(position.x,position.verticalCenter()))},Marker.DrawOval=function(polyline,position){var cpX,cpY;cpX=position.width/2*.5522848,cpY=position.height/2*.5522848,polyline.addSegment(new MoveSegment(position.x,position.verticalCenter())),polyline.addSegment(new CubicArcSegment(position.x,position.verticalCenter()-cpY,position.horizontalCenter()-cpX,position.y,position.horizontalCenter(),position.y)),polyline.addSegment(new CubicArcSegment(position.horizontalCenter()+cpX,position.y,position.right(),position.verticalCenter()-cpY,position.right(),position.verticalCenter())),polyline.addSegment(new CubicArcSegment(position.right(),position.verticalCenter()+cpY,position.horizontalCenter()+cpX,position.bottom(),position.horizontalCenter(),position.bottom())),polyline.addSegment(new CubicArcSegment(position.horizontalCenter()-cpX,position.bottom(),position.x,position.verticalCenter()+cpY,position.x,position.verticalCenter()))},Marker.DrawTriangle=function(polyline,position){polyline.addSegment(new MoveSegment(position.left(),position.bottom())),polyline.addSegment(new LineSegment(position.horizontalCenter(),position.y)),polyline.addSegment(new LineSegment(position.right(),position.bottom())),polyline.addSegment(new LineSegment(position.left(),position.bottom()))},Marker.DrawCrossOut=function(polyline,position){polyline.addSegment(new MoveSegment(position.horizontalCenter(),position.verticalCenter())),polyline.addSegment(new LineSegment(position.x,position.y)),polyline.addSegment(new MoveSegment(position.horizontalCenter(),position.verticalCenter())),polyline.addSegment(new LineSegment(position.right(),position.bottom())),polyline.addSegment(new MoveSegment(position.horizontalCenter(),position.verticalCenter())),polyline.addSegment(new LineSegment(position.right(),position.y)),polyline.addSegment(new MoveSegment(position.horizontalCenter(),position.verticalCenter())),polyline.addSegment(new LineSegment(position.left(),position.bottom()))},Marker.DrawRhombus=function(polyline,position){polyline.addSegment(new MoveSegment(position.horizontalCenter(),position.bottom())),polyline.addSegment(new LineSegment(position.left(),position.verticalCenter())),polyline.addSegment(new LineSegment(position.horizontalCenter(),position.y)),polyline.addSegment(new LineSegment(position.right(),position.verticalCenter())),polyline.addSegment(new LineSegment(position.horizontalCenter(),position.bottom()))},Marker.DrawWedge=function(polyline,position){polyline.addSegment(new MoveSegment(position.horizontalCenter(),position.y)),polyline.addSegment(new LineSegment(position.right(),position.y)),polyline.addSegment(new LineSegment(position.horizontalCenter(),position.bottom())),polyline.addSegment(new LineSegment(position.left(),position.y)),polyline.addSegment(new LineSegment(position.horizontalCenter(),position.y))},Marker.DrawFramedOval=function(polyline,position){Marker.DrawRectangle(polyline,position),Marker.DrawOval(polyline,position)},Marker.DrawFramedTriangle=function(polyline,position){Marker.DrawRectangle(polyline,position),Marker.DrawTriangle(polyline,position)},Marker.DrawFramedWedge=function(polyline,position){Marker.DrawRectangle(polyline,position),Marker.DrawWedge(polyline,position)},Marker.DrawFramedRhombus=function(polyline,position){Marker.DrawRectangle(polyline,position),Marker.DrawRhombus(polyline,position)},Marker.DrawNone=function(polyline,position){},Marker.Markers[enums.DY.Circle]=Marker.DrawCircle,Marker.Markers[enums.DY.Rectangle]=Marker.DrawRectangle,Marker.Markers[enums.DY.Oval]=Marker.DrawOval,Marker.Markers[enums.DY.Triangle]=Marker.DrawTriangle,Marker.Markers[enums.DY.CrossOut]=Marker.DrawCrossOut,Marker.Markers[enums.DY.Rhombus]=Marker.DrawRhombus,Marker.Markers[enums.DY.Wedge]=Marker.DrawWedge,Marker.Markers[enums.DY.FramedOval]=Marker.DrawFramedOval,Marker.Markers[enums.DY.FramedTriangle]=Marker.DrawFramedTriangle,Marker.Markers[enums.DY.FramedWedge]=Marker.DrawFramedWedge,Marker.Markers[enums.DY.FramedRhombus]=Marker.DrawFramedRhombus,Marker.Markers[enums.DY.None]=Marker.DrawNone,Marker.prototype.draw=function(polylinesBuffer,shapeType,position,paletteItem){var polyline;polyline=polylinesBuffer.getPolyline(paletteItem),Marker.Markers[shapeType](polyline,position)},Shape.prototype=new BaseShape,Shape.prototype.draw=function(position,uiHash){var labelPlacement,calloutShape,linePaletteItem,buffer,marker;if(position=new Rect(position).offset(this.offset),this.transform=new Transform,this.transform.size=this.panelSize,this.transform.setOrientation(this.orientationType),this.hasLabel&&(labelPlacement=this._getLabelPosition(position.x,position.y,position.width,position.height,this.labelSize.width,this.labelSize.height,this.labelOffset,this.labelPlacement)),this.shapeType===enums.DY.Rectangle)(calloutShape=new Callout(this.m_graphics)).cornerRadius=this.cornerRadius,calloutShape.opacity=this.opacity,calloutShape.lineWidth=this.lineWidth,calloutShape.lineType=this.lineType,calloutShape.borderColor=this.borderColor,calloutShape.fillColor=this.fillColor,calloutShape.draw(null,position);else linePaletteItem=new PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,lineType:this.lineType,fillColor:this.fillColor,opacity:this.opacity}),this.transform.transformRect(position.x,position.y,position.width,position.height,!1,this,(function(x,y,width,height){position=new Rect(x,y,width,height)})),marker=new Marker,buffer=new PolylinesBuffer,marker.draw(buffer,this.shapeType,position,linePaletteItem),buffer.transform(this.transform,!0),this.m_graphics.polylinesBuffer(buffer);this.hasLabel&&this.m_graphics.template(labelPlacement.x,labelPlacement.y,0,0,0,0,labelPlacement.width,labelPlacement.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,uiHash,null)},Label.prototype=new Rect,Cache.prototype.begin=function(){var placeholder,type,index,control;for(placeholder in this.m_visible)if(this.m_visible.hasOwnProperty(placeholder))for(type in this.m_visible[placeholder])if(this.m_visible[placeholder].hasOwnProperty(type)){for(index=this.m_visible[placeholder][type].length-1;index>=0;index-=1)(control=this.m_visible[placeholder][type][index]).style.visibility="hidden",this.m_invisible[placeholder][type].push(control);this.m_visible[placeholder][type].length=0}},Cache.prototype.end=function(){var placeholder,type,control;for(placeholder in this.m_visible)if(this.m_visible.hasOwnProperty(placeholder))for(type in this.m_visible[placeholder])if(this.m_visible[placeholder].hasOwnProperty(type)&&(control=null,this.m_invisible[placeholder][type].length>this.threshold))for(;void 0!==(control=this.m_invisible[placeholder][type].pop());)control.parentNode.removeChild(control)},Cache.prototype.reset=function(placeholder,layer){placeholder=placeholder+"-"+layer;var type,index,control=null;for(type in this.m_visible[placeholder])if(this.m_visible[placeholder].hasOwnProperty(type)){for(index=this.m_visible[placeholder][type].length-1;index>=0;index-=1)control=this.m_visible[placeholder][type][index],this.m_invisible[placeholder][type].push(control),control.style.visibility="hidden";this.m_visible[placeholder][type].length=0}},Cache.prototype.clear=function(){var placeholder,type,control;for(placeholder in this.m_visible)if(this.m_visible.hasOwnProperty(placeholder))for(type in this.m_visible[placeholder])if(this.m_visible[placeholder].hasOwnProperty(type)){for(control=null;void 0!==(control=this.m_visible[placeholder][type].pop());)control.parentNode.removeChild(control);for(;void 0!==(control=this.m_invisible[placeholder][type].pop());)control.parentNode.removeChild(control)}},Cache.prototype.get=function(placeholder,layer,type){placeholder=placeholder+"-"+layer;var result=null;return void 0===this.m_visible[placeholder]&&(this.m_visible[placeholder]={},this.m_invisible[placeholder]={}),void 0===this.m_visible[placeholder][type]&&(this.m_visible[placeholder][type]=[],this.m_invisible[placeholder][type]=[]),null!==(result=this.m_invisible[placeholder][type].pop()||null)&&(this.m_visible[placeholder][type].push(result),result.style.visibility="inherit"),result},Cache.prototype.put=function(placeholder,layer,type,control){placeholder=placeholder+"-"+layer,this.m_visible[placeholder][type].push(control)},Graphics.prototype.clean=function(){var key,placeholder,layerKey,layer;for(key in this.m_cache.clear(),this.m_cache=null,this.m_element=null,this.m_placeholders)if(this.m_placeholders.hasOwnProperty(key)){for(layerKey in(placeholder=this.m_placeholders[key]).layers)placeholder.layers.hasOwnProperty(layerKey)&&((layer=placeholder.layers[layerKey]).canvas.parentNode.removeChild(layer.canvas),layer.canvas=null);placeholder.layers.length=0,placeholder.activeLayer=null,placeholder.size=null,placeholder.rect=null,placeholder.div=null}this.m_placeholders.length=0,this.m_activePlaceholder=null},Graphics.prototype.resize=function(name,width,height){var placeholder=this.m_placeholders[name];void 0===placeholder&&(placeholder=this._activatePlaceholder(name)),this.resizePlaceholder(placeholder,0,0,width,height)},Graphics.prototype.position=function(name,left,top,width,height){var placeholder=this.m_placeholders[name];void 0===placeholder&&(placeholder=this._activatePlaceholder(name)),this.resizePlaceholder(placeholder,left,top,width,height)},Graphics.prototype.show=function(name){var placeholder=this.m_placeholders[name];null!=placeholder&&jsonml_html.applyStyles(placeholder.div,{display:"inherit",visibility:"inherit"})},Graphics.prototype.hide=function(name){var placeholder=this.m_placeholders[name];null!=placeholder&&jsonml_html.applyStyles(placeholder.div,{display:"none",visibility:"hidden"})},Graphics.prototype.resizePlaceholder=function(placeholder,left,top,width,height){var layerKey,layer;for(layerKey in placeholder.size=new Size(width,height),placeholder.rect=new Rect(left,top,width,height),jsonml_html.applyStyles(placeholder.div,placeholder.rect.getCSS()),placeholder.layers)placeholder.layers.hasOwnProperty(layerKey)&&-1!==(layer=placeholder.layers[layerKey]).name&&jsonml_html.applyStyles(layer.canvas,{position:"absolute",width:"0px",height:"0px"})},Graphics.prototype.begin=function(){this.m_cache.begin()},Graphics.prototype.end=function(){this.m_cache.end()},Graphics.prototype.reset=function(arg0,arg1){var placeholderName="none",layerName=-1;switch(arguments.length){case 1:"string"==typeof arg0?placeholderName=arg0:layerName=arg0;break;case 2:placeholderName=arg0,layerName=arg1}this.m_cache.reset(placeholderName,layerName)},Graphics.prototype.activate=function(arg0,arg1){switch(arguments.length){case 1:"string"==typeof arg0?(this._activatePlaceholder(arg0),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(arg0));break;case 2:this._activatePlaceholder(arg0),this._activateLayer(arg1)}return this.m_activePlaceholder},Graphics.prototype._activatePlaceholder=function(placeholderName){var div,divs,placeholder=this.m_placeholders[placeholderName];return void 0===placeholder&&(div=null,div="none"===placeholderName?this.m_element:(divs=this.m_element.getElementsByClassName(placeholderName)).length>0?divs[0]:this.m_element,(placeholder=new Placeholder(placeholderName)).div=div,placeholder.size=getInnerSize(div),placeholder.rect=new Rect(0,0,placeholder.size.width,placeholder.size.height),this.m_placeholders[placeholderName]=placeholder),this.m_activePlaceholder=placeholder,this.m_activePlaceholder},Graphics.prototype._activateLayer=function(layerName){var placeholder,canvas,maximumLayer,layerKey,layer=this.m_activePlaceholder.layers[layerName];if(void 0===layer){if(placeholder=this.m_activePlaceholder,-1===layerName)(layer=new Layer(layerName)).canvas=placeholder.div;else{for(layerKey in canvas=jsonml_html.toHTML(["div",{style:{position:"absolute",width:"0px",height:"0px"},class:["Layer"+layerName,"Layer"+this.layerNames[layerName]]}]),maximumLayer=null,placeholder.layers)placeholder.layers.hasOwnProperty(layerKey)&&(layer=placeholder.layers[layerKey]).name<layerName&&(maximumLayer=null!==maximumLayer?Math.max(maximumLayer,layer.name):layer.name);(layer=new Layer(layerName)).canvas=canvas,null===maximumLayer?this.prepend(placeholder.div,layer.canvas):this.insertAfter(placeholder.layers[maximumLayer].canvas,layer.canvas)}placeholder.layers[layerName]=layer}this.m_activePlaceholder.activeLayer=layer},Graphics.prototype.prepend=function(parent,newElement){null==parent.firstChild?parent.appendChild(newElement):parent.insertBefore(newElement,parent.firstChild)},Graphics.prototype.insertAfter=function(insertAfterElement,newElement){var parent=insertAfterElement.parentNode;parent.lastChild==insertAfterElement?parent.appendChild(newElement):parent.insertBefore(newElement,insertAfterElement.nextSibling)},Graphics.prototype.text=function(x,y,width,height,label,orientation,horizontalAlignment,verticalAlignment,attr){var element,tdstyle,placeholder=this.m_activePlaceholder,style={position:"absolute",padding:0,margin:0,textAlign:getTextAlign(horizontalAlignment),fontSize:attr.fontSize,fontFamily:attr.fontFamily,fontWeight:attr.fontWeight,fontStyle:attr.fontStyle,color:attr.fontColor,lineHeight:1},rotation="";switch(orientation){case enums.GE.Horizontal:case enums.GE.Auto:style.left=x+"px",style.top=y+"px",style.width=width+"px",style.height=height+"px";break;case enums.GE.RotateLeft:style.left=x+Math.round(width/2-height/2)+"px",style.top=y+Math.round(height/2-width/2)+"px",style.width=height+"px",style.height=width+"px",rotation="rotate(-90deg)";break;case enums.GE.RotateRight:style.left=x+Math.round(width/2-height/2)+"px",style.top=y+Math.round(height/2-width/2)+"px",style.width=height+"px",style.height=width+"px",rotation="rotate(90deg)"}if(style["-webkit-transform-origin"]="center center",style["-moz-transform-origin"]="center center",style["-o-transform-origin"]="center center",style["-ms-transform-origin"]="center center",style["-webkit-transform"]=rotation,style["-moz-transform"]=rotation,style["-o-transform"]=rotation,style["-ms-transform"]=rotation,style.transform=rotation,style.maxWidth=style.width,style.maxHeight=style.height,label=label.replace(new RegExp("\n","g"),"<br/>"),verticalAlignment===enums.Vn.Top)this.debug&&(style.border="solid 1px black"),null===(element=this.m_cache.get(placeholder.name,placeholder.activeLayer.name,"text"))?(element=jsonml_html.toHTML(["div",{style:style,$:function(element){element.innerHTML=label}}]),placeholder.activeLayer.canvas.appendChild(element),this.m_cache.put(placeholder.name,placeholder.activeLayer.name,"text",element)):(jsonml_html.applyStyles(element,style),element.innerHTML=label);else if(style.borderCollapse="collapse",tdstyle={verticalAlign:getVerticalAlignment(verticalAlignment),padding:0},this.debug&&(tdstyle.border="solid 1px black"),null===(element=this.m_cache.get(placeholder.name,placeholder.activeLayer.name,"textintable")))element=jsonml_html.toHTML(["table",{style:style},["tbody",["tr",["td",{style:tdstyle,$:function(element){element.innerHTML=label}}]]]]),placeholder.activeLayer.canvas.appendChild(element),this.m_cache.put(placeholder.name,placeholder.activeLayer.name,"textintable",element);else{jsonml_html.applyStyles(element,style);var td=element.getElementsByTagName("td")[0];jsonml_html.applyStyles(td,tdstyle),td.innerHTML=label}},Graphics.prototype.polylinesBuffer=function(buffer){buffer.loop(this,(function(polyline){polyline.length()>0&&this.polyline(polyline)}))},Graphics.prototype.template=function(x,y,width,height,contentx,contenty,contentWidth,contentHeight,template,hashCode,onRenderTemplate,uiHash,attr){var element,style,placeholder=this.m_activePlaceholder,templateKey="template"+(null!==hashCode?hashCode:common_getHashCode(template)),gap=0;return element=this.m_cache.get(placeholder.name,placeholder.activeLayer.name,templateKey),null!==attr&&void 0!==attr.borderWidth&&(attr.borderWidth=attr.borderWidth.toString(),gap=this.getPxSize(attr.borderWidth)),mergeObjects(style={width:contentWidth-gap+"px",height:contentHeight-gap+"px",top:y+contenty+"px",left:x+contentx+"px"},attr),null==uiHash&&(uiHash=new RenderEventArgs),uiHash.x=x+contentx,uiHash.y=y+contenty,uiHash.width=contentWidth-gap,uiHash.height=contentHeight-gap,null==element?(element=this.getElementByTemplate(template),style=mergeObjects(style,{position:"absolute",padding:"0px",margin:"0px"},attr),jsonml_html.applyStyles(element,style),uiHash.element=element,uiHash.renderingMode=enums.sO.Create,null!==onRenderTemplate&&onRenderTemplate(null,uiHash),placeholder.activeLayer.canvas.appendChild(element),this.m_cache.put(placeholder.name,placeholder.activeLayer.name,templateKey,element)):(uiHash.element=element,uiHash.renderingMode=enums.sO.Update,jsonml_html.applyStyles(element,style),null!==onRenderTemplate&&onRenderTemplate(null,uiHash)),element},Graphics.prototype.getElementByTemplate=function(template){var result=null;if(Array.isArray(template))result=jsonml_html.toHTML(template);else{var parent=document.createElement("div");parent.innerHTML=template,result=parent.firstChild}return result},Graphics.prototype.getPxSize=function(value,base){var result=value;return"string"==typeof value&&(result=value.indexOf("pt")>0?96*parseInt(value,10)/72:value.indexOf("%")>0?parseFloat(value)/100*base:parseInt(value,10)),result},Element.prototype.setAttribute=function(key,value){this.attr[key]=value},Element.prototype.appendChild=function(child){this.children[this.children.length]=child},Element.prototype.create=function(ie8mode){var name,child,index,result=null;for(name in result=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name),this.attr)this.attr.hasOwnProperty(name)&&(void 0!==ie8mode?result[name]=this.attr[name]:result.setAttribute(name,this.attr[name]));for(name in this.style)this.style.hasOwnProperty(name)&&(result.style[name]=this.style[name]);for(index=0;index<this.children.length;index+=1)"string"==typeof(child=this.children[index])?result.appendChild(document.createTextNode(child)):result.appendChild(child.create(ie8mode));return result},Element.prototype.update=function(target,ie8mode){var name,length,index,child,value;for(name in this.style)this.style.hasOwnProperty(name)&&(value=this.style[name],target.style[name]!==value&&(target.style[name]=value));for(name in this.attr)this.attr.hasOwnProperty(name)&&(value=this.attr[name],void 0!==ie8mode?target[name]!==value&&(target[name]=value):target.getAttribute(name)!==value&&target.setAttribute(name,value));for(length=this.children.length,index=0;index<length;index+=1)"string"==typeof(child=this.children[index])?target.innerHtml!==child&&(target.innerHtml=child):this.children[index].update(target.children[index],ie8mode)},SvgGraphics.prototype=new Graphics,SvgGraphics.prototype.clean=function(){var key,placeholder,layerKey,layer;for(key in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(key))for(layerKey in(placeholder=this.m_placeholders[key]).layers)placeholder.layers.hasOwnProperty(layerKey)&&null!==(layer=placeholder.layers[layerKey]).svgcanvas&&(layer.svgcanvas.parentNode.removeChild(layer.svgcanvas),layer.svgcanvas=null);this.parent.clean.apply(this,arguments)},SvgGraphics.prototype.resizePlaceholder=function(placeholder,left,top,width,height){var layerKey,layer;for(layerKey in this.parent.resizePlaceholder.apply(this,arguments),placeholder.layers)placeholder.layers.hasOwnProperty(layerKey)&&null!==(layer=placeholder.layers[layerKey]).svgcanvas&&(jsonml_html.applyStyles(layer.svgcanvas,{position:"absolute",width:width+"px",height:height+"px"}),layer.svgcanvas.setAttribute("viewBox","0 0 "+width+" "+height))},SvgGraphics.prototype._getCanvas=function(){var placeholder=this.m_activePlaceholder,layer=placeholder.activeLayer,panelSize=placeholder.rect;return null===layer.svgcanvas&&(layer.svgcanvas=document.createElementNS(this._svgxmlns,"svg"),layer.svgcanvas.setAttribute("viewBox",panelSize.x+" "+panelSize.y+" "+panelSize.width+" "+panelSize.height),jsonml_html.applyStyles(layer.svgcanvas,{width:panelSize.width+"px",height:panelSize.height+"px"}),this.prepend(placeholder.activeLayer.canvas,layer.svgcanvas)),layer.svgcanvas},SvgGraphics.prototype.polyline=function(polylineData){var polyline,data,element,step,radius,cornerRadius,placeholder=this.m_activePlaceholder,attr=polylineData.paletteItem.toAttr();if(polyline=new Element(this._svgxmlns,"path"),void 0!==attr.fillColor?(polyline.setAttribute("fill",attr.fillColor),polyline.setAttribute("fill-opacity",attr.opacity)):polyline.setAttribute("fill-opacity",0),void 0!==attr.lineWidth&&void 0!==attr.borderColor?(polyline.setAttribute("stroke",attr.borderColor),polyline.setAttribute("stroke-width",attr.lineWidth),void 0!==attr.opacity?polyline.setAttribute("stroke-opacity",attr.opacity):polyline.setAttribute("stroke-opacity",1)):(polyline.setAttribute("stroke","transparent"),polyline.setAttribute("stroke-width",0)),null!=attr.lineType)switch(step=Math.round(attr.lineWidth)||1,attr.lineType){case enums.SP.Solid:polyline.setAttribute("stroke-dasharray","");break;case enums.SP.Dotted:polyline.setAttribute("stroke-dasharray",step+","+step);break;case enums.SP.Dashed:polyline.setAttribute("stroke-dasharray",5*step+","+3*step)}data="",polylineData.loop(this,(function(segment){switch(segment.segmentType){case enums.vZ.Move:data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5);break;case enums.vZ.Line:data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5);break;case enums.vZ.QuadraticArc:data+="Q"+(Math.round(segment.cpX)+.5)+" "+(Math.round(segment.cpY)+.5)+" "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5);break;case enums.vZ.Dot:segment.width==segment.height&&segment.width/2<=segment.cornerRadius?(radius=segment.width/2,data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+segment.height/2+.5),data+="A"+radius+" "+radius+" 0 0 0 "+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y)+segment.height/2+.5),data+="A"+radius+" "+radius+" 0 0 0 "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+segment.height/2+.5)):0===segment.cornerRadius?(data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5),data+="L"+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y)+.5),data+="L"+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5)):(cornerRadius=Math.min(segment.cornerRadius,Math.min(segment.width/2,segment.height/2)),data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+cornerRadius)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x+cornerRadius)+.5)+" "+(Math.round(segment.y)+.5),data+="L"+(Math.round(segment.x+segment.width-cornerRadius)+.5)+" "+(Math.round(segment.y)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y+cornerRadius)+.5),data+="L"+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y+segment.height-cornerRadius)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x+segment.width-cornerRadius)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="L"+(Math.round(segment.x+cornerRadius)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+segment.height-cornerRadius)+.5),data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+cornerRadius)+.5));break;case enums.vZ.CubicArc:data+="C"+(Math.round(segment.cpX1)+.5)+" "+(Math.round(segment.cpY1)+.5)+" "+(Math.round(segment.cpX2)+.5)+" "+(Math.round(segment.cpY2)+.5)+" "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5)}})),polyline.setAttribute("d",data),null===(element=this.m_cache.get(placeholder.name,placeholder.activeLayer.name,"path"))?(element=polyline.create(),this._getCanvas().appendChild(element),this.m_cache.put(placeholder.name,placeholder.activeLayer.name,"path",element)):polyline.update(element)},UserDefinedNodesOrder.prototype.getUserDefinedPositions=function(items){var userItem,index,len,relationTree=Tree(),referencedItems={};for(index=0,len=items.length;index<len;index+=1)null!=(userItem=items[index]).relativeItem&&(referencedItems[userItem.relativeItem]=!0),null!=userItem.id&&(referencedItems[userItem.id]=!0);for(index=0,len=items.length;index<len;index+=1)if(userItem=items[index],referencedItems.hasOwnProperty(userItem.id)){var relativeItem=userItem.relativeItem||null;relationTree.add(relativeItem,userItem.id,userItem)}function Set(position,items){this.position=position,this.items=items}var itemsOrder={},lefts={},rights={};relationTree.loopPostOrder(this,(function(nodeid,node,parentid,parent){var index,items=[],leftItems=lefts[nodeid],rightItems=rights[nodeid];if(null!=leftItems)for(leftItems.sort((function(a,b){return b.position-a.position})),index=0;index<leftItems.length;index+=1)items=items.concat(leftItems[index].items);if(items.push(nodeid),null!=rightItems)for(rightItems.sort((function(a,b){return a.position-b.position})),index=0;index<rightItems.length;index+=1)items=items.concat(rightItems[index].items);null!=parentid?node.placementType==enums.hZ.Left?(lefts.hasOwnProperty(parentid)||(lefts[parentid]=[]),lefts[parentid].push(new Set(node.position,items))):(rights.hasOwnProperty(parentid)||(rights[parentid]=[]),rights[parentid].push(new Set(node.position,items))):itemsOrder[nodeid]=items}));var position={},group={};for(var rootItemId in itemsOrder)if(itemsOrder.hasOwnProperty(rootItemId))for(items=itemsOrder[rootItemId],index=0;index<items.length;index+=1){var itemid=items[index];position[itemid]=index,group[itemid]=rootItemId}return{position:position,group:group}},EdgeItem.prototype.getNear=function(key){return this.values[this[key]]},EdgeItem.prototype.getFar=function(key){return this.values[Math.abs(this[key]-1)]},EdgeItem.prototype.setNear=function(key,value){this.values[this[key]]=value},EdgeItem.prototype.setFar=function(key,value){this.values[Math.abs(this[key]-1)]=value},EdgeItem.prototype.toString=function(){return this.parent+","+this.child},BaseTransformer.prototype.validate=function(logicalFamily,strongValidate){if(!logicalFamily.validate())throw"Family structure failed to pass validation!";logicalFamily.loop(this,(function(famItemId,famItem){logicalFamily.loopChildren(this,famItemId,(function(childid,child,level){if(null===child.level||null===famItem.level||(strongValidate?child.level!=famItem.level+1:child.level<=famItem.level))throw"Family tree is broken. Children/Parents or levels mismatch!";return logicalFamily.SKIP}))}))},MatrixConnectorBundle.prototype=new BaseConnectorBundle,MatrixConnectorBundle.prototype.trace=function(data,params,options){this.isChildren?this.traceChildrenLayout(data,params,options):this.traceParentsLayout(data,params,options)},MatrixConnectorBundle.prototype.traceChildrenLayout=function(data,params,options){for(var actualPosition,forkItems=[],blockIndex=0;blockIndex<this.blocksCount;blockIndex+=1){for(var prevMedianPoint=null,rowIndex=this.rowsCount-1;rowIndex>=0;rowIndex-=1){var leftNodeIndex=this.getNodeIndex(blockIndex,rowIndex,!0,!0),leftNodeId=null,leftTreeItemPosition=null;leftNodeIndex<this.len&&(leftNodeId=this.items[leftNodeIndex],leftTreeItemPosition=params.treeItemsPositions[leftNodeId]);var rightNodeIndex=this.getNodeIndex(blockIndex,rowIndex,!1,!0),rightNodeId=null,rightTreeItemPosition=null;rightNodeIndex<this.len&&(rightNodeId=this.items[rightNodeIndex],rightTreeItemPosition=params.treeItemsPositions[rightNodeId]);var medianPoint=null;null==medianPoint&&null!=leftTreeItemPosition&&(medianPoint=new this.ConnectorDestination({id:this.getId(data),x:leftTreeItemPosition.actualPosition.horizontalCenter()+leftTreeItemPosition.rightMedianOffset,y:leftTreeItemPosition.horizontalConnectorsShift})),null==medianPoint&&null!=rightTreeItemPosition&&(medianPoint=new this.ConnectorDestination({id:this.getId(data),x:rightTreeItemPosition.actualPosition.horizontalCenter()-rightTreeItemPosition.leftMedianOffset,y:rightTreeItemPosition.horizontalConnectorsShift})),null!=leftTreeItemPosition&&(actualPosition=leftTreeItemPosition.actualPosition,params.transform.transformPoints(actualPosition.right(),medianPoint.y,medianPoint.x,medianPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),leftNodeId=params.nestedLayoutParentConnectorIds[leftNodeId]||leftNodeId,data.graph.addEdge(leftNodeId,medianPoint.id,new this.ConnectorEdge(leftNodeId,medianPoint.id,polyline,null,leftNodeId,null,10,null,null,null,!0))}))),null!=rightTreeItemPosition&&(actualPosition=rightTreeItemPosition.actualPosition,params.transform.transformPoints(actualPosition.left(),medianPoint.y,medianPoint.x,medianPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),rightNodeId=params.nestedLayoutParentConnectorIds[rightNodeId]||rightNodeId,data.graph.addEdge(rightNodeId,medianPoint.id,new this.ConnectorEdge(rightNodeId,medianPoint.id,polyline,null,rightNodeId,null,10,null,null,null,!0))}))),null!=prevMedianPoint&&null!=medianPoint&&params.transform.transformPoints(prevMedianPoint.x,prevMedianPoint.y,medianPoint.x,medianPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),data.graph.addEdge(prevMedianPoint.id,medianPoint.id,new this.ConnectorEdge(prevMedianPoint.id,medianPoint.id,polyline,null,null,null,0))})),null!=medianPoint&&(prevMedianPoint=medianPoint)}null!=prevMedianPoint&&forkItems.push(new this.ConnectorDestination({id:prevMedianPoint.id,bundleid:this.getId(data),x:prevMedianPoint.x,y:prevMedianPoint.y,isSquared:!0,visibility:enums.EE.Invisible}))}actualPosition=params.treeItemsPositions[this.matrixNodeId].actualPosition;var parentPoint=new this.ConnectorDestination({id:this.matrixNodeId,x:actualPosition.horizontalCenter(),y:actualPosition.top()});this.traceFork(data,params,options,parentPoint,forkItems,!0,!1,0,options.showExtraArrows)},MatrixConnectorBundle.prototype.traceParentsLayout=function(data,params,options){for(var actualPosition,forkItems=[],blockIndex=0;blockIndex<=this.blocksCount;blockIndex+=1){for(var prevMedianPoint=null,rowIndex=0;rowIndex<this.rowsCount;rowIndex+=1){var leftNodeIndex=this.getNodeIndex(blockIndex,rowIndex,!0,!1),leftNodeId=null,leftTreeItemPosition=null;leftNodeIndex<this.len&&(leftNodeId=this.items[leftNodeIndex],leftTreeItemPosition=params.treeItemsPositions[leftNodeId]);var rightNodeIndex=this.getNodeIndex(blockIndex,rowIndex,!1,!1),rightNodeId=null,rightTreeItemPosition=null;rightNodeIndex<this.len&&(rightNodeId=this.items[rightNodeIndex],rightTreeItemPosition=params.treeItemsPositions[rightNodeId]);var medianPoint=null;null==medianPoint&&null!=leftTreeItemPosition&&(medianPoint=new this.ConnectorDestination({id:this.getId(data),x:leftTreeItemPosition.actualPosition.horizontalCenter()+leftTreeItemPosition.rightMedianOffset,y:leftTreeItemPosition.horizontalConnectorsShift})),null==medianPoint&&null!=rightTreeItemPosition&&(medianPoint=new this.ConnectorDestination({id:this.getId(data),x:rightTreeItemPosition.actualPosition.horizontalCenter()-rightTreeItemPosition.leftMedianOffset,y:rightTreeItemPosition.horizontalConnectorsShift})),null!=leftTreeItemPosition&&(actualPosition=leftTreeItemPosition.actualPosition,params.transform.transformPoints(actualPosition.right(),medianPoint.y,medianPoint.x,medianPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),leftNodeId=params.nestedLayoutBottomConnectorIds[leftNodeId]||leftNodeId,data.graph.addEdge(leftNodeId,medianPoint.id,new this.ConnectorEdge(leftNodeId,medianPoint.id,polyline,leftNodeId,null,null,10,null,null,null,!0))}))),null!=rightTreeItemPosition&&(actualPosition=rightTreeItemPosition.actualPosition,params.transform.transformPoints(actualPosition.left(),medianPoint.y,medianPoint.x,medianPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),rightNodeId=params.nestedLayoutBottomConnectorIds[rightNodeId]||rightNodeId,data.graph.addEdge(rightNodeId,medianPoint.id,new this.ConnectorEdge(rightNodeId,medianPoint.id,polyline,rightNodeId,null,null,10,null,null,null,!0))}))),null!=prevMedianPoint&&null!=medianPoint&&params.transform.transformPoints(prevMedianPoint.x,prevMedianPoint.y,medianPoint.x,medianPoint.y,!0,this,(function(fromX,fromY,toX,toY){var polyline=new Polyline;polyline.addSegment(new MoveSegment(fromX,fromY)),polyline.addSegment(new LineSegment(toX,toY)),data.graph.addEdge(prevMedianPoint.id,medianPoint.id,new this.ConnectorEdge(prevMedianPoint.id,medianPoint.id,polyline,null,null,null,0,null,null,null,!0))})),null!=medianPoint&&(prevMedianPoint=medianPoint)}null!=prevMedianPoint&&forkItems.push(new this.ConnectorDestination({id:prevMedianPoint.id,bundleid:this.getId(data),x:prevMedianPoint.x,y:prevMedianPoint.y,isSquared:!0,visibility:enums.EE.Invisible}))}actualPosition=params.treeItemsPositions[this.matrixNodeId].actualPosition;var parentPoint=new this.ConnectorDestination({id:this.connectionId,x:actualPosition.horizontalCenter(),y:actualPosition.bottom()});this.traceFork(data,params,options,parentPoint,forkItems,!0,!0,0,options.showExtraArrows)},MatrixConnectorBundle.prototype.getNodeIndex=function(blockIndex,row,isLeft,isChild){var column,result=null;return isChild?(column=2*blockIndex+(isLeft?0:1),this.matrixWidth>column&&(result=row*this.matrixWidth+column)):(column=2*blockIndex+(isLeft?-1:0))>=0&&column<this.matrixWidth&&(result=row*this.matrixWidth+column),result},MatrixLayout.prototype.loop=function(thisArg,onItem){if(null!=onItem)for(var index=0,len=this.items.length;index<len;index+=1){var item=this.items[index];onItem.call(thisArg,item,0)}},MatrixLayout.prototype.Column=function(){this.depth=0,this.offset=0,this.leftPadding=0,this.rightPadding=0,this.layoutDirection=enums.hZ.Left},MatrixLayout.prototype.Row=function(){this.depth=0,this.offset=0,this.horizontalConnectorsDepth=0,this.minimalDepth=null,this.dotsDepth=null},MatrixLayout.prototype.getMatrixWidth=function(maximumColumnsInMatrix,len){return Math.min(maximumColumnsInMatrix,Math.ceil(Math.sqrt(len)))},MatrixLayout.prototype.measure=function(levelVisibility,isCursor,isSelected,treeItemTemplate,treeItemsPositions,options){var data={columns:[],rows:[]};this.measureColumns(data,this.items,treeItemsPositions,options),this.measureRows(data,this.items,treeItemsPositions,options),this.data=data;var treeItemPosition=new TreeItemPosition;return treeItemPosition.actualVisibility=enums.EE.Normal,treeItemPosition.actualSize=this.getLayoutSize(data),treeItemPosition},MatrixLayout.prototype.measureColumns=function(data,items,treeItemsPositions,options){var column,index,len,maximumColumns=this.getMatrixWidth(options.maximumColumnsInMatrix,items.length);for(index=0,len=items.length;index<len;index+=1){var treeItemPosition=treeItemsPositions[items[index].id],horizontalPadding=options.intervals[treeItemPosition.actualVisibility]/2,columnIndex=index%maximumColumns;null==(column=data.columns[columnIndex])&&((column=new this.Column).layoutDirection=columnIndex%2?enums.hZ.Right:enums.hZ.Left,data.columns[columnIndex]=column);var itemWidth=horizontalPadding+treeItemPosition.actualSize.width+horizontalPadding;column.depth=Math.max(column.depth,itemWidth)}var arrowTipLength=8*options.linesWidth,offset=0;for(index=0,len=data.columns.length;index<len;index+=1){if(column=data.columns[index],index%2==0)switch(options.arrowsDirection){case enums.zX.Parents:column.leftPadding=this.hideChildrenConnection?0:arrowTipLength,column.rightPadding=0;break;case enums.zX.Children:column.leftPadding=0,column.rightPadding=this.hideParentConnection?0:arrowTipLength}else switch(options.arrowsDirection){case enums.zX.Parents:column.leftPadding=0,column.rightPadding=this.hideChildrenConnection?0:arrowTipLength;break;case enums.zX.Children:column.leftPadding=this.hideParentConnection?0:arrowTipLength,column.rightPadding=0}column.offset=offset+column.leftPadding+column.depth/2,offset=column.offset+column.depth/2+column.rightPadding}},MatrixLayout.prototype.measureRows=function(data,items,treeItemsPositions,options){var index,len,row,maximumColumns=this.getMatrixWidth(options.maximumColumnsInMatrix,items.length);for(index=0,len=items.length;index<len;index+=1){var treeItemPosition=treeItemsPositions[items[index].id],rowIndex=Math.floor(index/maximumColumns),verticalPadding=options.shifts[treeItemPosition.actualVisibility]/2;switch(null==(row=data.rows[rowIndex])&&(row=new this.Row,data.rows[rowIndex]=row),row.depth=Math.max(row.depth,verticalPadding+treeItemPosition.actualSize.height+verticalPadding),treeItemPosition.actualVisibility){case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:row.dotsDepth=row.dotsDepth?Math.min(row.dotsDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height;break;default:row.minimalDepth=row.minimalDepth?Math.min(row.minimalDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height}}var offset=0;for(index=0,len=data.rows.length;index<len;index+=1)switch((row=data.rows[index]).offset=offset+row.depth/2,offset=row.offset+row.depth/2,null==row.minimalDepth&&(row.minimalDepth=row.depth),null!=row.dotsDepth&&row.dotsDepth>row.minimalDepth&&(row.minimalDepth=row.dotsDepth),options.verticalAlignment){case enums.Vn.Top:row.horizontalConnectorsDepth=row.minimalDepth/2;break;case enums.Vn.Middle:row.horizontalConnectorsDepth=row.depth/2;break;case enums.Vn.Bottom:row.horizontalConnectorsDepth=row.depth-row.minimalDepth/2}},MatrixLayout.prototype.getLayoutSize=function(data){return new Rect(0,0,Math.round(this.getLayoutWidth(data)),Math.round(this.getLayoutHeight(data)))},MatrixLayout.prototype.getLayoutWidth=function(data){var result=0,length=data.columns.length;if(length>0){var lastColumn=data.columns[length-1];result=lastColumn.offset+lastColumn.depth/2+lastColumn.rightPadding}return result},MatrixLayout.prototype.getLayoutHeight=function(data){var result=0,length=data.rows.length;if(length>0){var lastRow=data.rows[length-1];result=lastRow.offset+lastRow.depth/2}return result},MatrixLayout.prototype.arrange=function(thisArg,parentPosition,layoutDirection,treeItemsPositions,options,onItemPositioned){if(null!=onItemPositioned)for(var maximumColumns=this.getMatrixWidth(options.maximumColumnsInMatrix,this.items.length),index=0,len=this.items.length;index<len;index+=1){var treeItemId=this.items[index].id,columnIndex=index%maximumColumns,column=this.data.columns[columnIndex],rowIndex=Math.floor(index/maximumColumns),row=this.data.rows[rowIndex],treeItemPosition=treeItemsPositions[treeItemId],actualPosition=this.getItemPosition(treeItemPosition.actualVisibility,column,row,treeItemPosition.actualSize,options.verticalAlignment);actualPosition.translate(parentPosition.x,parentPosition.y),treeItemPosition={...treeItemPosition,actualPosition:actualPosition,horizontalConnectorsShift:parentPosition.y+row.offset-row.depth/2+row.horizontalConnectorsDepth,leftMedianOffset:column.depth/2+column.leftPadding,rightMedianOffset:column.depth/2+column.rightPadding,topConnectorShift:row.depth/2,bottomConnectorShift:row.depth/2},onItemPositioned.call(thisArg,treeItemId,treeItemPosition,column.layoutDirection)}},MatrixLayout.prototype.getItemPosition=function(visibility,column,row,size,verticalAlignment){var itemShift=0;switch(visibility){case enums.EE.Normal:switch(verticalAlignment){case enums.Vn.Top:itemShift=0;break;case enums.Vn.Middle:itemShift=(row.depth-size.height)/2;break;case enums.Vn.Bottom:itemShift=row.depth-size.height}break;case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:itemShift=row.horizontalConnectorsDepth-size.height/2}return new Rect(column.offset-size.width/2,row.offset-row.depth/2+itemShift,size.width,size.height)},HorizontalLayout.prototype.loop=function(thisArg,onItem){if(null!=onItem)for(var index=0,len=this.items.length;index<len;index+=1){var item=this.items[index];onItem.call(thisArg,item,0)}},HorizontalLayout.prototype.Column=function(){this.depth=0,this.offset=0,this.parentsPadding=0,this.childrenPadding=0},HorizontalLayout.prototype.Row=function(){this.depth=0,this.offset=0,this.minimalDepth=null,this.dotsDepth=null},HorizontalLayout.prototype.measure=function(levelVisibility,isCursor,isSelected,treeItemTemplate,treeItemsPositions,options){var data={columns:[],row:null};this.measureColumns(data,this.items,treeItemsPositions,options),this.measureRow(data,this.items,treeItemsPositions,options),this.data=data;var treeItemPosition=new TreeItemPosition;return treeItemPosition.actualVisibility=enums.EE.Normal,treeItemPosition.actualSize=this.getLayoutSize(data),treeItemPosition},HorizontalLayout.prototype.measureColumns=function(data,items,treeItemsPositions,options){for(var column,offset=0,arrowTipLength=8*options.linesWidth,index=0;index<items.length;index+=1){var treeItemPosition=treeItemsPositions[items[index].id];null==(column=data.columns[index])&&(column=new this.Column,data.columns[index]=column),column.depth=treeItemPosition.actualSize.width;var padding=options.intervals[treeItemPosition.actualVisibility]/2;switch(0!=index&&(column.parentsPadding=padding),index!=items.length-1&&(column.childrenPadding=padding),options.arrowsDirection){case enums.zX.Parents:index!=items.length-1&&(column.childrenPadding+=this.hideChildrenConnection?0:arrowTipLength);break;case enums.zX.Children:0!=index&&(column.parentsPadding+=this.hideParentConnection?0:arrowTipLength)}column.offset=offset+column.parentsPadding+column.depth/2,offset=column.offset+column.depth/2+column.childrenPadding}},HorizontalLayout.prototype.measureRow=function(data,items,treeItemsPositions,options){data.row=new this.Row;for(var row=data.row,index=0;index<items.length;index+=1){var treeItemPosition=treeItemsPositions[items[index].id],verticalPadding=options.shifts[treeItemPosition.actualVisibility]/2;switch(row.depth=Math.max(row.depth,verticalPadding+treeItemPosition.actualSize.height+verticalPadding),treeItemPosition.actualVisibility){case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:row.dotsDepth=row.dotsDepth?Math.min(row.dotsDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height;break;default:row.minimalDepth=row.minimalDepth?Math.min(row.minimalDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height}}row.offset=row.depth/2,null==row.minimalDepth&&(row.minimalDepth=row.depth),null!=row.dotsDepth&&row.dotsDepth>row.minimalDepth&&(row.minimalDepth=row.dotsDepth)},HorizontalLayout.prototype.getLayoutSize=function(data){var width=0,length=data.columns.length;if(length>0){var lastColumn=data.columns[length-1];width=lastColumn.offset+lastColumn.depth/2+lastColumn.childrenPadding}var height=data.row.offset+data.row.depth/2;return new Rect(0,0,Math.round(width),Math.round(height))},HorizontalLayout.prototype.arrange=function(thisArg,parentPosition,layoutDirection,treeItemsPositions,options,onItemPositioned){if(null!=onItemPositioned)for(var index=0;index<this.items.length;index+=1){var treeItemId=this.items[index].id,column=this.data.columns[index],row=this.data.row,treeItemPosition=treeItemsPositions[treeItemId],offset=column.offset;layoutDirection==enums.hZ.Left&&(offset=parentPosition.width-column.offset);var actualPosition=this.getItemPosition(treeItemPosition.actualVisibility,offset,row,treeItemPosition.actualSize,options);actualPosition.translate(parentPosition.x,parentPosition.y),treeItemPosition={...treeItemPosition,actualPosition:actualPosition,horizontalConnectorsShift:parentPosition.y+row.offset-row.depth/2+row.offset,leftMedianOffset:column.depth/2+(layoutDirection==enums.hZ.Left?column.childrenPadding:column.parentsPadding),rightMedianOffset:column.depth/2+(layoutDirection==enums.hZ.Left?column.parentsPadding:column.childrenPadding),topConnectorShift:row.depth/2,bottomConnectorShift:row.depth/2},onItemPositioned.call(thisArg,treeItemId,treeItemPosition)}},HorizontalLayout.prototype.getItemPosition=function(visibility,offset,row,size,options){return new Rect(offset-size.width/2,row.offset-size.height/2,size.width,size.height)},FamilyMatrixesExtractor.prototype=new BaseTransformer,FamilyMatrixesExtractor.prototype.extract=function(options,getConfig,logicalFamily,maximumId){var layouts={},nestedLayoutParentConnectorIds={},nestedLayoutBottomConnectorIds={},bundles=[];return logicalFamily.hasNodes()>0&&options.enableMatrixLayout&&logicalFamily.groupBy(this,Math.max(2,options.minimumMatrixSize),(function(parentIds,childIds,groups){for(var nodes=[],groupIndex=0;groupIndex<groups.length;groupIndex+=1){var group=groups[groupIndex];if(1==group.length)nodes.push(group[0].node);else{var id=maximumId+=1,id2=maximumId+=1,horizontalNode=new FamilyItem({id:id,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+id,description:"This is item used as aggregator of horizontally grouped nodes."},hideParentConnection:!0,hideChildrenConnection:!0});nestedLayoutParentConnectorIds[id]=group[0].id,nestedLayoutBottomConnectorIds[id]=group[group.length-1].id;for(var index=0;index<group.length-1;index+=1){var fromNode=group[index],toNode=group[index+1];bundles.push(new HorizontalConnectorBundle(toNode.id,fromNode.id))}for(index=0;index<group.length;index+=1){var node=group[index];logicalFamily.removeNode(node.id)}var ids=nodes.map((node=>node.id));if(parentIds.length>0?(logicalFamily.add(parentIds,id,horizontalNode),horizontalNode.hideParentConnection=!1):logicalFamily.add(null,id,horizontalNode),childIds.length>0){for(index=0;index<childIds.length;index+=1)logicalFamily.adopt([id],childIds[index]);horizontalNode.hideChildrenConnection=!1}layouts[id]=new HorizontalLayout(group.map((item=>item.node)),horizontalNode.hideParentConnection,horizontalNode.hideChildrenConnection),nodes.push(horizontalNode)}}id=maximumId+=1,id2=maximumId+=1;var matrixNode=new FamilyItem({id:id,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+id,description:"This is item used as aggregator of matrixed nodes."},hideParentConnection:!0,hideChildrenConnection:!0});nestedLayoutBottomConnectorIds[id]=id2;index=0;for(var len=nodes.length;index<len;index+=1){node=nodes[index];logicalFamily.removeNode(node.id)}ids=nodes.map((node=>node.id));if(parentIds.length>0?(logicalFamily.add(parentIds,id,matrixNode),matrixNode.hideParentConnection=!1,bundles.push(new MatrixConnectorBundle(!0,ids,id,id,this.getMatrixWidth(options.maximumColumnsInMatrix,ids.length)))):logicalFamily.add(null,id,matrixNode),childIds.length>0){for(index=0;index<childIds.length;index+=1)logicalFamily.adopt([id],childIds[index]);matrixNode.hideChildrenConnection=!1,bundles.push(new MatrixConnectorBundle(!1,ids,id,id2,this.getMatrixWidth(options.maximumColumnsInMatrix,ids.length)))}layouts[id]=new MatrixLayout(nodes,matrixNode.hideParentConnection,matrixNode.hideChildrenConnection)}),(function(items){for(var result=null,count=0,index=0;index<items.length;index+=1){var item=items[index],itemConfig=getConfig(item.id);if(null!=itemConfig){if(count>0){result=-1;break}if(count++,!itemConfig.addToMatrix){result=-1;break}result=itemConfig.matrixId}}return 0==count&&(result=-1),result})),{maximumId:maximumId,nestedLayoutParentConnectorIds:nestedLayoutParentConnectorIds,nestedLayoutBottomConnectorIds:nestedLayoutBottomConnectorIds,layouts:layouts,bundles:bundles}},FamilyMatrixesExtractor.prototype.getMatrixWidth=function(maximumColumnsInMatrix,len){return Math.min(maximumColumnsInMatrix,Math.ceil(Math.sqrt(len)))},FamilyNormalizer.prototype=new BaseTransformer,FamilyNormalizer.prototype.normalize=function(options,logicalFamily,maximumId){if(logicalFamily.hasNodes()>0){var toBeRemoved=[];logicalFamily.loop(this,(function(itemId,item){item.isLevelNeutral&&toBeRemoved.push(itemId)}));var logicalFamily2=logicalFamily;if(toBeRemoved.length>0){logicalFamily2=logicalFamily.clone();for(var index=0;index<toBeRemoved.length;index+=1){var itemId=toBeRemoved[index],parents=[];logicalFamily2.loopParents(this,itemId,(function(parentId,parent,levelIndex){if(0!=levelIndex)return!0;parents.push(parentId)}));var children=[];if(parents.length>0&&logicalFamily2.loopChildren(this,itemId,(function(childId,child,levelIndex){if(0!=levelIndex)return!0;children.push(childId)})),logicalFamily2.removeNode(itemId),children.length>0)for(var childIndex=0;childIndex<children.length;childIndex+=1){var childId=children[childIndex];logicalFamily2.adopt(parents,childId)}}}logicalFamily2.loopLevels(this,options.groupByType==enums.zX.Parents,(function(itemId,item,levelIndex){item.level=levelIndex})),options.alignBylevels?this.resortItemsBylevels(logicalFamily):logicalFamily.loopLevels(this,options.groupByType==enums.zX.Parents,(function(itemid,item,levelIndex){item.level=levelIndex})),this.debug&&this.validate(logicalFamily,!1),this.fillInItems(logicalFamily,(function(famItem){return new FamilyItem({id:maximumId+=1,levelGravity:enums.zX.Children,isVisible:!1,isActive:!1,itemConfig:{title:"extension #"+maximumId,description:"This is item used to fill gaps in levels."}})})),this.debug&&this.validate(logicalFamily,!0)}return maximumId},FamilyNormalizer.prototype.resortItemsBylevels=function(logicalFamily){var index,itemsAtLevel,itemsAtLevels=[],minimumLevel=null,maximumLevel=null;for(logicalFamily.loop(this,(function(famItemId,famItem){famItem.originalLevel=famItem.level,famItem.level=null,null!=famItem.originalLevel&&(itemsAtLevels[famItem.originalLevel]||(itemsAtLevels[famItem.originalLevel]={}),itemsAtLevels[famItem.originalLevel][famItemId]=famItem,minimumLevel=null!=minimumLevel?Math.min(famItem.originalLevel,minimumLevel):famItem.originalLevel,maximumLevel=null!=maximumLevel?Math.max(famItem.originalLevel,maximumLevel):famItem.originalLevel)})),index=minimumLevel;index<=maximumLevel;index+=1)itemsAtLevel=itemsAtLevels[index],this.setLevelsForItems(itemsAtLevel,logicalFamily);logicalFamily.loopTopo(this,(function(famItemId,famItem,position){var level;famItem.levelGravity==enums.zX.Parents&&(level=null,logicalFamily.loopParents(this,famItemId,(function(childItemId,childFamItem,levelIndex){return level=null==level?childFamItem.level+1:Math.max(childFamItem.level+1,level),logicalFamily.SKIP})),famItem.level=level||famItem.level)}))},FamilyNormalizer.prototype.setLevelsForItems=function(items,logicalFamily){var key,famItem,nextItems,level=0;for(key in items)items.hasOwnProperty(key)&&logicalFamily.loopParents(this,key,(function(parentid,parent,levelIndex){return level=Math.max(parent.level+1,level),logicalFamily.SKIP}));for(key in items)items.hasOwnProperty(key)&&((famItem=items[key]).level=level);for(;!isEmptyObject(items);){for(key in nextItems={},items)items.hasOwnProperty(key)&&(famItem=items[key],logicalFamily.loopChildren(this,key,(function(childid,child,levelIndex){return(null==child.originalLevel||child.isLevelNeutral)&&(child.level=null==child.level?famItem.level+1:Math.max(child.level,famItem.level+1),nextItems[childid]=child),logicalFamily.SKIP})));items=nextItems}},FamilyNormalizer.prototype.fillInItems=function(logicalFamily,createFamItem){var bundleItem;logicalFamily.loop(this,(function(famItemId,famItem){for(var itemsToBundle,extNeeded=!0;extNeeded;)extNeeded=!1,itemsToBundle=[],logicalFamily.loopParents(this,famItemId,(function(parentItemId,parentItem,level){return famItem.level-1>parentItem.level&&itemsToBundle.push(parentItemId),logicalFamily.SKIP})),itemsToBundle.length>1&&((bundleItem=createFamItem(famItem)).level=famItem.level-1,bundleItem.hideParentConnection=!1,bundleItem.hideChildrenConnection=!1,logicalFamily.bundleParents(famItemId,itemsToBundle,bundleItem.id,bundleItem),extNeeded=!0,famItemId=bundleItem.id,famItem=bundleItem)})),logicalFamily.loop(this,(function(famItemId,famItem){for(var itemsToBundle,extNeeded=!0,isSingleExtension=!0;extNeeded;)extNeeded=!1,itemsToBundle=[],logicalFamily.loopChildren(this,famItemId,(function(childItemId,childItem,level){return famItem.level+1<childItem.level?itemsToBundle.push(childItemId):isSingleExtension=!1,logicalFamily.SKIP})),itemsToBundle.length>1&&((bundleItem=createFamItem(famItem)).level=famItem.level+1,isSingleExtension&&(bundleItem.hideParentConnection=!1,bundleItem.hideChildrenConnection=!1),logicalFamily.bundleChildren(famItemId,itemsToBundle,bundleItem.id,bundleItem),extNeeded=!0,famItemId=bundleItem.id,famItem=bundleItem)})),logicalFamily.loop(this,(function(famItemId,famItem){for(var itemsToBundle,extNeeded=!0;extNeeded;)extNeeded=!1,itemsToBundle=[],logicalFamily.loopParents(this,famItemId,(function(parentItemId,parentItem,level){return famItem.level-1>parentItem.level&&itemsToBundle.push(parentItemId),logicalFamily.SKIP})),itemsToBundle.length>0&&((bundleItem=createFamItem(famItem)).level=famItem.level-1,bundleItem.hideParentConnection=!1,bundleItem.hideChildrenConnection=!1,logicalFamily.bundleParents(famItemId,itemsToBundle,bundleItem.id,bundleItem),extNeeded=!0,famItemId=bundleItem.id,famItem=bundleItem)}))},Slot.prototype.clone=function(itemid){var level,result=new Slot(itemid);for(level in this.left)this.left.hasOwnProperty(level)&&(result.left[level]=this.left[level]);for(level in this.right)this.right.hasOwnProperty(level)&&(result.right[level]=this.right[level]);for(level in this.crossings)this.crossings.hasOwnProperty(level)&&(result.crossings[level]=this.crossings[level]);return result.itemid=itemid,result},FamilyBalance.prototype.balance=function(params){var result={maximumId:null,treeLevels:TreeLevels(),bundles:[],connectorStacks:[]},data={orgTree:Tree(),maximumId:params.maximumId,orgPartners:{},itemByChildrenKey:{},minimumLevel:null,maximumLevel:null};this.createOrgTree(params,data);var currentLevelIndex,index=-1;return data.orgTree.loopLevels(this,(function(treeItemId,treeItem,levelIndex){var familyItem=params.logicalFamily.node(treeItemId);null!=familyItem&&(currentLevelIndex!==levelIndex&&(currentLevelIndex=levelIndex,index+=1),result.treeLevels.addItem(index,treeItemId,familyItem))})),this.recalcLevelsDepth(result.bundles,result.connectorStacks,result.treeLevels,params.logicalFamily),result.maximumId=data.maximumId,result},FamilyBalance.prototype.Family=function(id){this.id=null,this.familyPriority=1,this.childFamilies=[],this.items=[],this.links=[],this.backLinks=[],1==arguments.length&&(this.id=id)},FamilyBalance.prototype.FamLink=function(fromItem,toItem){this.fromItem=fromItem,this.toItem=toItem},FamilyBalance.prototype.createOrgTree=function(params,data){var index,len,index2,len2,familiesGraph,link,links,fromFamily,toFamily,sortedFamiliesHash,attachedFamilies,familyId,family,familyRootItem,toItem,rootItem,rootItems,bestRootItem,bestReference,spanningTree,extraGravities,grandChildren,orgItemRoot,famItemsExtracted,families2,sortedFamilies=[],families=[];if(params.logicalFamily.hasNodes()>0){if(famItemsExtracted={},familyId=0,families2=[],params.logicalFamily.loopRoots(this,(function(grandParentId,grandParent){family=new this.Family(familyId),this.extractOrgChart(grandParentId,params.logicalFamily,params.primaryParents,data.orgTree,data.orgPartners,data.itemByChildrenKey,famItemsExtracted,family),families.push(family),families2.push(family),familyId+=1})),families2.sort((function(a,b){var aLevel=a.items[0].level,bLevel=b.items[0].level;return aLevel!=bLevel?aLevel-bLevel:b.items.length-a.items.length})),sortedFamilies=[],sortedFamiliesHash={},families.length>0){for(familiesGraph=Graph(),index=0,len=families.length;index<len;index+=1)for(index2=0,len2=(family=families[index]).links.length;index2<len2;index2+=1)link=family.links[index2],(fromFamily=params.logicalFamily.node(link.fromItem).familyId)!=(toFamily=params.logicalFamily.node(link.toItem).familyId)&&(familiesGraph.addEdge(fromFamily,toFamily,{weight:0}),familiesGraph.edge(fromFamily,toFamily).weight+=1),families[toFamily].backLinks.push(new this.FamLink(link.toItem,link.fromItem));for(;sortedFamilies.length<families.length;)for(index=0,len=families2.length;index<len;index+=1)family=families2[index],sortedFamiliesHash.hasOwnProperty(family.id)||(null!=(spanningTree=familiesGraph.getSpanningTree(family.id,(function(edge){return-edge.weight}))).node(family.id)?(spanningTree.loopPostOrder(this,(function(nodeid,node,parentid,parent){var family=families[nodeid],parentFamily=families[parentid],children=[];null!=parentid&&(parentFamily.familyPriority=parentFamily.familyPriority+family.familyPriority),children=[],spanningTree.loopChildren(this,nodeid,(function(childid,child,index){children.push(childid)})),children.sort((function(a,b){return families[a].familyPriority-families[b].familyPriority})),spanningTree.arrangeChildren(nodeid,children)})),spanningTree.loopPreOrder(this,(function(familyid,node){sortedFamilies.push(familyid),sortedFamiliesHash[familyid]=!0}))):(sortedFamilies.push(family.id),sortedFamiliesHash[family.id]=!0))}for(data.maximumId+=1,orgItemRoot=new FamilyBalanceItem(data.maximumId,null,data.minimumLevel-1),data.orgTree.add(null,orgItemRoot.id,orgItemRoot),attachedFamilies={},index=0,len=sortedFamilies.length;index<len;index+=1){for(rootItems={},bestRootItem=orgItemRoot,bestReference=0,links=(family=families[sortedFamilies[index]]).links.concat(family.backLinks),index2=0;index2<links.length;index2+=1)link=links[index2],toItem=data.orgTree.node(link.toItem),data.orgTree.node(link.fromItem),!0===attachedFamilies[toItem.familyId]&&(familyRootItem=family.items[0],(rootItem=toItem).level>=familyRootItem.level&&data.orgTree.loopParents(this,rootItem.id,(function(nodeid,node){if(rootItem=node,node.level<familyRootItem.level)return!0})),rootItems.hasOwnProperty(rootItem.id)?rootItems[rootItem.id]+=1:rootItems[rootItem.id]=1,bestReference<rootItems[rootItem.id]&&(bestRootItem=rootItem,bestReference=rootItems[rootItem.id]));this.attachFamilyToOrgChart(data,bestRootItem,family),attachedFamilies[family.id]=!0}extraGravities=this.getExtraGravity(data),grandChildren=this.getGrandChildren(data),this.balanceOrgTree(data.orgTree,extraGravities,grandChildren,params.itemsPositions,params.itemsGroups)}},FamilyBalance.prototype.getGrandChildren=function(data){var result={};return data.orgTree.loopPostOrder(this,(function(itemId,orgItem,parentId,parent){var level;if(data.minimumLevel=null!=data.minimumLevel?Math.min(data.minimumLevel,orgItem.level):orgItem.level,data.maximumLevel=null!=data.maximumLevel?Math.max(data.maximumLevel,orgItem.level):orgItem.level,null!=parentId&&(result[parentId]||(result[parentId]={}),level=orgItem.level-1,result[parentId][level]?result[parentId][level]+=1:result[parentId][level]=1,null!=result[itemId]))for(level in result[itemId])result[itemId].hasOwnProperty(level)&&(result[parentId][level]?result[parentId][level]+=result[itemId][level]:result[parentId][level]=result[itemId][level])})),result},FamilyBalance.prototype.balanceOrgTree=function(orgTree,extraGravities,grandChildren,itemsPositions,itemsGroups){var index2,len2,index3,len3,extraGravity,childExtraGravities,sortedChildren,subChildren,subOrgItem,levelExtraGravities,sequence;orgTree.loopLevels(this,(function(parentOrgItemId,parentOrgItem,levelid){var toItemId,graph=Graph(),graphGravities={},firstOrgItem=null;if(sortedChildren=[],orgTree.loopChildren(this,parentOrgItem.id,(function(childOrgItemId,childOrgItem,index){var levelKey;if(null==firstOrgItem&&(firstOrgItem=childOrgItem),graphGravities[childOrgItem.id]={},extraGravities.hasOwnProperty(childOrgItem.id))for(levelKey in childExtraGravities=extraGravities[childOrgItem.id])if(childExtraGravities.hasOwnProperty(levelKey))for(levelExtraGravities=childExtraGravities[levelKey],graphGravities[childOrgItem.id][levelKey]={},index2=0,len2=levelExtraGravities.length;index2<len2;index2+=1)extraGravity=levelExtraGravities[index2],toItemId=extraGravity.commonParent==parentOrgItem.id?extraGravity.toParent:orgTree.node(extraGravity.fromParent).childIndex<orgTree.node(extraGravity.toParent).childIndex?"__right__":"__left__",childOrgItem.id!=toItemId&&(graph.addEdge(childOrgItem.id,toItemId,{weight:0}),graph.edge(childOrgItem.id,toItemId).weight+=1,null==graphGravities[childOrgItem.id][levelKey][toItemId]&&(graphGravities[childOrgItem.id][levelKey][toItemId]=0),graphGravities[childOrgItem.id][levelKey][toItemId]+=1);index>0&&graph.addEdge(childOrgItem.id,firstOrgItem.id,{weight:0})})),null!=firstOrgItem)for(sequence=[],graph.getTotalWeightGrowthSequence(this,(function(a){return a.weight}),(function(a){sequence.push(a)})),0===sequence.length&&(sequence=[firstOrgItem.id]),subChildren=this.balanceItems(sequence,"__left__","__right__",graphGravities,grandChildren,itemsPositions,itemsGroups),index3=0,len3=subChildren.length;index3<len3;index3+=1)(subOrgItem=orgTree.node(subChildren[index3])).childIndex=index3,sortedChildren.push(subOrgItem.id);orgTree.arrangeChildren(parentOrgItem.id,sortedChildren)}))},FamilyBalance.prototype.balanceItems=function(sequence,leftId,rightId,graphGravities,grandChildren,itemsPositions,itemsGroups){var index,startSlotKey,endSlotKey,key,slot,itemid,itemsToAdd,bestSlotKey,bestSlot,bestSlotValue,bestSlotDistance,bestSlotBalance,bestSlotCrossings,slotValue,slotDistance,slotBalance,slotCrossings,itemGrandChildren,itemSlot,itemSlotKey,level,levelGravities,toItemId,toItemSlot,userItemPosition,position,itemGroup,groupPositions,toItemSlotKey,result=[],slots=LinkedHashItems(),counter=0,positions={},items={};for(itemsToAdd=[leftId,null,rightId],index=0;index<itemsToAdd.length;index+=1)key=counter++,(slot=new Slot(itemid=itemsToAdd[index])).position=index,slots.add(key,slot),null!==itemid&&(items[itemid]=key);for(index=0;index<sequence.length;index+=1)if((itemid=sequence[index])!=leftId&&itemid!=rightId)for(level in bestSlotKey=null,bestSlot=null,bestSlotValue=null,bestSlotDistance=null,bestSlotBalance=null,bestSlotCrossings=null,startSlotKey=null,endSlotKey=null,itemsGroups.hasOwnProperty(itemid)&&(itemGroup=itemsGroups[itemid],positions.hasOwnProperty(itemGroup)&&(userItemPosition=itemsPositions[itemid],startSlotKey=(groupPositions=positions[itemGroup]).previousContext(userItemPosition),endSlotKey=groupPositions.nextContext(userItemPosition))),slots.iterate((function(slot,slotKey){var level,toItemId,levelGravities,toItemSlot;if(null==slot.itemId){for(level in itemGrandChildren=grandChildren[itemid],slotValue=0,slotDistance=0,slotBalance=0,slotCrossings=0,slot.crossings)slot.crossings.hasOwnProperty(level)&&(itemGrandChildren&&null!=itemGrandChildren[level]&&(slotValue+=slot.crossings[level]*itemGrandChildren[level]),slotCrossings+=slot.crossings[level]);for(level in graphGravities[itemid])if(graphGravities[itemid].hasOwnProperty(level))for(toItemId in levelGravities=graphGravities[itemid][level])levelGravities.hasOwnProperty(toItemId)&&items.hasOwnProperty(toItemId)&&null!=(toItemSlot=slots.item(items[toItemId]))&&(toItemSlot.position<slot.position?(slotValue+=(slot.left[level]||0)-(toItemSlot.left[level]||0),slotBalance+=Math.abs(toItemSlot.balance+1)):(slotValue+=(slot.right[level]||0)-(toItemSlot.right[level]||0),slotBalance+=Math.abs(toItemSlot.balance-1)),slotDistance+=Math.abs(toItemSlot.position-slot.position));(null==bestSlotValue||bestSlotValue>slotValue||bestSlotValue==slotValue&&(bestSlotDistance>slotDistance||bestSlotDistance==slotDistance&&(bestSlotBalance>slotBalance||bestSlotBalance==slotBalance&&bestSlotCrossings>slotCrossings)))&&(bestSlotKey=slotKey,bestSlotValue=slotValue,bestSlot=slot,bestSlotDistance=slotDistance,bestSlotBalance=slotBalance,bestSlotCrossings=slotCrossings)}}),startSlotKey,endSlotKey),slots.insertBefore(bestSlotKey,counter++,bestSlot.clone(null)),items[itemid]=counter,itemSlotKey=counter,itemSlot=bestSlot.clone(itemid),itemsPositions.hasOwnProperty(itemid)&&(itemGroup=itemsGroups[itemid],positions.hasOwnProperty(itemGroup)||(positions[itemGroup]=SortedList()),(groupPositions=positions[itemGroup]).add(itemsPositions[itemid],counter)),slots.insertBefore(bestSlotKey,counter++,itemSlot),itemSlot.position=0,position=0,slots.iterate((function(slot,slotKey){var level,itemGrandChildren;if(slotKey!=itemSlotKey){for(level in itemGrandChildren=grandChildren[itemid])itemGrandChildren.hasOwnProperty(level)&&(slot.left[level]?slot.left[level]+=itemGrandChildren[level]:slot.left[level]=itemGrandChildren[level]);position+=1,slot.position=position}}),itemSlotKey),position=0,slots.iterateBack((function(slot,slotKey){var level,itemGrandChildren;if(slotKey!=itemSlotKey){for(level in itemGrandChildren=grandChildren[itemid],grandChildren[itemid])grandChildren[itemid].hasOwnProperty(level)&&(slot.right[level]?slot.right[level]+=itemGrandChildren[level]:slot.right[level]=itemGrandChildren[level]);position-=1,slot.position=position}}),itemSlotKey),graphGravities[itemid])if(graphGravities[itemid].hasOwnProperty(level))for(toItemId in levelGravities=graphGravities[itemid][level])levelGravities.hasOwnProperty(toItemId)&&items.hasOwnProperty(toItemId)&&(toItemSlotKey=items[toItemId],null!=(toItemSlot=slots.item(toItemSlotKey))&&(toItemSlot.position<0?(toItemSlot.balance+=1,itemSlot.balance-=1,slots.iterateBack((function(slot,slotKey){slotKey!=itemSlotKey&&slotKey!=toItemSlotKey&&(slot.crossings[level]?slot.crossings[level]+=levelGravities[toItemId]:slot.crossings[level]=levelGravities[toItemId])}),itemSlotKey,toItemSlotKey)):(toItemSlot.balance-=1,itemSlot.balance+=1,slots.iterate((function(slot,slotKey){slotKey!=itemSlotKey&&slotKey!=toItemSlotKey&&(slot.crossings[level]?slot.crossings[level]+=levelGravities[toItemId]:slot.crossings[level]=levelGravities[toItemId])}),itemSlotKey,toItemSlotKey))));return slots.iterate((function(slot){var itemId=slot.itemId;null!=itemId&&itemId!=leftId&&itemId!=rightId&&result.push(itemId)})),result},FamilyBalance.prototype.ExtraGravity=function(level){this.commonParent=null,this.fromParent=null,this.toParent=null,this.level=level},FamilyBalance.prototype.getExtraGravity=function(data){var orgItemId,orgItem,index,len,extraPartners,extraPartner,result={};for(orgItemId in data.orgPartners)if(data.orgPartners.hasOwnProperty(orgItemId))for(orgItem=data.orgTree.node(orgItemId),index=0,len=(extraPartners=data.orgPartners[orgItemId]).length;index<len;index+=1)extraPartner=data.orgTree.node(extraPartners[index]),this.addExtraGravitiesForConnection(data.orgTree,result,extraPartner,orgItem);return result},FamilyBalance.prototype.addExtraGravitiesForConnection=function(orgTree,extraGravities,fromItem,toItem){var extraGravityFrom=new this.ExtraGravity(fromItem.level),extraGravityTo=new this.ExtraGravity(toItem.level);orgTree.zipUp(this,fromItem.id,toItem.id,(function(fromItemId,parentFromItemId,toItemId,parentToItemId){if(this.addExtraGravityForItem(extraGravities,fromItemId,extraGravityFrom),this.addExtraGravityForItem(extraGravities,toItemId,extraGravityTo),parentFromItemId==parentToItemId)return extraGravityFrom.commonParent=parentFromItemId,extraGravityFrom.fromParent=fromItemId,extraGravityFrom.toParent=toItemId,extraGravityTo.commonParent=parentFromItemId,extraGravityTo.fromParent=toItemId,extraGravityTo.toParent=fromItemId,!0}))},FamilyBalance.prototype.addExtraGravityForItem=function(extraGravities,id,extraGravity){extraGravities.hasOwnProperty(id)||(extraGravities[id]={}),null==extraGravities[id][extraGravity.level]&&(extraGravities[id][extraGravity.level]=[]),extraGravities[id][extraGravity.level].push(extraGravity)},FamilyBalance.prototype.attachFamilyToOrgChart=function(data,parent,family){var levelIndex,familyRoot=family.items[0],newOrgItem=null,rootItem=parent;for(levelIndex=parent.level+1;levelIndex<familyRoot.level;levelIndex+=1)data.maximumId+=1,newOrgItem=new FamilyBalanceItem(data.maximumId,null,levelIndex),data.orgTree.add(rootItem.id,newOrgItem.id,newOrgItem),family.items.push(newOrgItem),rootItem=newOrgItem;familyRoot.hideParentConnection=!0,data.orgTree.adopt(rootItem.id,familyRoot.id,familyRoot)},FamilyBalance.prototype.extractOrgChart=function(grandParentId,logicalFamily,primaryParentsPath,orgTree,orgPartners,itemByChildrenKey,famItemsExtracted,family){var index,len,tempChildren,childItem,newOrgItem,children=[],grandParent=logicalFamily.node(grandParentId);for(newOrgItem=new FamilyBalanceItem(grandParent.id,family.id,grandParent.level),orgTree.add(null,newOrgItem.id,newOrgItem),family.items.push(newOrgItem),famItemsExtracted[grandParent.id]=grandParent,grandParent.familyId=family.id,children=this.extractChildren(grandParent,logicalFamily,primaryParentsPath,orgTree,orgPartners,itemByChildrenKey,famItemsExtracted,family);children.length>0;){for(tempChildren=[],index=0,len=children.length;index<len;index+=1)childItem=children[index],tempChildren=tempChildren.concat(this.extractChildren(childItem,logicalFamily,primaryParentsPath,orgTree,orgPartners,itemByChildrenKey,famItemsExtracted,family));children=tempChildren}},FamilyBalance.prototype.extractChildren=function(parentItem,logicalFamily,primaryParentsPath,orgTree,orgPartners,itemByChildrenKey,famItemsExtracted,family){var newOrgItem,result=[],firstChild=null,partnerItem=null;if(1==logicalFamily.countChildren(parentItem.id)&&(firstChild=logicalFamily.firstChild(parentItem.id)),null!=itemByChildrenKey[firstChild])null==orgPartners[(partnerItem=itemByChildrenKey[firstChild]).id]&&(orgPartners[partnerItem.id]=[]),orgPartners[partnerItem.id].push(parentItem.id),family.links.push(new this.FamLink(parentItem.id,firstChild));else{if(null!=firstChild){if(primaryParentsPath.hasOwnProperty(firstChild)){var realParent=primaryParentsPath[firstChild];if(realParent!=parentItem.id)return null==orgPartners[realParent]&&(orgPartners[realParent]=[]),orgPartners[realParent].push(parentItem.id),family.links.push(new this.FamLink(parentItem.id,firstChild)),result}itemByChildrenKey[firstChild]=parentItem}logicalFamily.loopChildren(this,parentItem.id,(function(childid,childItem,levelIndex){if(famItemsExtracted[childItem.id])throw"Many to many relations should not exist at this stage";return result.push(childItem),newOrgItem=new FamilyBalanceItem(childItem.id,family.id,childItem.level),orgTree.add(parentItem.id,newOrgItem.id,newOrgItem),family.items.push(newOrgItem),famItemsExtracted[childItem.id]=!0,childItem.familyId=family.id,logicalFamily.SKIP}))}return result},FamilyBalance.prototype.recalcLevelsDepth=function(bundles,connectorStacks,treeLevels,logicalFamily){var index2,len2,index3,len3,itemPosition,bundle,bundlesToStack,startIndex,endIndex,stackSegments,processed={};treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var stacksSizes=new TreeLevelConnectorStackSize;if(connectorStacks[levelIndex]=stacksSizes,bundlesToStack=[],treeLevels.loopLevelItems(this,levelIndex,(function(itemid,familyItem,position){var fromItems=[],toItems=[],dotId=null;processed.hasOwnProperty(itemid)||(processed[itemid]=!0,familyItem.hideChildrenConnection?dotId=itemid:fromItems.push(itemid),logicalFamily.loopChildren(this,itemid,(function(childid,child,index){return logicalFamily.loopParents(this,childid,(function(parentid,parentItem){return processed.hasOwnProperty(parentid)||(processed[parentid]=!0,parentItem.hideChildrenConnection?dotId=parentid:fromItems.push(parentid)),logicalFamily.SKIP})),child.hideParentConnection?dotId=childid:toItems.push(childid),logicalFamily.SKIP})),(fromItems.length>1||toItems.length>0)&&(bundle=new VerticalConnectorBundle(fromItems,toItems,dotId),bundles.push(bundle),fromItems.length>1&&bundlesToStack.push(bundle)))})),bundlesToStack.length>0){for(stackSegments=Pile(),index2=0,len2=bundlesToStack.length;index2<len2;index2+=1){for(bundle=bundlesToStack[index2],startIndex=null,endIndex=null,index3=0,len3=bundle.fromItems.length;index3<len3;index3+=1)itemPosition=treeLevels.getItemPosition(bundle.fromItems[index3]),startIndex=null!=startIndex?Math.min(startIndex,itemPosition):itemPosition,endIndex=null!=endIndex?Math.max(endIndex,itemPosition):itemPosition;stackSegments.add(startIndex,endIndex,bundle)}stacksSizes.parentsStackSize=stackSegments.resolve(this,(function(from,to,bundle,offset,stackSize){bundle.fromOffset=offset+1,bundle.fromStackSize=stackSize}))}}))},UserDefinedPrimaryParents.prototype.getUserDefinedPrimaryParents=function(items,family){var index,len,result={},primaryParents={};for(index=0,len=items.length;index<len;index+=1){var item=items[index];null!=item.primaryParent&&(primaryParents[item.id]=item.primaryParent)}for(var nodeid in primaryParents)for(var primaryParent=primaryParents[nodeid],trace={},nodes=[nodeid];nodes.length>0;){var tempNodes=[];for(index=0,len=nodes.length;index<len;index+=1)nodeid=nodes[index],family.loopParents(this,nodeid,(function(parentid,parent){if(trace[parentid]=nodeid,parentid==primaryParent){for(;null!=trace[parentid];)result[trace[parentid]]=parentid,parentid=trace[parentid];return tempNodes=[],family.BREAK}return 0==parent.isVisible&&tempNodes.push(parentid),family.SKIP}));nodes=tempNodes}return result},FamilyLayout.prototype.loop=function(thisArg,onItem){if(null!=onItem){var zeroBasedLevelIndex=0;this.treeLevels.loopLevels(this,(function(levelIndex){this.treeLevels.loopLevelItems(this,levelIndex,(function(treeItemId,treeItem){onItem.call(thisArg,treeItem,zeroBasedLevelIndex)})),zeroBasedLevelIndex+=1}))}},FamilyLayout.prototype.measure=function(levelVisibility,isCursor,isSelected,treeItemTemplate,treeItemsPositions,options){this.treeLevelsPositions=[],this.treeLevels.loopLevels(this,(function(index,levelContext){var treeLevelPosition=new TreeLevelPosition;this.treeLevelsPositions.push(treeLevelPosition)})),this.setOffsets(this.treeLevels,treeItemsPositions,this.childLayoutsPositions,this.treeLevelsPositions,this.logicalFamily,options.intervals,options.padding),this.setLevelsDepth(this.treeLevels,treeItemsPositions,this.treeLevelsPositions,options.verticalAlignment),this.shiftLevels(this.treeLevelsPositions,options.padding.top,options.shifts,options.arrowsDirection,options.linesWidth,this.getConnectorsStacksSizes);var treeItemPosition=new TreeItemPosition;return treeItemPosition.actualVisibility=enums.EE.Normal,treeItemPosition.actualSize=this.getLayoutSize(this.treeLevels,treeItemsPositions,this.childLayoutsPositions,this.treeLevelsPositions,options.padding),treeItemPosition},FamilyLayout.prototype.getLayoutSize=function(treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions,padding){return new Rect(0,0,Math.round(this.getLayoutWidth(treeLevels,treeItemsPositions,childLayoutsPositions,padding)),Math.round(this.getLayoutHeight(treeLevelsPositions,padding)))},FamilyLayout.prototype.getLayoutWidth=function(treeLevels,treeItemsPositions,childLayoutsPositions,padding){var result=0;return treeLevels.loopLevels(this,(function(levelIndex,level){var levelLength=treeLevels.getLevelLength(levelIndex);if(levelLength>0){var itemId=treeLevels.getItemAtPosition(levelIndex,levelLength-1),treeItemPosition=treeItemsPositions[itemId],childLayoutPosition=childLayoutsPositions[itemId];result=Math.max(result,childLayoutPosition.offset+treeItemPosition.actualSize.width+padding.right)}})),result},FamilyLayout.prototype.getLayoutHeight=function(treeLevelsPositions,padding){return treeLevelsPositions[treeLevelsPositions.length-1].getNodesBottom()+padding.bottom},FamilyLayout.prototype.setLevelsDepth=function(treeLevels,treeItemsPositions,treeLevelsPositions,verticalAlignment){var minimalDepth,dotsDepth;treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var treeLevelPosition=treeLevelsPositions[levelIndex];switch(treeLevelPosition.shift=0,treeLevelPosition.depth=0,treeLevelPosition.actualVisibility=enums.EE.Invisible,minimalDepth=null,dotsDepth=null,treeLevels.loopLevelItems(this,levelIndex,(function(itemid,treeItem,position){var treeItemPosition=treeItemsPositions[itemid];switch(treeLevelPosition.depth=Math.max(treeLevelPosition.depth,treeItemPosition.actualSize.height),treeItemPosition.actualVisibility){case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:dotsDepth=dotsDepth?Math.min(dotsDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height;break;default:minimalDepth=minimalDepth?Math.min(minimalDepth,treeItemPosition.actualSize.height):treeItemPosition.actualSize.height}treeLevelPosition.actualVisibility=Math.min(treeLevelPosition.actualVisibility,treeItemPosition.actualVisibility)})),null==minimalDepth&&(minimalDepth=treeLevelPosition.depth),null!=dotsDepth&&dotsDepth>minimalDepth&&(minimalDepth=dotsDepth),verticalAlignment){case enums.Vn.Top:treeLevelPosition.horizontalConnectorsDepth=minimalDepth/2;break;case enums.Vn.Middle:treeLevelPosition.horizontalConnectorsDepth=treeLevelPosition.depth/2;break;case enums.Vn.Bottom:treeLevelPosition.horizontalConnectorsDepth=treeLevelPosition.depth-minimalDepth/2}}))},FamilyLayout.prototype.shiftLevels=function(treeLevelsPositions,shift,shifts,arrowsDirection,linesWidth,getConnectorsStacksSizes){var index,len,treeLevelPosition,parentsStackSize,childrenSpace=0,parentsSpace=0,arrowTipLength=8*linesWidth;switch(arrowsDirection){case enums.zX.Parents:childrenSpace=arrowTipLength,parentsSpace=0;break;case enums.zX.Children:childrenSpace=0,parentsSpace=arrowTipLength}for(index=0,len=treeLevelsPositions.length;index<len;index+=1)treeLevelPosition=treeLevelsPositions[index],parentsStackSize=getConnectorsStacksSizes(index).parentsStackSize,shift+=treeLevelPosition.setShift(shift,shifts[treeLevelPosition.actualVisibility],parentsSpace,childrenSpace,parentsStackSize)},FamilyLayout.prototype.setOffsets=function(treeLevels,treeItemsPositions,childLayoutsPositions,treeLevelsPositions,logicalFamily,intervals,padding){var index,len;for(index=0,len=treeLevelsPositions.length;index<len;index+=1)treeLevelsPositions[index].currentOffset=0;var familyAlignment=new FamilyAlignment(this,logicalFamily.getPlanarFamily(treeLevels),treeLevels,(function(nodeId,node){var treeItemPosition=treeItemsPositions[nodeId],treeItemPadding=intervals[treeItemPosition.actualVisibility]/2;return childLayoutsPositions[nodeId]=new FamilyLayout_ChildLayoutPosition(0,treeItemPadding,treeItemPadding),treeItemPadding+treeItemPosition.actualSize.width+treeItemPadding})),leftMargin=null;treeLevels.loopLevels(this,(function(levelIndex,level){var nodeId=treeLevels.getItemAtPosition(levelIndex,0);if(null!=nodeId){var treeItemPosition=treeItemsPositions[nodeId],nodeOffset=familyAlignment.getOffset(nodeId)-treeItemPosition.actualSize.width/2;leftMargin=null===leftMargin?nodeOffset:Math.min(leftMargin,nodeOffset)}})),treeLevels.loopLevels(this,(function(levelIndex,level){treeLevels.loopLevelItems(this,levelIndex,(function(nodeId,node,position){var treeItemPosition=treeItemsPositions[nodeId],nodeOffset=familyAlignment.getOffset(nodeId);childLayoutsPositions[nodeId].offset=nodeOffset-treeItemPosition.actualSize.width/2-leftMargin+padding.left}))}))},FamilyLayout.prototype.arrange=function(thisArg,position,layoutDirection,treeItemsPositions,options,onItemPositioned){var prevLevelPosition=null;null!=onItemPositioned&&this.treeLevels.loopLevels(this,(function(levelIndex,treeLevel){var treeLevelPosition=this.treeLevelsPositions[levelIndex];this.treeLevels.loopLevelItems(this,levelIndex,(function(itemId,treeItem,position){var treeItemPosition=treeItemsPositions[itemId],childLayoutPosition=this.childLayoutsPositions[itemId],result=this.getItemPosition(treeItemPosition.actualVisibility,childLayoutPosition.offset,treeItemPosition.actualSize,prevLevelPosition,treeLevelPosition,options.verticalAlignment);onItemPositioned.call(thisArg,itemId,{...treeItemPosition,...result})})),prevLevelPosition=treeLevelPosition}))},FamilyLayout.prototype.getItemPosition=function(visibility,offset,size,prevLevel,level,verticalAlignment){var itemShift=0;switch(visibility){case enums.EE.Normal:switch(verticalAlignment){case enums.Vn.Top:itemShift=0;break;case enums.Vn.Middle:itemShift=(level.depth-size.height)/2;break;case enums.Vn.Bottom:itemShift=level.depth-size.height}break;case enums.EE.Dot:case enums.EE.Line:case enums.EE.Invisible:itemShift=level.horizontalConnectorsDepth-size.height/2}return{actualPosition:new Rect(offset,level.shift+itemShift,size.width,size.height),horizontalConnectorsShift:level.shift+level.horizontalConnectorsDepth,topConnectorShift:null!=prevLevel?prevLevel.shift+prevLevel.connectorShift:null,topConnectorInterval:null!=prevLevel?prevLevel.levelSpace/2:null,bottomConnectorShift:level.shift+level.connectorShift,bottomConnectorInterval:level.levelSpace/2}},PdfGraphics.prototype.clean=function(){for(;this.saveCounter;)this.saveCounter--,this._doc.restore()},PdfGraphics.prototype.resize=function(name,width,height){var placeholder=this.m_placeholders[name];placeholder||((placeholder=new Placeholder(name)).size=new Size(0,0),placeholder.rect=new Rect(0,0,0,0),this.m_placeholders[name]=placeholder),placeholder.size=new Size(width,height),placeholder.rect=new Rect(placeholder.rect.x,placeholder.rect.y,width,height)},PdfGraphics.prototype.position=function(name,left,top,width,height){this.resize(name,width,height);var placeholder=this.m_placeholders[name];placeholder.rect.x=left,placeholder.rect.y=top},PdfGraphics.prototype.begin=function(){},PdfGraphics.prototype.end=function(){},PdfGraphics.prototype.reset=function(arg0,arg1){},PdfGraphics.prototype.activate=function(name,layer){this.m_placeholders[name]||this.resize(name,0,0),this.m_activePlaceholder=this.m_placeholders[name];for(var{x:x,y:y}=this.m_activePlaceholder.rect;this.saveCounter;)this.saveCounter--,this._doc.restore();return this._doc.save(),this.saveCounter++,this._doc.translate(x,y),this.m_activePlaceholder},PdfGraphics.prototype.text=function(x,y,width,height,label,orientation,horizontalAlignment,verticalAlignment,attr){},PdfGraphics.prototype.polylinesBuffer=function(buffer){buffer.loop(this,(function(polyline){polyline.length()>0&&this.polyline(polyline)}))},PdfGraphics.prototype.polyline=function(polylineData){this.m_activePlaceholder;var step,cornerRadius,attr=polylineData.paletteItem.toAttr(),doc=this._doc;if(doc.save(),polylineData.loop(this,(function(segment){switch(segment.segmentType){case enums.vZ.Move:doc.moveTo(Math.round(segment.x)+.5,Math.round(segment.y)+.5);break;case enums.vZ.Line:doc.lineTo(Math.round(segment.x)+.5,Math.round(segment.y)+.5);break;case enums.vZ.Dot:segment.width==segment.height&&segment.width/2<=segment.cornerRadius?doc.roundedRect(Math.round(segment.x)+.5,Math.round(segment.y)+.5,segment.width,segment.height,Math.min(segment.width,segment.height)/2):0===segment.cornerRadius?(doc.moveTo(Math.round(segment.x)+.5,Math.round(segment.y)+.5),doc.lineTo(Math.round(segment.x+segment.width)+.5,Math.round(segment.y)+.5),doc.lineTo(Math.round(segment.x+segment.width)+.5,Math.round(segment.y+segment.height)+.5),doc.lineTo(Math.round(segment.x)+.5,Math.round(segment.y+segment.height)+.5),doc.lineTo(Math.round(segment.x)+.5,Math.round(segment.y)+.5)):(cornerRadius=Math.min(segment.cornerRadius,Math.min(segment.width/2,segment.height/2)),doc.roundedRect(Math.round(segment.x)+.5,Math.round(segment.y)+.5,segment.width,segment.height,cornerRadius));break;case enums.vZ.QuadraticArc:doc.quadraticCurveTo(Math.round(segment.cpX)+.5,Math.round(segment.cpY)+.5,Math.round(segment.x)+.5,Math.round(segment.y)+.5);break;case enums.vZ.CubicArc:doc.bezierCurveTo(Math.round(segment.cpX1)+.5,Math.round(segment.cpY1)+.5,Math.round(segment.cpX2)+.5,Math.round(segment.cpY2)+.5,Math.round(segment.x)+.5,Math.round(segment.y)+.5)}})),doc.lineJoin("round"),null!=attr.lineType)switch(step=Math.round(attr.lineWidth)||1,attr.lineType){case enums.SP.Solid:break;case enums.SP.Dotted:doc.dash(step,2*step);break;case enums.SP.Dashed:doc.dash(5*step,3*step)}void 0!==attr.lineWidth&&void 0!==attr.fillColor?doc.lineWidth(attr.lineWidth).fillColor(attr.fillColor,attr.opacity).strokeColor(attr.borderColor).fillAndStroke():void 0!==attr.lineWidth?doc.lineWidth(attr.lineWidth).stroke(attr.borderColor):void 0!==attr.fillColor&&doc.fillColor(attr.fillColor,attr.opacity),doc.restore()},PdfGraphics.prototype.rightAngleLine=function(fromX,fromY,toX,toY,attr){},PdfGraphics.prototype.template=function(x,y,width,height,contentx,contenty,contentWidth,contentHeight,template,hashCode,onRenderTemplate,uiHash,attr){var gap=0;null!==attr&&void 0!==attr.borderWidth&&(gap=this.getPxSize(attr.borderWidth));var position=new Rect(x+contentx,y+contenty,contentWidth-gap,contentHeight-gap);null==uiHash&&(uiHash=new RenderEventArgs),null!==onRenderTemplate&&onRenderTemplate(this._doc,position,uiHash)},PdfGraphics.prototype.getPxSize=function(value,base){var result=value;return"string"==typeof value&&(result=value.indexOf("pt")>0?96*parseInt(value,10)/72:value.indexOf("%")>0?parseFloat(value)/100*base:parseInt(value,10)),result}},"./node_modules/basicprimitivesreact/dist/esm/BaseDiagram.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(__webpack_require__("./node_modules/react/index.js")),_propTypes=_interopRequireDefault(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_Graphics=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Graphics.js")),_Templates=__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var BaseDiagram=function(_Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(BaseDiagram,_Component);var _super=_createSuper(BaseDiagram);function BaseDiagram(props,TaskManagerFactory,EventArgs){var _this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BaseDiagram),(_this=_super.call(this,props)).TaskManagerFactory=TaskManagerFactory,_this.EventArgs=EventArgs;var config=props.config,centerOnCursor=props.centerOnCursor,highlightItem=config.highlightItem,cursorItem=config.cursorItem,selectedItems=config.selectedItems;_this.state={config:config,viewportSize:{width:0,height:0},contentPosition:{x:0,y:0},centerOnCursor:centerOnCursor,highlightItem:highlightItem,cursorItem:cursorItem,selectedItems:(selectedItems||[]).slice()};var viewportSize=_this.state.viewportSize;return _this.onRefreshViewport=_this.onRefreshViewport.bind(_assertThisInitialized(_this)),_this.onSizeChanged=_this.onSizeChanged.bind(_assertThisInitialized(_this)),_this.onScroll=_this.onScroll.bind(_assertThisInitialized(_this)),_this.onMouseMove=_this.onMouseMove.bind(_assertThisInitialized(_this)),_this.onClick=_this.onClick.bind(_assertThisInitialized(_this)),_this.onCheckboxChange=_this.onCheckboxChange.bind(_assertThisInitialized(_this)),_this.onKeyDown=_this.onKeyDown.bind(_assertThisInitialized(_this)),_this.onFrameClick=_this.onFrameClick.bind(_assertThisInitialized(_this)),_this.onFrameMouseMove=_this.onFrameMouseMove.bind(_assertThisInitialized(_this)),_this.getOptions=_this.getOptions.bind(_assertThisInitialized(_this)),_this.getGraphics=_this.getGraphics.bind(_assertThisInitialized(_this)),_this.getLayout=_this.getLayout.bind(_assertThisInitialized(_this)),_this.setLayout=_this.setLayout.bind(_assertThisInitialized(_this)),_this.getEventArgs=_this.getEventArgs.bind(_assertThisInitialized(_this)),_this.centerOnCursor=_this.centerOnCursor.bind(_assertThisInitialized(_this)),_this.onItemRender=_this.onItemRender.bind(_assertThisInitialized(_this)),_this.onHighlightRender=_this.onHighlightRender.bind(_assertThisInitialized(_this)),_this.onCursorRender=_this.onCursorRender.bind(_assertThisInitialized(_this)),_this.controlPanelRef=_react.default.createRef(),_this.frameMousePanelRef=_react.default.createRef(),_this.framePlaceholderRef=_react.default.createRef(),_this.titlesMousePanelRef=_react.default.createRef(),_this.titlesPlaceholderRef=_react.default.createRef(),_this.scrollPanelRef=_react.default.createRef(),_this.mousePanelRef=_react.default.createRef(),_this.placeholderRef=_react.default.createRef(),_this.calloutPlaceholderRef=_react.default.createRef(),_this.layoutOptions={},_this.templatesHash={},_this.graphics=new _Graphics.default(viewportSize),_this.templates={AnnotationLabelTemplate:_Templates.AnnotationLabelTemplate,ButtonsTemplate:_Templates.ButtonsTemplate,CheckBoxTemplate:_Templates.CheckBoxTemplate,CursorTemplate:_Templates.CursorTemplate,DotHighlightTemplate:_Templates.DotHighlightTemplate,GroupTitleTemplate:_Templates.GroupTitleTemplate,HighlightTemplate:_Templates.HighlightTemplate,ItemTemplate:_Templates.ItemTemplate,UserTemplate:_Templates.UserTemplate,CustomRenderTemplate:_Templates.CustomRenderTemplate,LabelAnnotationTemplate:_Templates.LabelAnnotationTemplate,LevelTitleTemplate:_Templates.LevelTitleTemplate,LevelBackgroundTemplate:_Templates.LevelBackgroundTemplate},_this.tasks=TaskManagerFactory(_this.getOptions,_this.getGraphics,_this.getLayout,_this.setLayout,_this.templates),_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(BaseDiagram,[{key:"componentDidMount",value:function componentDidMount(){__webpack_require__("./node_modules/resize-observer-polyfill/dist/ResizeObserver.global.js"),this.observer=new ResizeObserver(this.onSizeChanged),this.observer.observe(this.controlPanelRef.current),this.centerOnCursor(),this.fixPixelAlignment()}},{key:"componentWillUnmount",value:function componentWillUnmount(){clearTimeout(this.timer),this.timer=null,this.observer.disconnect()}},{key:"componentDidUpdate",value:function componentDidUpdate(){this.centerOnCursor()}},{key:"centerOnCursor",value:function centerOnCursor(){var centerOnCursor=this.state.centerOnCursor;if(centerOnCursor){var placeholderOffset=this.tasks.getTask("CenterOnCursorTask").getPlaceholderOffset(),scrollLeft=placeholderOffset.x,scrollTop=placeholderOffset.y;this.scrollPanelRef.current.scrollLeft=scrollLeft,this.scrollPanelRef.current.scrollTop=scrollTop}}},{key:"fixPixelAlignment",value:function fixPixelAlignment(){var current=this.controlPanelRef.current,pixelAlignmentFix=(0,_basicprimitives.getFixOfPixelAlignment)(current);current.style.marginLeft=pixelAlignmentFix.width+"px",current.style.marginTop=pixelAlignmentFix.height+"px"}},{key:"onSizeChanged",value:function onSizeChanged(){var _getInnerSize=(0,_basicprimitives.getInnerSize)(this.controlPanelRef.current),width=_getInnerSize.width,height=_getInnerSize.height;this.setState({viewportSize:{width:width,height:height},centerOnCursor:!0})}},{key:"onScroll",value:function onScroll(){null==this.timer&&(this.timer=setTimeout(this.onRefreshViewport,200))}},{key:"onRefreshViewport",value:function onRefreshViewport(){clearTimeout(this.timer),this.timer=null;var _this$scrollPanelRef$=this.scrollPanelRef.current,scrollTop=_this$scrollPanelRef$.scrollTop,scrollLeft=_this$scrollPanelRef$.scrollLeft;this.setState({contentPosition:{x:Math.floor(scrollLeft),y:Math.floor(scrollTop)},centerOnCursor:!1})}},{key:"onFrameMouseMove",value:function onFrameMouseMove(event){var placeholderOffset=(0,_basicprimitives.getElementOffset)(this.frameMousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,projectItemsToFrameTask=this.tasks.getTask("ProjectItemsToFrameTask"),highlightItemOptionTask=this.tasks.getTask("HighlightItemOptionTask");if(highlightItemOptionTask.hasHighlightEnabled()){var itemId=projectItemsToFrameTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());this.setHighlightItem(event,itemId)}}},{key:"onFrameClick",value:function onFrameClick(event){var placeholderOffset=(0,_basicprimitives.getElementOffset)(this.frameMousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,projectItemsToFrameTask=this.tasks.getTask("ProjectItemsToFrameTask"),cursorItemOptionTask=this.tasks.getTask("CursorItemOptionTask"),highlightItemOptionTask=this.tasks.getTask("HighlightItemOptionTask"),newCursorItemId=projectItemsToFrameTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());null!==newCursorItemId&&cursorItemOptionTask.hasCursorEnabled()&&(this.setCursorItem(event,newCursorItemId),this.controlPanelRef.current.focus())}},{key:"onMouseMove",value:function onMouseMove(event){var placeholderOffset=(0,_basicprimitives.getElementOffset)(this.mousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,createTransformTask=this.tasks.getTask("CreateTransformTask"),highlightItemOptionTask=this.tasks.getTask("HighlightItemOptionTask");if(highlightItemOptionTask.hasHighlightEnabled()){var itemId=createTransformTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());this.setHighlightItem(event,itemId)}}},{key:"getEventArgs",value:function getEventArgs(oldTreeItemId,newTreeItemId,name){var itemPosition,offset,panelOffset,result=new this.EventArgs,combinedContextsTask=this.tasks.getTask("CombinedContextsTask"),alignDiagramTask=this.tasks.getTask("AlignDiagramTask"),oldItemConfig=combinedContextsTask.getConfig(oldTreeItemId),newItemConfig=combinedContextsTask.getConfig(newTreeItemId);return oldItemConfig&&null!=oldItemConfig.id&&(result.oldContext=oldItemConfig),newItemConfig&&null!=newItemConfig.id&&(result.context=newItemConfig,null!==newItemConfig.parent&&(result.parentItem=combinedContextsTask.getConfig(newItemConfig.parent)),panelOffset=(0,_basicprimitives.getElementOffset)(this.mousePanelRef.current),offset=(0,_basicprimitives.getElementOffset)(this.scrollPanelRef.current),itemPosition=alignDiagramTask.getItemPosition(newTreeItemId),result.position=new _basicprimitives.Rect(itemPosition.actualPosition).translate(panelOffset.left,panelOffset.top).translate(-offset.left,-offset.top)),null!=name&&(result.name=name),result}},{key:"setHighlightItem",value:function setHighlightItem(event,newHighlightItemId){var eventArgs,cancel=!1,_this$props=this.props,onHighlightChanging=_this$props.onHighlightChanging,onHighlightChanged=_this$props.onHighlightChanged,highlightItem=this.state.highlightItem;newHighlightItemId!==highlightItem&&(eventArgs=this.getEventArgs(highlightItem,newHighlightItemId),null!=onHighlightChanging?onHighlightChanging(event,eventArgs)||(cancel=!0,this.setState({highlightItem:newHighlightItemId})):this.setState({highlightItem:newHighlightItemId}),cancel||null!=onHighlightChanged&&onHighlightChanged(event,eventArgs))}},{key:"setCursorItem",value:function setCursorItem(event,newCursorItemId){var eventArgs,cancel=!1,_this$props2=this.props,onCursorChanging=_this$props2.onCursorChanging,onCursorChanged=_this$props2.onCursorChanged,cursorItem=this.state.cursorItem;newCursorItemId!==cursorItem&&(eventArgs=this.getEventArgs(cursorItem,newCursorItemId),null!=onCursorChanging?onCursorChanging(event,eventArgs)||(cancel=!0,this.setState({cursorItem:newCursorItemId,centerOnCursor:!0})):this.setState({cursorItem:newCursorItemId,centerOnCursor:!0}),cancel||null!=onCursorChanged&&onCursorChanged(event,eventArgs))}},{key:"onClick",value:function onClick(event){var target,placeholderOffset=(0,_basicprimitives.getElementOffset)(this.mousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,createTransformTask=this.tasks.getTask("CreateTransformTask"),cursorItemOptionTask=this.tasks.getTask("CursorItemOptionTask"),highlightItemOptionTask=this.tasks.getTask("HighlightItemOptionTask"),newCursorItemId=createTransformTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());target=event.target,null!==newCursorItemId&&("checkbox"===target.getAttribute("name")||"selectiontext"===target.getAttribute("name")||cursorItemOptionTask.hasCursorEnabled()&&(this.setCursorItem(event,newCursorItemId),this.controlPanelRef.current.focus()))}},{key:"onCheckboxChange",value:function onCheckboxChange(event){var _this$props3=this.props,onSelectionChanging=_this$props3.onSelectionChanging,onSelectionChanged=_this$props3.onSelectionChanged,selectedItems=this.state.selectedItems,newSelectedItems=[],itemid=event.target.getAttribute("data-id"),checked=event.target.checked,cancel=!1;null!=itemid&&(newSelectedItems=checked?[].concat(_toConsumableArray(selectedItems),[itemid]):selectedItems.filter((function(id){return id!=itemid})),null!=onSelectionChanging&&(cancel=onSelectionChanging(event,selectedItems,newSelectedItems)),cancel||(this.setState({selectedItems:newSelectedItems}),null!=onSelectionChanged&&onSelectionChanged(event,selectedItems,newSelectedItems)))}},{key:"onKeyDown",value:function onKeyDown(event){var newNavigationItem,accepted,highlightItemTask=this.tasks.getTask("HighlightItemTask"),highlightItemOptionTask=this.tasks.getTask("HighlightItemOptionTask"),cursorItemTask=this.tasks.getTask("CursorItemTask"),cursorItemOptionTask=this.tasks.getTask("CursorItemOptionTask"),alignDiagramTask=this.tasks.getTask("AlignDiagramTask"),transform=this.tasks.getTask("CreateTransformTask").getTransform(),navigationItem=null,direction=null;if(highlightItemOptionTask.hasHighlightEnabled()&&cursorItemOptionTask.hasCursorEnabled()?null===(navigationItem=highlightItemTask.getHighlightTreeItem())&&(navigationItem=cursorItemTask.getCursorTreeItem()):highlightItemOptionTask.hasHighlightEnabled()?navigationItem=highlightItemTask.getHighlightTreeItem():cursorItemOptionTask.hasCursorEnabled()&&(navigationItem=cursorItemTask.getCursorTreeItem()),null!=navigationItem){switch(event.which){case 13:cursorItemOptionTask.hasCursorEnabled()&&(this.setCursorItem(event,navigationItem),event.preventDefault(),this.controlPanelRef.current.focus());break;case 40:direction=_basicprimitives.OrientationType.Bottom;break;case 38:direction=_basicprimitives.OrientationType.Top;break;case 37:direction=_basicprimitives.OrientationType.Left;break;case 39:direction=_basicprimitives.OrientationType.Right}if(null!=direction){for(accepted=!1;!accepted;)accepted=!0,direction=transform.getOrientation(direction),null!=(newNavigationItem=alignDiagramTask.getNextItem(navigationItem,direction))&&(event.preventDefault(),highlightItemOptionTask.hasHighlightEnabled()?this.setHighlightItem(event,newNavigationItem):cursorItemOptionTask.hasCursorEnabled()&&this.setCursorItem(event,newNavigationItem));this.controlPanelRef.current.focus()}}}},{key:"onItemRender",value:function onItemRender(data){var templateName=data.templateName;return this.templatesHash[templateName].onItemRender(data)}},{key:"onHighlightRender",value:function onHighlightRender(data){var templateName=data.templateName;return this.templatesHash[templateName].onHighlightRender(data)}},{key:"onCursorRender",value:function onCursorRender(data){var templateName=data.templateName;return this.templatesHash[templateName].onCursorRender(data)}},{key:"getOptions",value:function getOptions(){var config=this.props.config,templates=config.templates||[],effectiveTemplates=templates.map((function(template){var onItemRender=template.onItemRender,onHighlightRender=template.onHighlightRender,onCursorRender=template.onCursorRender;return _objectSpread(_objectSpread({},template),{},{itemTemplate:onItemRender?"<p>This template is not being used in React</p>":null,highlightTemplate:onHighlightRender?"<p>This template is not being used in React</p>":null,cursorTemplate:onCursorRender?"<p>This template is not being used in React</p>":null})}));this.templatesHash=templates.reduce((function(agg,template){return agg[template.name]=template,agg}),{});var _this$state=this.state,highlightItem=_this$state.highlightItem,cursorItem=_this$state.cursorItem,selectedItems=_this$state.selectedItems;return _objectSpread(_objectSpread({},config),{},{templates:effectiveTemplates,highlightItem:highlightItem,cursorItem:cursorItem,selectedItems:selectedItems,onItemRender:this.onItemRender,onCursorRender:this.onCursorRender,onHighlightRender:this.onHighlightRender})}},{key:"getGraphics",value:function getGraphics(){return this.graphics}},{key:"getLayout",value:function getLayout(){var _this$state2=this.state,centerOnCursor=_this$state2.centerOnCursor,viewportSize=_this$state2.viewportSize,contentPosition=_this$state2.contentPosition;return{forceCenterOnCursor:centerOnCursor,scrollPanelSize:new _basicprimitives.Size(viewportSize),placeholderOffset:new _basicprimitives.Point(contentPosition)}}},{key:"setLayout",value:function setLayout(layoutOptions){var autoSize=layoutOptions.autoSize,controlSize=layoutOptions.controlSize,scale=layoutOptions.scale,frameMousePanelRect=layoutOptions.frameMousePanelRect,framePlaceholderSize=layoutOptions.framePlaceholderSize,titlesMousePanelRect=layoutOptions.titlesMousePanelRect,titlesPlaceholderSize=layoutOptions.titlesPlaceholderSize,scrollPanelRect=layoutOptions.scrollPanelRect,mousePanelSize=layoutOptions.mousePanelSize,placeholderSize=layoutOptions.placeholderSize;this.layoutOptions={autoSize:autoSize,controlSize:new _basicprimitives.Size(controlSize),scale:scale,frameMousePanelRect:new _basicprimitives.Rect(frameMousePanelRect),framePlaceholderSize:new _basicprimitives.Size(framePlaceholderSize),titlesMousePanelRect:new _basicprimitives.Rect(titlesMousePanelRect),titlesPlaceholderSize:new _basicprimitives.Size(titlesPlaceholderSize),scrollPanelRect:new _basicprimitives.Rect(scrollPanelRect),mousePanelSize:new _basicprimitives.Size(mousePanelSize),placeholderSize:new _basicprimitives.Size(placeholderSize)}}},{key:"render",value:function render(){var graphics=this.graphics;this.tasks.process("OptionsTask",null,!1);var _this$graphics$placeh=this.graphics.placeholders,placeholder=_this$graphics$placeh.placeholder,calloutplaceholder=_this$graphics$placeh.calloutplaceholder,frameplaceholder=_this$graphics$placeh.frameplaceholder,titlesplaceholder=_this$graphics$placeh.titlesplaceholder,placeholderRectCSS=placeholder.rect.getCSS(),_this$layoutOptions=this.layoutOptions,autoSize=_this$layoutOptions.autoSize,controlSize=_this$layoutOptions.controlSize,scale=_this$layoutOptions.scale,frameMousePanelRect=_this$layoutOptions.frameMousePanelRect,titlesMousePanelRect=_this$layoutOptions.titlesMousePanelRect,scrollPanelRect=_this$layoutOptions.scrollPanelRect,mousePanelSize=_this$layoutOptions.mousePanelSize,scaletext="scale("+scale+","+scale+")";return _react.default.createElement(_react.default.Fragment,null,_react.default.createElement("div",{ref:this.controlPanelRef,onKeyDown:this.onKeyDown,style:_objectSpread({position:"relative",overflow:"hidden",top:"0px",left:"0px",width:"100%",height:"100%",padding:"0px",marginBottom:"0px",marginRight:"0px"},autoSize?controlSize.getCSS():{}),tabIndex:"0"},frameplaceholder&&_react.default.createElement("div",{ref:this.frameMousePanelRef,onMouseMove:this.onFrameMouseMove,onClick:this.onFrameClick,style:_objectSpread({position:"absolute",overflow:"hidden"},frameMousePanelRect.getCSS())},_react.default.createElement("div",{ref:this.framePlaceholderRef,style:_objectSpread(_objectSpread({},frameplaceholder.rect.getCSS()),{},{position:"absolute",overflow:"hidden",transformOrigin:"0 0",transform:scaletext,msTransform:scaletext,WebkitTransform:scaletext,OTransform:scaletext,MozTransform:scaletext})},graphics.map(this,"frameplaceholder",(function(layerKey,elements){return _react.default.createElement("div",{key:layerKey,style:{position:"absolute",overflow:"visible",left:"0px",top:"0px"}},elements)})))),titlesplaceholder&&_react.default.createElement("div",{ref:this.titlesMousePanelRef,onMouseMove:this.onFrameMouseMove,onClick:this.onFrameClick,style:_objectSpread({position:"absolute",overflow:"hidden"},titlesMousePanelRect.getCSS())},_react.default.createElement("div",{ref:this.titlesPlaceholderRef,style:_objectSpread(_objectSpread({},titlesplaceholder.rect.getCSS()),{},{position:"absolute",overflow:"hidden",transformOrigin:"0 0",transform:scaletext,msTransform:scaletext,WebkitTransform:scaletext,OTransform:scaletext,MozTransform:scaletext})},graphics.map(this,"titlesplaceholder",(function(layerKey,elements){return _react.default.createElement("div",{key:layerKey,style:{position:"absolute",overflow:"visible",left:"0px",top:"0px"}},elements)})))),_react.default.createElement("div",{ref:this.scrollPanelRef,onScroll:this.onScroll,style:_objectSpread(_objectSpread({position:"absolute",overflow:"auto",WebkitOverflowScrolling:"touch"},scrollPanelRect.getCSS()),{},{border:scrollPanelRect.x>0?"1px dotted #dddddd":""})},_react.default.createElement("div",{ref:this.mousePanelRef,onMouseMove:this.onMouseMove,onClick:this.onClick,onChange:this.onCheckboxChange,style:_objectSpread({position:"absolute",overflow:"hidden"},mousePanelSize.getCSS())},_react.default.createElement("div",{ref:this.placeholderRef,style:_objectSpread(_objectSpread({},placeholderRectCSS),{},{position:"absolute",overflow:"hidden",transformOrigin:"0 0",transform:scaletext,msTransform:scaletext,WebkitTransform:scaletext,OTransform:scaletext,MozTransform:scaletext})},graphics.map(this,"placeholder",(function(layerKey,elements){return _react.default.createElement("div",{key:layerKey,style:{position:"absolute",overflow:"visible",left:"0px",top:"0px"}},elements)})),calloutplaceholder&&_react.default.createElement("div",{key:"Callout",ref:this.calloutPlaceholderRef,style:{position:"absolute",overflow:"visible",left:calloutplaceholder.rect.x+"px",top:calloutplaceholder.rect.y+"px"}},graphics.map(this,"calloutplaceholder",(function(layerKey,elements){return _react.default.createElement("div",{key:layerKey,style:{position:"absolute",overflow:"visible"}},elements)}))))))))}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(nextProps,state){var nextConfig=nextProps.config,centerOnCursor=nextProps.centerOnCursor;return state.config!==nextConfig?{config:nextConfig,highlightItem:nextConfig.highlightItem,cursorItem:nextConfig.cursorItem,selectedItems:(nextConfig.selectedItems||[]).slice(),centerOnCursor:centerOnCursor}:null}}]),BaseDiagram}(_react.Component);_defineProperty(BaseDiagram,"propTypes",{centerOnCursor:_propTypes.default.bool,onHighlightChanging:_propTypes.default.func,onHighlightChanged:_propTypes.default.func,onCursorChanging:_propTypes.default.func,onCursorChanged:_propTypes.default.func,onSelectionChanging:_propTypes.default.func,onSelectionChanged:_propTypes.default.func}),_defineProperty(BaseDiagram,"defaultProps",{centerOnCursor:!0,onHighlightChanging:null,onHighlightChanged:null,onCursorChanging:null,onCursorChanged:null,onSelectionChanging:null,onSelectionChanged:null});var _default=BaseDiagram;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/FamDiagram.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_BaseDiagram2=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/BaseDiagram.js")),_FamConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/FamConfigShape.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var FamDiagram=function(_BaseDiagram){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(FamDiagram,_BaseDiagram);var _super=_createSuper(FamDiagram);function FamDiagram(props){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FamDiagram),_super.call(this,props,_basicprimitives.FamTaskManagerFactory,_basicprimitives.FamEventArgs)}return FamDiagram}(_BaseDiagram2.default);!function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(FamDiagram,"propTypes",{config:_FamConfigShape.default.isRequired});var _default=FamDiagram;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Graphics.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_RotatedText=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/RotatedText.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var Placeholder=function Placeholder(name){_classCallCheck(this,Placeholder),this.name=name,this.layers={},this.activeLayer=null,this.size=null,this.rect=null,this.hasGraphics=!0,this.isVisible=!0},Layer=function(){function Layer(name){_classCallCheck(this,Layer),this.name=name,this.items=[],this.polylines=[]}return _createClass(Layer,[{key:"reset",value:function reset(){this.items=[],this.polylines=[]}}]),Layer}(),_default=function(){function Graphics(size){_classCallCheck(this,Graphics),this.placeholders={},this.activePlaceholder=null,this.size=size,this.hasGraphics=!0,this.names=Object.keys(_basicprimitives.Layers).reduce((function(agg,key){return agg[_basicprimitives.Layers[key]]=key,agg}),[]),this.orientations=["Horizontal","RotateLeft","RotateRight","Horizontal"],this.horizontalAlignments=["center","left","right"],this.verticalAlignments=["top","middle","bottom"]}return _createClass(Graphics,[{key:"clean",value:function clean(){this.placeholders={},this.activePlaceholder=null}},{key:"resize",value:function resize(name,width,height){this.activatePlaceholder(name),this.resizePlaceholder(this.activePlaceholder,0,0,width,height)}},{key:"position",value:function position(name,left,top,width,height){this.activatePlaceholder(name),this.resizePlaceholder(this.activePlaceholder,left,top,width,height)}},{key:"show",value:function show(name){var placeholder=this.placeholders[name];null!=placeholder&&(placeholder.isVisible=!0)}},{key:"hide",value:function hide(name){var placeholder=this.placeholders[name];null!=placeholder&&(placeholder.isVisible=!1)}},{key:"resizePlaceholder",value:function resizePlaceholder(placeholder,left,top,width,height){placeholder.size=new _basicprimitives.Size(width,height),placeholder.rect=new _basicprimitives.Rect(left,top,width,height)}},{key:"reset",value:function reset(placeholderName,layerKey){var layerName=this.names[layerKey],placeholder=this.placeholders[placeholderName];if(null!=placeholder){var layer=placeholder.layers[layerName];null!=layer&&layer.reset()}}},{key:"activate",value:function activate(placeholderName,layerKey){return this.activatePlaceholder(placeholderName),this.activateLayer(layerKey),this.activePlaceholder}},{key:"activatePlaceholder",value:function activatePlaceholder(name){var placeholder=this.placeholders[name];void 0===placeholder&&((placeholder=new Placeholder(name)).size=this.size,placeholder.rect=new _basicprimitives.Rect(0,0,placeholder.size.width,placeholder.size.height),this.placeholders[name]=placeholder),this.activePlaceholder=placeholder}},{key:"activateLayer",value:function activateLayer(value){var name=this.names[value],layer=this.activePlaceholder.layers[name];void 0===layer&&(layer=new Layer(name),this.activePlaceholder.layers[name]=layer),this.activePlaceholder.activeLayer=layer}},{key:"map",value:function map(thisArg,placeholderName,onLayer){var result=[];if(null!=onLayer){var placeholder=this.placeholders[placeholderName];this.names.forEach((function(layerKey){var layer=placeholder.layers[layerKey];null!=layer&&result.push(onLayer.call(thisArg,layerKey,_react.default.createElement(_react.default.Fragment,null,layer.polylines.length>0?_react.default.createElement("svg",{height:placeholder.size.height,width:placeholder.size.width},layer.polylines):null,layer.items)))}))}return result}},{key:"text",value:function text(x,y,width,height,label,orientation,horizontalAlignment,verticalAlignment,attr){this.activePlaceholder.activeLayer.items.push(_react.default.createElement("div",{key:this.activePlaceholder.activeLayer.items.length,style:_objectSpread(_objectSpread({position:"absolute",overflow:"visible",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box"},attr),{},{top:y+"px",left:x+"px"})},_react.default.createElement(_RotatedText.default,{width:width,height:height,orientation:this.orientations[orientation],horizontalAlignment:this.horizontalAlignments[horizontalAlignment],verticalAlignment:this.verticalAlignments[verticalAlignment]},label)))}},{key:"polylinesBuffer",value:function polylinesBuffer(buffer){buffer.loop(this,(function(polyline){polyline.length()>0&&this.polyline(polyline)}))}},{key:"polyline",value:function polyline(polylineData){var data,step,radius,cornerRadius,attr=polylineData.paletteItem.toAttr(),style={};if(void 0!==attr.fillColor?(style.fill=attr.fillColor,style.fillOpacity=attr.opacity):style.fillOpacity=0,void 0!==attr.lineWidth&&void 0!==attr.borderColor?(style.stroke=attr.borderColor,style.strokeWidth=attr.lineWidth,void 0!==attr.opacity?style.strokeOpacity=attr.opacity:style.strokeOpacity=1):(style.stroke="transparent",style.strokeWidth=0),null!=attr.lineType)switch(step=Math.round(attr.lineWidth)||1,attr.lineType){case _basicprimitives.LineType.Dotted:style.strokeDasharray=step+","+step;break;case _basicprimitives.LineType.Dashed:style.strokeDasharray=5*step+","+3*step;break;case _basicprimitives.LineType.Solid:default:style.strokeDasharray=""}data="",polylineData.loop(this,(function(segment){switch(segment.segmentType){case _basicprimitives.SegmentType.Move:data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5);break;case _basicprimitives.SegmentType.Line:data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5);break;case _basicprimitives.SegmentType.QuadraticArc:data+="Q"+(Math.round(segment.cpX)+.5)+" "+(Math.round(segment.cpY)+.5)+" "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5);break;case _basicprimitives.SegmentType.Dot:segment.width===segment.height&&segment.width/2<=segment.cornerRadius?(radius=segment.width/2,data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+segment.height/2+.5),data+="A"+radius+" "+radius+" 0 0 0 "+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y)+segment.height/2+.5),data+="A"+radius+" "+radius+" 0 0 0 "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+segment.height/2+.5)):0===segment.cornerRadius?(data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5),data+="L"+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y)+.5),data+="L"+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5)):(cornerRadius=Math.min(segment.cornerRadius,Math.min(segment.width/2,segment.height/2)),data+="M"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+cornerRadius)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x+cornerRadius)+.5)+" "+(Math.round(segment.y)+.5),data+="L"+(Math.round(segment.x+segment.width-cornerRadius)+.5)+" "+(Math.round(segment.y)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y+cornerRadius)+.5),data+="L"+(Math.round(segment.x+segment.width)+.5)+" "+(Math.round(segment.y+segment.height-cornerRadius)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x+segment.width-cornerRadius)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="L"+(Math.round(segment.x+cornerRadius)+.5)+" "+(Math.round(segment.y+segment.height)+.5),data+="A"+Math.round(cornerRadius)+" "+Math.round(cornerRadius)+" 0 0 1 "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+segment.height-cornerRadius)+.5),data+="L"+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y+cornerRadius)+.5));break;case _basicprimitives.SegmentType.CubicArc:data+="C"+(Math.round(segment.cpX1)+.5)+" "+(Math.round(segment.cpY1)+.5)+" "+(Math.round(segment.cpX2)+.5)+" "+(Math.round(segment.cpY2)+.5)+" "+(Math.round(segment.x)+.5)+" "+(Math.round(segment.y)+.5)}})),this.activePlaceholder.activeLayer.polylines.push(_react.default.createElement("path",{key:this.activePlaceholder.activeLayer.polylines.length,d:data,style:style}))}},{key:"template",value:function template(x,y,width,height,contentx,contenty,contentWidth,contentHeight,_template,hashCode,onRenderTemplate,uiHash,attr){var style,left=x+contentx,top=y+contenty,templateWidth=contentWidth,templateHeight=contentHeight;style=_objectSpread({width:templateWidth+"px",height:templateHeight+"px",top:top+"px",left:left+"px",position:"absolute",padding:"0px",margin:"0px"},attr),null==uiHash&&(uiHash={}),uiHash.x=left,uiHash.y=top,uiHash.width=templateWidth,uiHash.height=templateHeight,null!==onRenderTemplate&&this.activePlaceholder.activeLayer.items.push(_react.default.createElement("div",{key:this.activePlaceholder.activeLayer.items.length,style:_objectSpread({position:"absolute",overflow:"visible",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box"},style)},onRenderTemplate(uiHash)))}},{key:"getPxSize",value:function getPxSize(value,base){var result=value;return"string"==typeof value&&(result=value.indexOf("pt")>0?96*parseInt(value,10)/72:value.indexOf("%")>0?parseFloat(value)/100*base:parseInt(value,10)),result}}]),Graphics}();exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/OrgDiagram.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_BaseDiagram2=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/BaseDiagram.js")),_OrgConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/OrgConfigShape.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var OrgDiagram=function(_BaseDiagram){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(OrgDiagram,_BaseDiagram);var _super=_createSuper(OrgDiagram);function OrgDiagram(props){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,OrgDiagram),_super.call(this,props,_basicprimitives.OrgTaskManagerFactory,_basicprimitives.OrgEventArgs)}return OrgDiagram}(_BaseDiagram2.default);!function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(OrgDiagram,"propTypes",{config:_OrgConfigShape.default.isRequired});var _default=OrgDiagram;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/BackgroundAnnotationConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({annotationType:_propTypes.default.oneOf([_basicprimitives.AnnotationType.Background]),items:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),includeChildren:_propTypes.default.bool,zOrderType:_propTypes.default.oneOf(Object.values(_basicprimitives.ZOrderType)),offset:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),lineWidth:_propTypes.default.number,opacity:_propTypes.default.number,borderColor:_propTypes.default.string,fillColor:_propTypes.default.string,lineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),selectItems:_propTypes.default.bool});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/ConnectorAnnotationConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({annotationType:_propTypes.default.oneOf([_basicprimitives.AnnotationType.Connector]),zOrderType:_propTypes.default.oneOf(Object.values(_basicprimitives.ZOrderType)),fromItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),toItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),connectorShapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ConnectorShapeType)),connectorPlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.ConnectorPlacementType)),labelPlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.ConnectorLabelPlacementType)),offset:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired})]),lineWidth:_propTypes.default.number,color:_propTypes.default.string,lineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),selectItems:_propTypes.default.bool,label:_propTypes.default.any,size:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired})});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/FamConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=_interopRequireDefault(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_FamItemConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/FamItemConfigShape.js")),_TemplateConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/TemplateConfigShape.js")),_BackgroundAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/BackgroundAnnotationConfigShape.js")),_ConnectorAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/ConnectorAnnotationConfigShape.js")),_HighlightPathAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/HighlightPathAnnotationConfigShape.js")),_ShapeAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/ShapeAnnotationConfigShape.js")),_LevelAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/LevelAnnotationConfigShape.js")),_LabelAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/LabelAnnotationConfigShape.js")),_PaletteItemConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/PaletteItemConfigShape.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _default=_propTypes.default.shape({navigationMode:_propTypes.default.oneOf(Object.values(_basicprimitives.NavigationMode)),pageFitMode:_propTypes.default.oneOf(Object.values(_basicprimitives.PageFitMode)),minimalVisibility:_propTypes.default.oneOf(Object.values(_basicprimitives.Visibility)),minimumVisibleLevels:_propTypes.default.number,orientationType:_propTypes.default.oneOf(Object.values(_basicprimitives.OrientationType)),verticalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.VerticalAlignmentType)),arrowsDirection:_propTypes.default.oneOf(Object.values(_basicprimitives.GroupByType)),showExtraArrows:_propTypes.default.bool,extraArrowsMinimumSpace:_propTypes.default.number,groupByType:_propTypes.default.oneOf(Object.values(_basicprimitives.GroupByType)),alignBylevels:_propTypes.default.bool,enableMatrixLayout:_propTypes.default.bool,minimumMatrixSize:_propTypes.default.number,maximumColumnsInMatrix:_propTypes.default.number,hideGrandParentsConnectors:_propTypes.default.bool,bevelSize:_propTypes.default.number,elbowType:_propTypes.default.oneOf(Object.values(_basicprimitives.ElbowType)),elbowDotSize:_propTypes.default.number,emptyDiagramMessage:_propTypes.default.string,items:_propTypes.default.arrayOf(_FamItemConfigShape.default),annotations:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_BackgroundAnnotationConfigShape.default,_ConnectorAnnotationConfigShape.default,_HighlightPathAnnotationConfigShape.default,_ShapeAnnotationConfigShape.default,_LabelAnnotationConfigShape.default,_LevelAnnotationConfigShape.default])),cursorItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),highlightItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),highlightGravityRadius:_propTypes.default.number,selectedItems:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),hasSelectorCheckbox:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),selectCheckBoxLabel:_propTypes.default.string,selectionPathMode:_propTypes.default.oneOf(Object.values(_basicprimitives.SelectionPathMode)),neighboursSelectionMode:_propTypes.default.oneOf(Object.values(_basicprimitives.NeighboursSelectionMode)),templates:_propTypes.default.arrayOf(_TemplateConfigShape.default),defaultTemplateName:_propTypes.default.string,defaultLabelAnnotationTemplate:_propTypes.default.string,hasButtons:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),onButtonsRender:_propTypes.default.func,normalLevelShift:_propTypes.default.number,dotLevelShift:_propTypes.default.number,lineLevelShift:_propTypes.default.number,normalItemsInterval:_propTypes.default.number,dotItemsInterval:_propTypes.default.number,lineItemsInterval:_propTypes.default.number,cousinsIntervalMultiplier:_propTypes.default.number,itemTitleFirstFontColor:_propTypes.default.string,itemTitleSecondFontColor:_propTypes.default.string,minimizedItemShapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ShapeType)),linesColor:_propTypes.default.string,linesWidth:_propTypes.default.number,linesType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),showNeigboursConnectorsHighlighted:_propTypes.default.bool,highlightLinesColor:_propTypes.default.string,highlightLinesWidth:_propTypes.default.number,highlightLinesType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),linesPalette:_propTypes.default.arrayOf(_PaletteItemConfigShape.default),calloutMaximumVisibility:_propTypes.default.oneOf(Object.values(_basicprimitives.Visibility)),showCallout:_propTypes.default.bool,calloutPlacementOffset:_propTypes.default.number,defaultCalloutTemplateName:_propTypes.default.string,calloutfillColor:_propTypes.default.string,calloutBorderColor:_propTypes.default.string,calloutOffset:_propTypes.default.number,calloutCornerRadius:_propTypes.default.number,calloutPointerWidth:_propTypes.default.string,calloutLineWidth:_propTypes.default.number,calloutOpacity:_propTypes.default.number,buttonsPanelSize:_propTypes.default.number,groupTitlePanelSize:_propTypes.default.number,checkBoxPanelSize:_propTypes.default.number,groupTitlePlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.AdviserPlacementType)),groupTitleOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),groupTitleVerticalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.VerticalAlignmentType)),groupTitleHorizontalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.HorizontalAlignmentType)),groupTitleFontSize:_propTypes.default.string,groupTitleFontFamily:_propTypes.default.string,groupTitleColor:_propTypes.default.string,groupTitleFontWeight:_propTypes.default.string,groupTitleFontStyle:_propTypes.default.string,onGroupTitleRender:_propTypes.default.func,levelTitlePanelSize:_propTypes.default.number,levelTitlePlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.AdviserPlacementType)),levelTitlePlaceInside:_propTypes.default.bool,levelTitleOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),levelTitleVerticalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.VerticalAlignmentType)),levelTitleHorizontalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.HorizontalAlignmentType)),levelTitleFontSize:_propTypes.default.string,levelTitleFontFamily:_propTypes.default.string,levelTitleFontColor:_propTypes.default.string,levelTitleColor:_propTypes.default.string,levelTitleFontWeight:_propTypes.default.string,levelTitleFontStyle:_propTypes.default.string,onLevelTitleRender:_propTypes.default.func,onLevelBackgroundRender:_propTypes.default.func,distance:_propTypes.default.number,scale:_propTypes.default.number,minimumScale:_propTypes.default.number,maximumScale:_propTypes.default.number,showLabels:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),labelSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),labelOffset:_propTypes.default.number,labelOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),labelPlacement:_propTypes.default.oneOf(Object.values(_basicprimitives.PlacementType)),labelFontSize:_propTypes.default.string,labelFontFamily:_propTypes.default.string,labelColor:_propTypes.default.string,labelFontWeight:_propTypes.default.string,labelFontStyle:_propTypes.default.string,enablePanning:_propTypes.default.bool,autoSizeMinimum:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),autoSizeMaximum:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),showFrame:_propTypes.default.bool,frameInnerPadding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),frameOuterPadding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),padding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired})});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/FamItemConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({id:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]).isRequired,parents:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),title:_propTypes.default.string,description:_propTypes.default.string,image:_propTypes.default.string,context:_propTypes.default.any,itemTitleColor:_propTypes.default.string,minimizedItemShapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ShapeType)),groupTitle:_propTypes.default.string,groupTitleColor:_propTypes.default.string,isActive:_propTypes.default.bool,hasSelectorCheckbox:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),hasButtons:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),templateName:_propTypes.default.string,showCallout:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),calloutTemplateName:_propTypes.default.string,label:_propTypes.default.string,showLabel:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),labelSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),labelOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),labelPlacement:_propTypes.default.oneOf(Object.values(_basicprimitives.PlacementType)),primaryParent:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),relativeItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),position:_propTypes.default.number,placementType:_propTypes.default.oneOf(Object.values(_basicprimitives.AdviserPlacementType)),matrixId:_propTypes.default.string,addToMatrix:_propTypes.default.bool});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/HighlightPathAnnotationConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({annotationType:_propTypes.default.oneOf([_basicprimitives.AnnotationType.HighlightPath]),zOrderType:_propTypes.default.oneOf(Object.values(_basicprimitives.ZOrderType)),items:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),lineWidth:_propTypes.default.number,color:_propTypes.default.string,lineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),opacity:_propTypes.default.number,showArrows:_propTypes.default.bool,selectItems:_propTypes.default.bool});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/LabelAnnotationConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({annotationType:_propTypes.default.oneOf([_basicprimitives.AnnotationType.Label]),fromItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]).isRequired,toItems:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])).isRequired,title:_propTypes.default.any,itemTitleColor:_propTypes.default.string,templateName:_propTypes.default.string});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/LevelAnnotationConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({annotationType:_propTypes.default.oneOf([_basicprimitives.AnnotationType.Level]),levels:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),title:_propTypes.default.any,titleFontColor:_propTypes.default.string,titleColor:_propTypes.default.string,offset:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),lineWidth:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),opacity:_propTypes.default.number,borderColor:_propTypes.default.string,fillColor:_propTypes.default.string,lineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType))});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/OrgConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=_interopRequireDefault(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_OrgItemConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/OrgItemConfigShape.js")),_TemplateConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/TemplateConfigShape.js")),_BackgroundAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/BackgroundAnnotationConfigShape.js")),_ConnectorAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/ConnectorAnnotationConfigShape.js")),_HighlightPathAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/HighlightPathAnnotationConfigShape.js")),_ShapeAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/ShapeAnnotationConfigShape.js")),_LevelAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/LevelAnnotationConfigShape.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _default=_propTypes.default.shape({navigationMode:_propTypes.default.oneOf(Object.values(_basicprimitives.NavigationMode)),pageFitMode:_propTypes.default.oneOf(Object.values(_basicprimitives.PageFitMode)),alignBranches:_propTypes.default.bool,minimalVisibility:_propTypes.default.oneOf(Object.values(_basicprimitives.Visibility)),minimumVisibleLevels:_propTypes.default.number,orientationType:_propTypes.default.oneOf(Object.values(_basicprimitives.OrientationType)),horizontalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.HorizontalAlignmentType)),verticalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.VerticalAlignmentType)),arrowsDirection:_propTypes.default.oneOf(Object.values(_basicprimitives.GroupByType)),showExtraArrows:_propTypes.default.bool,extraArrowsMinimumSpace:_propTypes.default.number,showHorizontalArrows:_propTypes.default.bool,connectorType:_propTypes.default.oneOf(Object.values(_basicprimitives.ConnectorType)),bevelSize:_propTypes.default.number,elbowType:_propTypes.default.oneOf(Object.values(_basicprimitives.ElbowType)),elbowDotSize:_propTypes.default.number,emptyDiagramMessage:_propTypes.default.string,items:_propTypes.default.arrayOf(_OrgItemConfigShape.default),annotations:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_BackgroundAnnotationConfigShape.default,_ConnectorAnnotationConfigShape.default,_HighlightPathAnnotationConfigShape.default,_ShapeAnnotationConfigShape.default,_LevelAnnotationConfigShape.default])),cursorItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),highlightItem:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),highlightGravityRadius:_propTypes.default.number,selectedItems:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),hasSelectorCheckbox:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),selectCheckBoxLabel:_propTypes.default.string,selectionPathMode:_propTypes.default.oneOf(Object.values(_basicprimitives.SelectionPathMode)),templates:_propTypes.default.arrayOf(_TemplateConfigShape.default),defaultTemplateName:_propTypes.default.string,hasButtons:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),onButtonsRender:_propTypes.default.func,normalLevelShift:_propTypes.default.number,dotLevelShift:_propTypes.default.number,lineLevelShift:_propTypes.default.number,normalItemsInterval:_propTypes.default.number,dotItemsInterval:_propTypes.default.number,lineItemsInterval:_propTypes.default.number,cousinsIntervalMultiplier:_propTypes.default.number,itemTitleFirstFontColor:_propTypes.default.string,itemTitleSecondFontColor:_propTypes.default.string,minimizedItemShapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ShapeType)),linesColor:_propTypes.default.string,linesWidth:_propTypes.default.number,linesType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),highlightLinesColor:_propTypes.default.string,highlightLinesWidth:_propTypes.default.number,highlightLinesType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),calloutMaximumVisibility:_propTypes.default.oneOf(Object.values(_basicprimitives.Visibility)),showCallout:_propTypes.default.bool,calloutPlacementOffset:_propTypes.default.number,defaultCalloutTemplateName:_propTypes.default.string,calloutfillColor:_propTypes.default.string,calloutBorderColor:_propTypes.default.string,calloutOffset:_propTypes.default.number,calloutCornerRadius:_propTypes.default.number,calloutPointerWidth:_propTypes.default.string,calloutLineWidth:_propTypes.default.number,calloutOpacity:_propTypes.default.number,childrenPlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.ChildrenPlacementType)),leavesPlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.ChildrenPlacementType)),placeAssistantsAboveChildren:_propTypes.default.bool,placeAdvisersAboveChildren:_propTypes.default.bool,maximumColumnsInMatrix:_propTypes.default.number,buttonsPanelSize:_propTypes.default.number,groupTitlePanelSize:_propTypes.default.number,checkBoxPanelSize:_propTypes.default.number,groupTitlePlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.AdviserPlacementType)),groupTitleOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),groupTitleVerticalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.VerticalAlignmentType)),groupTitleHorizontalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.HorizontalAlignmentType)),groupTitleFontSize:_propTypes.default.string,groupTitleFontFamily:_propTypes.default.string,groupTitleColor:_propTypes.default.string,groupTitleFontWeight:_propTypes.default.string,groupTitleFontStyle:_propTypes.default.string,onGroupTitleRender:_propTypes.default.func,levelTitlePanelSize:_propTypes.default.number,levelTitlePlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.AdviserPlacementType)),levelTitlePlaceInside:_propTypes.default.bool,levelTitleOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),levelTitleVerticalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.VerticalAlignmentType)),levelTitleHorizontalAlignment:_propTypes.default.oneOf(Object.values(_basicprimitives.HorizontalAlignmentType)),levelTitleFontSize:_propTypes.default.string,levelTitleFontFamily:_propTypes.default.string,levelTitleFontColor:_propTypes.default.string,levelTitleColor:_propTypes.default.string,levelTitleFontWeight:_propTypes.default.string,levelTitleFontStyle:_propTypes.default.string,onLevelTitleRender:_propTypes.default.func,onLevelBackgroundRender:_propTypes.default.func,distance:_propTypes.default.number,scale:_propTypes.default.number,minimumScale:_propTypes.default.number,maximumScale:_propTypes.default.number,showLabels:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),labelSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),labelOffset:_propTypes.default.number,labelOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType)),labelPlacement:_propTypes.default.oneOf(Object.values(_basicprimitives.PlacementType)),labelFontSize:_propTypes.default.string,labelFontFamily:_propTypes.default.string,labelColor:_propTypes.default.string,labelFontWeight:_propTypes.default.string,labelFontStyle:_propTypes.default.string,enablePanning:_propTypes.default.bool,autoSizeMinimum:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),autoSizeMaximum:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),showFrame:_propTypes.default.bool,frameInnerPadding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),frameOuterPadding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),padding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired})});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/OrgItemConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({id:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]).isRequired,parent:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),title:_propTypes.default.string,description:_propTypes.default.string,image:_propTypes.default.string,context:_propTypes.default.any,itemTitleColor:_propTypes.default.string,minimizedItemShapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ShapeType)),groupTitle:_propTypes.default.string,groupTitleColor:_propTypes.default.string,isVisible:_propTypes.default.bool,isActive:_propTypes.default.bool,hasSelectorCheckbox:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),hasButtons:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),itemType:_propTypes.default.oneOf(Object.values(_basicprimitives.ItemType)),adviserPlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.AdviserPlacementType)),childrenPlacementType:_propTypes.default.oneOf(Object.values(_basicprimitives.ChildrenPlacementType)),levelOffset:_propTypes.default.number,placeAdvisersAboveChildren:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),placeAssistantsAboveChildren:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),templateName:_propTypes.default.string,showCallout:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),calloutTemplateName:_propTypes.default.string,label:_propTypes.default.string,showLabel:_propTypes.default.oneOf(Object.values(_basicprimitives.Enabled)),labelSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),labelOrientation:_propTypes.default.oneOf(Object.values(_basicprimitives.TextOrientationType))});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/PaletteItemConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js"),_propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js"));var _default=_propTypes.default.shape({lineColor:_propTypes.default.string,lineWidth:_propTypes.default.number,lineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType))});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/ShapeAnnotationConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({annotationType:_propTypes.default.oneOf([_basicprimitives.AnnotationType.Shape]),zOrderType:_propTypes.default.oneOf(Object.values(_basicprimitives.ZOrderType)),items:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string])),shapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ShapeType)),offset:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),lineWidth:_propTypes.default.number,cornerRadius:_propTypes.default.string,opacity:_propTypes.default.number,borderColor:_propTypes.default.string,fillColor:_propTypes.default.string,lineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),selectItems:_propTypes.default.bool,label:_propTypes.default.any,labelSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),labelPlacement:_propTypes.default.oneOf(Object.values(_basicprimitives.PlacementType)),labelOffset:_propTypes.default.number});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Schemas/TemplateConfigShape.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");var _default=_propTypes.default.shape({name:_propTypes.default.string,isActive:_propTypes.default.bool,itemSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),itemBorderWidth:_propTypes.default.number,onItemRender:_propTypes.default.func,minimizedItemShapeType:_propTypes.default.oneOf(Object.values(_basicprimitives.ShapeType)),minimizedItemSize:_propTypes.default.shape({width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired}),minimizedItemCornerRadius:_propTypes.default.number,minimizedItemLineWidth:_propTypes.default.number,minimizedItemBorderColor:_propTypes.default.string,minimizedItemLineType:_propTypes.default.oneOf(Object.values(_basicprimitives.LineType)),minimizedItemFillColor:_propTypes.default.string,minimizedItemOpacity:_propTypes.default.number,highlightPadding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),highlightBorderWidth:_propTypes.default.number,onHighlightRender:_propTypes.default.func,cursorPadding:_propTypes.default.shape({left:_propTypes.default.number.isRequired,top:_propTypes.default.number.isRequired,right:_propTypes.default.number.isRequired,bottom:_propTypes.default.number.isRequired}),cursorBorderWidth:_propTypes.default.number,onCursorRender:_propTypes.default.func,onButtonsRender:_propTypes.default.func});exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js":function(__unused_webpack_module,exports){"use strict";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=function(){function AbstractTemplate(){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AbstractTemplate)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(AbstractTemplate,[{key:"template",value:function template(){}},{key:"getHashCode",value:function getHashCode(){}},{key:"render",value:function render(data){}}]),AbstractTemplate}();exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/AnnotationLabelTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var AnnotationLabelTemplate=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(AnnotationLabelTemplate,_AbstractTemplate);var _super=_createSuper(AnnotationLabelTemplate);function AnnotationLabelTemplate(){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AnnotationLabelTemplate),_super.apply(this,arguments)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(AnnotationLabelTemplate,[{key:"render",value:function render(data){return data.context.label}}]),AnnotationLabelTemplate}(function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default),_default=AnnotationLabelTemplate;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/ButtonsTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var ButtonsTemplate=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ButtonsTemplate,_AbstractTemplate);var _super=_createSuper(ButtonsTemplate);function ButtonsTemplate(){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ButtonsTemplate),_super.apply(this,arguments)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ButtonsTemplate,[{key:"render",value:function render(data){return(0,data.onButtonsRender)(data)}}]),ButtonsTemplate}(function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default),_default=ButtonsTemplate;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/CheckBoxTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CheckBoxTemplate,_AbstractTemplate);var _super=_createSuper(CheckBoxTemplate);function CheckBoxTemplate(selectCheckBoxLabel){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CheckBoxTemplate),(_this=_super.call(this)).render=_this.render.bind(_assertThisInitialized(_this)),_this.selectCheckBoxLabel=selectCheckBoxLabel,_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(CheckBoxTemplate,[{key:"render",value:function render(data){return _react.default.createElement("div",{style:{textAlign:"left"}},_react.default.createElement("input",{type:"checkbox",name:"checkbox",style:{fontSize:"12px",lineHeight:"12px",verticalAlign:"middle",margin:"0px",padding:"0px"},checked:data.isSelected,onChange:function onChange(){return null},"data-id":data.id}),_react.default.createElement("span",{name:"selectiontext",style:{fontSize:"12px",lineHeight:"12px",verticalAlign:"middle",maring:"0px",paddingLeft:"2px",paddingTop:"0px",paddingRight:"0px",paddingBottom:"0px"},"data-id":data.id},this.selectCheckBoxLabel))}}]),CheckBoxTemplate}(_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/CursorTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CursorTemplate,_AbstractTemplate);var _super=_createSuper(CursorTemplate);function CursorTemplate(options,itemTemplateConfig){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CursorTemplate),(_this=_super.call(this)).options=options,_this.itemTemplateConfig=itemTemplateConfig,_this.render=_this.render.bind(_assertThisInitialized(_this)),_this.style={position:"absolute",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box",MozBorderRadius:"4px",WebkitBorderRadius:"4px",KhtmlBorderRadius:"4px",BorderRadius:"4px",border:"2px solid #fbd850",background:"#ffffff",color:"#eb8f00",width:"100%",height:"100%",left:"-2px",top:"-2px"},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(CursorTemplate,[{key:"render",value:function render(data){var _this$itemTemplateCon=this.itemTemplateConfig,cursorPadding=_this$itemTemplateCon.cursorPadding,itemSize=_this$itemTemplateCon.itemSize,cursorBorderWidth=_this$itemTemplateCon.cursorBorderWidth,style=_objectSpread(_objectSpread({},this.style),{},{width:itemSize.width+cursorPadding.left+cursorPadding.right+"px",height:itemSize.height+cursorPadding.top+cursorPadding.bottom+"px",borderWidth:cursorBorderWidth+"px"});return _react.default.createElement("div",{style:style})}}]),CursorTemplate}(_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/CustomRenderTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(CustomRenderTemplate,_AbstractTemplate);var _super=_createSuper(CustomRenderTemplate);function CustomRenderTemplate(options,onRender){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CustomRenderTemplate),(_this=_super.call(this)).render=onRender,_this}return CustomRenderTemplate}(function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/DotHighlightTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(DotHighlightTemplate,_AbstractTemplate);var _super=_createSuper(DotHighlightTemplate);function DotHighlightTemplate(options,itemTemplateConfig){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DotHighlightTemplate),(_this=_super.call(this)).render=_this.render.bind(_assertThisInitialized(_this)),_this.config=itemTemplateConfig,_this.style={position:"absolute",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box",border:"1px solid #fbcb09",background:"#fdf5ce",color:"#c77405",width:"100%",height:"100%",left:"0px",top:"0px"},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(DotHighlightTemplate,[{key:"render",value:function render(data){var _this$config=this.config,minimizedItemCornerRadius=_this$config.minimizedItemCornerRadius,highlightPadding=_this$config.highlightPadding,highlightBorderWidth=_this$config.highlightBorderWidth,minimizedItemSize=_this$config.minimizedItemSize,radius=0;radius=null===minimizedItemCornerRadius?Math.max(minimizedItemSize.width/2,minimizedItemSize.height/2)+highlightPadding.left:minimizedItemCornerRadius+highlightPadding.left;var style=_objectSpread(_objectSpread({},this.style),{},{borderWidth:highlightBorderWidth+"px",left:-highlightBorderWidth+"px",top:-highlightBorderWidth+"px",MozBorderRadius:radius+"px",WebkitBorderRadius:radius+"px",KhtmlBorderRadius:radius+"px",borderRadius:radius+"px"});return _react.default.createElement("div",{style:style})}}]),DotHighlightTemplate}(_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/GroupTitleTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js")),_AbstractTemplate2=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")),_RotatedText=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/RotatedText.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(GroupTitleTemplate,_AbstractTemplate);var _super=_createSuper(GroupTitleTemplate);function GroupTitleTemplate(options){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GroupTitleTemplate),(_this=_super.call(this)).render=_this.render.bind(_assertThisInitialized(_this)),_this.options=options,_this.style={position:"absolute",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box",MozBorderRadius:"4px",WebkitBorderRadius:"4px",KhtmlBorderRadius:"4px",BorderRadius:"4px",background:"royalblue",borderWidth:0,color:"white",padding:0,width:"100%",height:"100%",left:"-1px",top:"-1px"},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(GroupTitleTemplate,[{key:"render",value:function render(data){var _this$options=this.options,groupTitleFontSize=_this$options.groupTitleFontSize,groupTitleFontFamily=_this$options.groupTitleFontFamily,groupTitleFontWeight=_this$options.groupTitleFontWeight,groupTitleFontStyle=_this$options.groupTitleFontStyle,itemTitleSecondFontColor=_this$options.itemTitleSecondFontColor,itemTitleFirstFontColor=_this$options.itemTitleFirstFontColor,groupTitleOrientation=_this$options.groupTitleOrientation,groupTitleHorizontalAlignment=_this$options.groupTitleHorizontalAlignment,groupTitleVerticalAlignment=_this$options.groupTitleVerticalAlignment,groupTitleColor=_this$options.groupTitleColor,itemConfig=data.context,width=data.width,height=data.height,backgroundColor=itemConfig.groupTitleColor||groupTitleColor,label=(itemConfig.groupTitle||"").replace("\n","<br/>"),color=(0,_basicprimitives.highestContrast)(backgroundColor,itemTitleSecondFontColor,itemTitleFirstFontColor),style=_objectSpread(_objectSpread({},this.style),{},{backgroundColor:backgroundColor,color:color,fontSize:groupTitleFontSize,fontFamily:groupTitleFontFamily,fontWeight:groupTitleFontWeight,fontStyle:groupTitleFontStyle});return _react.default.createElement("div",{style:style},_react.default.createElement(_RotatedText.default,{width:width,height:height,orientation:["Horizontal","RotateLeft","RotateRight","Horizontal"][groupTitleOrientation],horizontalAlignment:["center","left","right"][groupTitleHorizontalAlignment],verticalAlignment:["top","middle","bottom"][groupTitleVerticalAlignment]},label))}}]),GroupTitleTemplate}(_AbstractTemplate2.default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/HighlightTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(HighlightTemplate,_AbstractTemplate);var _super=_createSuper(HighlightTemplate);function HighlightTemplate(options,config){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,HighlightTemplate),(_this=_super.call(this)).options=options,_this.config=config,_this.render=_this.render.bind(_assertThisInitialized(_this)),_this.style={position:"absolute",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box",MozBorderRadius:"4px",WebkitBorderRadius:"4px",KhtmlBorderRadius:"4px",BorderRadius:"4px",border:"1px solid #fbcb09",background:"#fdf5ce",color:"#c77402",width:"100%",height:"100%",left:"-1px",top:"-1px"},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(HighlightTemplate,[{key:"render",value:function render(data){var highlightBorderWidth=this.config.highlightBorderWidth;return _react.default.createElement("div",{style:_objectSpread(_objectSpread({},this.style),{},{borderWidth:highlightBorderWidth+"px"})})}}]),HighlightTemplate}(_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/ItemTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ItemTemplate,_AbstractTemplate);var _super=_createSuper(ItemTemplate);function ItemTemplate(options,config){var _this;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ItemTemplate),(_this=_super.call(this)).options=options,_this.config=config,_this.render=_this.render.bind(_assertThisInitialized(_this));var item={position:"absolute",overflow:"visible",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box"},cornerAll={MozBorderRadius:"4px",WebkitBorderRadius:"4px",KhtmlBorderRadius:"4px",BorderRadius:"4px"},itemFrame={border:"1px solid #dddddd",background:"#eeeeee",color:"#333333"},defaultTemplate=_objectSpread(_objectSpread(_objectSpread(_objectSpread({},item),cornerAll),itemFrame),{},{width:"100%",height:"100%",left:"-1px",top:"-1px"}),title=_objectSpread(_objectSpread({},item),{},{textOverflow:"ellipsis",OTextOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"left",fontSize:"14px",lineHeight:"16px",color:"white",padding:0}),background=_objectSpread(_objectSpread(_objectSpread({},item),cornerAll),itemFrame),photoFrame=_objectSpread(_objectSpread({},item),{},{border:"1px solid #cccccc",background:"#f6f6f6",color:"#1c94c4"});return _this.styles={defaultTemplate:defaultTemplate,title:_objectSpread(_objectSpread({},title),{},{top:"2px",left:"2px",right:"2px",height:"16px"}),background:_objectSpread(_objectSpread({},background),{},{top:"2px",left:"2px",right:"2px",height:"20px"}),photoFrame:_objectSpread(_objectSpread({},photoFrame),{},{top:"26px",left:"2px",width:"50px",height:"60px"}),photo:{height:"60px",width:"50px"},description:_objectSpread(_objectSpread({},item),{},{overflow:"hidden",textAlign:"left",top:"26px",left:"56px",right:"2px",bottom:"2px",fontSize:"12px"})},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ItemTemplate,[{key:"render",value:function render(data){var itemConfig=data.context,_this$styles=this.styles,defaultTemplate=_this$styles.defaultTemplate,title=_this$styles.title,background=_this$styles.background,photoFrame=_this$styles.photoFrame,photo=_this$styles.photo,description=_this$styles.description,itemTitleColor=null!=itemConfig.itemTitleColor?itemConfig.itemTitleColor:_basicprimitives.Colors.RoyalBlue,color=(0,_basicprimitives.highestContrast)(itemTitleColor,this.options.itemTitleSecondFontColor,this.options.itemTitleFirstFontColor);return _react.default.createElement("div",{style:defaultTemplate},_react.default.createElement("div",{style:_objectSpread(_objectSpread({},background),{},{backgroundColor:itemTitleColor})},_react.default.createElement("div",{style:_objectSpread(_objectSpread({},title),{},{color:color})},itemConfig.title)),_react.default.createElement("div",{style:photoFrame},_react.default.createElement("img",{style:photo,src:itemConfig.image,alt:itemConfig.title})),_react.default.createElement("div",{style:description},itemConfig.description))}}]),ItemTemplate}(_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/LabelAnnotationTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var LabelAnnotationTemplate=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(LabelAnnotationTemplate,_AbstractTemplate);var _super=_createSuper(LabelAnnotationTemplate);function LabelAnnotationTemplate(){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LabelAnnotationTemplate),_super.apply(this,arguments)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(LabelAnnotationTemplate,[{key:"render",value:function render(data){return data.context.title}}]),LabelAnnotationTemplate}(function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default),_default=LabelAnnotationTemplate;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/LevelBackgroundTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js")),_AbstractTemplate2=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function getBorderStyle(lineType){var result=null;switch(lineType){case _basicprimitives.LineType.Dotted:result="dotted";break;case _basicprimitives.LineType.Dashed:result="dashed";break;default:result="solid"}return result}var LevelBackgroundTemplate=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(LevelBackgroundTemplate,_AbstractTemplate);var _super=_createSuper(LevelBackgroundTemplate);function LevelBackgroundTemplate(options){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LevelBackgroundTemplate),(_this=_super.call(this)).options=options,_this.render=_this.render.bind(_assertThisInitialized(_this)),_this.style={position:"absolute",width:"100%",height:"100%"},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(LevelBackgroundTemplate,[{key:"render",value:function render(data){var annotationConfig=data.context,style=function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({opacity:annotationConfig.opacity,borderColor:annotationConfig.borderColor,backgroundColor:annotationConfig.fillColor,borderWidth:annotationConfig.lineWidth.toString(),borderStyle:getBorderStyle(annotationConfig.lineType)},this.style);return _react.default.createElement("div",{style:style})}}]),LevelBackgroundTemplate}(_AbstractTemplate2.default),_default=LevelBackgroundTemplate;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/LevelTitleTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=_interopRequireDefault(__webpack_require__("./node_modules/react/index.js")),_AbstractTemplate2=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")),_RotatedText=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/RotatedText.js")),_basicprimitives=__webpack_require__("./node_modules/basicprimitives/src/index.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(LevelTitleTemplate,_AbstractTemplate);var _super=_createSuper(LevelTitleTemplate);function LevelTitleTemplate(options,orientation){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LevelTitleTemplate),(_this=_super.call(this)).render=_this.render.bind(_assertThisInitialized(_this)),_this.options=options,_this.orientation=orientation,_this.style={position:"absolute",fontFamily:"Trebuchet MS, Tahoma, Verdana, Arial, sans-serif",WebkitTapHighlightColor:"rgba(0,0,0,0)",WebkitUserSelect:"none",WebkitTouchCallout:"none",KhtmlUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",boxSizing:"content-box",MozBorderRadius:"4px",WebkitBorderRadius:"4px",KhtmlBorderRadius:"4px",BorderRadius:"4px",background:"royalblue",borderWidth:0,color:"white",padding:0,width:"100%",height:"100%",left:"-1px",top:"-1px"},_this}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(LevelTitleTemplate,[{key:"render",value:function render(data){var _this$options=this.options,levelTitleFontSize=_this$options.levelTitleFontSize,levelTitleFontFamily=_this$options.levelTitleFontFamily,levelTitleFontWeight=_this$options.levelTitleFontWeight,levelTitleFontStyle=_this$options.levelTitleFontStyle,levelTitleOrientation=_this$options.levelTitleOrientation,levelTitleHorizontalAlignment=_this$options.levelTitleHorizontalAlignment,levelTitleVerticalAlignment=_this$options.levelTitleVerticalAlignment,levelTitleFontColor=_this$options.levelTitleFontColor,levelTitleColor=_this$options.levelTitleColor;if(levelTitleOrientation===_basicprimitives.TextOrientationType.Auto)switch(this.orientation){case _basicprimitives.OrientationType.Top:case _basicprimitives.OrientationType.Bottom:levelTitleOrientation=_basicprimitives.TextOrientationType.RotateRight}var annotationConfig=data.context,width=data.width,height=data.height,backgroundColor=annotationConfig.titleColor||levelTitleColor,label=(annotationConfig.title||"").replace("\n","<br/>"),color=annotationConfig.titleFontColor||levelTitleFontColor,style=_objectSpread(_objectSpread({},this.style),{},{backgroundColor:backgroundColor,color:color,fontSize:levelTitleFontSize,fontFamily:levelTitleFontFamily,fontWeight:levelTitleFontWeight,fontStyle:levelTitleFontStyle});return _react.default.createElement("div",{style:style},_react.default.createElement(_RotatedText.default,{width:width,height:height,orientation:["Horizontal","RotateLeft","RotateRight","Horizontal"][levelTitleOrientation],horizontalAlignment:["center","left","right"][levelTitleHorizontalAlignment],verticalAlignment:["top","middle","bottom"][levelTitleVerticalAlignment]},label))}}]),LevelTitleTemplate}(_AbstractTemplate2.default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/RotatedText.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _react=function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;if(null===obj||"object"!==_typeof(obj)&&"function"!=typeof obj)return{default:obj};var cache=_getRequireWildcardCache();if(cache&&cache.has(obj))return cache.get(obj);var newObj={},hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;desc&&(desc.get||desc.set)?Object.defineProperty(newObj,key,desc):newObj[key]=obj[key]}newObj.default=obj,cache&&cache.set(obj,newObj);return newObj}(__webpack_require__("./node_modules/react/index.js")),_propTypes=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/prop-types/index.js"));function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var cache=new WeakMap;return _getRequireWildcardCache=function _getRequireWildcardCache(){return cache},cache}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var RotatedText=function(_Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(RotatedText,_Component);var _super=_createSuper(RotatedText);function RotatedText(){return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RotatedText),_super.apply(this,arguments)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(RotatedText,[{key:"getTransform",value:function getTransform(orientation){var result="";switch(orientation){case"RotateLeft":result="rotate(-90deg)";break;case"RotateRight":result="rotate(90deg)"}return result}},{key:"render",value:function render(){var _this$props=this.props,children=_this$props.children,width=_this$props.width,height=_this$props.height,orientation=_this$props.orientation,horizontalAlignment=_this$props.horizontalAlignment,verticalAlignment=_this$props.verticalAlignment,transform=this.getTransform(orientation),style=_objectSpread({position:"absolute",padding:0,margin:0,lineHeight:1,textAlign:horizontalAlignment,WebkitTransformOrigin:"center center",MozTransformOrigin:"center center",OTransformOrigin:"center center",msTransformOrigin:"center center",WebkitTransform:transform,MozTransform:transform,OTransform:transform,msTransform:transform,transform:transform,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",tableLayout:"fixed"},"Horizontal"===orientation?{width:width+"px",height:height+"px",maxWidth:width+"px",maxHeight:height+"px"}:{width:height+"px",height:width+"px",maxWidth:height+"px",maxHeight:width+"px",left:Math.round(width/2-height/2)+"px",top:Math.round(height/2-width/2)+"px"});return"top"===verticalAlignment?_react.default.createElement("div",{style:style},children):_react.default.createElement("table",{style:_objectSpread(_objectSpread({},style),{},{borderCollapse:"collapse"})},_react.default.createElement("tbody",null,_react.default.createElement("tr",null,_react.default.createElement("td",{style:{verticalAlign:verticalAlignment,padding:0,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}},children))))}}]),RotatedText}(_react.Component);_defineProperty(RotatedText,"propTypes",{width:_propTypes.default.number.isRequired,height:_propTypes.default.number.isRequired,orientation:_propTypes.default.oneOf(["Horizontal","RotateLeft","RotateRight"]),horizontalAlignment:_propTypes.default.oneOf(["left","center","right"]),verticalAlignment:_propTypes.default.oneOf(["top","middle","bottom"])}),_defineProperty(RotatedText,"defaultProps",{orientation:"RotateRight",horizontalAlignment:"center",verticalAlignment:"middle"});var _default=RotatedText;exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/UserTemplate.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _default=function(_AbstractTemplate){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(UserTemplate,_AbstractTemplate);var _super=_createSuper(UserTemplate);function UserTemplate(options,content,onRender){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UserTemplate),(_this=_super.call(this)).render=onRender,_this}return UserTemplate}(function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AbstractTemplate.js")).default);exports.default=_default},"./node_modules/basicprimitivesreact/dist/esm/Templates/index.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AnnotationLabelTemplate",{enumerable:!0,get:function get(){return _AnnotationLabelTemplate.default}}),Object.defineProperty(exports,"ButtonsTemplate",{enumerable:!0,get:function get(){return _ButtonsTemplate.default}}),Object.defineProperty(exports,"CheckBoxTemplate",{enumerable:!0,get:function get(){return _CheckBoxTemplate.default}}),Object.defineProperty(exports,"CursorTemplate",{enumerable:!0,get:function get(){return _CursorTemplate.default}}),Object.defineProperty(exports,"DotHighlightTemplate",{enumerable:!0,get:function get(){return _DotHighlightTemplate.default}}),Object.defineProperty(exports,"GroupTitleTemplate",{enumerable:!0,get:function get(){return _GroupTitleTemplate.default}}),Object.defineProperty(exports,"HighlightTemplate",{enumerable:!0,get:function get(){return _HighlightTemplate.default}}),Object.defineProperty(exports,"ItemTemplate",{enumerable:!0,get:function get(){return _ItemTemplate.default}}),Object.defineProperty(exports,"UserTemplate",{enumerable:!0,get:function get(){return _UserTemplate.default}}),Object.defineProperty(exports,"CustomRenderTemplate",{enumerable:!0,get:function get(){return _CustomRenderTemplate.default}}),Object.defineProperty(exports,"LabelAnnotationTemplate",{enumerable:!0,get:function get(){return _LabelAnnotationTemplate.default}}),Object.defineProperty(exports,"LevelTitleTemplate",{enumerable:!0,get:function get(){return _LevelTitleTemplate.default}}),Object.defineProperty(exports,"LevelBackgroundTemplate",{enumerable:!0,get:function get(){return _LevelBackgroundTemplate.default}});var _AnnotationLabelTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/AnnotationLabelTemplate.js")),_ButtonsTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/ButtonsTemplate.js")),_CheckBoxTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/CheckBoxTemplate.js")),_CursorTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/CursorTemplate.js")),_DotHighlightTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/DotHighlightTemplate.js")),_GroupTitleTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/GroupTitleTemplate.js")),_HighlightTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/HighlightTemplate.js")),_ItemTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/ItemTemplate.js")),_UserTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/UserTemplate.js")),_CustomRenderTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/CustomRenderTemplate.js")),_LabelAnnotationTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/LabelAnnotationTemplate.js")),_LevelTitleTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/LevelTitleTemplate.js")),_LevelBackgroundTemplate=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/LevelBackgroundTemplate.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},"./node_modules/basicprimitivesreact/dist/esm/index.js":function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"PI",{enumerable:!0,get:function get(){return _OrgDiagram.default}});var _OrgDiagram=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/OrgDiagram.js")),_FamDiagram=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/FamDiagram.js")),_RotatedText=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Templates/RotatedText.js")),_BackgroundAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/BackgroundAnnotationConfigShape.js")),_ConnectorAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/ConnectorAnnotationConfigShape.js")),_FamConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/FamConfigShape.js")),_FamItemConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/FamItemConfigShape.js")),_HighlightPathAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/HighlightPathAnnotationConfigShape.js")),_LabelAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/LabelAnnotationConfigShape.js")),_OrgConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/OrgConfigShape.js")),_OrgItemConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/OrgItemConfigShape.js")),_PaletteItemConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/PaletteItemConfigShape.js")),_ShapeAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/ShapeAnnotationConfigShape.js")),_LevelAnnotationConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/LevelAnnotationConfigShape.js")),_TemplateConfigShape=_interopRequireDefault(__webpack_require__("./node_modules/basicprimitivesreact/dist/esm/Schemas/TemplateConfigShape.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},"./node_modules/resize-observer-polyfill/dist/ResizeObserver.global.js":function(module,__unused_webpack_exports,__webpack_require__){module.exports=function(){"use strict";var MapShim=function(){if("undefined"!=typeof Map)return Map;function getIndex(arr,key){var result=-1;return arr.some((function(entry,index){return entry[0]===key&&(result=index,!0)})),result}return function(){function anonymous(){this.__entries__=[]}var prototypeAccessors={size:{configurable:!0}};return prototypeAccessors.size.get=function(){return this.__entries__.length},anonymous.prototype.get=function(key){var index=getIndex(this.__entries__,key),entry=this.__entries__[index];return entry&&entry[1]},anonymous.prototype.set=function(key,value){var index=getIndex(this.__entries__,key);~index?this.__entries__[index][1]=value:this.__entries__.push([key,value])},anonymous.prototype.delete=function(key){var entries=this.__entries__,index=getIndex(entries,key);~index&&entries.splice(index,1)},anonymous.prototype.has=function(key){return!!~getIndex(this.__entries__,key)},anonymous.prototype.clear=function(){this.__entries__.splice(0)},anonymous.prototype.forEach=function(callback,ctx){void 0===ctx&&(ctx=null);for(var i=0,list=this.__entries__;i<list.length;i+=1){var entry=list[i];callback.call(ctx,entry[1],entry[0])}},Object.defineProperties(anonymous.prototype,prototypeAccessors),anonymous}()}(),isBrowser="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,global$1=void 0!==__webpack_require__.g&&__webpack_require__.g.Math===Math?__webpack_require__.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),requestAnimationFrame$1="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(global$1):function(callback){return setTimeout((function(){return callback(Date.now())}),1e3/60)},trailingTimeout=2,throttle=function(callback,delay){var leadingCall=!1,trailingCall=!1,lastCallTime=0;function resolvePending(){leadingCall&&(leadingCall=!1,callback()),trailingCall&&proxy()}function timeoutCallback(){requestAnimationFrame$1(resolvePending)}function proxy(){var timeStamp=Date.now();if(leadingCall){if(timeStamp-lastCallTime<trailingTimeout)return;trailingCall=!0}else leadingCall=!0,trailingCall=!1,setTimeout(timeoutCallback,delay);lastCallTime=timeStamp}return proxy},REFRESH_DELAY=20,transitionKeys=["top","right","bottom","left","width","height","size","weight"],mutationObserverSupported="undefined"!=typeof MutationObserver,ResizeObserverController=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=throttle(this.refresh.bind(this),REFRESH_DELAY)};ResizeObserverController.prototype.addObserver=function(observer){~this.observers_.indexOf(observer)||this.observers_.push(observer),this.connected_||this.connect_()},ResizeObserverController.prototype.removeObserver=function(observer){var observers=this.observers_,index=observers.indexOf(observer);~index&&observers.splice(index,1),!observers.length&&this.connected_&&this.disconnect_()},ResizeObserverController.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},ResizeObserverController.prototype.updateObservers_=function(){var activeObservers=this.observers_.filter((function(observer){return observer.gatherActive(),observer.hasActive()}));return activeObservers.forEach((function(observer){return observer.broadcastActive()})),activeObservers.length>0},ResizeObserverController.prototype.connect_=function(){isBrowser&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),mutationObserverSupported?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},ResizeObserverController.prototype.disconnect_=function(){isBrowser&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},ResizeObserverController.prototype.onTransitionEnd_=function(ref){var propertyName=ref.propertyName;void 0===propertyName&&(propertyName=""),transitionKeys.some((function(key){return!!~propertyName.indexOf(key)}))&&this.refresh()},ResizeObserverController.getInstance=function(){return this.instance_||(this.instance_=new ResizeObserverController),this.instance_},ResizeObserverController.instance_=null;var defineConfigurable=function(target,props){for(var i=0,list=Object.keys(props);i<list.length;i+=1){var key=list[i];Object.defineProperty(target,key,{value:props[key],enumerable:!1,writable:!1,configurable:!0})}return target},getWindowOf=function(target){return target&&target.ownerDocument&&target.ownerDocument.defaultView||global$1},emptyRect=createRectInit(0,0,0,0);function toFloat(value){return parseFloat(value)||0}function getBordersSize(styles){for(var positions=[],len=arguments.length-1;len-- >0;)positions[len]=arguments[len+1];return positions.reduce((function(size,position){return size+toFloat(styles["border-"+position+"-width"])}),0)}function getPaddings(styles){for(var paddings={},i=0,list=["top","right","bottom","left"];i<list.length;i+=1){var position=list[i],value=styles["padding-"+position];paddings[position]=toFloat(value)}return paddings}function getSVGContentRect(target){var bbox=target.getBBox();return createRectInit(0,0,bbox.width,bbox.height)}function getHTMLElementContentRect(target){var clientWidth=target.clientWidth,clientHeight=target.clientHeight;if(!clientWidth&&!clientHeight)return emptyRect;var styles=getWindowOf(target).getComputedStyle(target),paddings=getPaddings(styles),horizPad=paddings.left+paddings.right,vertPad=paddings.top+paddings.bottom,width=toFloat(styles.width),height=toFloat(styles.height);if("border-box"===styles.boxSizing&&(Math.round(width+horizPad)!==clientWidth&&(width-=getBordersSize(styles,"left","right")+horizPad),Math.round(height+vertPad)!==clientHeight&&(height-=getBordersSize(styles,"top","bottom")+vertPad)),!isDocumentElement(target)){var vertScrollbar=Math.round(width+horizPad)-clientWidth,horizScrollbar=Math.round(height+vertPad)-clientHeight;1!==Math.abs(vertScrollbar)&&(width-=vertScrollbar),1!==Math.abs(horizScrollbar)&&(height-=horizScrollbar)}return createRectInit(paddings.left,paddings.top,width,height)}var isSVGGraphicsElement="undefined"!=typeof SVGGraphicsElement?function(target){return target instanceof getWindowOf(target).SVGGraphicsElement}:function(target){return target instanceof getWindowOf(target).SVGElement&&"function"==typeof target.getBBox};function isDocumentElement(target){return target===getWindowOf(target).document.documentElement}function getContentRect(target){return isBrowser?isSVGGraphicsElement(target)?getSVGContentRect(target):getHTMLElementContentRect(target):emptyRect}function createReadOnlyRect(ref){var x=ref.x,y=ref.y,width=ref.width,height=ref.height,Constr="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,rect=Object.create(Constr.prototype);return defineConfigurable(rect,{x:x,y:y,width:width,height:height,top:y,right:x+width,bottom:height+y,left:x}),rect}function createRectInit(x,y,width,height){return{x:x,y:y,width:width,height:height}}var ResizeObservation=function(target){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=createRectInit(0,0,0,0),this.target=target};ResizeObservation.prototype.isActive=function(){var rect=getContentRect(this.target);return this.contentRect_=rect,rect.width!==this.broadcastWidth||rect.height!==this.broadcastHeight},ResizeObservation.prototype.broadcastRect=function(){var rect=this.contentRect_;return this.broadcastWidth=rect.width,this.broadcastHeight=rect.height,rect};var ResizeObserverEntry=function(target,rectInit){var contentRect=createReadOnlyRect(rectInit);defineConfigurable(this,{target:target,contentRect:contentRect})},ResizeObserverSPI=function(callback,controller,callbackCtx){if(this.activeObservations_=[],this.observations_=new MapShim,"function"!=typeof callback)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=callback,this.controller_=controller,this.callbackCtx_=callbackCtx};ResizeObserverSPI.prototype.observe=function(target){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(target instanceof getWindowOf(target).Element))throw new TypeError('parameter 1 is not of type "Element".');var observations=this.observations_;observations.has(target)||(observations.set(target,new ResizeObservation(target)),this.controller_.addObserver(this),this.controller_.refresh())}},ResizeObserverSPI.prototype.unobserve=function(target){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(target instanceof getWindowOf(target).Element))throw new TypeError('parameter 1 is not of type "Element".');var observations=this.observations_;observations.has(target)&&(observations.delete(target),observations.size||this.controller_.removeObserver(this))}},ResizeObserverSPI.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},ResizeObserverSPI.prototype.gatherActive=function(){var this$1=this;this.clearActive(),this.observations_.forEach((function(observation){observation.isActive()&&this$1.activeObservations_.push(observation)}))},ResizeObserverSPI.prototype.broadcastActive=function(){if(this.hasActive()){var ctx=this.callbackCtx_,entries=this.activeObservations_.map((function(observation){return new ResizeObserverEntry(observation.target,observation.broadcastRect())}));this.callback_.call(ctx,entries,ctx),this.clearActive()}},ResizeObserverSPI.prototype.clearActive=function(){this.activeObservations_.splice(0)},ResizeObserverSPI.prototype.hasActive=function(){return this.activeObservations_.length>0};var observers="undefined"!=typeof WeakMap?new WeakMap:new MapShim,ResizeObserver=function(callback){if(!(this instanceof ResizeObserver))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var controller=ResizeObserverController.getInstance(),observer=new ResizeObserverSPI(callback,controller,this);observers.set(this,observer)};return["observe","unobserve","disconnect"].forEach((function(method){ResizeObserver.prototype[method]=function(){return(ref=observers.get(this))[method].apply(ref,arguments);var ref}})),void 0!==global$1.ResizeObserver?global$1.ResizeObserver:(global$1.ResizeObserver=ResizeObserver,ResizeObserver)}()}}]);